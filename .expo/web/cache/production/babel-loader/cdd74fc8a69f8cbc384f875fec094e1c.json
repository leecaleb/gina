{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import Image from\"react-native-web/dist/exports/Image\";import{Card}from'native-base';import{formatDate,fetchData as _fetchData,formatTime}from\"../util\";import Reloading from\"../reloading\";var MilkCard=function(_React$Component){_inherits(MilkCard,_React$Component);var _super=_createSuper(MilkCard);function MilkCard(props){var _this;_classCallCheck(this,MilkCard);_this=_super.call(this,props);_this.state={isLoading:true};_this.fetchData=_this.fetchData.bind(_assertThisInitialized(_this));return _this;}_createClass(MilkCard,[{key:\"componentDidMount\",value:function componentDidMount(){var date=this.props.date;this.fetchData(this.props.child_id,new Date(date.getTime()));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(this.props.date!==prevProps.date){this.setState({isLoading:true});this.fetchData(this.props.child_id,new Date(this.props.date.getTime()));}else if(this.props.child_id!==prevProps.child_id){this.setState({isLoading:true});this.fetchData(this.props.child_id,new Date(this.props.date.getTime()));}}},{key:\"fetchData\",value:function fetchData(child_id,date){var start_date,end_date,milkIntakeData;return _regeneratorRuntime.async(function fetchData$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(date.getHours()<17)){_context.next=3;break;}this.setState({isLoading:false});return _context.abrupt(\"return\");case 3:start_date=formatDate(date);date.setDate(date.getDate()+1);end_date=formatDate(date);_context.next=8;return _regeneratorRuntime.awrap(_fetchData('milkintake',child_id,start_date,end_date));case 8:milkIntakeData=_context.sent;this.setState({milkIntakeData:milkIntakeData,isLoading:false});case 10:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"render\",value:function render(){var _this$state=this.state,milkIntakeData=_this$state.milkIntakeData,isLoading=_this$state.isLoading;var today=formatDate(this.props.date);return React.createElement(Card,{style:{width:'93%'}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{width:56,height:56,justifyContent:'center',alignItems:'center'}},React.createElement(Image,{source:require(\"../../assets/icon-milk.png\"),style:{width:48,height:48}})),React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{paddingTop:8}},React.createElement(Text,{style:{fontSize:20}},\"\\u559D\\u5976\")),isLoading?React.createElement(Reloading,null):milkIntakeData&&milkIntakeData[today]?React.createElement(View,{style:{flex:1,paddingVertical:8}},React.createElement(View,{style:{flexDirection:'row',paddingBottom:5}},React.createElement(View,{style:{width:'25%',justifyContent:'center'}},React.createElement(Text,{style:{fontSize:15,textAlign:'center',color:'#606060'}},\"\\u6642\\u9593\")),React.createElement(View,{style:{width:'28%',justifyContent:'center'}},React.createElement(Text,{style:{fontSize:15,textAlign:'center',color:'#606060'}},\"\\u91CF\")),React.createElement(View,{style:{width:'28%',justifyContent:'center'}},React.createElement(Text,{style:{fontSize:15,textAlign:'center',color:'#606060'}},\"\\u4E73\\u54C1\")),React.createElement(View,{style:{width:'19%',justifyContent:'center'}},React.createElement(Text,{style:{fontSize:15,textAlign:'center',color:'#606060'}},\"\\u8001\\u5E2B\"))),milkIntakeData[today].map(function(record,index){var time=record.time,amount=record.amount,milk_type=record.milk_type,teacher_name=record.teacher_name;return React.createElement(View,{key:index,style:{flexDirection:'row'}},React.createElement(View,{style:{width:'25%'}},React.createElement(Text,{style:{fontSize:20,textAlign:'center',color:'#404040'}},time)),React.createElement(View,{style:{width:'28%'}},React.createElement(Text,{style:{fontSize:20,textAlign:'center',color:'#404040'}},amount,\" c.c.\")),React.createElement(View,{style:{width:'28%'}},React.createElement(Text,{style:{fontSize:20,textAlign:'center',color:'#404040'}},milk_type)),React.createElement(View,{style:{width:'19%'}},React.createElement(Text,{style:{fontSize:20,textAlign:'center',color:'#404040'}},teacher_name!==null&&teacher_name.slice(1))));})):React.createElement(View,{style:{flex:1,paddingVertical:8}},React.createElement(Text,{style:{fontSize:17}},\"\\u6C92\\u6709\\u65B0\\u7D00\\u9304\")))));}}]);return MilkCard;}(React.Component);export{MilkCard as default};","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/parent/milkcard.js"],"names":["React","Card","formatDate","fetchData","formatTime","Reloading","MilkCard","props","state","isLoading","bind","date","child_id","Date","getTime","prevProps","setState","getHours","start_date","setDate","getDate","end_date","milkIntakeData","today","width","flex","flexDirection","height","justifyContent","alignItems","require","paddingTop","fontSize","paddingVertical","paddingBottom","textAlign","color","map","record","index","time","amount","milk_type","teacher_name","slice","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { View, Text, Image } from 'react-native'\nimport { Card } from 'native-base'\nimport { formatDate, fetchData, formatTime } from '../util';\nimport Reloading from '../reloading';\n\nexport default class MilkCard extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      isLoading: true\n    }\n    this.fetchData = this.fetchData.bind(this)\n  }\n\n  componentDidMount() {\n    const { date } = this.props\n    this.fetchData(this.props.child_id, new Date(date.getTime()))\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.date !== prevProps.date) {\n      this.setState({ isLoading: true })\n      this.fetchData(this.props.child_id, new Date(this.props.date.getTime()));\n    } else if (this.props.child_id !== prevProps.child_id) {\n      this.setState({ isLoading: true })\n      this.fetchData(this.props.child_id, new Date(this.props.date.getTime()));\n    }\n  }\n\n  async fetchData(child_id, date) {\n    if (date.getHours() < 17) {\n      this.setState({\n        isLoading: false\n      })\n      return\n    }\n    const start_date = formatDate(date)\n    date.setDate(date.getDate() + 1)\n    const end_date = formatDate(date)\n    const milkIntakeData = await fetchData('milkintake', child_id, start_date, end_date)\n    this.setState({\n      milkIntakeData,\n      isLoading: false\n    })\n  }\n\n  render() {\n    const { milkIntakeData, isLoading } = this.state\n    // console.log('milkIntakeData: ', milkIntakeData)\n    const today = formatDate(this.props.date)\n    return (\n      <Card style={{ width: '93%' }}>\n        <View style={{ flex: 1, flexDirection: 'row' }}>\n          <View style={{ width: 56, height: 56, justifyContent: 'center', alignItems: 'center'}}>\n            <Image\n              source={require('../../assets/icon-milk.png')}\n              style={{\n                  width: 48,\n                  height: 48\n              }}\n            />\n          </View>\n          <View style={{ flex: 1 }}>\n            <View style={{ paddingTop: 8 }}>\n              <Text style={{ fontSize: 20 }}>喝奶</Text>\n            </View>\n            {isLoading ? \n              <Reloading />\n            : milkIntakeData && milkIntakeData[today] ?\n                <View style={{ flex: 1, paddingVertical: 8 }}>\n                  <View\n                    style={{ flexDirection: 'row', paddingBottom: 5 }}\n                  >\n                    <View style={{ width: '25%', justifyContent: 'center' }}>\n                      <Text style={{ fontSize: 15, textAlign: 'center', color: '#606060' }}>時間</Text>\n                    </View>\n                    <View style={{ width: '28%', justifyContent: 'center' }}>\n                      <Text style={{ fontSize: 15, textAlign: 'center', color: '#606060' }}>量</Text>\n                    </View>\n                    <View style={{ width: '28%', justifyContent: 'center' }}>\n                      <Text style={{ fontSize: 15, textAlign: 'center', color: '#606060' }}>乳品</Text>\n                    </View>\n                    <View style={{ width: '19%', justifyContent: 'center' }}>\n                      <Text style={{ fontSize: 15, textAlign: 'center', color: '#606060' }}>老師</Text>\n                    </View>\n                  </View>\n                  {milkIntakeData[today].map((record, index) => {\n                    const { time, amount, milk_type, teacher_name } = record\n                    return (\n                      <View key={index}\n                        style={{ flexDirection: 'row' }}\n                      >\n                        <View style={{ width: '25%' }}>\n                          <Text style={{ fontSize: 20, textAlign: 'center', color: '#404040' }}>{time}</Text>\n                        </View>\n                        <View style={{ width: '28%' }}>\n                          <Text style={{ fontSize: 20, textAlign: 'center', color: '#404040' }}>{amount} c.c.</Text>\n                        </View>\n                        <View style={{ width: '28%' }}>\n                          <Text style={{ fontSize: 20, textAlign: 'center', color: '#404040' }}>{milk_type}</Text>\n                        </View>\n                        <View style={{ width: '19%' }}>\n                          <Text style={{fontSize: 20, textAlign: 'center', color: '#404040' }}>{teacher_name !== null && teacher_name.slice(1)}</Text>\n                        </View>\n                      </View>\n                    )\n                  })}\n                </View>\n              : <View style={{ flex: 1, paddingVertical: 8  }}>\n                  <Text style={{ fontSize: 17 }}>沒有新紀錄</Text>\n                </View>\n            }\n          </View>\n        </View>\n      </Card>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}