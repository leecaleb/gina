{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/home/caleb_lee/gina_web_app/components/teacher/attendancecard.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport { Card, CardItem, Toast } from 'native-base';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { markAbsent, markPresent } from \"./../../redux/school/actions/index\";\nimport { formatDate } from \"./../util\";\n\nvar AttendanceCard = function (_React$Component) {\n  _inherits(AttendanceCard, _React$Component);\n\n  var _super = _createSuper(AttendanceCard);\n\n  function AttendanceCard(props) {\n    var _this;\n\n    _classCallCheck(this, AttendanceCard);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      selected_student_ids: []\n    };\n    return _this;\n  }\n\n  _createClass(AttendanceCard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchData();\n    }\n  }, {\n    key: \"onSelectAttendanceType\",\n    value: function onSelectAttendanceType(attendance_type) {\n      var attendance = this.props.attendance;\n\n      switch (attendance_type) {\n        case 'present':\n          {\n            this.setState({\n              selected_student_ids: _toConsumableArray(attendance.present)\n            });\n            return;\n          }\n\n        case 'absent':\n          {\n            this.setState({\n              selected_student_ids: _toConsumableArray(attendance.absent)\n            });\n            return;\n          }\n\n        case 'unmarked':\n          {\n            this.setState({\n              selected_student_ids: _toConsumableArray(attendance.unmarked)\n            });\n            return;\n          }\n      }\n    }\n  }, {\n    key: \"fetchData\",\n    value: function fetchData() {\n      var _this2 = this;\n\n      var date = formatDate(new Date());\n      var query = \"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance?date=\" + date + \"&class_id=\" + this.props.class.class_id;\n      fetch(query, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (resJson) {\n        for (var key in resJson) {\n          if (resJson[key][0] !== null) {\n            _this2.props.markPresent(key, resJson[key][0]);\n          } else if (resJson[key][2] !== null) {\n            _this2.props.markAbsent(key, resJson[key][2]);\n          }\n        }\n\n        _this2.setState({\n          selected_student_ids: _toConsumableArray(_this2.props.attendance.unmarked)\n        });\n      }).catch(function (err) {\n        return console.log('err: ', err);\n      });\n    }\n  }, {\n    key: \"handleOnClick\",\n    value: function handleOnClick(student_id) {\n      this.props.showModal(student_id);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(Card, {\n        style: {\n          flex: 1,\n          alignItems: 'center',\n          justifyContent: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }\n      }, React.createElement(CardItem, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 17\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 30\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 21\n        }\n      }, \"\\u51FA\\u5E2D\\u72C0\\u6CC1\")), React.createElement(View, {\n        style: {\n          flex: 1,\n          flexDirection: 'row'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 17\n        }\n      }, React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 21\n        }\n      }, React.createElement(View, {\n        style: {\n          paddingLeft: 5,\n          paddingTop: 5\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 25\n        }\n      }, React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 29\n        }\n      }, \"\\u51FA\\u5E2D\")), React.createElement(TouchableHighlight, {\n        style: {\n          flex: 1,\n          alignSelf: 'center',\n          width: '70%',\n          height: '70%',\n          backgroundColor: '#dcf3d0'\n        },\n        underlayColor: \"#00c07f\",\n        onPress: function onPress() {\n          return _this3.onSelectAttendanceType('present');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 25\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          width: '100%',\n          textAlign: 'center',\n          fontSize: 60\n        },\n        adjustsFontSizeToFit: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 29\n        }\n      }, this.props.attendance.present.size))), React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 21\n        }\n      }, React.createElement(View, {\n        style: {\n          paddingLeft: 5,\n          paddingTop: 5\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 25\n        }\n      }, React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 29\n        }\n      }, \"\\u7F3A\\u5E2D\")), React.createElement(TouchableHighlight, {\n        style: {\n          flex: 1,\n          alignSelf: 'center',\n          width: '70%',\n          height: '70%',\n          backgroundColor: '#ffe1d0'\n        },\n        underlayColor: \"#fa625f\",\n        onPress: function onPress() {\n          return _this3.onSelectAttendanceType('absent');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 25\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          width: '100%',\n          textAlign: 'center',\n          fontSize: 60\n        },\n        adjustsFontSizeToFit: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 29\n        }\n      }, this.props.attendance.absent.size))), React.createElement(View, {\n        style: {\n          flex: 1\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 21\n        }\n      }, React.createElement(View, {\n        style: {\n          paddingLeft: 5,\n          paddingTop: 5\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 25\n        }\n      }, React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 29\n        }\n      }, \"\\u672A\\u77E5\")), React.createElement(TouchableHighlight, {\n        style: {\n          flex: 1,\n          alignSelf: 'center',\n          width: '70%',\n          height: '70%',\n          backgroundColor: '#fff1b5'\n        },\n        underlayColor: \"#f4d41f\",\n        onPress: function onPress() {\n          return _this3.onSelectAttendanceType('unmarked');\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 25\n        }\n      }, React.createElement(Text, {\n        style: {\n          flex: 1,\n          width: '100%',\n          textAlign: 'center',\n          fontSize: 60\n        },\n        adjustsFontSizeToFit: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 29\n        }\n      }, this.props.attendance.unmarked.size)))), React.createElement(View, {\n        style: {\n          flex: 1,\n          flexDirection: 'row',\n          flexWrap: 'wrap'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 17\n        }\n      }, this.state.selected_student_ids.map(function (student_id) {\n        var _this3$props$attendan = _this3.props.attendance,\n            present = _this3$props$attendan.present,\n            unmarked = _this3$props$attendan.unmarked,\n            absent = _this3$props$attendan.absent;\n        return React.createElement(TouchableHighlight, {\n          key: student_id,\n          style: {\n            width: '31%',\n            margin: '1%'\n          },\n          underlayColor: \"transparent\",\n          onPress: function onPress() {\n            return _this3.handleOnClick(student_id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 29\n          }\n        }, React.createElement(View, {\n          style: styles.cardContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 33\n          }\n        }, React.createElement(Card, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 37\n          }\n        }, React.createElement(CardItem, {\n          style: {\n            justifyContent: 'center'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 41\n          }\n        }, React.createElement(Image, {\n          source: _this3.props.class.students[student_id].profile_picture === '' ? require(\"../../assets/icon-thumbnail.png\") : {\n            uri: _this3.props.class.students[student_id].profile_picture\n          },\n          style: {\n            height: 200,\n            width: 200,\n            borderRadius: 100,\n            borderWidth: 10,\n            borderColor: present.has(student_id) ? '#dcf3d0' : unmarked.has(student_id) ? '#fff1b5' : '#ffe1d0'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 49\n          }\n        })), React.createElement(CardItem, {\n          footer: true,\n          style: {\n            justifyContent: 'center',\n            marginTop: -5\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 41\n          }\n        }, React.createElement(Text, {\n          style: {\n            marginTop: -10\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 45\n          }\n        }, _this3.props.class.students[student_id].name)))));\n      })));\n    }\n  }]);\n\n  return AttendanceCard;\n}(React.Component);\n\nvar styles = StyleSheet.create({\n  cardContainer: {\n    paddingVertical: 5\n  },\n  thumbnailImage: {\n    height: 80,\n    width: 80,\n    borderRadius: 40\n  }\n});\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    attendance: state.attendance,\n    class: state.classInfo\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return _objectSpread({}, bindActionCreators({\n    markAbsent: markAbsent,\n    markPresent: markPresent\n  }, dispatch));\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps, null, {\n  forwardRef: true\n})(AttendanceCard);","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/teacher/attendancecard.js"],"names":["React","Card","CardItem","Toast","connect","bindActionCreators","markAbsent","markPresent","formatDate","AttendanceCard","props","state","selected_student_ids","fetchData","attendance_type","attendance","setState","present","absent","unmarked","date","Date","query","class","class_id","fetch","method","headers","Accept","then","res","json","resJson","key","catch","err","console","log","student_id","showModal","flex","alignItems","justifyContent","fontSize","flexDirection","paddingLeft","paddingTop","alignSelf","width","height","backgroundColor","onSelectAttendanceType","textAlign","size","flexWrap","map","margin","handleOnClick","styles","cardContainer","students","profile_picture","require","uri","borderRadius","borderWidth","borderColor","has","marginTop","name","Component","StyleSheet","create","paddingVertical","thumbnailImage","mapStateToProps","classInfo","mapDispatchToProps","dispatch","forwardRef"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Card, CardItem, Toast } from 'native-base'\nimport { View, Text, StyleSheet, Image, TouchableHighlight } from 'react-native'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport { markAbsent, markPresent } from './../../redux/school/actions/index'\nimport { formatDate } from './../util'\n\nclass AttendanceCard extends React.Component{\n    constructor(props) {\n        super(props)\n        this.state = {\n            selected_student_ids: []\n        }\n    }\n\n    componentDidMount() {\n        this.fetchData()\n    }\n\n    onSelectAttendanceType(attendance_type) {\n        const { attendance } = this.props\n        switch (attendance_type) {\n            case 'present': {\n                this.setState({\n                    selected_student_ids: [...attendance.present]\n                })\n                return\n            }\n            \n            case 'absent': {\n                this.setState({\n                    selected_student_ids: [...attendance.absent]\n                })\n                return \n            }\n                \n            case 'unmarked': {\n                this.setState({\n                    selected_student_ids: [...attendance.unmarked]\n                })\n                return\n            }\n        }\n    }\n\n    fetchData() {\n        const date = formatDate(new Date())\n\n        const query = `https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance?date=${date}&class_id=${this.props.class.class_id}`\n        fetch(query, {\n            method: 'GET',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            }\n        }).then(res => res.json())\n        .then(resJson => {\n            for (var key in resJson) {\n                // {student_id}: [in_time, out_time, excuse_type]\n                if(resJson[key][0] !== null) {\n                    this.props.markPresent(key, resJson[key][0])\n                }\n                else if (resJson[key][2] !== null) {\n                    this.props.markAbsent(key, resJson[key][2])\n                }\n            }\n            this.setState({\n                selected_student_ids: [...this.props.attendance.unmarked]\n            })\n        })\n        .catch(err => console.log('err: ', err))\n    }\n\n    handleOnClick(student_id) {\n        this.props.showModal(student_id)\n    }\n\n    render() {\n        // TODO: on unmount, clear redux\n        // TODO: way to automatically update absent whenever parents send absense request\n        // TODO: what to display on homepage vs what to display in other pages after teachers\n        //          click into the attendance status(present, absent, or not yet)\n        // console.log(this.props.attendance)\n        // console.log(this.props.class.students)\n        return (\n            <Card style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n                <CardItem>\n                    <Text style={{ fontSize: 30 }}>出席狀況</Text>\n                </CardItem>\n\n                <View style={{ flex: 1, flexDirection: 'row' }}>\n                    <View style={{ flex: 1 }}>\n                        <View style={{ paddingLeft: 5, paddingTop: 5}}>\n                            <Text>出席</Text>\n                        </View>\n                        <TouchableHighlight\n                            style={{\n                                flex: 1,\n                                alignSelf: 'center',\n                                width: '70%',\n                                height: '70%',\n                                backgroundColor: '#dcf3d0'\n                            }}\n                            underlayColor='#00c07f'\n                            onPress={() => this.onSelectAttendanceType('present')}\n                        >\n                            <Text \n                                style={{ flex: 1, width: '100%', textAlign: 'center', fontSize: 60 }}\n                                adjustsFontSizeToFit={true}\n                            >\n                                {this.props.attendance.present.size}\n                            </Text>\n                        </TouchableHighlight>\n                    </View>\n                    <View style={{ flex: 1 }}>\n                        <View style={{ paddingLeft: 5, paddingTop: 5}}>\n                            <Text>缺席</Text>\n                        </View>\n                        <TouchableHighlight\n                            style={{\n                                flex: 1,\n                                alignSelf: 'center',\n                                width: '70%',\n                                height: '70%',\n                                backgroundColor: '#ffe1d0'\n                            }}\n                            underlayColor='#fa625f'\n                            onPress={() => this.onSelectAttendanceType('absent')}\n                        >\n                            <Text \n                                style={{ flex: 1, width: '100%', textAlign: 'center', fontSize: 60 }}\n                                adjustsFontSizeToFit={true}\n                            >\n                                {this.props.attendance.absent.size}\n                            </Text>\n                        </TouchableHighlight>\n                    </View>\n                    <View style={{ flex: 1 }}>\n                        <View style={{ paddingLeft: 5, paddingTop: 5}}>\n                            <Text>未知</Text>\n                        </View>\n                        <TouchableHighlight\n                            style={{\n                                flex: 1,\n                                alignSelf: 'center',\n                                width: '70%',\n                                height: '70%',\n                                backgroundColor: '#fff1b5'\n                            }}\n                            underlayColor='#f4d41f'\n                            onPress={() => this.onSelectAttendanceType('unmarked')}\n                        >\n                            <Text \n                                style={{ flex: 1, width: '100%', textAlign: 'center', fontSize: 60 }}\n                                adjustsFontSizeToFit={true}\n                            >\n                                {this.props.attendance.unmarked.size}\n                            </Text>\n                        </TouchableHighlight>\n                    </View>\n                </View>\n\n                <View style={{ flex: 1, flexDirection: 'row', flexWrap: 'wrap' }}>\n                    {this.state.selected_student_ids.map((student_id) => {\n                        const { present, unmarked, absent } = this.props.attendance\n                        return (\n                            <TouchableHighlight\n                                key={student_id}\n                                style={{ width: '31%', margin: '1%'}}\n                                underlayColor='transparent'\n                                onPress={() => this.handleOnClick(student_id)}\n                            >\n                                <View style={styles.cardContainer}>\n                                    <Card>\n                                        <CardItem style={{ justifyContent: 'center' }}>\n                                                <Image\n                                                    source={\n                                                        this.props.class.students[student_id].profile_picture === '' ?\n                                                            require('../../assets/icon-thumbnail.png')\n                                                            : {uri: this.props.class.students[student_id].profile_picture}\n                                                    }\n                                                    style={{\n                                                        height: 200,\n                                                        width: 200,\n                                                        borderRadius: 100,\n                                                        borderWidth: 10,\n                                                        borderColor:\n                                                            present.has(student_id) ? '#dcf3d0'\n                                                                : unmarked.has(student_id) ? '#fff1b5'\n                                                                    : '#ffe1d0'\n                                                    }}\n                                                />\n                                        </CardItem>\n                                        <CardItem\n                                            footer\n                                            style={{ justifyContent: 'center', marginTop: -5 }}\n                                        >\n                                            <Text style={{ marginTop: -10 }}>{this.props.class.students[student_id].name}</Text>\n                                        </CardItem>\n                                    </Card>\n                                </View>\n                            </TouchableHighlight>\n                        )\n                    })}\n                </View>\n            </Card>\n        )\n    }\n}\n\nconst styles = StyleSheet.create({\n    cardContainer: {\n        paddingVertical: 5\n    },\n    thumbnailImage: {\n        height: 80,\n        width: 80,\n        borderRadius: 40\n    }\n})\n\nconst mapStateToProps = (state) => {\n    return {\n        attendance: state.attendance,\n        class: state.classInfo\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        ...bindActionCreators({markAbsent, markPresent}, dispatch)\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps, null, { forwardRef: true }) (AttendanceCard)"]},"metadata":{},"sourceType":"module"}