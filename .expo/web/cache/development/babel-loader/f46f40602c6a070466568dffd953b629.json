{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/home/caleb_lee/gina_web_app/components/auth/signin.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { View, Text } from 'native-base';\nimport Auth from '@aws-amplify/auth';\nimport Reloading from \"../reloading\";\n\nvar Signin = function (_React$Component) {\n  _inherits(Signin, _React$Component);\n\n  var _super = _createSuper(Signin);\n\n  function Signin(props) {\n    var _this;\n\n    _classCallCheck(this, Signin);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      username: '',\n      password: '',\n      errMessage: '',\n      user_type: '',\n      isLoading: false\n    };\n    return _this;\n  }\n\n  _createClass(Signin, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {}\n  }, {\n    key: \"handleSignIn\",\n    value: function handleSignIn() {\n      var _this2 = this;\n\n      this.setState({\n        isLoading: true\n      });\n      var _this$state = this.state,\n          username = _this$state.username,\n          password = _this$state.password;\n      Auth.signIn(username, password).then(function (user) {\n        if (user.challengeName === 'NEW_PASSWORD_REQUIRED') {\n          _this2.completeNewPassword(user);\n\n          return;\n        }\n\n        _this2.setState({\n          isLoading: false\n        });\n\n        _this2.props.loadAuth();\n      }).catch(function (err) {\n        if (err.code === 'UserNotConfirmedException') {\n          _this2.props.changeAuthState('ConfirmSignUpPage', username);\n        } else {\n          _this2.props.changeAuthState('signedout', username);\n\n          _this2.setState({\n            errMessage: err.message,\n            isLoading: false\n          });\n        }\n      });\n    }\n  }, {\n    key: \"completeNewPassword\",\n    value: function completeNewPassword(user) {\n      var _this3 = this;\n\n      Auth.completeNewPassword(user, 'barRoco', {\n        name: 'barroco'\n      }).then(function (user) {\n        _this3.setState({\n          isLoading: false\n        });\n\n        _this3.props.loadAuth();\n      }).catch(function (err) {\n        _this3.setState({\n          errMessage: err.message,\n          isLoading: false\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var isLoading = this.state.isLoading;\n\n      if (isLoading) {\n        return React.createElement(Reloading, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 17\n          }\n        });\n      }\n\n      var keyboardVerticalOffset = Platform.OS === 'ios' ? 60 : 0;\n      var errMessage = this.state.errMessage ? React.createElement(Text, {\n        style: {\n          color: 'red'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 13\n        }\n      }, this.state.errMessage) : null;\n      return React.createElement(KeyboardAvoidingView, {\n        style: styles.container,\n        behavior: 'padding',\n        keyboardVerticalOffset: keyboardVerticalOffset,\n        enabled: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }\n      }, React.createElement(Image, {\n        source: require(\"../../assets/app_logo.png\"),\n        style: {\n          width: 200,\n          height: 200\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 17\n        }\n      }), React.createElement(Text, {\n        style: {\n          fontSize: 40\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 17\n        }\n      }, \"\\u8ACB\\u767B\\u5165\"), errMessage, React.createElement(TextInput, {\n        placeholder: \"Email / \\u5E33\\u865F\",\n        keyboardType: \"email-address\",\n        autoCapitalize: \"none\",\n        style: styles.textInput,\n        onChangeText: function onChangeText(username) {\n          return _this4.setState({\n            username: username\n          });\n        },\n        value: this.state.username,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 17\n        }\n      }), React.createElement(TextInput, {\n        secureTextEntry: true,\n        placeholder: \"\\u5BC6\\u78BC\",\n        style: styles.textInput,\n        onChangeText: function onChangeText(pass) {\n          return _this4.setState({\n            password: pass\n          });\n        },\n        value: this.state.password,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 17\n        }\n      }), React.createElement(View, {\n        style: {\n          marginTop: 20\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 17\n        }\n      }, React.createElement(TouchableHighlight, {\n        style: {\n          backgroundColor: 'grey',\n          padding: 20\n        },\n        onPress: function onPress() {\n          return _this4.handleSignIn();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 30\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 25\n        }\n      }, \"\\u767B\\u5165\"))));\n    }\n  }]);\n\n  return Signin;\n}(React.Component);\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  textInput: {\n    height: 80,\n    width: '90%',\n    borderColor: 'gray',\n    borderWidth: 1,\n    marginTop: 20,\n    fontSize: 30,\n    padding: 10\n  }\n});\nexport default Signin;","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/auth/signin.js"],"names":["React","View","Text","Auth","Reloading","Signin","props","state","username","password","errMessage","user_type","isLoading","setState","signIn","then","user","challengeName","completeNewPassword","loadAuth","catch","err","code","changeAuthState","message","name","keyboardVerticalOffset","Platform","OS","color","styles","container","require","width","height","fontSize","textInput","pass","marginTop","backgroundColor","padding","handleSignIn","Component","StyleSheet","create","flex","justifyContent","alignItems","borderColor","borderWidth"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { StyleSheet, TextInput, Platform, KeyboardAvoidingView, TouchableHighlight, Image } from 'react-native'\nimport { View, Text } from 'native-base'\nimport Auth from '@aws-amplify/auth'\nimport Reloading from '../reloading'\n\nclass Signin extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            username: '',\n            password: '',\n            errMessage: '',\n            user_type: '',\n            isLoading: false\n        }\n    }\n\n    componentDidMount() {\n        // this.props.clearState\n    }\n\n    handleSignIn() {\n        // invoke google auth with scopes, ask for school's authorization\n        // allow requests to googple photo api\n        this.setState({\n            isLoading: true\n        })\n        const { username, password } = this.state\n        Auth.signIn(username, password)\n            .then((user) => {\n                if (user.challengeName === 'NEW_PASSWORD_REQUIRED') {\n                    // const {requiredAttributes} = user.challengeParam\n                    this.completeNewPassword(user)\n                    return\n                }\n                this.setState({\n                    isLoading: false\n                })\n                this.props.loadAuth()\n            })\n            .catch((err) => {\n                if (err.code === 'UserNotConfirmedException') {\n                    this.props.changeAuthState('ConfirmSignUpPage', username)\n                } else {\n                    this.props.changeAuthState('signedout', username)\n                    this.setState({ \n                        errMessage: err.message,\n                        isLoading: false\n                    })\n                }\n            })\n    }\n\n    completeNewPassword(user) {\n        Auth.completeNewPassword(\n            user,\n            'barRoco',\n            { name: 'barroco' }\n        )\n        .then((user) => {\n            this.setState({\n                isLoading: false\n            })\n            this.props.loadAuth()\n        })\n        .catch((err) => {\n            this.setState({\n                errMessage: err.message,\n                isLoading: false\n            })\n        })\n    }\n\n    render () {\n        const { isLoading } = this.state\n        if (isLoading) {\n            return (\n                <Reloading />\n            )\n        }\n        const keyboardVerticalOffset = Platform.OS === 'ios' ? 60 : 0\n        const errMessage = this.state.errMessage ? (\n            <Text style={{ color: 'red'}}>\n                {this.state.errMessage}\n            </Text>\n        ) : (\n            null\n        )\n\n        return (\n            <KeyboardAvoidingView \n                style={styles.container} \n                behavior={'padding'}\n                keyboardVerticalOffset={keyboardVerticalOffset} \n                enabled\n            >\n                <Image\n                    source={require('../../assets/app_logo.png')}\n                    style={{\n                        width: 200,\n                        height: 200,\n                    }}\n                />\n\n                <Text style={{ fontSize: 40 }}>請登入</Text>\n                {errMessage}\n                <TextInput\n                    placeholder=\"Email / 帳號\"\n                    keyboardType=\"email-address\"\n                    autoCapitalize=\"none\"\n                    style={styles.textInput}\n                    onChangeText={(username) => this.setState({ username })}\n                    value={this.state.username}\n                />\n\n                <TextInput\n                    secureTextEntry\n                    placeholder=\"密碼\"\n                    style={styles.textInput}\n                    onChangeText={(pass) => this.setState({ password: pass })}\n                    value={this.state.password}\n                />\n\n                <View style={{ marginTop: 20 }}>\n                    <TouchableHighlight\n                        style={{ backgroundColor: 'grey', padding: 20 }}\n                        onPress={() => this.handleSignIn()}\n                    >\n                        <Text style={{ fontSize: 30 }}>登入</Text>\n                    </TouchableHighlight>\n                </View>\n                \n                {/*<View style={{ width: '90%', margin: 10, flexDirection: 'row', justifyContent: 'space-around' }}>\n                    <Button style={{ backgroundColor: '#35D0BA' }} onPress={() => this.handleSignIn('','')}>\n                        <Text>Sign in</Text>\n                    </Button>\n                    <Button style={{ backgroundColor: '#35D0BA' }} onPress={() => this.props.changeAuthState('SignupPage', '')}>\n                        <Text>No Account? Sign up here!</Text>\n                    </Button>\n                </View>\n                <Button style={{ backgroundColor: '#35D0BA' }} onPress={() => this.handleSignIn('abc123', 'password')}>\n                    <Text>我是家長</Text>\n                </Button>\n                <Button style={{ backgroundColor: '#35D0BA' }} onPress={() => this.handleSignIn('formosa', 'formosaADMIN')}>\n                    <Text>我是校方</Text>\n                </Button>*/}\n            </KeyboardAvoidingView>\n        )\n    }\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        justifyContent: 'center',\n        alignItems: 'center'\n    },\n    textInput: {\n        height: 80,\n        width: '90%',\n        borderColor: 'gray',\n        borderWidth: 1,\n        marginTop: 20,\n        fontSize: 30,\n        padding: 10\n    }\n})\n\n// const mapDispatchToProps = (dispatch) => {\n//     return {\n//         ...bindActionCreators({addUserType, clearState}, dispatch)\n//     }\n// }\n\n// function mapStateToProps(state) {\n//     return({\n//         user: state.user\n//     })\n// }\n\n// export default connect(mapStateToProps, mapDispatchToProps) (Signin)\nexport default Signin"]},"metadata":{},"sourceType":"module"}