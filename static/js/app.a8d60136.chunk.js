(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{1249:function(e,t,n){e.exports=n.p+"static/media/app-splash.ed2a7dfb.gif"},180:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsSAAALEgHS3X78AAACi0lEQVR42u3dsWsTYRjH8d97aRKJ6eDkIlXBScFFN3GzLnYNiBQjaSp0UJdi1+Cklg6KUi2xia0VJGPbRVcdHVx0ERRxcXIoSnqX3ONQERRbWk3Svtfv9w9ILve5e98ny51EREREREREtJtyvfqi1dHiMddWWaZBOR2StHeHnYtvMn1UoOcWB9VsrfY2EQBWKGSifG5KTmOSUp5cmG1J99N92XE3MxN5C2CFQibqzy1LOuPl+mB6kU5nz3UTIejm8Uf53JS3J3/t8hyMonDSyzvg55r/xqNlZ71aFsTHs9X5d17dAa7lRhNw8iWpz8Wpsn9LkLPB5AyLdtbHPWAgQeP6QR8B8gkC6PdyCiIAACAAACAAACAAACAAACAAACAAACAAACAAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACgt5lJS052WoFOSjavtUfOe1efZ8cbSvbMLHXzjxcsXGyODN8ILHVF0mVJe3z5QV17enpYKloHP25FUq0VtCZz1YXPG94a5fL+MG6NOdlVSfs6dQCZ2cduNwJ8MbkHmWx4x00//bqlNapU6o9cq+TMjZt0AICt9V7O7qXbwUNXrzf/a7NYe4vHeUkTko7uNICdtge8lnQ3vfJ9wTUaHdlUXaMRSpozaX515NJQYDYh6RSb8O8TzXIgu5WenXvZxc3O9Ki+KGkxLBdPKLZrkrugbX7JxHYuQetNND2rOTJ8ZLOTU5L2gE1PND27BTcxOSUB4J8nmp5BbDA5+QzQsYmmZxB/mZx8nIJexdLt7MDhJVepxD793f41OVUqT1Y/fRgKpOsiIiIiIiIiog70A/W73/uabAUFAAAAAElFTkSuQmCC"},236:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAB4UlEQVRo3u2YvUvDQBiHf++dGYuLoKJDB4sfuCnEDmprrX+0iikiqOAoOOioUKxLzeAHvTsXBZHY3CXvRcX7jcnl8jzJm+TNASEhISEhIZZJO/HKsBs3fM0/bDUX0k684nKMsB34uLe2RDCHUpvjdHdjmR2+GzekVD2CSdK99VXb48gWXih5BGD2fVPfkNipHZ5dscFrkwCYe990b6Tu1PYvLksLZMCDUyIDHi4SuSUUvUbPAF4yds2Q0UdlymkMPABo6AnFUkJPrY26kjoBUM/YXehO5MBbz0m2J+SU4IJ3EuCS4IR3FigrwQ1fSKCohA/4wgKuEr7gSwnYSmgyI1/wpQVyJQgDGGgA0z7gWQQs7gR8wbMJOEqw9lFsAh8SI6lPKLveYYAHkNjigndqp23yGplIGMhKrha3wMer0hBmxgybKtsAerkoOe95r8+B8ApvMADQ99GKswjkfmGF2FZKbgK49SVB3uA/txKt5oKUKgEw/ytaiSK9jS8JqgLepwRVBf9FosfV3Ikq4QFgsnd6owS1AdxxPNhUJfyP/NT7/BnhmDu3hGikxDfjSn9NJw/Or8eUk4AYSZ6lxfb6ohAi+ZNLixkSxAmfIRHZwjvH+/J6N264Lq+HhISEhPzvvAH4usfGrPqHIQAAAABJRU5ErkJggg=="},316:function(e,t){},328:function(e,t,n){e.exports=n.p+"static/media/icon-teacher-thumbnail.9b4e21e6.png"},334:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABqUlEQVRo3u2Zu1LDMBBF7zJ0JC215Zq/YgYGjKHkzSQhEEogWG7gq+jjPq1My1IkgUxwg61dO4PvB3jO0eqxkoE2bdq0+XOYySRubKyLqn6KaoFP8zGACAADiLPDblL2cxvq8DZ/nsMvBrBSJTbVR56wCksE7DS7AjP4p6WRX87rZNqJmiswmzaPAOIi+Gza2UePPhsrEKYfIxCOJeDFd6HQ5g8MPpWCF61AkOQjaXixXSiw+T2Bz6ThRabQHP5cA967gLHuDsCFFrzXNWBSN9SG91YBk7ohGJfa8F4EjHW3AK7qgK88hUziBnXCV6qASdwAhOs64UtXILSu3wT4UgJh4noM3DQB3nMrQfq3u7JrILSuX1wFesumW3uaVRBYxLoSlcreBAnBg0xHQriVkJfwtnPUJaHUTstJKF5oZCREDh9NCbHTM0jyEVHRvdivRE3PKv4kxPsXaQn5BmzxtFj4OlddQqeD/HncjX1L6LxOE3F20DkBUPAjg3fD7XwNfnDMJGIwXlYNwHhv9hT6PZ2+fzER42gSdS3WKswUWGeD1O2jTZs2/ztfAkobJARJpfUAAAAASUVORK5CYII="},335:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABwklEQVRo3u1ZQVLCQBDs4Rxz9UryBat8EQIJRakIeOUqImBhElT8kW9gveIR9sx4pYRAyiRbEyt93UrSne6ZnWyAEiVKFBqU9gZOuK6B6FKtrCYGtC2UACdc1wB6BVABsFDfVsO0iEpG5AGg5pzrOZipEAIIdLF3PePKifTMpIi/P4iZnEjPALQOrL4pz2qCiGUXsQARlXTyiZVntQEEB1br7lxP8o5TJb2H8SKYce1Geix6H0gSJwKmS//sVqYDSZwAbqrReizbgQROMPHky7M7sgWc7E48Vr59Jy9CibsTdZxgPZLtQBInmJ9Uy+7KFnA6TiPl2z15EUoep64T6qFsBxI5QY/Kt/oyHUjkBPfcSD/IFnBy7OC+G2wGsgXsfEwUo40eqoO5fgHD3zeHhkvPupddxDHk0xQxFZm8mRo4Sp5HacibGSXiyIsfJQyQz3ecjo9NpuM0mSQv/4PGMPlsu9CxTQqY5kE+OwdOkM/rRCIbB46OB3heelYHOYLy6zZmjhapyORTRciNdBhDPjBFPpUAZv4EsP3l57vyrLYp8qkEqJb9Aeb6joiFWpl785mhGm0a1XATmv61VKJEiX+CH053J36ap3UTAAAAAElFTkSuQmCC"},470:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsSAAALEgHS3X78AAACQUlEQVR42u1bbW7CMAx9TIhb7CKM/R87yI4y2BF2HWgvsgLHoPuTSihLGtv5aNP5SREsJHbixvZzYIBCoVAoFC5sAHwBuAHoK21XAEezFzaOFW/cbgeJAa5m8rbiU7x7OAlsDNarHaP7ePrvgU4NIJjzDqAjBJ4OwP5hXusY03g+bxLoy+Y7lMUM7cchz24Dzg99pwT6omOZbyJVoD0u9HdsMBatV2NAAhk+3+WejJ4oh6sveQwIbcA37sxkb7H6SC6wChjANcbu7z0y+4AOrnypvtF1pHCBxnrKuVFMX+os0FqL57pYlvWuCwbcreNJzrrWyEWExqK6K7jNjgjtjSLKYt4sfz2N6Ok9TFCqL5sBiparWg7PkAlKmVjI12PliJihxAB3z3tuFoAwn4/pfJnSN0P1PlVeK3yyxahwaDyE1JgqJ5a6Zw+CK4bRSsiZTRBcTBYIBUFuOcstb32xYnKCwq33OY3KIPsE+8jG0HLfAeqd4NRBkJq/Y+4AJbGiWBC8B8Y2Qga3Zcahaqo0btbQanAuMSD2uzpq/uZ+f9CmJmapr8So+ZvLEaLSYPLqSjBfGgOSGGC9IHdOfstMtWjLrP+lLpCbWUYfYeqRPAe4fujz6g2Q+oRSmWc2A/h+2TGFAWadBVx5OqavujTompeyr1g5fGHc7HQT1BIsSHjAB4BvAM+BcZ0ZO5anY/t2S6gGJz0hWg2qAfy4mdddxft7Na+in8sfsJx/mPiUGGBjjHCteOMXs/kNFAqFQqH4g1+9qDy6b2x6HAAAAABJRU5ErkJggg=="},476:function(e,t,n){e.exports=n.p+"static/media/app_logo.64014c13.png"},477:function(e,t,n){e.exports=n.p+"static/media/icon-checked.a824d7ff.png"},478:function(e,t,n){e.exports=n.p+"static/media/icon-plus.90bf87ac.png"},554:function(e,t,n){"use strict";n.d(t,"a",(function(){return oo}));var r=n(6),s=n.n(r),a=n(7),i=n.n(a),c=n(9),o=n.n(c),l=n(11),d=n.n(l),u=n(5),f=n.n(u),h=n(4),p=n.n(h),j=n(1),b=n.n(j),y=n(15),g=n.n(y),O=n(2),x=n(3),m=n(183),_=n(375),w=n(70),v=n(8),S=n.n(v),C=n(76),D=n(58),A=n(31),k=n(37);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E={class_id:"",passcodeTeacherId:{},teachers:{},students:{},isConnected:!1,errMessage:""};var R=n(17),I=n.n(R);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B={initialized:!1,present:new Set,absent:new Set,unmarked:new Set,attendance:{}};function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U={loaded:!1,fruit_name:"\u6c34\u679c",ratings:{},updatedStudents:new Set,err_message:"",data_dispatched:!0};function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G={by_student_id:{},records:{by_id:{},all_id:new Set},errorMessage:"",newDataForCreate:new Set,oldDataForEdit:new Set,records_with_error:new Set,data_dispatched:!0};function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X={by_student_id:{},records:{},record_id_for_update:new Set,errMessage:"",records_with_error:new Set,data_dispatched:!0};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $={loaded:!1,by_student_id:{},records:{by_id:{},all_id:new Set},newDataForCreate:new Set,oldDataForEdit:new Set,dataForRemoval:new Set,errMessage:"",data_dispatched:!0};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne={by_student_id:{},records:{by_id:{},all_id:[]},all_dispatched:!0,data_to_update:[],new_data_for_create:new Set,old_data_for_edit:new Set,err_message:"",data_dispatched:!0};function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?re(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae={message_by_student_id:{},for_all:{text:""},student_id_for_update:new Set,data_dispatched:!0,parent_messages:{}};function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe={isConnected:!0,classes:{},pick_up_request:[],admin_passcode:"",viewing_status:"",passcodeAdminId:{},passcodeTeacherId:{},teacherOnDuty:"",teachers:{},students:{},attendance:{},student_present:new Set,student_absent:new Set,student_unmarked:new Set,teacher_present:new Set,teacher_absent:new Set,teacher_unmarked:new Set};var le=Object(k.b)({classInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0,n=T({},e);switch(t.type){case"SET_CONNECT_STATE":var r=t.isConnected;return T(T({},e),{},{isConnected:r});case"INITIALIZE_CLASS":var s={},a={};return t.teacher_objs.forEach((function(t){s[t[0]]={name:t[1],passcode:t[2],logged_in:!1,in_time:"",out_time:""},e.passcodeTeacherId[t[2]]=t[0]})),t.students.forEach((function(e){var t=e.id,n=e.name,r=e.profile_picture,s=e.blood_type,i=e.address,c=e.home_phone,o=e.father_phone,l=e.mother_phone,d=e.conversation_id;a[t]={name:n,profile_picture:r,blood_type:s,address:i,home_phone:c,father_phone:o,mother_phone:l,conversation_id:d}})),T(T({},e),{},{passcodeTeacherId:e.passcodeTeacherId,teachers:s,students:a});case"SET_CLASS_ID":return T(T({},e),{},{class_id:t.class_id});case"FETCH_ATTENDANCE_SUCCESS":var i=t.data;return i.forEach((function(t){var r=t.attendance_id,s=t.teacher_id,a=t.in_time;n.teachers[s]=T(T({},e.teachers[s]),{},{logged_in:!0,attendance_id:r,in_time:a})})),n;case"MARK_TEACHER_LOGGED_IN":var c=t.teacher_id,o=t.time,l=t.attendance_id;return n.teachers[c]=T(T({},e.teachers[c]),{},{logged_in:!0,in_time:o,attendance_id:l}),n;case"MARK_TEACHER_LOGGED_OUT":var d=t.teacher_id,u=t.time;return n.teachers[d]=T(T({},e.teachers[d]),{},{logged_in:!1,out_time:u,attendance_id:""}),n;case"MARK_STAFF_ATTENDANCE_FAIL":var f=t.errMessage;return{errMessage:f};case"CLEAR_STATE":return{class_id:"",passcodeTeacherId:{},teachers:{},students:{},isConnected:!1,errMessage:""};default:return e}},attendance:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAKR_DISMISS":return L(L({},e),{},{attendance:L(L({},e.attendance),{},S()({},t.student_id,L(L({},e.attendance[t.student_id]),{},{present:!1,out_time:t.out_time})))});case"MARK_ABSENT":return e.unmarked.delete(t.student_id),L(L({},e),{},{absent:new Set([].concat(I()(e.absent),[t.student_id])),unmarked:e.unmarked,attendance:L(L({},e.attendance),{},S()({},t.student_id,L(L({},e.attendance[t.student_id]),{},{excuse_type:t.excuse_type})))});case"CLEAR_STATE":return{initialized:!1,present:new Set,absent:new Set,unmarked:new Set,attendance:{}};default:return e}},medicationrequests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{requests:{},unfinished:[],finished:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_REQUESTS":var n=t.requests,r=t.finished,s=t.unfinished;return F(F({},e),{},{requests:n,finished:r,unfinished:s});case"FILL_MED_REQUEST":var a=F({},e),i=e.unfinished,c=[];a.requests[t.request_id].administered=!0,a.finished=[].concat(I()(e.finished),[t.request_id]);for(var o=0;o<i.length;o++)i[o]!==t.request_id&&c.push(i[o]);return a.unfinished=c,a;case"CLEAR_STATE":return{requests:{},unfinished:[],finished:[]};default:return e}},appetite:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]={Breakfast:"0",Fruit:"0",Lunch:"0",Snack:"0",teacher_id:""}})),q(q({},e),{},{ratings:n});case"FETCH_CLASS_APPETITE_DATA":var r=t.fruit_name,s=t.ratings;return q(q({},e),{},{fruit_name:r,ratings:q(q({},e.ratings),s)});case"EDIT_FRUIT_NAME":var a=t.fruit_name;return q(q({},e),{},{fruit_name:a});case"RATE_APPETITE":var i,c=t.student_id,o=t.mealType,l=t.rating,d=t.teacher_id,u=e.updatedStudents,f=e.ratings[c][o].slice(-1);return""!==l&&(u=new Set([].concat(I()(e.updatedStudents),[c]))),q(q({},e),{},{ratings:q(q({},e.ratings),{},S()({},c,q(q({},e.ratings[c]),{},(i={},S()(i,o,l+f),S()(i,"teacher_id",d),i)))),updatedStudents:u,data_dispatched:!1});case"CLEAR_RATINGS":for(var h=t.meal_type,p=q({},e),j=Object.keys(e.ratings),b=new Set,y=0;y<j.length;y++){var g=j[y];"0"!==e.ratings[g][h]&&b.add(g),p.ratings[g]=q(q({},e.ratings[g]),{},S()({},h,"0"))}return p.updatedStudents=b,p.data_dispatched=!1,p;case"SET_ALL_RATINGS_TO_GREAT":var O=t.students_to_display,x=t.mealType,m=t.teacher_id,_=new Set(I()(e.updatedStudents)),w=q({},e.ratings);return O.map((function(t){var n;_.add(t);var r="1"===e.ratings[t][x].slice(-1);w[t]=q(q({},e.ratings[t]),{},(n={},S()(n,x,r?"\u80c3\u53e3\u4f731":"\u80c3\u53e3\u4f730"),S()(n,"teacher_id",m),n))})),q(q({},e),{},{ratings:w,updatedStudents:_,data_dispatched:!1});case"MARK_WATER_DRANK":var v,C=t.student_id,D=t.meal_type,A=t.teacher_id,k=new Set([].concat(I()(e.updatedStudents),[C])),P=e.ratings[C][D],T="1"===P.slice(-1);return q(q({},e),{},{ratings:q(q({},e.ratings),{},S()({},C,q(q({},e.ratings[C]),{},(v={},S()(v,D,T?P.slice(0,-1)+"0":P.slice(0,-1)+"1"),S()(v,"teacher_id",A),v)))),updatedStudents:k,data_dispatched:!1});case"SET_ALL_DRINK_WATER":var E=t.mealType,R=t.students_to_display,z=t.teacher_id,L=new Set(I()(R));w=q({},e.ratings);return R.forEach((function(t){var n,r=e.ratings[t][E].slice(0,-1);r+="1",w[t]=q(q({},e.ratings[t]),{},(n={},S()(n,E,r),S()(n,"teacher_id",z),n))})),q(q({},e),{},{ratings:w,updatedStudents:L,data_dispatched:!1});case"CLEAR_UPDATED_STUDENTS":return q(q({},e),{},{updatedStudents:new Set});case"ON_SEND_APPETITE_SUCCESS":return q(q({},e),{},{updatedStudents:new Set,data_dispatched:!0});case"ALERT_ERR_MESSAGE":var B=t.err_message;return q(q({},e),{},{err_message:B});case"CLEAR_ERR_MESSAGE":return q(q({},e),{},{err_message:""});case"ADD_STUDENT_ID_FOR_UPDATE":var M=t.student_id_array;return q(q({},e),{},{updatedStudents:new Set([].concat(I()(e.updatedStudents),I()(M))),data_dispatched:!1});case"CLEAR_STATE":return{loaded:!1,fruit_name:"\u6c34\u679c",ratings:{},updatedStudents:new Set,err_message:"",data_dispatched:!0};default:return e}},water:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{byId:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){n[e[0]]=[]})),{byId:n};case"ADD_WATER_RECORD":return e.byId[t.student_id].includes(t.time)||e.byId[t.student_id].push(t.time),V({},e);default:return e}},sleep:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]=[]})),K(K({},e),{},{by_student_id:n});case"FETCH_CLASS_SLEEP_DATA":var r=t.sleepData,s=r.by_student_id,a=r.records;return K(K({},e),{},{by_student_id:K({},s),records:{by_id:K({},a.by_id),all_id:new Set(I()(a.all_id))}});case"SET_SLEEP_TIME":var i=K({},e),c=t.student_id,o=t.index,l=t.sleep_time,d=t.teacher_id,u=i.by_student_id[c],f=u[o],h=i.records.by_id;if(l.setSeconds(0,0),null!==o){if(o>0&&l<=h[u[o-1]].sleep_time){for(var p=i.by_student_id[c],j=p.splice(o,1),b=0,y=0;y<p.length-1;y++)if(h[p[y]].sleep_time>l){b=y;break}p.splice(b,0,j[0]),i.by_student_id[c]=p}i.records.by_id[f].sleep_time=l,i.records.by_id[f].teacher_id=d,i.newDataForCreate.has(f)||i.oldDataForEdit.add(f)}else{var g=i.records.all_id.size;i.by_student_id[c].push(g),i.records.by_id[g]={student_id:c,sleep_time:l,wake_time:null,teacher_id:d},i.records.all_id.add(g),i.errorMessage="",i.newDataForCreate.add(g)}return i.data_dispatched=!1,i;case"SET_WAKE_TIME":var O=K({},e),x=t.student_id,m=t.index,_=t.wake_time,w=t.teacher_id,v=O.by_student_id[x][m];return _.setSeconds(0,0),O.records.by_id[v].wake_time=_,O.records.by_id[v].teacher_id=w,O.errorMessage="",O.newDataForCreate.has(v)||O.oldDataForEdit.add(v),O.data_dispatched=!1,O;case"REMOVE_WAKE_TIME":var C=t.record_id,D=t.teacher_id,A=K({},e),k=new Set(I()(e.records_with_error));return k.delete(C),A.records_with_error=k,A.records.by_id[C].wake_time=null,A.records.by_id[C].teacher_id=D,A.newDataForCreate.has(C)||A.oldDataForEdit.add(C),A.data_dispatched=!1,A;case"CREATE_SLEEP_RECORD_SUCCESS":return K(K({},e),{},{newDataForCreate:new Set,data_dispatched:!0});case"CREATE_SLEEP_RECORD_FAIL":return K(K({},e),{},{errorMessage:t.errMessage});case"EDIT_SLEEP_RECORD_SUCCESS":return K(K({},e),{},{oldDataForEdit:new Set,data_dispatched:!0});case"EDIT_SLEEP_RECORD_FAIL":return K(K({},e),{},{errorMessage:t.errMessage});case"REMOVE_RECORD_SUCCESS":var P=t.record_id,T=t.student_id,E=e.by_student_id[T],R=E.findIndex((function(e){return e===P})),z=new Set(I()(e.newDataForCreate));z.delete(P);var L=new Set(I()(e.oldDataForEdit));return L.delete(P),K(K({},e),{},{by_student_id:K(K({},e.by_student_id),{},S()({},T,[].concat(I()(E.slice(0,R)),I()(E.slice(R+1))))),newDataForCreate:z,oldDataForEdit:L,data_dispatched:z.size+L.size===0});case"REMOVE_RECORD_FAIL":return K(K({},e),{},{errorMessage:t.errorMessage});case"MARK_RECORD_ERROR":var B=t.record_id_array;return K(K({},e),{},{records_with_error:new Set([].concat(I()(e.records_with_error),I()(B)))});case"MARK_RECORD_CORRECT":var M=t.record_id,F=new Set(I()(e.records_with_error));return F.delete(M),K(K({},e),{},{records_with_error:F});case"ALERT_SLEEPLOG_ERROR_MESSAGE":var N=t.err_message;return K(K({},e),{},{errorMessage:N});case"CLEAR_SLEEPLOG_ERROR_MESSAGE":return K(K({},e),{},{errorMessage:""});case"CLEAR_STATE":return{by_student_id:{},records:{by_id:{},all_id:new Set},errorMessage:"",newDataForCreate:new Set,oldDataForEdit:new Set,records_with_error:new Set,data_dispatched:!0};default:return e}},healthstatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_STUDENT_WELLNESS":var n={},r={},s=0;return t.students.forEach((function(e){n[e]=[s,s+1],r[s]={temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""},r[s+1]={temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""},s+=2})),J(J({},e),{},{by_student_id:n,records:r});case"FETCH_CLASS_WELLNESS_DATA":for(var a=t.wellnessData,i=a.by_student_id,c=a.records,o=Object.keys(i),l=0;l<o.length;l++){var d=o[l],u=i[d];1===u.length&&(u.push(e.by_student_id[d][1]),i[d]=u)}return J(J({},e),{},{by_student_id:J(J({},e.by_student_id),i),records:J(J({},e.records),c)});case"ADD_RECORD":var f=e.by_student_id,h=e.records,p=t.student_id,j=Object.keys(e.records).length;return J(J({},e),{},{by_student_id:J(J({},f),{},S()({},p,[].concat(I()(f[p]),[j]))),records:J(J({},h),{},S()({},j,{temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""}))});case"ADD_HEALTH_STATUS":var b=t.student_id,y=t.record_id,g=t.status,O=t.teacher_id,x=new Set([].concat(I()(e.record_id_for_update),[y])),m=J(J({},e.records),{},S()({},y,J(J({},e.records[y]),{},{student_id:b,status:g,time:new Date,teacher_id:O})));return J(J({},e),{},{records:m,record_id_for_update:x,data_dispatched:!1});case"ADD_TEMPERATURE":var _=t.student_id,w=t.record_id,v=t.temperature,C=t.teacher_id,D=new Set([].concat(I()(e.record_id_for_update),[w])),A=J(J({},e.records),{},S()({},w,J(J({},e.records[w]),{},{student_id:_,temperature:v,time:new Date,teacher_id:C})));return J(J({},e),{},{records:A,record_id_for_update:D,data_dispatched:!1});case"INVALIDATE_WELLNESS_DATA":var k=t.record_id;t.errMessage;return J(J({},e),{},{records_with_error:new Set([].concat(I()(e.records_with_error),[k]))});case"SEND_WELLNESS_DATA_SUCCESS":return J(J({},e),{},{record_id_for_update:new Set,data_dispatched:!0});case"SEND_DATA_FAIL":return J(J({},e),{},{errMessage:t.errMessage});default:return e}},milk:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]=[]})),Z(Z({},e),{},{by_student_id:n});case"FETCH_CLASS_MILK_DATA":var r=t.milkData,s=r.by_student_id,a=r.records;return Z(Z({},e),{},{by_student_id:Z({},s),records:{by_id:Z({},a.by_id),all_id:new Set(I()(a.all_id))}});case"FETCH_CLASS_MILK_DATA_SUCCESS":case"ADD_MILK_RECORD":var i=Z({},e),c=t.student_id,o=e.newDataForCreate.size;return i.records.by_id[o]={student_id:c,time:new Date,amount:"",milk_type:"\u914d\u65b9\u5976",teacher_id:""},i.by_student_id[c].push(o),i.newDataForCreate.add(o),i.data_dispatched=!1,i;case"EDIT_MILK_AMOUNT":var l=Z({},e),d=t.record_id,u=t.milk_amount,f=t.teacher_id;return l.records.by_id[d].amount=u,l.records.by_id[d].teacher_id=f,l.newDataForCreate.has(d)||l.oldDataForEdit.add(d),l.data_dispatched=!1,l;case"EDIT_MILK_TYPE":var h=Z({},e),p=t.record_id,j=t.teacher_id,b=e.records.by_id[p].milk_type;return h.records.by_id[p].milk_type="\u914d\u65b9\u5976"===b?"\u6bcd\u5976":"\u914d\u65b9\u5976",h.records.by_id[p].teacher_id=j,h.newDataForCreate.has(p)||h.oldDataForEdit.add(p),h.data_dispatched=!1,h;case"EDIT_MILK_TIME":var y=Z({},e),g=t.record_id,O=t.date_time,x=t.teacher_id;return y.records.by_id[g].time=O,y.records.by_id[g].teacher_id=x,y.newDataForCreate.has(g)||y.oldDataForEdit.add(g),y.data_dispatched=!1,y;case"CREATE_DATA_SUCCESS":return Z(Z({},e),{},{newDataForCreate:new Set,data_dispatched:0===e.oldDataForEdit.size});case"CREATE_DATA_FAIL":return Z(Z({},e),{},{errMessage:t.errMessage});case"EDIT_DATA_SUCCESS":return Z(Z({},e),{},{oldDataForEdit:new Set,data_dispatched:0===e.newDataForCreate.size});case"EDIT_DATA_FAIL":return Z(Z({},e),{},{errMessage:t.errMessage});case"REMOVE_RECORD":var m=t.student_id,_=t.record_id,w=Z({},e),v=e.by_student_id[m].indexOf(_);return v>-1&&w.by_student_id[m].splice(v,1),w.oldDataForEdit.has(_)&&w.oldDataForEdit.delete(_),w.newDataForCreate.has(_)?w.newDataForCreate.delete(_):w.dataForRemoval.add(_),w.data_dispatched=w.newDataForCreate.size+w.oldDataForEdit.size===0,w;case"REMOVE_MILK_RECORD_SUCCESS":return Z(Z({},e),{},{dataForRemoval:new Set,data_dispatched:e.newDataForCreate.size+e.oldDataForEdit.size===0});case"REMOVE_MILK_RECORD_FAIL":return Z(Z({},e),{},{errMessage:"Error occured while removing milk record, please try again"});case"CLEAR_STATE":return{loaded:!1,by_student_id:{},records:{by_id:{},all_id:new Set},newDataForCreate:new Set,oldDataForEdit:new Set,dataForRemoval:new Set,errMessage:"",data_dispatched:!0};default:return e}},diaper:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]={amount:"",records:[]}})),te(te({},e),{},{by_student_id:n});case"FETCH_CLASS_DIAPER_DATA":return te(te({},e),t.diaperData);case"ADD_DIAPER_RECORD":var r=t.student_id,s=t.time,a=t.cloth_diaper,i=t.teacher_id,c=te({},e),o=c.records.all_id.length;return c.by_student_id[r].records.push(o),a||(c.by_student_id[r].amount-=1),c.records.by_id[o]={student_id:r,time:s,cloth_diaper:a,pee_or_poo:"\u5c0f\u4fbf",condition:a?"\u6709\u6fd5":"",teacher_id:i},c.records.all_id.push(o),c.all_dispatched=!1,c.new_data_for_create.add(o),c.data_dispatched=!1,c;case"EDIT_DIAPER_TIME":var l=t.record_id,d=t.time,u=t.teacher_id,f=e.new_data_for_create,h=te({},e);return h.records.by_id[l].time=d,h.records.by_id[l].teacher_id=u,f.has(l)||h.old_data_for_edit.add(l),h.data_dispatched=!1,h;case"SWITCH_PEE_OR_POO":var p=t.record_id,j=t.teacher_id,b=e.new_data_for_create,y=te({},e),g=y.records.by_id[p].pee_or_poo,O=y.records.by_id[p].cloth_diaper;return y.records.by_id[p].pee_or_poo="\u5c0f\u4fbf"===g?"\u5927\u4fbf":"\u5927\u4fbf"===g?"\u6d17\u6fa1":"\u5c0f\u4fbf",y.records.by_id[p].teacher_id=j,y.records.by_id[p].condition="\u5c0f\u4fbf"===g?"\u6b63\u5e38":("\u5927\u4fbf"!==g||O)&&"\u6d17\u6fa1"===g&&O?"\u6709\u6fd5":"",b.has(p)||y.old_data_for_edit.add(p),y.data_dispatched=!1,y;case"EDIT_CLOTH_DIAPER_CONDITION":var x=t.record_id,m=t.teacher_id,_=te({},e),w=e.records.by_id[x].condition;return _.records.by_id[x].condition="\u6709\u6fd5"===w?"\u6210\u529f":"\u6709\u6fd5",_.records.by_id[x].teacher_id=m,e.new_data_for_create.has(x)||_.old_data_for_edit.add(x),_.data_dispatched=!1,_;case"EDIT_DIAPER_PEE_CONDITION":var v=t.record_id,S=t.teacher_id,C=t.student_id,D=te({},e),A=e.records.by_id[v].condition;return""===A?(D.records.by_id[v].condition="\u6aa2\u67e5",D.by_student_id[C].amount+=1):(D.records.by_id[v].condition="",D.by_student_id[C].amount-=1),D.records.by_id[v].teacher_id=S,e.new_data_for_create.has(v)||D.old_data_for_edit.add(v),D.data_dispatched=!1,D;case"EDIT_POO_CONDITION":var k=t.record_id,P=t.condition,T=t.teacher_id,E=e.new_data_for_create,R=te({},e);return R.records.by_id[k].condition=P,R.records.by_id[k].teacher_id=T,E.has(k)||R.old_data_for_edit.add(k),R.data_dispatched=!1,R;case"EDIT_SHOWER_CONDITION":var z=t.record_id,L=te({},e),B=e.records.by_id[z].condition;return L.records.by_id[z].condition=""===B?"\u5927\u4fbf":"",e.new_data_for_create.has(z)||L.old_data_for_edit.add(z),L.data_dispatched=!1,L;case"REMOVE_DIAPER_RECORD_SUCCESS":var M=t.student_id,F=t.record_id,N=te({},e),q=[],U=e.by_student_id[M].records,H=e.records.by_id[F];H.cloth_diaper||"\u5c0f\u4fbf"===H.pee_or_poo&&"\u6aa2\u67e5"===H.condition||(N.by_student_id[M].amount+=1);for(var V=0;V<U.length;V++)U[V]!==F&&q.push(U[V]);N.by_student_id[M].records=q;var W=new Set(I()(e.new_data_for_create));W.delete(F),N.new_data_for_create=W;var K=new Set(I()(e.old_data_for_edit));return K.delete(F),N.old_data_for_edit=K,N.data_dispatched=W.size+K.size===0,N;case"REMOVE_DIAPER_RECORD_FAIL":var G=t.err_message;return te(te({},e),{},{err_message:G});case"CREATE_DIAPER_RECORD_SUCCESS":return te(te({},e),{},{new_data_for_create:new Set,old_data_for_edit:new Set,data_dispatched:!0});case"CREATE_DIAPER_RECORD_FAIL":var Q=t.err_message;return te(te({},e),{},{err_message:Q});case"EDIT_DIAPER_RECORD_SUCCESS":return te(te({},e),{},{old_data_for_edit:new Set});case"EDIT_DIAPER_RECORD_FAIL":var J=t.err_message;return te(te({},e),{},{err_message:J});case"EDIT_DIAPER_AMOUNT_SUCCESS":return te(te({},e),{},{students_pending_amount_update:new Set,data_dispatched:e.new_data_for_create.size+e.old_data_for_edit.size===0});case"EDIT_DIAPER_AMOUNT_FAIL":var X=t.err_message;return te(te({},e),{},{err_message:X});case"CLEAR_ERR_MESSAGE":return te(te({},e),{},{err_message:""});case"CLEAR_STATE":return{by_student_id:{},records:{by_id:{},all_id:[]},all_dispatched:!0,data_to_update:[],new_data_for_create:new Set,old_data_for_edit:new Set,err_message:"",data_dispatched:!0};default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]={text:"",things_to_bring:[0,0,0,0,0],other_item:"\u5176\u5b83",activities:[0,0,0,0,0,0,0,0,0],other_activity:"\u5176\u5b83",teacher_id:""}})),se(se({},e),{},{message_by_student_id:n});case"FETCH_CLASS_MESSAGE_DATA":var r=t.message_data;return se(se({},e),{},{message_by_student_id:se(se({},e.message_by_student_id),r),for_all:{text:""}});case"WRITE_TO_ALL":var s=t.text,a=t.teacher_id,i=se({},e.message_by_student_id);return Object.keys(i).forEach((function(e){i[e].teacher_id=a})),se(se({},e),{},{for_all:se(se({},e.for_all),{},{text:s}),message_by_student_id:i,student_id_for_update:new Set(Object.keys(e.message_by_student_id)),data_dispatched:!1});case"WRITE_TO_ONE":var c=t.text,o=t.student_id,l=t.teacher_id,d=new Set([].concat(I()(e.student_id_for_update),[o]));return se(se({},e),{},{message_by_student_id:se(se({},e.message_by_student_id),{},S()({},o,se(se({},e.message_by_student_id[o]),{},{text:c,teacher_id:l}))),student_id_for_update:d,data_dispatched:!1});case"REMIND_ITEMS_TO_BRING_TO_ALL":var u=t.items_to_bring_bool,f=t.teacher_id,h=se({},e.message_by_student_id);return Object.keys(h).forEach((function(e){h[e].things_to_bring=u,h[e].teacher_id=f})),se(se({},e),{},{message_by_student_id:h,student_id_for_update:new Set(Object.keys(h)),data_dispatched:!1});case"REMIND_ITEMS_TO_BRING_TO_ONE":var p=t.student_id,j=t.things_to_bring,b=t.teacher_id,y=se({},e.message_by_student_id);return y[p].things_to_bring=j,y[p].teacher_id=b,se(se({},e),{},{message_by_student_id:y,student_id_for_update:new Set([].concat(I()(e.student_id_for_update),[p])),data_dispatched:!1});case"WRITE_ITEM_TO_BRING_TO_ALL":var g=t.item_to_bring,O=t.teacher_id,x=se({},e.message_by_student_id);return Object.keys(x).forEach((function(e){x[e].other_item=""===g?"\u5176\u5b83":g,x[e].teacher_id=O})),se(se({},e),{},{message_by_student_id:x,student_id_for_update:new Set(Object.keys(x)),data_dispatched:!1});case"WRITE_ITEM_TO_BRING_TO_ONE":var m=t.student_id,_=t.item_to_bring,w=t.teacher_id;return se(se({},e),{},{message_by_student_id:se(se({},e.message_by_student_id),{},S()({},m,se(se({},e.message_by_student_id[m]),{},{other_item:_,teacher_id:w}))),student_id_for_update:new Set([].concat(I()(e.student_id_for_update),[m])),data_dispatched:!1});case"RECORD_ACTIVITIES_FOR_ALL":var v=t.new_acitivities_bool,C=t.teacher_id,D=se({},e.message_by_student_id);return Object.keys(D).forEach((function(e){D[e].activities=v,D[e].teacher_id=C})),se(se({},e),{},{message_by_student_id:D,student_id_for_update:new Set(Object.keys(D)),data_dispatched:!1});case"RECORD_ACTIVITIES_FOR_ONE":var A=t.student_id,k=t.activities,P=t.teacher_id,T=se({},e.message_by_student_id);return T[A].activities=k,T[A].teacher_id=P,se(se({},e),{},{message_by_student_id:T,student_id_for_update:new Set([].concat(I()(e.student_id_for_update),[A])),data_dispatched:!1});case"WRITE_ACTIVITY_FOR_ALL":var E=t.activity,R=t.teacher_id,z=se({},e.message_by_student_id);return Object.keys(z).forEach((function(e){z[e].other_activity=""===E?"\u5176\u5b83":E,z[e].teacher_id=R})),se(se({},e),{},{message_by_student_id:z,student_id_for_update:new Set(Object.keys(z)),data_dispatched:!1});case"WRITE_ACTIVITY_FOR_ONE":var L=t.student_id,B=t.activity,M=t.teacher_id;return se(se({},e),{},{message_by_student_id:se(se({},e.message_by_student_id),{},S()({},L,se(se({},e.message_by_student_id[L]),{},{other_activity:B,teacher_id:M}))),student_id_for_update:new Set([].concat(I()(e.student_id_for_update),[L])),data_dispatched:!1});case"SEND_MESSAGE_ON_SUCCESS":return se(se({},e),{},{student_id_for_update:new Set,data_dispatched:!0});case"GET_PARENT_MESSAGE_SUCCESS":var F=t.messages;return se(se({},e),{},{parent_messages:F});case"CLEAR_STATE":return{message_by_student_id:{},student_id_for_update:new Set,for_all:{text:""},data_dispatched:!0,parent_messages:{}};default:return e}},school:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONNECT_STATE":var n=t.isConnected;return ce(ce({},e),{},{isConnected:n});case"FETCH_CLASSES_SUCCESS":var r=t.classes,s=t.admin_passcode;return ce(ce({},e),{},{classes:r,admin_passcode:s});case"FETCH_TEACHERS_SUCCESS":var a=t.admins,i=t.teachers,c=t.classes,o=ce({},e.classes),l=e.passcodeAdminId,d=e.passcodeTeacherId;return Object.keys(c).forEach((function(e){o[e].teachers=c[e].teachers})),Object.keys(a).forEach((function(e){l[a[e].passcode]=e})),Object.keys(i).forEach((function(e){d[i[e].passcode]=e})),ce(ce({},e),{},{passcodeAdminId:l,passcodeTeacherId:d,teachers:ce(ce({},i),a),classes:o,teacher_unmarked:new Set(Object.keys(i))});case"FETCH_STUDENTS_SUCCESS":var u=t.students,f=t.classes,h=ce({},e.classes);return Object.keys(f).forEach((function(e){h[e].students=f[e].students})),ce(ce({},e),{},{students:u,classes:h,student_unmarked:new Set(Object.keys(u))});case"FETCH_TEACHER_ATTENDANCE_SUCCESS":var p=t.attendance,j=t.teachers,b=ce({},e.teachers),y=new Set(Object.keys(e.teachers)),g=new Set,O=new Set;return Object.keys(j).forEach((function(e){b[e].attendance=j[e].attendance_array,b[e].present=j[e].present,b[e].total_minutes=j[e].total_minutes,j[e].present?g.add(e):O.add(e),y.delete(e)})),ce(ce({},e),{},{teachers:b,attendance:ce(ce({},e.attendance),p),teacher_present:g,teacher_absent:O,teacher_unmarked:y});case"FETCH_STUDENT_ATTENDANCE_SUCCESS":var x=t.attendance,m=t.students,_=t.present,w=t.absent,v=ce({},e.students),S=new Set(Object.keys(e.students));return Object.keys(m).forEach((function(e){v[e].attendance_id=m[e],(_.includes(e)||w.includes(e))&&S.delete(e)})),ce(ce({},e),{},{students:v,attendance:ce(ce({},e.attendance),x),student_present:new Set(I()(_)),student_absent:new Set(I()(w)),student_unmarked:S});case"EDIT_TEACHER_ON_DUTY":var C=t.teacher_id;return ce(ce({},e),{},{teacherOnDuty:C});case"ADD_PICKUP_REQUEST":var D=t.requests;return ce(ce({},e),{},{pick_up_request:D});case"UPDATE_VIEWING_STATUS":var A=t.status;return ce(ce({},e),{},{viewing_status:A});case"UPDATE_PROFILE_PICTURE":var k=t.student_id,P=t.uri,T=ce({},e.students);return T[k].profile_picture=P,ce(ce({},e),{},{students:T});case"EDIT_STUDENT_SUCCESS":var E=t.student_id,R=t.name,z=t.old_class_id,L=t.new_class_id,B=ce({},e.students),M=ce({},e.classes);B[E].name=R,B[E].class_id=L;for(var F=M[z].students,N=[],q=0;q<F.length;q++)F[q]!==E&&N.push(E);return M[z].students=N,(F=M[L].students).push(E),M[L].students=F,ce(ce({},e),{},{students:B,classes:M});case"UPDATE_TEACHER_PROFILE_PICTURE":var U=t.teacher_id,H=t.image_url,V=ce({},e.teachers);return V[U].profile_picture=H,ce(ce({},e),{},{teachers:V});case"CLEAR_STATE":return ce(ce({},e),{},{viewing_status:""});case"CLEAR_SCHOOL_STATE":return{isConnected:!1,classes:{},pick_up_request:[],passcodeAdminId:{},passcodeTeacherId:{},teacherOnDuty:"",teachers:{},students:{},attendance:{},student_present:new Set,student_absent:new Set,student_unmarked:new Set,teacher_present:new Set,teacher_absent:new Set,teacher_unmarked:new Set};default:return e}}}),de=n(16),ue=n.n(de),fe=n(14),he=n(18),pe=n(34),je=n(12),be=n(22),ye=function(e,t){return{type:"INITIALIZE_CLASS",teacher_objs:e,students:t}},ge=function(e,t,n,r){return{type:"RATE_APPETITE",student_id:e,mealType:t,rating:n,teacher_id:r}},Oe=function(e,t){return{type:"MARK_PRESENT",student_id:e,in_time:t}},xe=function(e,t){return{type:"MARK_ABSENT",student_id:e,excuse_type:t}},me=function(e,t,n){return{type:"INITIALIZE_REQUESTS",requests:e,finished:t,unfinished:n}},_e=function(e){return{type:"FILL_MED_REQUEST",request_id:e}},we=function(e){return{type:"FETCH_ATTENDANCE_SUCCESS",data:e}},ve=function(e,t,n){return{type:"MARK_TEACHER_LOGGED_IN",teacher_id:e,time:t,attendance_id:n}},Se=function(e,t){return{type:"MARK_TEACHER_LOGGED_OUT",teacher_id:e,time:t}},Ce=function(e){return{type:"CLEAR_RATINGS",meal_type:e}},De=function(e,t,n){return{type:"SET_ALL_RATINGS_TO_GREAT",mealType:e,students_to_display:t,teacher_id:n}},Ae=function(e,t,n){return{type:"SET_ALL_DRINK_WATER",mealType:e,students_to_display:t,teacher_id:n}},ke=function(e){return{type:"ADD_RECORD",student_id:e}},Pe=function(e,t,n,r){return{type:"ADD_HEALTH_STATUS",student_id:e,record_id:t,status:n,teacher_id:r}},Te=function(e,t,n,r){return{type:"ADD_TEMPERATURE",student_id:e,record_id:t,temperature:n,teacher_id:r}},Ee=function(){return{type:"SEND_WELLNESS_DATA_SUCCESS"}},Re=function(e){return{type:"SEND_DATA_FAIL",errMessage:e}},Ie=function(e,t){return{type:"INVALIDATE_WELLNESS_DATA",record_id:e,errMessage:t}},ze=function(e,t,n,r){return{type:"SET_SLEEP_TIME",student_id:e,index:t,sleep_time:n,teacher_id:r}},Le=function(e,t){return{type:"REMOVE_RECORD",record_id:e,student_id:t}},Be=function(e,t){return{type:"REMOVE_RECORD_SUCCESS",record_id:e,student_id:t}},Me=function(e){return{type:"REMOVE_RECORD_FAIL",errorMessage:e}},Fe=function(e,t,n,r){return{type:"SET_WAKE_TIME",student_id:e,index:t,wake_time:n,teacher_id:r}},Ne=function(e,t){return{type:"REMOVE_WAKE_TIME",record_id:e,teacher_id:t}},qe=function(e,t,n){return{type:"EDIT_MILK_AMOUNT",record_id:e,milk_amount:t,teacher_id:n}},Ue=function(e,t,n){return{type:"EDIT_MILK_TIME",record_id:e,date_time:t,teacher_id:n}},He=function(e,t){return{type:"UPDATE_DIAPER_AMOUNT",student_id:e,amount:t}},Ve=function(e,t,n,r){return{type:"ADD_DIAPER_RECORD",student_id:e,time:t,cloth_diaper:n,teacher_id:r}},We=function(e,t,n){return{type:"EDIT_DIAPER_TIME",record_id:e,time:t,teacher_id:n}},Ke=function(e,t){return{type:"SWITCH_PEE_OR_POO",record_id:e,teacher_id:t}},Ge=function(e,t,n){return{type:"EDIT_POO_CONDITION",record_id:e,condition:t,teacher_id:n}},Qe=function(e,t){return{type:"REMOVE_DIAPER_RECORD_SUCCESS",student_id:e,record_id:t}},Je=function(e){return{type:"REMOVE_DIAPER_RECORD_FAIL",err_message:e}},Xe=function(){return{type:"CLEAR_ERR_MESSAGE"}},Ye=function(e){return{type:"ADD_MILK_RECORD",student_id:e}},Ze=function(e,t){return{type:"FETCH_CLASS_APPETITE_DATA",fruit_name:e,ratings:t}},$e=function(e){return{type:"FETCH_CLASS_WELLNESS_DATA",wellnessData:e}},et=function(e){return{type:"FETCH_CLASS_SLEEP_DATA",sleepData:e}},tt=function(){return{type:"CLEAR_PENDNING_SLEEP_UPDATE"}},nt=function(e){return{type:"FETCH_CLASS_MILK_DATA",milkData:e}},rt=function(){return{type:"CREATE_DATA_SUCCESS"}},st=function(e){return{type:"CREATE_DATA_FAIL",errMessage:e}},at=function(){return{type:"EDIT_DATA_SUCCESS"}},it=function(e){return{type:"EDIT_DATA_FAIL",errMessage:e}},ct=function(){return{type:"REMOVE_MILK_RECORD_SUCCESS"}},ot=function(){return{type:"REMOVE_MILK_RECORD_FAIL"}},lt=function(){return{type:"CREATE_SLEEP_RECORD_SUCCESS"}},dt=function(e){return{type:"CREATE_SLEEP_RECORD_FAIL",errMessage:e}},ut=function(){return{type:"EDIT_SLEEP_RECORD_SUCCESS"}},ft=function(e){return{type:"EDIT_SLEEP_RECORD_FAIL",errMessage:e}},ht=function(e){return{type:"FETCH_CLASS_DIAPER_DATA",diaperData:e}},pt=function(){return{type:"CREATE_DIAPER_RECORD_SUCCESS"}},jt=function(e){return{type:"CREATE_DIAPER_RECORD_FAIL",errMessage:e}},bt=function(){return{type:"EDIT_DIAPER_RECORD_SUCCESS"}},yt=function(e){return{type:"EDIT_DIAPER_RECORD_FAIL",errMessage:e}},gt=function(){return{type:"EDIT_DIAPER_AMOUNT_SUCCESS"}},Ot=function(e){return{type:"EDIT_DIAPER_AMOUNT_FAIL",errMessage:e}},xt=function(e,t,n){return{type:"REMOVE_RECORD",student_id:e,record_id:t,index:n}},mt=function(){return{type:"CLEAR_STATE"}},_t=function(e){return{type:"SET_CLASS_ID",class_id:e}},wt=function(){return{type:"ON_SEND_APPETITE_SUCCESS"}},vt=function(e){return{type:"ALERT_ERR_MESSAGE",err_message:e}},St=function(){return{type:"CLEAR_ERR_MESSAGE"}},Ct=function(e){return{type:"ADD_STUDENT_ID_FOR_UPDATE",student_id_array:e}},Dt=function(e,t,n){return{type:"MARK_WATER_DRANK",student_id:e,meal_type:t,teacher_id:n}},At=function(e){return{type:"MARK_STAFF_ATTENDANCE_FAIL",errMessage:e}},kt=function(e,t){return{type:"WRITE_TO_ALL",text:e,teacher_id:t}},Pt=function(e,t,n){return{type:"WRITE_TO_ONE",text:e,student_id:t,teacher_id:n}},Tt=function(e,t){return{type:"REMIND_ITEMS_TO_BRING_TO_ALL",items_to_bring_bool:e,teacher_id:t}},Et=function(e,t,n){return{type:"REMIND_ITEMS_TO_BRING_TO_ONE",student_id:e,things_to_bring:t,teacher_id:n}},Rt=function(e,t){return{type:"RECORD_ACTIVITIES_FOR_ALL",new_acitivities_bool:e,teacher_id:t}},It=function(e,t,n){return{type:"RECORD_ACTIVITIES_FOR_ONE",student_id:e,activities:t,teacher_id:n}},zt=function(e,t){return{type:"WRITE_ITEM_TO_BRING_TO_ALL",item_to_bring:e,teacher_id:t}},Lt=function(e,t,n){return{type:"WRITE_ITEM_TO_BRING_TO_ONE",student_id:e,item_to_bring:t,teacher_id:n}},Bt=function(e,t){return{type:"WRITE_ACTIVITY_FOR_ALL",activity:e,teacher_id:t}},Mt=function(e,t,n){return{type:"WRITE_ACTIVITY_FOR_ONE",student_id:e,activity:t,teacher_id:n}},Ft=function(e){return{type:"FETCH_CLASS_MESSAGE_DATA",message_data:e}},Nt=function(e){return{type:"ALERT_SLEEPLOG_ERROR_MESSAGE",err_message:e}},qt=function(){return{type:"CLEAR_SLEEPLOG_ERROR_MESSAGE"}},Ut=function(e){return{type:"EDIT_FRUIT_NAME",fruit_name:e}},Ht=function(e,t,n){return{type:"FETCH_CLASSES_SUCCESS",classes:e,admin_passcode:t,email:n}},Vt=function(e,t,n){return{type:"FETCH_TEACHERS_SUCCESS",admins:e,teachers:t,classes:n}},Wt=function(e,t){return{type:"FETCH_STUDENTS_SUCCESS",students:e,classes:t}},Kt=function(e){return{type:"INITIALIZE_STUDENT_WELLNESS",students:e}},Gt=function(){return{type:"SEND_MESSAGE_ON_SUCCESS"}},Qt=function(e){return{type:"SET_CONNECT_STATE",isConnected:e}},Jt=function(){return{type:"CLEAR_SCHOOL_STATE"}},Xt=function(e,t){return{type:"FETCH_TEACHER_ATTENDANCE_SUCCESS",attendance:e,teachers:t}},Yt=function(e,t,n,r){return{type:"FETCH_STUDENT_ATTENDANCE_SUCCESS",attendance:e,students:t,present:n,absent:r}},Zt=function(e){return{type:"EDIT_TEACHER_ON_DUTY",teacher_id:e}},$t=function(e){return{type:"ADD_PICKUP_REQUEST",requests:e}},en=function(e){return{type:"UPDATE_VIEWING_STATUS",status:e}},tn=function(e,t){return{type:"UPDATE_PROFILE_PICTURE",student_id:e,uri:t}},nn=function(e,t,n,r){return{type:"EDIT_STUDENT_SUCCESS",student_id:e,name:t,old_class_id:n,new_class_id:r}},rn=function(e,t){return{type:"UPDATE_TEACHER_PROFILE_PICTURE",teacher_id:e,image_url:t}},sn=function(e){return{type:"MARK_RECORD_ERROR",record_id_array:e}},an=function(e){return{type:"MARK_RECORD_CORRECT",record_id:e}},cn=function(e){return{type:"GET_PARENT_MESSAGE_SUCCESS",messages:e}},on=n(0);function ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var un=function(e){o()(n,e);var t=dn(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={passcode:"",err_message:"",number_array:[1,2,3,4,5,6,7,8,9]},r.handlePasscode=r.handlePasscode.bind(g()(r)),r}return i()(n,[{key:"handlePasscode",value:function(e){this.setState({passcode:this.state.passcode+e})}},{key:"handleEnterPasscode",value:function(){this.props.handleEnterPasscode(this.state.passcode),this.setState({passcode:""})}},{key:"render",value:function(){var e=this,t=this.state,n=t.passcode,r=t.number_array;return Object(on.jsx)(je.a,{style:{backgroundColor:"rgba(0,0,0,0.5)",width:"100%",height:"100%",flex:1,justifyContent:"flex-start",alignItems:"center",zIndex:2,position:"absolute"},underlayColor:"transparent",onPress:this.props.hideLoginPad,children:Object(on.jsx)(je.a,{style:{width:350,height:560,borderRadius:25,zIndex:3,position:"absolute",backgroundColor:"white"},underlayColor:"white",onPress:function(){},children:Object(on.jsxs)(fe.View,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:[Object(on.jsxs)(fe.View,{style:{flex:1,flexDirection:"row",width:310,height:100,margin:5,borderRadius:50,backgroundColor:"#b5e9e9",justifyContent:"center"},children:[Object(on.jsx)(fe.Text,{style:{width:210,fontSize:40,fontWeight:"bold",paddingHorizontal:20,alignSelf:"center"},children:n}),Object(on.jsx)(je.a,{style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#ffe1d0",justifyContent:"center",alignItems:"center"},underlayColor:"#fa625f",onPress:function(){return e.setState({passcode:""})},children:Object(on.jsx)(fe.Text,{style:{fontSize:30},children:"Clear"})})]}),Object(on.jsx)(fe.View,{style:{flex:3,flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},children:r.map((function(t){return Object(on.jsx)(je.a,{style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#fff1b5",justifyContent:"center",alignItems:"center"},underlayColor:"#f4d41f",onPress:function(){return e.handlePasscode(t)},children:Object(on.jsx)(fe.Text,{style:{fontSize:30},children:t})},t)}))}),Object(on.jsxs)(fe.View,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(je.a,{style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#fff1b5",justifyContent:"center",alignItems:"center"},underlayColor:"#f4d41f",onPress:function(){return e.handlePasscode(0)},children:Object(on.jsx)(fe.Text,{style:{fontSize:30},children:"0"})}),Object(on.jsx)(je.a,{style:{width:210,height:100,margin:5,borderRadius:50,backgroundColor:"#dcf3d0",justifyContent:"center",alignItems:"center"},underlayColor:"#00c07f",onPress:function(){return e.handleEnterPasscode()},children:Object(on.jsx)(fe.Text,{style:{fontSize:30},children:"Enter"})})]})]})})})}}]),n}(b.a.Component),fn=(he.a.create({button:{minWidth:"22%",aspectRatio:1,margin:5,justifyContent:"center"}}),Object(A.b)((function(e){return{class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ln(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markTeacherLoggedIn:ve,markTeacherLoggedOut:Se},e))}))(un));n(536);var hn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return null===e||void 0===e||""===e||-1!==e.indexOf("dev")?"prod":-1!==e.indexOf("staging")?"staging":-1!==e.indexOf("prod")?"prod":void 0}(n(66).a.manifest.releaseChannel);function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var bn=function(e){return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)},yn=function(e){return e.getFullYear()+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+("0"+e.getDate()).slice(-2)},gn=function(e){return("0"+(e.getMonth()+1)).slice(-2)+"/"+("0"+e.getDate()).slice(-2)},On=function(e){return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},xn=function(e){return e.getHours()+":"+("0"+e.getMinutes()).slice(-2)},mn=function(e){return e.getHours()+":"+e.getMinutes()},_n=function(e){var t,n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=!0,r.next=3,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message,s=e.data;if(n>200)t=!1;else if(void 0===n)return{success:!1,statusCode:500,message:r,data:{}};return{success:t,statusCode:n,message:r,data:s}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return n=r.sent,r.abrupt("return",n);case 5:case"end":return r.stop()}}),null,null,null,Promise)},wn=function(e,t){var n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=!0,s.next=3,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,r=e.message,s=e.data;if(t>200)n=!1;else if(void 0===t)return{success:!1,statusCode:500,message:r,data:{}};return{success:n,statusCode:t,message:r,data:s}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return r=s.sent,s.abrupt("return",r);case 5:case"end":return s.stop()}}),null,null,null,Promise)},vn=function(e,t){var n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=!0,s.next=3,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+e,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,r=e.message,s=e.data;if(t>200)n=!1;else if(void 0===t)return{success:!1,statusCode:500,message:r,data:{}};return{success:n,statusCode:t,message:r,data:s}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return r=s.sent,s.abrupt("return",r);case 5:case"end":return s.stop()}}),null,null,null,Promise)},Sn=function(e){var t,n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=!0,r.next=3,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message,s=e.data;if(n>200)t=!1;else if(void 0===n)return{success:!1,statusCode:500,message:r,data:{}};return{success:t,statusCode:n,message:r,data:s}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return n=r.sent,r.abrupt("return",n);case 5:case"end":return r.stop()}}),null,null,null,Promise)},Cn=function(e,t,n,r){var s,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return s="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/"+e+"/"+t+"?start_date="+n+"&end_date="+r,i.next=3,p.a.awrap(fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.log(e)})));case 3:return a=i.sent,i.abrupt("return",a);case 5:case"end":return i.stop()}}),null,null,null,Promise)},Dn=function(e,t,n,r){var s,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return s="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/"+e+"/class/"+t+"?start_date="+n+"&end_date="+r,i.next=3,p.a.awrap(fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.log(e)})));case 3:return a=i.sent,i.abrupt("return",a);case 5:case"end":return i.stop()}}),null,null,null,Promise)},An=function(e,t,n){var r,s,a,i,c;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e.record_id_for_update,s=[],0!==r.size){o.next=4;break}return o.abrupt("return",{success:!0,data:[]});case 4:return r.forEach((function(t){s.push(jn({record_id:t},e.records[t]))})),kn(s),a={date:n,class_id:t,data_objs:s},i="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/wellness/",o.next=10,p.a.awrap(fetch(i,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message,r=e.data;return t>200||void 0===t?{success:!1,statusCode:t,message:n}:{success:!0,statusCode:t,message:n,data:r}})).catch((function(e){return{success:!1,message:e}})));case 10:return c=o.sent,o.abrupt("return",c);case 12:case"end":return o.stop()}}),null,null,null,Promise)};function kn(e){for(var t=0;t<e.length;t++)e[t].time=On(e[t].time)}function Pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var En=function(e){o()(r,e);var t=Tn(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={selected_student_ids:[]},n}return i()(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"onSelectAttendanceType",value:function(e){var t=this.props.attendance;switch(e){case"present":return void this.setState({selected_student_ids:I()(t.present)});case"absent":return void this.setState({selected_student_ids:I()(t.absent)});case"unmarked":return void this.setState({selected_student_ids:I()(t.unmarked)})}}},{key:"fetchData",value:function(){var e=this,t="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance?date="+bn(new Date)+"&class_id="+this.props.class.class_id;fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){for(var n in t)null!==t[n][0]?e.props.markPresent(n,t[n][0]):null!==t[n][2]&&e.props.markAbsent(n,t[n][2]);e.setState({selected_student_ids:I()(e.props.attendance.unmarked)})})).catch((function(e){return console.log("err: ",e)}))}},{key:"handleOnClick",value:function(e){this.props.showModal(e)}},{key:"render",value:function(){var e=this;return Object(on.jsxs)(fe.Card,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:[Object(on.jsx)(fe.CardItem,{children:Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u51fa\u5e2d\u72c0\u6cc1"})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingLeft:5,paddingTop:5},children:Object(on.jsx)(x.a,{children:"\u51fa\u5e2d"})}),Object(on.jsx)(je.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#dcf3d0"},underlayColor:"#00c07f",onPress:function(){return e.onSelectAttendanceType("present")},children:Object(on.jsx)(x.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0,children:this.props.attendance.present.size})})]}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingLeft:5,paddingTop:5},children:Object(on.jsx)(x.a,{children:"\u7f3a\u5e2d"})}),Object(on.jsx)(je.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#ffe1d0"},underlayColor:"#fa625f",onPress:function(){return e.onSelectAttendanceType("absent")},children:Object(on.jsx)(x.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0,children:this.props.attendance.absent.size})})]}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingLeft:5,paddingTop:5},children:Object(on.jsx)(x.a,{children:"\u672a\u77e5"})}),Object(on.jsx)(je.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#fff1b5"},underlayColor:"#f4d41f",onPress:function(){return e.onSelectAttendanceType("unmarked")},children:Object(on.jsx)(x.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0,children:this.props.attendance.unmarked.size})})]})]}),Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",flexWrap:"wrap"},children:this.state.selected_student_ids.map((function(t){var r=e.props.attendance,s=r.present,a=r.unmarked;r.absent;return Object(on.jsx)(je.a,{style:{width:"31%",margin:"1%"},underlayColor:"transparent",onPress:function(){return e.handleOnClick(t)},children:Object(on.jsx)(O.a,{style:Rn.cardContainer,children:Object(on.jsxs)(fe.Card,{children:[Object(on.jsx)(fe.CardItem,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===e.props.class.students[t].profile_picture?n(77):{uri:e.props.class.students[t].profile_picture},style:{height:200,width:200,borderRadius:100,borderWidth:10,borderColor:s.has(t)?"#dcf3d0":a.has(t)?"#fff1b5":"#ffe1d0"}})}),Object(on.jsx)(fe.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5},children:Object(on.jsx)(x.a,{style:{marginTop:-10},children:e.props.class.students[t].name})})]})})},t)}))})]})}}]),r}(b.a.Component),Rn=he.a.create({cardContainer:{paddingVertical:5},thumbnailImage:{height:80,width:80,borderRadius:40}}),In=(Object(A.b)((function(e){return{attendance:e.attendance,class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markAbsent:xe,markPresent:Oe},e))}),null,{forwardRef:!0})(En),n(36));function zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ln=he.a.create({card:{width:"90%",flex:1},button:{width:"30%",backgroundColor:"#b5e9e9"},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}}),Bn=Object(A.b)(null,(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zn(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({initializeRequests:me},e))}))((function(e){var t=Object(D.g)();Object(j.useEffect)((function(){r()}),[]);var r=function(){var t=new Date,n=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate();fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/medicationrequest?date="+n+"&class_id="+e.class_id,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message,s=t.data,a=s.requests,i=s.finished,c=s.unfinished;n>200||"Internal server error"===r?alert("\u6258\u85e5\u55ae\u53d6\u4e0d\u5b8c\u6574\uff0c\u8acb\u548c\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):e.initializeRequests(a,i,c)})).catch((function(e){alert("Error, please try again \u6258\u85e5\u55ae\u53d6\u4e0d\u5b8c\u6574\uff0c\u8acb\u548c\u5de5\u7a0b\u5e2b\u806f\u7e6b\uff1a"+e.message)}))},s=e.students,a=e.medication_requests,i=a.requests,c=a.unfinished;return Object(on.jsxs)(fe.Card,{style:{flex:1,width:"90%"},children:[Object(on.jsxs)(O.a,{style:{height:80,justifyContent:"center",marginTop:5},children:[Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center",position:"absolute"},children:"\u6258\u85e5\u55ae"}),Object(on.jsx)(je.a,{style:{width:"25%",alignSelf:"flex-end",position:"absolute",padding:5,backgroundColor:"#b5e9e9"},onPress:function(){t("medication",{state:{request_id:null}})},children:Object(on.jsx)(x.a,{style:Ln.button_text,children:"\u67e5\u770b"})})]}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsx)(In.a,{horizontal:!0,children:c.map((function(e){var r=i[e],a=r.student_id,c=r.timestamp,o=(r.medication,r.note,r.administered,r.teacher_id,mn(new Date(c)));return Object(on.jsx)(je.a,{style:{flex:1,margin:3},onPress:function(){t("medication",{state:{request_id:e}})},children:Object(on.jsxs)(fe.Card,{style:{flex:1,alignItems:"center",paddingHorizontal:15},children:[Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:35},children:o})}),Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===s[a].profile_picture?n(77):{uri:s[a].profile_picture},style:Ln.thumbnailImage})}),Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:s[a].name})})]})},e)}))})})]})}));function Mn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Fn=function(e){o()(n,e);var t=Mn(n);function n(){return s()(this,n),t.apply(this,arguments)}return i()(n,[{key:"render",value:function(){return Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(x.a,{children:"Loading..."}),Object(on.jsx)(m.a,{size:"large"})]})}}]),n}(b.a.Component);function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Un=function(e){o()(n,e);var t=qn(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).timer=function(){return setTimeout((function(){r.setState({color:"#ffe1d0"===r.state.color?"#fa625f":"#ffe1d0"}),r.timeoutId=r.timer()}),2e3)},r.state={color:"#ffe1d0",requestQueue:[],isLoading:!0},r.onConfirm=r.onConfirm.bind(g()(r)),r}return i()(n,[{key:"componentDidMount",value:function(){this.timeoutId=this.timer()}},{key:"onConfirm",value:function(e,t){var n=this,r=I()(this.props.pick_up_request);fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance/pickup-request?request_id="+e,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var s=e.statusCode,a=e.message;200===s?(r.splice(t,1),n.props.addPickupRequest(r),0===r.length&&n.props.navigation.goBack()):pe.a.alert("Sorry \u53d6\u5f97\u63a5\u56de\u901a\u77e5\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+a,[{text:"Ok"}])})).catch((function(e){console.log("err: ",e)}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.pick_up_request,r=t.students;return Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center",flexWrap:"wrap"},children:n.map((function(t,n){var s=t.id,a=t.student_id,i=t.arrival_time,c=r[a];return Object(on.jsxs)(O.a,{style:{width:"45%",height:"45%",marginTop:"5%",backgroundColor:e.state.color},children:[Object(on.jsx)(O.a,{style:{flex:2,alignItems:"center",justifyContent:"center"},children:Object(on.jsx)(be.a,{source:{uri:c.profile_picture},style:{width:"80%",aspectRatio:1}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:80,textAlign:"center"},children:i})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(je.a,{style:{backgroundColor:"grey",padding:15,alignSelf:"flex-end",justifyContent:"center",marginRight:15},onPress:function(){return e.onConfirm(s,n)},children:Object(on.jsx)(x.a,{style:{fontSize:35,textAlign:"center",color:"lightgrey"},children:"\u78ba\u8a8d"})})})]})]},n)}))})}}]),n}(b.a.Component),Hn=(Object(A.b)((function(e){return{students:e.school.students,pick_up_request:e.school.pick_up_request}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({addPickupRequest:$t},e))}),null,{forwardRef:!0})(Un),n(61)),Vn=n(26),Wn=n(21);function Kn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Gn=function(e){o()(n,e);var t=Kn(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={selectedIndex:0},r}return i()(n,[{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"showActionSheet",value:function(){}},{key:"iosShowActionSheet",value:function(){this.props.options}},{key:"androidShowActionSheet",value:function(){var e=this,t=this.props.options;fe.ActionSheet.show({options:t,cancelButtonIndex:t.length-1},(function(n){e.setState({selectedIndex:n}),e.props.handleSelectValue(t[n])}))}},{key:"isOtherSelected",value:function(){var e=this.props,t=e.selectedValue;return e.options.indexOf(t)<0}},{key:"render",value:function(){var e=this,t=this.props,n=t.selectedValue,r=t.style,s=t.textStyle,a=t.disabled;return Object(on.jsx)(je.a,{disabled:a,style:r,onPress:function(){return e.props.showSelect()},children:Object(on.jsx)(x.a,{style:s,children:n})})}}]),n}(b.a.Component);function Qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Jn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Xn=function(e){o()(n,e);var t=Jn(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={other_option:""},r}return i()(n,[{key:"handleSelectStatus",value:function(e,t,n){"Cancel"!==n&&("\u5176\u4ed6"===n?this.setState({other_option:"\u5176\u4ed6"}):this.props.addHealthStatus(e,t,n,this.props.teacher_id))}},{key:"handleTempInput",value:function(e,t,n){var r="."===n.slice(-1)?n.slice(0,2):3===n.length?n.slice(0,2)+"."+n.slice(-1):n;this.props.addTemperature(e,t,r,this.props.teacher_id)}},{key:"render",value:function(){var e=this,t=this.props,n=t.student_id,r=t.record_id,s=t.records,a=t.records_with_error,i=t.autoFocus,c=s[r];return Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",borderWidth:2,borderColor:a.has(r)?"red":"transparent"},children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",backgroundColor:"rgba(255,255,255, 0.5)",marginRight:"10%",justifyContent:"center",padding:5},children:[Object(on.jsx)(Vn.a,{style:{fontSize:40,width:100,outline:"none"},autoFocus:i,keyboardType:"decimal-pad",placeholder:"\u9ad4\u6eab",value:""+c.temperature,onChangeText:function(t){e.handleTempInput(n,r,t)}}),""===c.temperature?null:Object(on.jsx)(x.a,{style:{fontSize:30},children:"\xb0"})]}),Object(on.jsx)(O.a,{style:{flex:2},children:""===this.state.other_option?Object(on.jsx)(Gn,{style:{backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:5},textStyle:{fontSize:40},selectedValue:c.status,options:["\u5065\u5eb7\u5bf6\u5bf6","\u767c\u71d2","\u5589\u56a8\u504f\u7d05","\u54b3\u55fd","\u6d41\u2fd0\u6d95","\u982d\u75db","\u6d3b\u52d5\u2f12\u4e0d\u4f73","\u5614\u5410","\u7cde\u4fbf\u5e36\u6709\u2f8e\u7d72","\u62c9\u809a\u5b50","\u5176\u4ed6","Cancel"],handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectStatus(n,r,t)}}):Object(on.jsx)(Vn.a,{style:{fontSize:40,backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:2},keyboardType:"default",autoFocus:""!==this.state.other_option,selectTextOnFocus:!0,value:c.status,onChangeText:function(t){e.handleSelectStatus(n,r,t)},onBlur:function(){return e.setState({other_option:""})}})})]})}}]),n}(b.a.Component),Yn=Object(A.b)((function(e){return{records:e.healthstatus.records,records_with_error:e.healthstatus.records_with_error}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({addHealthStatus:Pe,addTemperature:Te},e))}))(Xn),Zn=n(44);function $n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function er(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var tr=Zn.a.get("window"),nr=(tr.width,tr.height),rr=function(e){o()(r,e);var t=er(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={class_id:""},n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.class_id,n=e.student_id;"all"===t?this.getClassIdByStudentId(n):this.setState({class_id:t})}},{key:"getClassIdByStudentId",value:function(e){for(var t=this.props.classes,n=Object.keys(t),r="",s=0;s<n.length;s++)for(var a=t[n[s]].students,i=0;i<a.length;i++)a[i]===e&&(r=n[s]);this.setState({class_id:r})}},{key:"handleSend",value:function(e){var t,n,r,s,a,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=this.props,n=t.wellness,r=t.isConnected,s=this.state.class_id,a=n.records,""!==a[e].temperature){c.next=7;break}return pe.a.alert("\u672a\u586b\u5beb!","",[{text:"OK"}]),c.abrupt("return");case 7:return r||alert("\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),c.next=10,p.a.awrap(An(n,s,bn(new Date)));case 10:(i=c.sent).success?(this.props.fetchStudentAttendance(),this.props.sendWellnessDataSuccess(),this.props.hideModal()):this.props.sendWellnessDataFail(i.message);case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"markAbsent",value:function(){var e,t,n,r,s,a,i,c;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.student_id,n=e.school_id,r=this.state.class_id,s={student_id:t,class_id:r,school_id:n,startDate:bn(new Date),endDate:bn(new Date),excuse_type:"none-medical",note:"\u6821\u65b9\u586b\u5beb"},o.next=5,p.a.awrap(wn("/absence-excuse",s));case 5:if(a=o.sent,i=a.success,a.statusCode,c=a.message,a.data,i){o.next=10;break}return pe.a.alert("Sorry \u6a19\u8a18\u5b78\u751f\u7f3a\u5e2d\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+c,[{text:"Ok"}]),o.abrupt("return");case 10:this.props.fetchStudentAttendance(),this.props.hideModal();case 12:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props,r=(t.show,t.student_id),s=(t.teacher_id,t.students),a=t.student_unmarked,i=t.student_absent,c=t.teacherOnDuty,o=s[r],l=this.props.wellness.by_student_id[r][0];return Object(on.jsxs)(O.a,{style:{flex:1,width:"80%",height:.7*nr,backgroundColor:i.has(r)?"#ffe1d0":a.has(r)?"#fff1b5":"#dcf3d0",zIndex:3,position:"absolute"},children:[Object(on.jsxs)(O.a,{style:{flex:2,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{flex:1,alignItems:"center"},children:Object(on.jsx)(be.a,{source:""===o.profile_picture?n(77):{uri:o.profile_picture},style:sr.thumbnailImage})}),Object(on.jsxs)(O.a,{style:{flex:1,alignItems:"flex-start"},children:[Object(on.jsx)(x.a,{style:{fontSize:60},children:o.name}),Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"lightgrey",justifyContent:"center"},onPress:function(){return e.markAbsent()},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u7f3a\u5e2d"})})]})]}),Object(on.jsxs)(O.a,{style:{flex:2},children:[Object(on.jsxs)(O.a,{style:{flex:3,alignItems:"center"},children:[Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u8840\u578b: ",o.blood_type," "]}),Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u5730\u5740: ",o.address]}),Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u5bb6\u88e1\u96fb\u8a71: ",o.home_phone]}),Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\uff08\u7236\uff09\u624b\u6a5f: ",o.father_phone]}),Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\uff08\u6bcd\uff09\u624b\u6a5f: ",o.mother_phone]})]}),Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",paddingHorizontal:30},children:a.has(r)?Object(on.jsx)(Yn,{student_id:r,teacher_id:c,record_id:l,autoFocus:!0}):null})]}),Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center"},children:a.has(r)?Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(je.a,{style:{backgroundColor:"red",flex:1,height:60,justifyContent:"center",alignItems:"center",margin:8},onPress:this.props.hideModal,children:Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u53d6\u6d88"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"grey",flex:1,height:60,justifyContent:"center",alignItems:"center",margin:8},onPress:function(){return e.handleSend(l)},children:Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u9001\u51fa"})})]}):null})]})}}]),r}(b.a.Component),sr=he.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),ar=Object(A.b)((function(e){return{classes:e.school.classes,student_absent:e.school.student_absent,student_unmarked:e.school.student_unmarked,students:e.school.students,wellness:e.healthstatus,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({sendWellnessDataFail:Re,sendWellnessDataSuccess:Ee},e))}))(rr);function ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var or=Zn.a.get("window"),lr=(or.width,or.height),dr=function(e){o()(r,e);var t=cr(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={temperature:""},n}return i()(r,[{key:"editTemperature",value:function(e){var t="."===e.slice(-1)?e.slice(0,2):3===e.length?e.slice(0,2)+"."+e.slice(-1):e;this.setState({temperature:t})}},{key:"clock",value:function(){var e=this.props,t=e.isConnected,n=e.teacher_id,r=e.teachers[n];if(t)if(r.present){var s=r.attendance[r.attendance.length-1];this.clockout(s)}else this.clockin();else fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"clockout",value:function(e){var t,n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,p.a.awrap(vn("/staff-attendance/"+e,{out_time:bn(new Date)+" "+On(new Date)}));case 2:t=s.sent,n=t.success,t.statusCode,r=t.message,t.data,n||pe.a.alert("Sorry \u6253\u5361\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r,[{text:"Ok"}]),this.props.fetchTeacherAttendance(),this.props.hideModal();case 7:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"clockin",value:function(){var e,t,n,r,s,a,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props,t=e.isConnected,n=e.teacher_id,r=this.state.temperature,t||fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),c.next=5,p.a.awrap(wn("/staff-attendance",{teacher_id:n,in_time:bn(new Date)+" "+On(new Date),temperature:r||0}));case 5:if(s=c.sent,a=s.success,s.statusCode,i=s.message,s.data,a){c.next=10;break}return pe.a.alert("Sorry \u6253\u5361\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+i,[{text:"Ok"}]),c.abrupt("return");case 10:this.props.fetchTeacherAttendance(),this.props.hideModal();case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"editTeacherOnDuty",value:function(e){var t=this.props,n=t.teacherOnDuty,r=t.teachers,s="\u672a\u767b\u5165";n===e?this.props.editTeacherOnDuty(""):(this.props.editTeacherOnDuty(e),s=r[e].name),this.props.navigation.setOptions({headerRight:function(){return Object(on.jsx)(O.a,{style:{paddingRight:20},children:Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u503c\u73ed\u8001\u5e2b\uff1a"+s})})}})}},{key:"render",value:function(){var e=this,t=this.props,r=(t.show,t.student_id,t.teacher_id),s=t.teachers,a=t.unmarked,i=t.absent,c=t.teacherOnDuty,o=t.attendance,l=this.state.temperature,d=s[r];return Object(on.jsxs)(O.a,{style:{flex:1,width:"80%",height:.9*lr,backgroundColor:i.has(r)?"#ffe1d0":a.has(r)?"#fff1b5":"#dcf3d0",zIndex:3,position:"absolute"},children:[Object(on.jsxs)(O.a,{style:{flex:2,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center",backgroundColor:"red"},children:[Object(on.jsx)(O.a,{style:{flex:1,alignItems:"center"},children:Object(on.jsx)(be.a,{source:""===d.profile_picture?n(328):{uri:d.profile_picture},style:ur.thumbnailImage})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(x.a,{style:{fontSize:60},children:d.name}),Object(on.jsx)(je.a,{onPress:function(){return e.editTeacherOnDuty(r)},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(be.a,{source:n(c===r?733:734),style:{width:80,height:80}}),Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u503c\u73ed\u8001\u5e2b"})]})})]})]}),Object(on.jsxs)(O.a,{style:{flex:1,paddingHorizontal:30,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{flex:1,backgroundColor:"lightgrey"},children:Object(on.jsx)(Vn.a,{style:{fontSize:50,textAlign:"center"},keyboardType:"decimal-pad",placeholder:"\u9ad4\u6eab",value:""+l,onChangeText:function(t){return e.editTemperature(t)}})}),Object(on.jsx)(O.a,{style:{flex:1,backgroundColor:"lightblue"}})]}),Object(on.jsxs)(O.a,{style:{flex:1,paddingHorizontal:30,justifyContent:"space-evenly",alignItems:"center"},children:[d.attendance&&d.attendance.map((function(e){var t=o[e];return Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",width:"60%",justifyContent:"space-around"},children:[Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:50},children:t.in_time})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:50},children:t.out_time})})]},e)})),Object(on.jsx)(O.a,{style:{flexDirection:"row",alignSelf:"flex-end",backgroundColor:"white",padding:10},children:Object(on.jsxs)(x.a,{style:{fontSize:25},children:["\u4eca\u65e5\u7e3d\u8a08: ",Math.round(100*d.total_minutes)/100]})})]}),Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(je.a,{style:{backgroundColor:"red",flex:1,height:80,justifyContent:"center",alignItems:"center",margin:8},onPress:this.props.hideModal,children:Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u53d6\u6d88"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"grey",flex:1,height:80,justifyContent:"center",alignItems:"center",margin:8},onPress:function(){return e.clock()},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u6253\u5361"})})]})})]})}}]),r}(b.a.Component),ur=he.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),fr=Object(A.b)((function(e){return{attendance:e.school.attendance,teachers:e.school.teachers,teacherOnDuty:e.school.teacherOnDuty,unmarked:e.school.teacher_unmarked,absent:e.school.teacher_absent,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ir(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markPresent:Oe,sendWellnessDataFail:Re,editTeacherOnDuty:Zt},e))}))(dr);function hr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var jr=function(e){o()(n,e);var t=pr(n);function n(e){return s()(this,n),t.call(this,e)}return i()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.show,r=t.student_id,s=t.teacher_id,a=t.students,i=(t.unmarked,t.absent,t.teacherOnDuty),c=t.class_id,o=t.school_id;if(!n)return null;a[r];return Object(on.jsxs)(Hn.a,{style:{backgroundColor:"transparent",justifyContent:"flex-start",alignItems:"center",zIndex:2,position:"absolute",width:"100%",height:"100%"},behavior:"height",enabled:!0,children:[Object(on.jsx)(je.a,{style:{backgroundColor:"rgba(0,0,0,0.8)",width:"100%",height:"100%"},onPress:this.props.hideModal,children:Object(on.jsx)(O.a,{})}),""!==r?Object(on.jsx)(ar,{student_id:r,teacherOnDuty:i,class_id:c,school_id:o,fetchStudentAttendance:function(){return e.props.fetchStudentAttendance()},hideModal:this.props.hideModal}):Object(on.jsx)(fr,{teacher_id:s,teacherOnDuty:i,navigation:this.props.navigation,fetchTeacherAttendance:function(){return e.props.fetchTeacherAttendance()},hideModal:this.props.hideModal})]})}}]),n}(b.a.Component),br=(he.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),Object(A.b)((function(e){return{students:e.school.students,isConnected:e.classInfo.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markPresent:Oe,sendWellnessDataFail:Re},e))}))(jr));n(359);function yr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var gr=b.a.forwardRef((function(e,t){var r=Object(D.g)(),s=Object(j.useState)({messages:[]}),a=ue()(s,2),i=a[0],c=a[1];Object(j.useEffect)((function(){var t=e.date;o(new Date(t))}));var o=function(t){var n,r,s,a,i;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(n=e.class_id,e.class.isConnected){o.next=5;break}return alert("\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),o.abrupt("return");case 5:return o.next=7,p.a.awrap(_n("/message/class/"+n+"/unread?date="+bn(t)));case 7:if(r=o.sent,s=r.success,r.statusCode,a=r.message,i=r.data,s){o.next=12;break}return pe.a.alert("Sorry \u53d6\u5f97\u5bb6\u9577\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a,[{text:"Ok"}]),o.abrupt("return");case 12:c({messages:i}),l(i);case 14:case"end":return o.stop()}}),null,null,null,Promise)},l=function(t){for(var n={},r=0;r<t.length;r++)n[t[r].student_id]=t[r].message_for_teacher;e.getParentMessageSuccess(n)},d=e.students,u=e.class_id,f=e.date,h=i.messages,b=f.toDateString()!==(new Date).toDateString();return Object(on.jsxs)(fe.Card,{style:{flex:1,width:"90%"},children:[Object(on.jsxs)(O.a,{style:{height:80,justifyContent:"center",marginTop:5},children:[Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center",position:"absolute"},children:"\u8a0a\u606f"}),Object(on.jsx)(je.a,{style:{width:"25%",alignSelf:"flex-end",position:"absolute",padding:5,backgroundColor:"#b5e9e9"},onPress:function(){r("/class/inbox",{state:{messages:h,students:d,class_id:u,date:f},data:{onGoBack:function(e){return o(e)}}})},children:Object(on.jsx)(x.a,{style:Or.button_text,children:"\u67e5\u770b"})})]}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsx)(In.a,{horizontal:!0,children:h.map((function(e,t){e.activities,e.items_to_bring,e.message_for_teacher,e.other_activity,e.other_item;var s=e.student_id;e.teacher_id,e.text;return function(e,t){return!(null!==e&&!e)&&!(null!==t&&!t)}(e.message_read,e.morning_reminder_read)&&!b?null:Object(on.jsx)(je.a,{style:{flex:1,margin:3},onPress:function(){r("/class/inbox",{state:{messages:h,students:d,class_id:u,date:f,onGoBack:function(e){return o(e)}}})},children:Object(on.jsxs)(fe.Card,{style:{flex:1,alignItems:"center",padding:15},children:[Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===d[s].profile_picture?n(77):{uri:d[s].profile_picture},style:Or.thumbnailImage})}),Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:d[s].name})})]})},t)}))})})]})})),Or=he.a.create({card:{width:"90%",flex:1},button:{width:"30%",backgroundColor:"#b5e9e9"},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}}),xr=Object(A.b)((function(e){return{class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yr(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({getParentMessageSuccess:cn},e))}))(gr),mr=he.a.create({card:{width:"90%",flex:1},button:{width:"30%",backgroundColor:"#b5e9e9"},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}}),_r=Object(A.b)((function(e){return{attendance:e.school.attendance,students:e.school.students,student_absent:e.school.student_absent,student_unmarked:e.school.student_unmarked}}),null)((function(e){console.log("this.props: ",e);var t=e.class_students,r=(e.students,e.student_absent),s=e.student_unmarked;return console.log("student_absent: ",r),console.log("student_unmarked: ",s),"object"===typeof r||"object"===typeof s?Object(on.jsx)(Fn,{}):Object(on.jsxs)("div",{style:{flex:1,width:"90%"},children:[Object(on.jsx)(O.a,{style:{height:80,justifyContent:"center",marginTop:5},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center",position:"absolute"},children:"\u51fa\u5e2d\u72c0\u6cc1"})}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsxs)(In.a,{horizontal:!0,children:[I()(s).map((function(r){var s=t[r];if(void 0!==s)return Object(on.jsx)(je.a,{style:{flex:1,margin:3},onPress:function(){e.showLoginNumberPad(r)},children:Object(on.jsxs)("div",{style:{flex:1,alignItems:"center",paddingHorizontal:15,padding:10,backgroundColor:"#fff1b5"},children:[Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===s.profile_picture||null===s.profile_picture?n(77):{uri:s.profile_picture},style:mr.thumbnailImage})}),Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:s.name})})]})},r)})),I()(r).map((function(r){var s=t[r];if(void 0!==s)return Object(on.jsx)(je.a,{style:{flex:1,margin:3},onPress:function(){e.showLoginNumberPad(r)},children:Object(on.jsxs)("div",{style:{flex:1,alignItems:"center",paddingHorizontal:15,padding:10,backgroundColor:"#ffe1d0"},children:[Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===s.profile_picture?n(77):{uri:s.profile_picture},style:mr.thumbnailImage})}),Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:s.name})})]})},r)}))]})})]})})),wr=n(367),vr=n.n(wr);n(735);function Sr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}Zn.a.get("window").width;var Cr=function(e){o()(n,e);var t=Sr(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).onChange=function(e){console.log(e)},r.isWeekday=function(e){var t=new Date("September 26, 2020"),n=e.getDay();return 0!==n&&6!==n||e.toDateString()===t.toDateString()},r.state={datetime:new Date,isLoading:!0},r}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props.start_date;this.setState({datetime:e,isLoading:!1})}},{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"setDate",value:function(e){this.isIOS()?this.iosSetDate(e):this.androidSetDate(e)}},{key:"iosSetDate",value:function(e){this.setState({datetime:e})}},{key:"androidSetDate",value:function(e){void 0!==e?this.props.selectDatetimeConfirm(e):this.props.hideModal()}},{key:"selectDatetimeConfirm",value:function(e){this.props.selectDatetimeConfirm(e),this.props.hideModal()}},{key:"render",value:function(){var e=this,t=this.props,n=t.datetime_type,r=t.minDatetime,s=t.maxDatetime,a=t.minTime,i=t.maxTime,c=t.paddingVertical,o=this.state,l=o.datetime;return o.isLoading?null:Object(on.jsx)(je.a,{style:{width:"100%",height:"100%",zIndex:2,position:"absolute",paddingVertical:c,alignItems:"center",backgroundColor:"rgba(0,0,0,0.7)"},children:Object(on.jsxs)(O.a,{style:{},children:["date"===n&&Object(on.jsx)(vr.a,{onChange:function(t){return e.selectDatetimeConfirm(t)},inline:!0,selected:l,minDate:new Date(r),maxDate:new Date(s),onClickOutside:function(){return e.props.hideModal()}}),"time"===n&&Object(on.jsx)(vr.a,{onChange:function(t){return e.selectDatetimeConfirm(t)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:30,timeCaption:"Time",dateFormat:"h:mm aa",selected:l,minTime:a,maxTime:i,onClickOutside:function(){return e.props.hideModal()}})]})})}}]),n}(b.a.Component);function Dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ar(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kr=he.a.create({card:{width:"90%"},button_row:{width:"90%",height:100,justifyContent:"space-between",flexDirection:"row",marginVertical:7,paddingHorizontal:3},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:40},record_button:{width:"30%",height:"100%",backgroundColor:"#b5e9e9"},button:{width:"30%",backgroundColor:"#b5e9e9"}}),Pr=Object(A.b)((function(e){return{class:e.classInfo,medication_requests:e.medicationrequests,attendance:e.attendance,teachers:e.school.teachers,passcodeAdminId:e.school.passcodeAdminId,passcodeTeacherId:e.school.passcodeTeacherId,wellness_dispatched:e.healthstatus.data_dispatched,message_dispatched:e.message.data_dispatched,appetite_dispatched:e.appetite.data_dispatched,sleep_dispatched:e.sleep.data_dispatched,milk_dispatched:e.milk.data_dispatched,diaper_dispatched:e.diaper.data_dispatched}}),(function(e){return Ar({},Object(k.a)({setConnectState:Qt,initializeClass:ye,setClassId:_t,fetchStudentAttendanceSuccess:Yt,clearState:mt},e))}))((function(e){var t=Object(D.g)(),r=Object(D.f)(),s={messages:Object(j.useRef)(null),med_request:Object(j.useRef)(null)},a=Object(j.useState)({date:new Date,isLoading:!0,showLoginNumberPad:!1,pageClicked:"",alertForPickup:!1,pickupQueue:[],showModal:!1,modalStudentId:"",modalTeacherId:"",isAdmin:!1,admin_id:"",appState:"",showDateTimeModal:!1}),i=ue()(a,2),c=i[0],o=i[1];Object(j.useEffect)((function(){console.log("teacher home / useEffect"),l();e.class_name;var t=e.isAdmin,n=e.admin_id,s=((null==r?void 0:r.state)||{}).class_id;o(Ar(Ar({},c),{},{isAdmin:t,admin_id:n})),e.setClassId(s),b(s);var a=f(s);return g(),function(){console.log("unmounting"),clearTimeout(a),window.removeEventListener("online",console.log("removing online listener")),window.removeEventListener("offline",console.log("removing offline listener"))}}),[]);var l=function(){window.navigator.onLine?(d(),window.addEventListener("online",(function(e){console.log("online"),d()})),window.addEventListener("offline",(function(e){console.log("offline"),u()}))):u()},d=function(){e.setConnectState(!0)},u=function(){e.setConnectState(!1)},f=function(e){return setTimeout((function(){h(e)}),1e4)},h=function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/class/"+e+"/updates",n.next=3,p.a.awrap(fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.data.forEach((function(e){"attendance"===e?g():s[e].fetchData(c.date)}))})).catch((function(e){console.log("teacherhome poll err: ",e)})));case 3:f(e);case 4:case"end":return n.stop()}}),null,null,null,Promise)},b=function(t){console.log("initializeClass"),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/class/"+t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.initializeClass(t.teachers,t.students),o(Ar(Ar({},c),{},{isLoading:!1}))})).catch((function(e){console.log("initializeClass err: ",e)}))},y=function(n){var r=c.isAdmin,s=c.admin_id,a=c.date;r?t("/"+n,{state:{class:e.class,teacher_id:s,date:a,isAdmin:r,teacher_name:e.teachers[s].name}}):o(Ar(Ar({},c),{},{showLoginNumberPad:!0,pageClicked:n}))},g=function(){var t,n,s,a,i,o,l,d,u,f,h;return p.a.async((function(j){for(;;)switch(j.prev=j.next){case 0:return t=(null==r?void 0:r.state)||{},n=t.class_id,s=bn(c.date),j.next=4,p.a.awrap(_n("/attendance/class?class_id="+n+"&date="+s));case 4:if(a=j.sent,i=a.success,a.statusCode,o=a.message,l=a.data,i){j.next=9;break}return pe.a.alert("Sorry \u53d6\u5f97\u5b78\u751f\u51fa\u5e2d\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o,[{text:"Ok"}]),j.abrupt("return");case 9:console.log("data: ",l),d=l.attendance,u=l.students,f=l.present,h=l.absent,e.fetchStudentAttendanceSuccess(d,u,f,h);case 12:case"end":return j.stop()}}),null,null,null,Promise)},x=function(e){c.isAdmin&&!m()&&o(Ar(Ar({},c),{},{date:e,showDateTimeModal:!1}))},m=function(){var t=e.wellness_dispatched,n=e.message_dispatched,r=e.appetite_dispatched,s=e.sleep_dispatched,a=e.milk_dispatched,i=e.diaper_dispatched;return!(t&&n&&r&&s&&a&&i)},_=e.school_id,w=((null==r?void 0:r.state)||{}).class_id,v=c.isLoading,S=c.date,C=c.showModal,A=c.modalStudentId,k=c.modalTeacherId,P=c.showDateTimeModal,T=c.isAdmin,E=e.wellness_dispatched,R=e.message_dispatched,I=e.appetite_dispatched,z=e.sleep_dispatched,L=e.milk_dispatched,B=e.diaper_dispatched;return console.log("isLoading: ",v),v?Object(on.jsx)(Fn,{}):Object(on.jsxs)(fe.Container,{style:{flex:1},children:[c.showLoginNumberPad?Object(on.jsx)(fn,{handleEnterPasscode:function(n){return function(n){var r=c.date,s=e.passcodeAdminId,a=e.passcodeTeacherId,i=e.teachers,l=a[n]||s[n],d=void 0!==s[n];void 0===l?fe.Toast.show({text:"\u5bc6\u78bc\u4e0d\u6b63\u78ba!",buttonText:"Okay",position:"top",type:"danger",duration:3e3}):"attendance_modal"===c.pageClicked?o(Ar(Ar({},c),{},{showModal:!0,showLoginNumberPad:!1,modalTeacherId:l})):(t(""+c.pageClicked,{state:{teacher_id:l,class:e.class,date:r,isAdmin:d,teacher_name:i[l].name}}),o(Ar(Ar({},c),{},{showLoginNumberPad:!1})))}(n)},hideLoginPad:function(){o(Ar(Ar({},c),{},{showLoginNumberPad:!1}))}}):null,P&&Object(on.jsx)(Cr,{start_date:S,datetime_type:"date",hideModal:function(){return o(Ar(Ar({},c),{},{showDateTimeModal:!1}))},selectDatetimeConfirm:function(e){return x(e)},minDatetime:null,maxDatetime:new Date}),Object(on.jsx)(br,{show:C,student_id:A,teacher_id:null,teacherOnDuty:k,class_id:w,school_id:_,navigation:t,fetchStudentAttendance:function(){return g()},fetchTeacherAttendance:function(){return null},hideModal:function(){o(Ar(Ar({},c),{},{showModal:!1}))}}),Object(on.jsxs)(fe.Content,{contentContainerStyle:{marginTop:30,paddingBottom:50,alignItems:"center",justifyContent:"center"},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between"},children:[Object(on.jsx)(O.a,{style:{width:"15%"},children:Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return function(){var e=new Date(c.date.getTime());1===e.getDay()?e.setDate(e.getDate()-3):e.setDate(e.getDate()-1),x(e)}()},children:Object(on.jsx)(be.a,{source:n(334),style:{width:40,height:40}})})}),Object(on.jsx)(je.a,{onPress:function(){T&&!m()&&o(Ar(Ar({},c),{},{showDateTimeModal:!0}))},children:Object(on.jsx)(fe.Text,{style:{fontSize:50},children:yn(S)})}),Object(on.jsx)(O.a,{style:{width:"15%"},children:S.toDateString()!==(new Date).toDateString()&&Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return function(){var e=new Date(c.date.getTime());5===e.getDay()?e.setDate(e.getDate()+3):e.setDate(e.getDate()+1),x(e)}()},children:Object(on.jsx)(be.a,{source:n(335),style:{width:40,height:40}})})})]}),Object(on.jsx)(xr,{class_id:w,students:e.class.students,navigation:t,date:S}),Object(on.jsx)(Bn,{class_id:w,students:e.class.students,medication_requests:e.medication_requests,navigation:t,date:S}),Object(on.jsxs)(O.a,{style:kr.button_row,children:[Object(on.jsx)(je.a,{style:kr.record_button,onPress:function(){return y("wellness")},children:Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center"},children:[Object(on.jsx)(O.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"},children:E?null:Object(on.jsx)(be.a,{source:n(180),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})}),Object(on.jsx)(fe.Text,{style:kr.button_text,children:"\u5065\u5eb7"})]})}),Object(on.jsx)(je.a,{style:kr.record_button,onPress:function(){return y("message")},children:Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center"},children:[Object(on.jsx)(O.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"},children:R?null:Object(on.jsx)(be.a,{source:n(180),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})}),Object(on.jsxs)(fe.Text,{style:kr.button_text,children:["\u8001\u5e2b","\n","\uf9cd\u2f94"]})]})}),Object(on.jsx)(je.a,{style:kr.record_button,onPress:function(){return y("appetite")},children:Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center"},children:[Object(on.jsx)(O.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"},children:I?null:Object(on.jsx)(be.a,{source:n(180),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})}),Object(on.jsx)(fe.Text,{style:kr.button_text,children:"\u98f2\u98df"})]})})]}),Object(on.jsxs)(O.a,{style:kr.button_row,children:[Object(on.jsx)(je.a,{style:kr.record_button,onPress:function(){return y("sleep")},children:Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center"},children:[Object(on.jsx)(O.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"},children:z?null:Object(on.jsx)(be.a,{source:n(180),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})}),Object(on.jsx)(fe.Text,{style:kr.button_text,children:"\u7761\u7720"})]})}),Object(on.jsx)(je.a,{style:kr.record_button,onPress:function(){return y("TeacherMilkLog")},children:Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center"},children:[Object(on.jsx)(O.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"},children:L?null:Object(on.jsx)(be.a,{source:n(180),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})}),Object(on.jsx)(fe.Text,{style:kr.button_text,children:"\u9935\u5976"})]})}),Object(on.jsx)(je.a,{style:kr.record_button,onPress:function(){return y("DiaperLog")},children:Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center"},children:[Object(on.jsx)(O.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"},children:B?null:Object(on.jsx)(be.a,{source:n(180),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})}),Object(on.jsx)(fe.Text,{style:kr.button_text,children:"\u63db\u5c3f\u5e03"})]})})]}),Object(on.jsx)(_r,{class_students:e.class.students,showLoginNumberPad:function(e){return o(Ar(Ar({},c),{},{showLoginNumberPad:!0,modalStudentId:e,pageClicked:"attendance_modal"}))}}),Object(on.jsx)(je.a,{style:kr.button,onPress:function(){return t(-1)},children:Object(on.jsx)(fe.Text,{style:kr.button_text,children:"\u8fd4\u56de"})})]})]})}));function Tr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tr(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rr=Object(A.b)((function(e){return{pick_up_request:e.school.pick_up_request,passcodeAdminId:e.school.passcodeAdminId,passcodeTeacherId:e.school.passcodeTeacherId,classes:e.school.classes,teachers:e.school.teachers,viewing_status:e.school.viewing_status,isConnected:e.school.isConnected}}),(function(e){return Er({},Object(k.a)({setConnectState:Qt,fetchClassesSuccess:Ht,fetchTeachersSuccess:Vt,fetchStudentsSuccess:Wt,initializeStudentWellness:Kt,addPickupRequest:$t,clearSchoolState:Jt,updateViewingStatus:en,fetchStudentAttendanceSuccess:Yt},e))}))((function(e){var t=Object(D.g)(),n=Object(j.useState)({classes:[],err_message:"",showLoginNumberPad:!1,pageClicked:"",class_id:"",admin_id:""}),r=ue()(n,2),s=r[0],a=r[1];Object(j.useEffect)((function(){console.log("useEffect"),window.addEventListener("offline",(function(t){e.setConnectState(!1)})),window.addEventListener("online",(function(){e.setConnectState(!0)}));var t=e.school_id;return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.awrap(i());case 2:c(t),l(t);case 4:case"end":return e.stop()}}),null,null,null,Promise),function(){console.log("school home / useEffect return "),window.removeEventListener("offline",(function(t){e.setConnectState(!1)})),window.removeEventListener("online",(function(t){e.setConnectState(!1)}))}}),[]);var i=function(){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.school_id,n.next=3,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/school/"+t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message,i=t.data;if(n>200||"Internal server error"===r)alert("Sorry \u53d6\u5f97\u6559\u5ba4\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+r);else{a(Er(Er({},s),{},{classes:i.classes}));var c={};i.classes.forEach((function(e){var t=e.id,n=e.name;c[t]={teachers:[],students:[],name:n}})),e.fetchClassesSuccess(c,i.admin_passcode)}})).catch((function(e){alert("Sorry \u53d6\u5f97\u6559\u5ba4\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b")})));case 3:case"end":return n.stop()}}),null,null,null,Promise)},c=function(t){var n,r,s,a,i,c,l;return p.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,p.a.awrap(_n("/school/"+t+"/teacher"));case 2:if(n=d.sent,r=n.success,n.statusCode,s=n.message,a=n.data,r){d.next=7;break}return alert("Sorry \u53d6\u5f97\u6559\u5e2b\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),d.abrupt("return");case 7:i=a.admins,c=a.teachers,l=a.classes,e.fetchTeachersSuccess(i,c,l),o(c);case 10:case"end":return d.stop()}}),null,null,null,Promise)},o=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)if("\u7ba1\u7406\u54e1"===e[t[n]].name)return void a(Er(Er({},s),{},{admin_id:t[n]}))},l=function(t){var n,r,s,a,i,c;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,p.a.awrap(_n("/school/"+t+"/student"));case 2:if(n=o.sent,r=n.success,n.statusCode,s=n.message,a=n.data,r){o.next=7;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),o.abrupt("return");case 7:i=a.students,c=a.classes,e.fetchStudentsSuccess(i,c),e.initializeStudentWellness(Object.keys(i));case 10:case"end":return o.stop()}}),null,null,null,Promise)},d=s.classes,u=s.showLoginNumberPad,f=e.school_id;new Set;return Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"column"},children:[u?Object(on.jsx)(fn,{handleEnterPasscode:function(n){return function(n){var r=e.school_name,i=e.school_id,c=e.passcodeAdminId,o=e.passcodeTeacherId,l=e.classes,d=e.teachers,u=s.pageClicked,f=s.class_id,h=o[n],p=c[n];void 0===h&&void 0===p?alert("\u5bc6\u78bc\u4e0d\u6b63\u78ba\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"):void 0!==p?(console.log("school home / class_id: ",f),a(Er(Er({},s),{},{showLoginNumberPad:!1})),t("/"+u,{state:{school_name:r,school_id:i,class_id:f,class_name:"\u7ba1\u7406\u54e1\uff1a"+d[p].name,isAdmin:!0,admin_id:p}})):""!==f&&!l[f].teachers.includes(h)||"admin"===u?alert("Sorry \u6b0a\u9650\u4e0d\u5408\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"):(a(Er(Er({},s),{},{showLoginNumberPad:!1})),e.updateViewingStatus("teacher"),console.log("school home / class_id: ",f),t("/class",{class_id:f,class_name:l[f].name,isAdmin:!1}))}(n)},hideLoginPad:function(){a(Er(Er({},s),{},{showLoginNumberPad:!1}))}}):null,Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){return a(Er(Er({},s),{},{showLoginNumberPad:!0,pageClicked:"admin"}))},children:Object(on.jsx)(x.a,{style:{fontSize:50,textAlign:"center"},children:"\u884c\u653f\u7ba1\u7406"})},"admin"),Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){e.updateViewingStatus("dismissal"),e.navigation.push("DismissChildQRScan",{})},children:Object(on.jsx)(x.a,{style:{fontSize:50,textAlign:"center"},children:"\u653e\u5b78"})},"child_dismissal")]}),Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){t("/attendance",{school_id:f})},children:Object(on.jsx)(x.a,{style:{fontSize:80,textAlign:"center"},children:"\u51fa\u5e2d/\u6253\u5361"})},"attendance_page"),Object(on.jsx)(O.a,{style:{flex:3},children:d.map((function(e){return"\u7ba1\u7406\u54e1"===e.name?null:Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){return a(Er(Er({},s),{},{showLoginNumberPad:!0,pageClicked:"class",class_id:e.id}))},children:Object(on.jsx)(x.a,{style:{fontSize:80,textAlign:"center"},children:e.name})},e.id)}))}),Object(on.jsx)(je.a,{onPress:function(){return function(){var t=e.loadAuth;w.a.signOut().then((function(){t()})).catch((function(e){return console.log(e)}))}()},children:Object(on.jsx)(x.a,{children:"sign out"})})]})}));function Ir(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Lr=function(e){o()(n,e);var t=zr(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={logging_in:!1,teacher_id:""},r.handleEnterPasscode=r.handleEnterPasscode.bind(g()(r)),r.hideLoginPad=r.hideLoginPad.bind(g()(r)),r}return i()(n,[{key:"componentDidMount",value:function(){this.fetchStaffAttendanceByClassId()}},{key:"fetchStaffAttendanceByClassId",value:function(){var e=this,t=this.props.class,n=t.class_id;t.isConnected?fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance?class_id="+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.props.fetchAttendanceSuccess(t.data)})).catch((function(e){console.log("err: ",e)})):fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"handleEnterPasscode",value:function(e){var t=this.props.class.passcodeTeacherId[e];if(void 0===t||t!==this.state.teacher_id)fe.Toast.show({text:"Wrong password!",buttonText:"Okay",position:"top",type:"warning",duration:3e3});else{var n=this.props.class.teachers[t],r=new Date;n.logged_in?this.clockOut(t,r):this.clockIn(t,r),this.setState({logging_in:!1})}}},{key:"clockIn",value:function(e,t){var n=this;if(this.props.class.isConnected){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({staff_id:e})}).then((function(e){return e.json()})).then((function(r){var s=r.statusCode,a=r.message,i=r.data;s>200||"Internal server error"===r.message?n.props.markStaffAttendanceFail(a):n.props.markTeacherLoggedIn(e,t,i.attendance_id)})).catch((function(e){console.log("err: ",e)}))}else fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"clockOut",value:function(e,t){var n=this;if(this.props.class.isConnected){var r=this.props.class.teachers[e].attendance_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance/"+r,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(r){var s=r.statusCode,a=r.message;s>200||"Internal server error"===a?n.props.markStaffAttendanceFail(a):n.props.markTeacherLoggedOut(e,t)})).catch((function(e){console.log("err: ",e)}))}else fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"hideLoginPad",value:function(){this.setState({logging_in:!1})}},{key:"render",value:function(){var e=this,t=this.props.class.errMessage;return Object(on.jsxs)(fe.Container,{children:[""!==t?Object(on.jsx)(fe.Text,{style:{fontSize:20,color:"red"},children:t}):null,this.state.logging_in?Object(on.jsx)(fn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:this.hideLoginPad}):null,Object(on.jsx)(fe.Content,{contentContainerStyle:{marginTop:30,paddingBottom:30,alignSelf:"center",flexDirection:"row"},children:Object.keys(this.props.class.teachers).map((function(t){return Object(on.jsx)(je.a,{style:{margin:20},underlayColor:"transparent",onPress:function(){return e.setState({logging_in:!0,teacher_id:t})},children:Object(on.jsx)(fe.View,{style:Br.cardContainer,children:Object(on.jsxs)(fe.Card,{children:[Object(on.jsx)(fe.CardItem,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{style:Br.thumbnailImage})}),Object(on.jsx)(fe.CardItem,{footer:!0,style:{justifyContent:"center",backgroundColor:e.props.class.teachers[t].logged_in?"#dcf3d0":"#ffe1d0"},children:Object(on.jsx)(fe.Text,{children:e.props.class.teachers[t].name})})]})})},t)}))})]})}}]),n}(b.a.Component),Br=he.a.create({cardContainer:{width:119,height:150,margin:2,marginBottom:-2},thumbnailImage:{height:80,width:80,borderRadius:40}}),Mr=(Object(A.b)((function(e){return{class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ir(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ir(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markTeacherLoggedIn:ve,markTeacherLoggedOut:Se,markStaffAttendanceFail:At,fetchAttendanceSuccess:we},e))}))(Lr),n(142));function Fr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Nr=function(e){o()(r,e);var t=Fr(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={medicated_time:new Date,showTimePicker:!1},n}return i()(r,[{key:"selectDatetimeConfirm",value:function(e){this.setState({medicated_time:e,showTimePicker:!1})}},{key:"render",value:function(){var e=this,t=this.props,r=t.thumbnail,s=t.student_name,a=t.request,i=this.state,c=i.medicated_time,o=i.showTimePicker,l=a.administered,d=a.fever_entry,u=a.medication,f=a.note,h=(a.student_id,a.teacher_id,a.timestamp),p=u.before_meal,j=u.gel,b=u.other_type,y=u.powder,g=u.powder_refrigerated,m=u.syrup,_=mn(new Date(h));return Object(on.jsxs)(fe.Card,{style:{flex:1,alignSelf:"center",width:"100%"},children:[o?Object(on.jsx)(Cr,{start_date:c,datetime_type:"time",hideModal:function(){return e.setState({showTimePicker:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:null}):null,Object(on.jsxs)(O.a,{style:{flex:.35,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===r?n(77):{uri:r},style:qr.thumbnailImage})}),Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"flex-start"},children:[Object(on.jsx)(x.a,{style:{fontSize:70,fontWeight:"bold"},children:s}),Object(on.jsxs)(x.a,{style:{fontSize:70,fontWeight:"bold"},children:[_," ",null===p?null:p?"\u9910\u524d":"\u9910\u5f8c"]})]})]}),Object(on.jsxs)(O.a,{style:{flex:.65,paddingBottom:20},children:[Object(on.jsxs)(O.a,{style:{width:"100%",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-evenly"},children:[y&&Object(on.jsxs)(O.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",flexDirection:"row",marginBottom:15,marginHorizontal:7},children:[Object(on.jsx)(be.a,{source:n(794)}),Object(on.jsxs)(O.a,{children:[Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u85e5\u7c89"}),g&&Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u9700\u51b7\u85cf"})]})]}),0!==m.length&&Object(on.jsxs)(O.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7},children:[Object(on.jsx)(be.a,{source:n(795)}),Object(on.jsxs)(O.a,{children:[Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u85e5\u6c34"}),m.map((function(e,t){return Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsxs)(x.a,{style:{fontSize:20},children:[e.amount," c.c."]}),e.need_refrigerated&&Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:20},children:"\u9700\u51b7\u85cf"})]},t)}))]})]}),j&&Object(on.jsxs)(O.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7},children:[Object(on.jsx)(be.a,{source:n(796)}),Object(on.jsxs)(O.a,{children:[Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u85e5\u818f"}),Object(on.jsx)(x.a,{style:{fontSize:30},children:j})]})]}),b&&Object(on.jsxs)(O.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7},children:[Object(on.jsx)(be.a,{source:n(797)}),Object(on.jsxs)(O.a,{children:[Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u5176\u4ed6"}),Object(on.jsx)(x.a,{style:{fontSize:30},children:b})]})]})]}),Object(on.jsxs)(O.a,{style:{width:"97%",marginHorizontal:10,flexDirection:"row",justifyContent:"space-between"},children:[Object(on.jsxs)(O.a,{style:{width:"32%",aspectRatio:1,backgroundColor:"#fff1b5"},children:[Object(on.jsx)(O.a,{style:{padding:10},children:Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u5099\u8a3b"})}),Object(on.jsx)(O.a,{style:{padding:10},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:f})})]}),Object(on.jsxs)(O.a,{style:{width:"40%",backgroundColor:"#fa625f"},children:[Object(on.jsx)(O.a,{style:{padding:10},children:Object(on.jsxs)(x.a,{style:{fontSize:30,color:"white"},children:["\u767c\u71d2\u8d85\u904e ",d.temperature,"\xb0C"]})}),Object(on.jsxs)(O.a,{style:{padding:10},children:[d.powder&&Object(on.jsxs)(x.a,{style:{fontSize:25,color:"white"},children:["\u85e5\u7c89 ",d.powder_refrigerated&&"\u9700\u51b7\u85cf"]}),0!==d.syrup.length&&Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(x.a,{style:{fontSize:25,color:"white"},children:"\u85e5\u6c34    "}),d.syrup.map((function(e,t){return Object(on.jsxs)(x.a,{style:{fontSize:25,color:"white"},children:[e.amount," c.c. ",e.need_refrigerated&&"\u9700\u51b7\u85cf"]},t)}))]}),d.other_type&&Object(on.jsxs)(x.a,{style:{fontSize:25,color:"white"},children:["\u5176\u4ed6    ",d.other_type]})]})]}),Object(on.jsxs)(O.a,{style:{width:"25%",justifyContent:"space-between"},children:[Object(on.jsx)(je.a,{style:{padding:15,backgroundColor:"rgba(0,0,0,0.2)",justifyContent:"center",alignItems:"center"},onPress:function(){return e.setState({showTimePicker:!0})},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:xn(c)})}),Object(on.jsx)(je.a,{style:{padding:15,width:"100%",backgroundColor:l?"#dcf3d0":"#ffe1d0",alignItems:"center"},onPress:function(){return e.props.showLoginNumberPad()},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u5b8c\u6210"})})]})]})]})]})}}]),r}(b.a.Component),qr=he.a.create({thumbnailImage:{height:180,width:180,borderRadius:90}});function Ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Hr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ur(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ur(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vr=he.a.create({cardContainer:{width:170,paddingRight:5},thumbnailImage:{height:110,width:110,borderRadius:55}}),Wr=Object(A.b)((function(e){return{class:e.classInfo,requests:e.medicationrequests,teachers:e.school.teachers,passcodeAdminId:e.school.passcodeAdminId}}),(function(e){return Hr({},Object(k.a)({initializeRequests:me,fillMedRequest:_e},e))}))((function(e){var t=Object(D.h)().request_id,r=Object(j.useState)({isLoading:!0,refreshing:!1,selected_request_id:"",showLoginNumberPad:!1,medicated_timestamp:null}),s=ue()(r,2),a=s[0],i=s[1];Object(j.useEffect)((function(){console.log("request_id: ",t),null!==t&&void 0!==t?c(t):i(Hr(Hr({},a),{},{isLoading:!1}))}),[]);var c=function(e){i(Hr(Hr({},a),{},{selected_request_id:e,isLoading:!1}))},o=function(t){var n=a.selected_request_id,r=a.medicated_timestamp,s=e.requests.requests[n].student_id;e.class.isConnected?fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/medicationrequest",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:n,teacher_id:t,student_id:s,medicated_timestamp:bn(r)+" "+On(r)})}).then((function(e){return e.json()})).then((function(t){var r=t.statusCode,s=t.message;t.data;r>200||"Internal server error"===s?pe.a.alert("Error, please try again",s,[{text:"OK"}]):(e.fillMedRequest(n),e.navigation.goBack())})).catch((function(e){pe.a.alert("Error, please try again",e.message,[{text:"OK"}])})):fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})},l=a.selected_request_id,d=a.isLoading,u=a.showLoginNumberPad;if(d)return Object(on.jsx)(Fn,{});var f=e.requests.requests,h=e.class.students,p=f[l];return console.log("requests: ",f),console.log("selected_request_id: ",l),console.log("current_request: ",p),Object(on.jsxs)(O.a,{style:{flex:1},children:[u?Object(on.jsx)(fn,{handleEnterPasscode:function(t){return function(t){var n=e.passcodeAdminId,r=e.class.passcodeTeacherId[t]||n[t];void 0===r?pe.a.alert("Wrong password","Please try again",[{text:"OK"}]):(i(Hr(Hr({},a),{},{showLoginNumberPad:!1})),o(r))}(t)},hideLoginPad:function(){i(Hr(Hr({},a),{},{showLoginNumberPad:!1}))}}):null,Object(on.jsxs)(In.a,{contentContainerStyle:{flex:1,padding:10},refreshControl:Object(on.jsx)(Mr.a,{style:{backgroundColor:"#E0FFFF"},refreshing:a.refreshing,onRefresh:function(){},tintColor:"#ff0000",title:"Loading...",titleColor:"#00ff00",colors:["#ff0000","#00ff00","#0000ff"],progressBackgroundColor:"#ffff00"}),children:[Object(on.jsx)(O.a,{style:{flex:3},children:""===l?null:Object(on.jsx)(Nr,{thumbnail:h[p.student_id].profile_picture,student_name:h[p.student_id].name,teacher_name:null===p.teacher_id?"":teachers[p.teacher_id].name,request:p,showLoginNumberPad:function(e){return i(Hr(Hr({},a),{},{showLoginNumberPad:!0,medicated_timestamp:e}))}})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(In.a,{horizontal:!0,children:Object.keys(f).map((function(t){var r=f[t].student_id,s=f[t],a=s.timestamp,i=s.administered,o=xn(new Date(a)),l=function(e){var t=e.powder_refrigerated,n=e.syrup,r=!1;return n.forEach((function(e){r|=e.need_refrigerated})),t||r}(f[t].medication);return Object(on.jsx)(je.a,{style:Vr.cardContainer,underlayColor:"transparent",onPress:function(){return c(t)},children:Object(on.jsxs)(Box,{style:{flex:1,backgroundColor:i?"#dcf3d0":"#ffe1d0"},children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center",paddingHorizontal:5},children:[Object(on.jsx)(O.a,{style:{width:24,height:24},children:l?Object(on.jsx)(be.a,{style:{width:24,height:24},source:n(798)}):null}),Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"   "+o})]}),Object(on.jsx)(O.a,{style:{flex:2,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:""===e.class.students[r].profile_picture?n(77):{uri:h[r].profile_picture},style:Vr.thumbnailImage})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:h[r].name})})]})},t)}))})})]})]})}));function Kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kr(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qr=he.a.create({childThumbnail:{flex:1,backgroundColor:"white",marginLeft:-7},thumbnailImage:{width:140,height:140,borderRadius:70},subHeading:{width:355,height:45,marginTop:10,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),Jr=Object(A.b)((function(e){return{class:e.classInfo,wellness:e.healthstatus,unmarked:e.attendance.unmarked}}),(function(e){return Gr({},Object(k.a)({fetchClassWellnessData:$e,markPresent:Oe,sendWellnessDataSuccess:Ee,sendWellnessDataFail:Re,addWellnessRecord:ke,invalidateWellnessData:Ie},e))}))((function(e){var t=Object(D.g)(),r=Object(D.f)(),s=Object(j.useState)({isLoading:!0,date:new Date,show_record:!1,showDateTimeModal:!1}),a=ue()(s,2),i=a[0],c=a[1];Object(j.useEffect)((function(){var t=e.wellness.record_id_for_update,n=e.class.isConnected,s=null==r?void 0:r.state,a=s.date;s.teacher_name;0===t.size&&n?(c(Gr(Gr({},i),{},{date:a})),o(a)):c(Gr(Gr({},i),{},{isLoading:!1})),n||fe.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3})}),[]);var o=function t(n){var r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return r=new Date(n),bn(r),r.setDate(r.getDate()+1),bn(r),a.next=6,p.a.awrap(t("wellness",e.class.class_id));case 6:s=a.sent,l(s),e.fetchClassWellnessData(s.data),c(Gr(Gr({},i),{},{isLoading:!1}));case 10:case"end":return a.stop()}}),null,null,null,Promise)},l=function(e){if(Object.keys(e.data.records).length){var t=e.data.records;for(var n in t)e.data.records[n].time=new Date(t[n].time)}},d=function(t){for(var n=e.wellness.record_id_for_update,r=!1,s=0;s<t.length;s++)if(n.has(t[s])){r=!0;break}return r},u=e.wellness,f=u.by_student_id,h=(u.records,null==r?void 0:r.state),b=h.teacher_id,y=h.isAdmin,g=i.showDateTimeModal,O=i.date,x=i.isLoading;return Object(on.jsxs)(Hn.a,{style:{flex:1},behavior:"height",keyboardVerticalOffset:80,enabled:!0,children:[g&&Object(on.jsx)(Cr,{start_date:O,datetime_type:"date",hideModal:function(){return c({showDateTimeModal:!1})},selectDatetimeConfirm:function(e){return function(e){c(Gr(Gr({},i),{},{date:e,showDateTimeModal:!1})),o(e)}(e)},minDatetime:null,maxDatetime:new Date}),Object(on.jsxs)(fe.View,{style:{flexDirection:"row",width:"90%",justifyContent:"space-between",alignSelf:"center",alignItems:"center"},children:[Object(on.jsx)(je.a,{onPress:function(){e.wellness.data_dispatched&&y&&c({showDateTimeModal:!0})},children:Object(on.jsx)(fe.Text,{style:{fontSize:40},children:yn(O)})}),Object(on.jsx)(je.a,{disabled:x,style:{backgroundColor:x?"rgba(0,0,0,0.5)":"#dcf3d0",padding:10},onPress:function(){var n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(n=e.wellness,e.class.isConnected){s.next=5;break}return fe.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3}),s.abrupt("return");case 5:return c(Gr(Gr({},i),{},{isLoading:!0})),s.next=8,p.a.awrap(An(n,e.class.class_id,bn(new Date)));case 8:(r=s.sent).success?(r.data.forEach((function(t){e.markPresent(t,new Date)})),e.sendWellnessDataSuccess(),t(-1)):(e.sendWellnessDataFail(r.message),pe.a.alert("Err",r.message,[{text:"OK"}])),c(Gr(Gr({},i),{},{isLoading:!1}));case 11:case"end":return s.stop()}}),null,null,null,Promise)},children:Object(on.jsx)(fe.Text,{style:{fontSize:40},children:"\u9001\u51fa"})})]}),Object(on.jsx)(In.a,{contentContainerStyle:{alignItems:"center",marginBottom:20},children:Object.keys(e.class.students).map((function(t){var r=f[t];return Object(on.jsx)(fe.View,{style:{width:"98%"},children:Object(on.jsx)(fe.View,{style:{margin:10,backgroundColor:"#fefefa"},children:Object(on.jsxs)(fe.View,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(je.a,{style:Qr.childThumbnail,children:Object(on.jsx)(be.a,{source:""===e.class.students[t].profile_picture?n(77):{uri:e.class.students[t].profile_picture},style:Qr.thumbnailImage})}),Object(on.jsxs)(fe.View,{style:{flex:3},children:[Object(on.jsxs)(fe.View,{style:{flex:1,flexDirection:"row",paddingVertical:10},children:[Object(on.jsx)(fe.View,{style:{flex:1},children:Object(on.jsx)(fe.Text,{style:{fontSize:25},children:e.class.students[t].name})}),Object(on.jsx)(fe.View,{style:{flex:1,alignItems:"flex-end"},children:d(r)?Object(on.jsx)(fe.Text,{style:{color:"red",fontSize:15},children:"\u672a\u9001\u51fa"}):null})]}),r.map((function(e,n){return Object(on.jsxs)(fe.View,{style:{flex:1},children:[0===n?Object(on.jsx)(fe.Text,{children:"\u65e9\u4e0a"}):1===n?Object(on.jsx)(fe.Text,{children:"\u4e2d\u5348"}):Object(on.jsx)(fe.Text,{children:"\u4e0b\u5348"}),Object(on.jsx)(Yn,{student_id:t,record_id:e,teacher_id:b})]},e)}))]})]})})},t)}))})]})})),Xr=Object(A.b)((function(e){return{parent:e.parent}}),null)((function(e){return Object(on.jsxs)(O.a,{style:{flex:1,height:50,justifyContent:"center"},children:[Object(on.jsx)(O.a,{style:{flex:1,alignSelf:"center",position:"absolute"},children:Object(on.jsx)(x.a,{style:{fontSize:30},children:e.title})}),Object(on.jsx)(O.a,{style:{flex:1,alignSelf:"flex-end",justifyContent:"center"},children:e.headerRight})]})}));function Yr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yr(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $r=he.a.create({childThumbnail:{width:"20%",justifyContent:"center",alignItems:"center"},cardBody:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginTop:10},foodButton:{width:70,alignSelf:"center",margin:5,justifyContent:"center",backgroundColor:"#b5e9e9"},thumbnailImage:{height:130,width:130,borderRadius:65},subHeading:{width:"99%",paddingHorizontal:"4%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",zIndex:2},mealButtons:{width:"99%",marginVertical:15,flexDirection:"row",alignItems:"center",justifyContent:"center"},mealButtonText:{fontSize:30,textAlign:"center"},buttonText:{color:"grey",textAlign:"center"}}),es=Object(A.b)((function(e){return{class:e.classInfo,appetite:e.appetite}}),(function(e){return Zr({},Object(k.a)({rateAppetite:ge,clearRatings:Ce,setAllRatingsToGreat:De,setAllDrinkWater:Ae,fetchClassAppetiteData:Ze,onSendAppetiteSuccess:wt,alertErrMessage:vt,markWaterDrank:Dt,editFruitName:Ut,clearAppetiteErrorMessage:St,addStudentIdForUpdate:Ct},e))}))((function(e){var t=Object(D.f)(),r=Object(D.g)(),s=Object(j.useState)({date:new Date,isLoading:!0,mealType:"",selectedForCustomize:new Set,editingFruitType:!1,students_with_records:[],showDateTimeModal:!1,display_all_students:!0,students_to_display:new Set}),a=ue()(s,2),i=a[0],c=a[1];Object(j.useEffect)((function(){var n=null==t?void 0:t.state,r=n.date,s=(n.teacher_name,e.appetite.updatedStudents),a=e.class,l=a.isConnected,d=a.students;s.size>0||!l?c(Zr(Zr({},i),{},{students_to_display:new Set(Object.keys(d)),isLoading:!1})):(c(Zr(Zr({},i),{},{date:r,students_to_display:new Set(Object.keys(d))})),o(r)),l||fe.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3})}),[]);var o=function(t){var n,r,s,a,o,l,d;return p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=new Date(t),r=bn(n),n.setDate(n.getDate()+1),s=bn(n),u.next=6,p.a.awrap(Dn("appetite",e.class.class_id,r,s));case 6:if(void 0!==(a=u.sent).data[r]){u.next=9;break}return u.abrupt("return");case 9:o=a.data[r],l=o.fruit_name,d=o.ratings,e.fetchClassAppetiteData(l,d),c(Zr(Zr({},i),{},{isLoading:!1,students_with_records:Object.keys(d)}));case 12:case"end":return u.stop()}}),null,null,null,Promise)},l=function(n,r){if(""===i.mealType)fe.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3});else{var s=i.selectedForCustomize,a=(null==t?void 0:t.state).teacher_id;s.delete(n),c(Zr(Zr({},i),{},{selectedForCustomize:s})),e.rateAppetite(n,i.mealType,r,a)}},d=function(e){return""!==i.mealType&&("\u80c3\u53e3\u4f73"!==e&&"\u6eff\u6eff\u4e00\u7897"!==e&&"\uff17/8\u5206\u6eff"!==e&&"\u534a\u7897"!==e&&"\u80c3\u53e3\u4e0d\u4f73"!==e&&""!==e)};""!==e.appetite.err_message&&pe.a.alert("Error!",e.appetite.err_message,[{text:"OK",onPress:function(){return e.clearAppetiteErrorMessage()}}]);var u=(null==t?void 0:t.state).isAdmin,f=i.mealType,h=i.selectedForCustomize,b=i.editingFruitType,y=i.date,g=i.showDateTimeModal,m=i.display_all_students,_=i.students_to_display,w=e.class.students;return console.log("students_to_display: ",_),Object(on.jsxs)(Hn.a,{style:{flex:1,backgroundColor:"Breakfast"===f?"#ffe1d0":"Fruit"===f?"#ffddb7":"Lunch"===f?"#fff1b5":"Snack"===f?"#dcf3d0":"transparent"},behavior:"height",keyboardVerticalOffset:80,enabled:!0,children:[g&&Object(on.jsx)(Cr,{start_date:y,datetime_type:"date",hideModal:function(){return c(Zr(Zr({},i),{},{showDateTimeModal:!1}))},selectDatetimeConfirm:function(e){return function(e){c(Zr(Zr({},i),{},{date:e,showDateTimeModal:!1})),o(e)}(e)},minDatetime:null,maxDatetime:new Date}),Object(on.jsxs)(O.a,{style:$r.subHeading,children:[Object(on.jsx)(je.a,{onPress:function(){e.appetite.data_dispatched&&u&&c(Zr(Zr({},i),{},{showDateTimeModal:!0}))},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:yn(y)})}),Object(on.jsx)(je.a,{style:{backgroundColor:"#b5e9e9",padding:10},onPress:function(){var n=(null==t?void 0:t.state).teacher_id,r=i.students_to_display;""===i.mealType?fe.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):e.setAllRatingsToGreat(i.mealType,I()(r),n)},children:Object(on.jsx)(x.a,{style:{color:"grey",fontSize:40},children:"\u5168\u80c3\u53e3\u4f73"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"#b5e9e9",padding:10},onPress:function(){var n=(null==t?void 0:t.state).teacher_id,r=i.students_to_display;""===i.mealType?fe.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):e.setAllDrinkWater(i.mealType,I()(r),n)},children:Object(on.jsx)(x.a,{style:{color:"grey",fontSize:40},children:"\u5168\u559d\u6c34"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:function(){var t=e.class.isConnected,n=e.appetite,s=n.updatedStudents,a=n.fruit_name,i=[],c=e.appetite.ratings;if(0===s.size&&r(-1),t){s.forEach((function(e){var t=c[e],n={student_id:e,b_rating:t.Breakfast,f_rating:t.Fruit,l_rating:t.Lunch,s_rating:t.Snack,teacher_id:t.teacher_id};i.push(n)}));var o={date:bn(new Date),fruit_name:a,obj:i};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/appetite",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,s=t.message;n>200||"Internal Server Error"===s?e.alertErrMessage(s):(e.onSendAppetiteSuccess(),r(-1))})).catch((function(t){e.alertErrMessage(t)}))}else fe.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3})},children:Object(on.jsx)(x.a,{style:{color:"grey",fontSize:40},children:"\u9001\u51fa"})})]}),Object(on.jsxs)(O.a,{style:$r.mealButtons,children:[Object(on.jsx)(je.a,{style:{backgroundColor:"Breakfast"===f?"#fa625f":"#ffe1d0",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#fa625f",onPress:function(){return c(Zr(Zr({},i),{},{mealType:"Breakfast",editingFruitType:!1}))},children:Object(on.jsx)(x.a,{style:$r.mealButtonText,children:"\u65e9\u9910"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"Fruit"===f?"#ff8944":"#ffddb7",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%"},underlayColor:"#ff8944",onPress:function(){return c(Zr(Zr({},i),{},{mealType:"Fruit"}))},onLongPress:function(){return c(Zr(Zr({},i),{},{mealType:"Fruit",editingFruitType:!0}))},children:b?Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(x.a,{style:{paddingLeft:5},children:"\u6c34\u679c:"}),Object(on.jsx)(Vn.a,{autoFocus:!0,selectTextOnFocus:!0,style:{width:"95%",alignSelf:"center",fontSize:25,textAlign:"center",color:"grey",borderWidth:1},onChangeText:function(t){return function(t){e.editFruitName(t)}(t)},value:e.appetite.fruit_name,onBlur:function(){return function(){var t=i.students_with_records;c(Zr(Zr({},i),{},{editingFruitType:!1})),""===e.appetite.fruit_name&&e.editFruitName("\u6c34\u679c"),t.length>1&&e.addStudentIdForUpdate(t)}()}})]}):Object(on.jsx)(x.a,{style:$r.mealButtonText,children:e.appetite.fruit_name})}),Object(on.jsx)(je.a,{style:{backgroundColor:"Lunch"===f?"#f4d41f":"#fff1b5",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#f4d41f",onPress:function(){return c(Zr(Zr({},i),{},{mealType:"Lunch",editingFruitType:!1}))},children:Object(on.jsx)(x.a,{style:$r.mealButtonText,children:"\u5348\u9910"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"Snack"===f?"#00c07f":"#dcf3d0",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#00c07f",onPress:function(){return c(Zr(Zr({},i),{},{mealType:"Snack",editingFruitType:!1}))},children:Object(on.jsx)(x.a,{style:$r.mealButtonText,children:"\u9ede\u5fc3"})})]}),Object(on.jsxs)(O.a,{style:{width:"98%",flexDirection:"row",flexWrap:"wrap",alignSelf:"center",justifyContent:"space-evenly"},children:[Object(on.jsx)(je.a,{style:{padding:5,backgroundColor:m?"#b5e9e9":"rgba(255,255,255,0.8)",marginRight:3},onPress:function(){c(Zr(Zr({},i),{},{display_all_students:!0,students_to_display:new Set(Object.keys(w))}))},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u5168\u73ed"})}),Object.keys(w).map((function(e){return Object(on.jsx)(je.a,{style:{padding:5,backgroundColor:_.has(e)&&!m?"#b5e9e9":"rgba(255,255,255,0.8)",marginRight:3},onPress:function(){return function(e){var t=i.display_all_students,n=i.students_to_display;if(t)c(Zr(Zr({},i),{},{students_to_display:new Set([e]),display_all_students:!1}));else if(n.has(e)){var r=new Set(I()(n));r.delete(e),c(Zr(Zr({},i),{},{students_to_display:r}))}else{var s=new Set(I()(n));s.add(e),c(Zr(Zr({},i),{},{students_to_display:s}))}}(e)},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:w[e].name})},e)}))]}),Object(on.jsx)(fe.Content,{contentContainerStyle:{alignItems:"center"},children:I()(_).reverse().map((function(r){var s=""===f?"":e.appetite.ratings[r][f].slice(0,-1),a=""!==f&&"1"===e.appetite.ratings[r][f].slice(-1);return Object(on.jsx)(O.a,{style:{width:"98%"},children:Object(on.jsx)(fe.Card,{children:Object(on.jsxs)(fe.CardItem,{children:[Object(on.jsx)(O.a,{style:$r.childThumbnail,children:Object(on.jsx)(be.a,{source:""===e.class.students[r].profile_picture?n(77):{uri:e.class.students[r].profile_picture},style:$r.thumbnailImage})}),Object(on.jsx)(O.a,{style:{width:"80%"},children:Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:30,paddingLeft:18,alignSelf:"center"},children:e.class.students[r].name})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:{width:"80%",borderWidth:2,borderColor:"#368cbf",padding:10,justifyContent:"center",backgroundColor:a?"#368cbf":"white"},onPress:function(){return function(n){var r=(null==t?void 0:t.state).teacher_id;""===i.mealType?fe.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):e.markWaterDrank(n,i.mealType,r)}(r)},children:Object(on.jsx)(x.a,{style:{textAlign:"center",color:a?"#D3D3D3":"grey",fontSize:17},children:"\u6709\u559d\u6c34"})})}),Object(on.jsx)(O.a,{style:{flex:2,alignItems:"flex-end"},children:e.appetite.updatedStudents.has(r)?Object(on.jsx)(x.a,{style:{color:"red",fontSize:15},children:"\u672a\u9001\u51fa"}):null})]}),Object(on.jsxs)(O.a,{style:$r.cardBody,children:[Object(on.jsx)(je.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\u80c3\u53e3\u4f73"===s?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return l(r,"\u80c3\u53e3\u4f73")},children:Object(on.jsx)(x.a,{style:{textAlign:"center",color:"\u80c3\u53e3\u4f73"===s?"#D3D3D3":"grey",fontSize:20},children:"\u80c3\u53e3\u4f73"})}),Object(on.jsx)(je.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\u6eff\u6eff\u4e00\u7897"===s?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return l(r,"\u6eff\u6eff\u4e00\u7897")},children:Object(on.jsx)(x.a,{style:{textAlign:"center",color:"\u6eff\u6eff\u4e00\u7897"===s?"#D3D3D3":"grey",fontSize:20},children:"\u6eff\u6eff\u4e00\u7897"})}),Object(on.jsx)(je.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\uff17/8\u5206\u6eff"===s?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return l(r,"\uff17/8\u5206\u6eff")},children:Object(on.jsx)(x.a,{style:{textAlign:"center",color:"\uff17/8\u5206\u6eff"===s?"#D3D3D3":"grey",fontSize:20},children:"\uff17/8\u5206\u6eff"})})]}),Object(on.jsxs)(O.a,{style:$r.cardBody,children:[Object(on.jsx)(je.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\u534a\u7897"===s?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return l(r,"\u534a\u7897")},children:Object(on.jsx)(x.a,{style:{textAlign:"center",color:"\u534a\u7897"===s?"#D3D3D3":"grey",fontSize:20},children:"\u534a\u7897"})}),Object(on.jsx)(je.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\u80c3\u53e3\u4e0d\u4f73"===s?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return l(r,"\u80c3\u53e3\u4e0d\u4f73")},children:Object(on.jsx)(x.a,{style:{textAlign:"center",color:"\u80c3\u53e3\u4e0d\u4f73"===s?"#D3D3D3":"grey",fontSize:20},children:"\u80c3\u53e3\u4e0d\u4f73"})}),Object(on.jsx)(je.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:d(s)||h.has(r)?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return function(n){var r=i.mealType,s=i.selectedForCustomize,a=(null==t?void 0:t.state).teacher_id;""===r?fe.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):(c(Zr(Zr({},i),{},{selectedForCustomize:new Set([].concat(I()(s),[n]))})),e.rateAppetite(n,i.mealType,"",a))}(r)},children:d(s)||h.has(r)?Object(on.jsx)(Vn.a,{style:{textAlign:"center",color:"#D3D3D3",fontSize:20},maxLength:6,autoFocus:""===s,onChangeText:function(n){return function(n,r){var s=(null==t?void 0:t.state).teacher_id;e.rateAppetite(n,i.mealType,r,s)}(r,n)},value:s,onBlur:function(){return function(e){var t=i.selectedForCustomize;t.delete(e),c(Zr(Zr({},i),{},{selectedForCustomize:t}))}(r)}}):Object(on.jsx)(x.a,{style:{textAlign:"center",color:d(s)||h.has(r)?"#D3D3D3":"grey",fontSize:20},children:"Other"})})]})]})})]})})},r)}))})]})}));function ts(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ns(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rs=he.a.create({thumbnail:{},subHeading:{flexDirection:"row",alignItems:"center"},cardBody:{flex:1,flexDirection:"row",marginVertical:6}}),ss=Object(A.b)((function(e){return{class:e.classInfo,sleep:e.sleep}}),(function(e){return ns({},Object(k.a)({setSleepTime:ze,setWakeTime:Fe,fetchClassSleepData:et,clearPendingSleepUpdate:tt,createSleepRecordSuccess:lt,createSleepRecordFail:dt,editSleepRecordSuccess:ut,editSleepRecordFail:ft,removeSleepRecord:Le,removeSleepRecordSuccess:Be,removeSleepRecordFail:Me,alertSleeplogErrorMessage:Nt,clearSleeplogErrorMessage:qt,removeWakeTime:Ne,markRecordError:sn,markRecordCorrect:an},e))}))((function(e){var t=Object(D.f)(),r=Object(j.useState)({isLoading:!0,date:new Date,showIOSDatePicker:!1,student_id:"",index:-1,recordType:"",teacher_id:"",confirmDelete:!1,showDateTimeModal:!1}),s=ue()(r,2),a=s[0],i=s[1];Object(j.useEffect)((function(){var n=e.sleep,r=n.newDataForCreate,s=n.oldDataForEdit,o=e.class.isConnected,l=null==t?void 0:t.state,d=l.teacher_id,u=l.date;l.teacher_name;i(ns(ns({},a),{},{teacher_id:d})),r.size+s.size===0&&o?c(u):i(ns(ns({},a),{},{isLoading:!1})),o||fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}),[]);var c=function(t){var n,r,s,c;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return n=new Date(t),r=bn(n),n.setDate(n.getDate()+1),s=bn(n),l.next=6,p.a.awrap(Dn("sleep",e.class.class_id,r,s));case 6:c=l.sent,o(c),e.fetchClassSleepData(c.data),i(ns(ns({},a),{},{isLoading:!1}));case 10:case"end":return l.stop()}}),null,null,null,Promise)},o=function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].sleep_time=new Date(t[n].sleep_time),t[n].wake_time=null===t[n].wake_time?null:new Date(t[n].wake_time);e.data.records.by_id=t}},l=function(t){for(var n=e.sleep,r=n.newDataForCreate,s=n.oldDataForEdit,a=n.by_student_id[t],i=!1,c=0;c<a.length;c++)if(r.has(a[c])||s.has(a[c])){i=!0;break}return i},d=function(t,n,r){var s=r.length,a=r[r.length-1],i=n[a];if(null!==i.wake_time&&i.sleep_time.getTime()>=i.wake_time.getTime()&&e.markRecordError([a]),s>1){var c=n[r[r.length-2]];i.sleep_time>=c.sleep_time&&i.sleep_time<=c.wake_time&&e.markRecordError([a])}},u=function(e,t,n,r){i(ns(ns({},a),{},{student_id:t,index:n,recordType:e,showDateTimeModal:!0,start_time:r||new Date}))},f=function t(n,r){var s=e.sleep.by_student_id[n],a=e.sleep.records.by_id,i=s[r],c=a[i],o=e.sleep.records_with_error,l=null,d=null;if(!(r<0||r>s.length-1))if(null!==c.wake_time&&c.sleep_time.getTime()>=c.wake_time.getTime())e.markRecordError([i]);else{if(r>0){var u=a[l=s[r-1]];if(null!==u.wake_time&&c.sleep_time.getTime()<=u.wake_time.getTime())return void e.markRecordError([i])}if(r<s.length-1){var f=a[d=s[r+1]];if(c.wake_time>=f.sleep_time)return void e.markRecordError([i])}e.markRecordCorrect(i),null!==l&&o.has(l)&&t(n,r-1),null!==d&&o.has(d)&&t(n,r+1)}},h=function(){var t,n,r,s,i,c;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.sleep,n=t.newDataForCreate,r=t.records,s=[],n.forEach((function(e){s.push(ns({},r.by_id[e]))})),g(s),i={date:bn(a.date),data_objs:s},o.next=7,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){return e.statusCode>200?{success:!1,status_code:e.statusCode,data:e.message}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return c=o.sent,o.abrupt("return",c);case 9:case"end":return o.stop()}}),null,null,null,Promise)},b=function(){var t,n,r,s,a,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.sleep,n=t.oldDataForEdit,r=t.records,s=[],n.forEach((function(e){s.push(ns({record_id:e},r.by_id[e]))})),g(s),a={date:bn(new Date),data_objs:s},c.next=7,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){return e.statusCode>200?{success:!1,status_code:e.statusCode,data:e.message}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=c.sent,c.abrupt("return",i);case 9:case"end":return c.stop()}}),null,null,null,Promise)},y=function(t,n){var r=e.sleep.newDataForCreate,s=e.class.isConnected;if(r.has(t))e.removeSleepRecordSuccess(t,n);else if(s){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({record_id:t})}).then((function(e){return e.json()})).then((function(r){var s=r.statusCode,a=r.message;return s>200||"Internal Server Error"===a?(e.removeSleepRecordFail(a),{success:!1,statusCode:s,message:a}):(e.removeSleepRecordSuccess(t,n),{success:!0,statusCode:s,message:a})})).catch((function(t){return e.removeSleepRecordFail(t),{success:!1,message:t}}))}else fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})},g=function(e){for(var t=0;t<e.length;t++)e[t].sleep_time=On(e[t].sleep_time),e[t].wake_time=null===e[t].wake_time?null:On(e[t].wake_time)};""!==e.sleep.errorMessage&&pe.a.alert("Add new record fail",e.sleep.errorMessage,[{text:"OK",onPress:function(){return e.clearSleeplogErrorMessage()}}]);var O=e.sleep.records_with_error,x=a.showDateTimeModal,m=a.start_time,_=a.date;return a.isLoading?Object(on.jsx)(Fn,{}):Object(on.jsxs)(fe.Container,{children:[x?Object(on.jsx)(Cr,{start_date:m,datetime_type:"time",hideModal:function(){return i(ns(ns({},a),{},{showDateTimeModal:!1}))},selectDatetimeConfirm:function(t){return function(t,n){i(ns(ns({},a),{},{showDateTimeModal:!1})),"sleep"===a.recordType?e.setSleepTime(a.student_id,t,n,a.teacher_id):e.setWakeTime(a.student_id,t,n,a.teacher_id),f(a.student_id,t)}(a.index,t)},minDatetime:null,maxDatetime:null}):null,Object(on.jsxs)(fe.View,{style:rs.subHeading,children:[Object(on.jsx)(fe.View,{style:{flex:1,alignItems:"center"},children:Object(on.jsx)(fe.Text,{style:{fontSize:40},children:_.getFullYear()+"."+(_.getMonth()+1)+"."+_.getDate()})}),Object(on.jsx)(fe.View,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(je.a,{style:{alignSelf:"flex-end",backgroundColor:"#dcf3d0",padding:10,marginRight:50},onPress:function(){var t,n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(e.class.isConnected){s.next=4;break}return fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),s.abrupt("return");case 4:if(i(ns(ns({},a),{},{isLoading:!0})),t=e.sleep,n=t.newDataForCreate,r=t.oldDataForEdit,!n.size){s.next=16;break}return s.next=9,p.a.awrap(h());case 9:if(!s.sent.success){s.next=14;break}e.createSleepRecordSuccess(),s.next=16;break;case 14:return e.createSleepRecordFail(),s.abrupt("return");case 16:if(!r.size){s.next=26;break}return s.next=19,p.a.awrap(b());case 19:if(!s.sent.success){s.next=24;break}e.editSleepRecordSuccess(),s.next=26;break;case 24:return e.editSleepRecordFail(),s.abrupt("return");case 26:e.navigation.goBack();case 27:case"end":return s.stop()}}),null,null,null,Promise)},underlayColor:"#00c07f",children:Object(on.jsx)(fe.Text,{style:{fontSize:40,color:"grey"},children:"\u9001\u51fa"})})})]}),Object(on.jsx)(fe.Content,{contentContainerStyle:{alignItems:"center"},children:Object.keys(e.class.students).map((function(t){var r=e.sleep.by_student_id[t],s=e.sleep.records.by_id,i=r.length>0?s[r[r.length-1]]:null,c=i?i.sleep_time:null,o=i?i.wake_time:null;return Object(on.jsx)(fe.View,{style:{width:"98%"},children:Object(on.jsx)(fe.Card,{style:{flex:1,paddingVertical:15},children:Object(on.jsxs)(fe.View,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(fe.View,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:rs.thumbnail,onPress:function(){return function(t){var n=e.sleep.by_student_id[t],r=e.sleep.records.by_id,s=n.length>0?r[n[n.length-1]]:null,i=s?s.wake_time:null;!n.length||i?e.setSleepTime(t,null,new Date,a.teacher_id):e.setWakeTime(t,n.length-1,new Date,a.teacher_id),d(t,r,n)}(t)},children:Object(on.jsx)(be.a,{source:""===e.class.students[t].profile_picture?n(77):{uri:e.class.students[t].profile_picture},style:{width:140,height:140,borderRadius:70,borderWidth:8,borderColor:null!==c&&null===o?"#ffe1d0":"#dcf3d0"}})},t)}),Object(on.jsxs)(fe.View,{style:{flex:3},children:[Object(on.jsxs)(fe.View,{style:{flex:1,flexDirection:"row",padding:10},children:[Object(on.jsx)(fe.View,{style:{flex:1},children:Object(on.jsx)(fe.Text,{style:{fontSize:30},children:e.class.students[t].name})}),Object(on.jsx)(fe.View,{style:{flex:1,alignItems:"flex-end"},children:l(t)?Object(on.jsx)(fe.Text,{style:{color:"red",fontSize:15},children:"\u672a\u9001\u51fa"}):null})]}),Object(on.jsxs)(fe.View,{style:rs.cardBody,children:[Object(on.jsx)(fe.View,{style:{width:"40%",height:"100%",paddingLeft:5},children:Object(on.jsx)(fe.Text,{style:{fontSize:20},children:"\u5f9e"})}),Object(on.jsx)(fe.View,{style:{width:"40%",height:"100%",paddingLeft:5},children:Object(on.jsx)(fe.Text,{style:{fontSize:20},children:"\u5230"})})]}),r.map((function(n,r){var i=s[n],c=i.sleep_time,o=i.wake_time;return Object(on.jsxs)(fe.View,{style:{flex:1,flexDirection:"row",marginVertical:6,borderWidth:2,borderColor:O.has(n)?"red":"white"},children:[Object(on.jsx)(fe.View,{style:{width:"35%",marginRight:"3%",height:"100%"},children:Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return u("sleep",t,r,c)},children:null===c?Object(on.jsx)(fe.Text,{style:{fontSize:30,textAlign:"center"},children:"\u9078\u64c7\u6642\u9593"}):Object(on.jsx)(fe.Text,{style:{fontSize:35,textAlign:"center"},children:c.getHours()+":"+c.getMinutes()})})}),Object(on.jsx)(fe.View,{style:{width:"35%",marginRight:"3%",height:"100%"},children:Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return u("wake",t,r,o)},onLongPress:function(){return function(t,n,r){n===e.sleep.by_student_id[r].length-1?pe.a.alert("\u78ba\u5b9a\u8981\u522a\u9664?","",[{text:"Yes",onPress:function(){return e.removeWakeTime(t,a.teacher_id)}},{text:"Cancel",style:"cancel"}]):e.alertSleeplogErrorMessage("\u9019\u500b\u7761\u7720\u8a18\u9304\u4e26\u4e0d\u80fd\u522a\u9664\uff0c\u53ea\u80fd\u6539\u9078")}(n,r,t)},children:null===o?Object(on.jsx)(fe.Text,{style:{fontSize:30,textAlign:"center"},children:"\u9078\u64c7\u6642\u9593"}):Object(on.jsx)(fe.Text,{style:{fontSize:35,textAlign:"center"},children:o.getHours()+":"+o.getMinutes()})})}),Object(on.jsx)(fe.View,{style:{width:"20%",marginRight:"4%",height:"100%"},children:Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return function(e,t){pe.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"Yes",onPress:function(){return y(e,t)}},{text:"Cancel",style:"cancel"}])}(n,t)},children:Object(on.jsx)(fe.Text,{style:{fontSize:30,textAlign:"center"},children:"\u79fb\u9664"})})})]},n)}))]})]})})},t)}))})]})}));function as(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function is(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?as(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):as(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var os=function(e){o()(r,e);var t=cs(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={isLoading:!0,date:new Date,showDateTimeModal:!1,record_id:""},n.handleSend=n.handleSend.bind(g()(n)),n.handleOnAddRecord=n.handleOnAddRecord.bind(g()(n)),n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props.class.isConnected,t=this.props.route.params,n=t.date,r=t.teacher_name;!this.props.milk.loaded&&e?this.fetchClassData(n):this.setState({isLoading:!1}),e||fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),this.props.navigation.setOptions({title:"\u9935\u5976 - "+r})}},{key:"checkUnsent",value:function(e){for(var t=this.props.milk,n=t.newDataForCreate,r=t.oldDataForEdit,s=(t.dataForRemoval,t.by_student_id[e]),a=!1,i=0;i<s.length;i++){var c=s[i];if(n.has(c)||r.has(c)){a=!0;break}}return a}},{key:"fetchClassData",value:function(e){var t,n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.props.class.isConnected){a.next=4;break}return fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),a.abrupt("return");case 4:return this.props.navigation.setOptions({headerRight:function(){return Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#f4d41f",marginRight:20}})}}),t=new Date(e),n=bn(t),t.setDate(t.getDate()+1),r=bn(t),a.next=11,p.a.awrap(Dn("milkintake",this.props.class.class_id,n,r));case 11:s=a.sent,this.denormalize(s),this.props.fetchClassMilkData(s.data),this.setState({isLoading:!1}),this.props.navigation.setOptions({headerRight:function(){return Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}});case 16:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].time=new Date(t[n].time)}}},{key:"handleEditMilkAmout",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.editMilkAmount(e,t,n)}},{key:"handleOnAddRecord",value:function(e){this.props.addMilkRecord(e)}},{key:"confirmToRemoveRecord",value:function(e,t,n){var r=this;pe.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"Yes",onPress:function(){return r.handleRemoveRecord(e,t,n)}},{text:"Cancel",style:"cancel"}])}},{key:"handleRemoveRecord",value:function(e,t,n){this.props.class.isConnected?(this.props.removeRecord(e,t,n),this.handleRemove(t,e)):fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"handleSend",value:function(){var e,t,n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(e=this.props.milk,t=e.newDataForCreate,n=e.oldDataForEdit,e.dataForRemoval,this.props.class.isConnected){a.next=5;break}return fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),a.abrupt("return");case 5:if(!t.size){a.next=15;break}return a.next=8,p.a.awrap(this.handleCreate());case 8:if(!(r=a.sent).success){a.next=13;break}this.props.createDataSuccess(),a.next=15;break;case 13:return this.props.createDataFail(r.data),a.abrupt("return");case 15:if(!n.size){a.next=25;break}return a.next=18,p.a.awrap(this.handleEdit());case 18:if(!(s=a.sent).success){a.next=23;break}this.props.editDataSuccess(),a.next=25;break;case 23:return this.props.editDataFail(s.data),a.abrupt("return");case 25:this.props.navigation.goBack();case 26:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"handleCreate",value:function(){var e,t,n,r,s,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.props.milk,t=e.newDataForCreate,n=e.records,r=[],t.forEach((function(e){r.push(is({},n.by_id[e]))})),this.normalize(r),s={date:bn(new Date),data_objs:r},i.next=7,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.errMessage,r=e.message;return t>200?{success:!1,status_code:t,data:n||r}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return a=i.sent,i.abrupt("return",a);case 9:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"handleEdit",value:function(){var e,t,n,r,s,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.props.milk,t=e.oldDataForEdit,n=e.records,r=[],t.forEach((function(e){r.push(is({record_id:e},n.by_id[e]))})),this.normalize(r),s={date:bn(new Date),data_objs:r},i.next=7,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message;return t>200?{success:!1,status_code:t,data:n}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return a=i.sent,i.abrupt("return",a);case 9:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"handleRemove",value:function(e,t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.props.milk.dataForRemoval.has(e)){r.next=3;break}return r.abrupt("return");case 3:return n={record_id_array:e,student_id:t},"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",r.next=7,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message;return t>200?{success:!1,status_code:t,data:n}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:r.sent.success?this.props.removeMilkRecordSuccess():this.props.removeMilkRecordFail();case 9:case"end":return r.stop()}}),null,this,null,Promise)}},{key:"normalize",value:function(e){for(var t=0;t<e.length;t++)e[t].time=On(e[t].time)}},{key:"selectDatetimeConfirm",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.record_id;this.setState({record_id:"",showDateTimeModal:!1}),this.props.editMilkTime(n,e,t)}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return Object(on.jsx)(Fn,{});var t=this.state,r=t.date,s=t.showDateTimeModal;return Object(on.jsxs)(fe.Container,{children:[s?Object(on.jsx)(Cr,{start_date:r,datetime_type:"time",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:null}):null,Object(on.jsxs)(O.a,{style:ls.subHeading,children:[Object(on.jsx)(x.a,{style:{fontSize:40},children:r.getFullYear()+"."+(r.getMonth()+1)+"."+r.getDate()}),Object(on.jsx)(je.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend,children:Object(on.jsx)(x.a,{style:{fontSize:40,color:"grey"},children:"\u9001\u51fa"})})]}),Object(on.jsx)(fe.Content,{contentContainerStyle:{alignItems:"center"},children:Object.keys(this.props.class.students).map((function(t){var r=e.props.milk.by_student_id[t],s=e.props.milk.records.by_id;return Object(on.jsx)(O.a,{style:{width:"98%"},children:Object(on.jsx)(fe.Card,{style:{flex:1,paddingVertical:15},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:ls.childThumbnail,onPress:function(){return e.handleOnAddRecord(t)},underlayColor:"transparent",children:Object(on.jsx)(be.a,{source:""===e.props.class.students[t].profile_picture?n(77):{uri:e.props.class.students[t].profile_picture},style:ls.thumbnailImage})})}),Object(on.jsxs)(O.a,{style:{flex:3},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:30,paddingLeft:18},children:e.props.class.students[t].name})}),Object(on.jsx)(O.a,{style:{flex:1,paddingRight:15},children:e.checkUnsent(t)?Object(on.jsx)(x.a,{style:{fontSize:15,paddingLeft:18,alignSelf:"flex-end",color:"red"},children:"\u672a\u9001\u51fa"}):null})]}),r.map((function(n,r){var a=s[n];return Object(on.jsxs)(O.a,{style:ls.cardBody,children:[Object(on.jsx)(O.a,{style:{width:"35%",marginRight:"3%",height:"100%"},children:Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setState({showDateTimeModal:!0,record_id:n})},children:Object(on.jsx)(x.a,{style:{fontSize:35,textAlign:"center"},children:a.time.getHours()+":"+a.time.getMinutes()})})}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",width:"35%",marginRight:"3%",alignItems:"center",justifyContent:"center",backgroundColor:"#fef6dd",height:"100%",borderRadius:10},children:[Object(on.jsx)(Vn.a,{style:{flex:2,fontSize:35,textAlign:"center"},keyboardType:"decimal-pad",placeholder:"\u2f64\u91cf",value:""+a.amount,onChangeText:function(t){e.handleEditMilkAmout(n,t)}}),Object(on.jsx)(x.a,{style:{flex:1,fontSize:30,textAlign:"center"},children:"c.c."})]}),Object(on.jsx)(O.a,{style:{width:"20%",marginRight:"4%",height:"100%"},children:Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return e.confirmToRemoveRecord(t,n,r)},children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:"\u79fb\u9664"})})})]},n)}))]})]})})},t)}))})]})}}]),r}(b.a.Component),ls=he.a.create({childThumbnail:{},thumbnailImage:{width:140,height:140,borderRadius:70},subHeading:{width:"90%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",alignSelf:"center"},cardBody:{flexDirection:"row",marginVertical:6}}),ds=(Object(A.b)((function(e){return{class:e.classInfo,milk:e.milk}}),(function(e){return is({},Object(k.a)({editMilkAmount:qe,addMilkRecord:Ye,fetchClassMilkData:nt,createDataSuccess:rt,createDataFail:st,editDataSuccess:at,editDataFail:it,removeRecord:xt,removeMilkRecordSuccess:ct,removeMilkRecordFail:ot,editMilkTime:Ue},e))}))(os),n(360));function us(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}!function(e){o()(n,e);var t=us(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={other_option:"\u5176\u4ed6"},r}i()(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({other_option:"\u5176\u4ed6"},(function(){console.log("mounted",e.refs.textRef.isFocused())}))}},{key:"onBlur",value:function(e){console.log("onBlur"),this.setState({other_option:""}),this.props.editPooCondition(e)}},{key:"render",value:function(){var e=this,t=this.state.other_option;return console.log("other_option ===: ","\u5176\u4ed6"===t),Object(on.jsx)(Vn.a,{ref:"textRef",autoFocus:"\u5176\u4ed6"===t,selectTextOnFocus:!0,style:{fontSize:30,textAlign:"center"},value:t,onChangeText:function(t){return e.setState({other_option:t})},onEndEditing:function(){return e.props.editPooCondition(t)},onBlur:function(){return e.onBlur(t)}})}}])}(b.a.Component);function fs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var ps=function(e){o()(n,e);var t=hs(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={selected_other:!1,other_option:""},r}return i()(n,[{key:"componentDidMount",value:function(){}},{key:"editPooCondition",value:function(e,t){var n=this.props.teacher_id;"\u53d6\u6d88\u7de8\u8f2f"!==t&&("\u5176\u4ed6"===t?this.setState({selected_other:!0,other_option:" "}):(console.log("editPooCondition: ",e,t,n),this.setState({selected_other:!1,other_option:t}),this.props.editPooCondition(e,t,n)))}},{key:"render",value:function(){var e=this,t=this.props,n=t.record_id,r=t.record,s=this.state,a=s.selected_other,i=s.other_option;return Object(on.jsx)(O.a,{style:{width:"23%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},children:a?Object(on.jsx)(Vn.a,{style:{fontSize:30,textAlign:"center"},keyboardType:"default",autoFocus:a,selectTextOnFocus:!0,value:i,onChangeText:function(t){return e.setState({other_option:t})},onBlur:function(){return e.editPooCondition(n,i)}}):Object(on.jsx)(Gn,{style:{alignItems:"center",padding:5},selectedValue:i||r.poo_condition,options:["\u6b63\u5e38","\u786c","\u8edf\u7cca","\u7a00\u6c34","\u5176\u4ed6","\u53d6\u6d88\u7de8\u8f2f"],textStyle:{fontSize:30},handleOnClick:function(){},handleSelectValue:function(t){return e.editPooCondition(n,t)}})})}}]),n}(b.a.Component),js=Object(A.b)((function(e){return{diaper_records:e.diaper,class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fs(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({editPooCondition:Ge},e))}))(ps);function bs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ys(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bs(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Os=function(e){o()(r,e);var t=gs(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={isLoading:!0,date:new Date,other_option:"",show_time_picker:!1,record_id_for_edit:"",cloth_diaper:!1,record_id:""},n.handleSend=n.handleSend.bind(g()(n)),n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.date,n=e.teacher_name,r=this.props.diaper_records,s=r.new_data_for_create,a=r.old_data_for_edit,i=this.props.class.isConnected;s.size+a.size===0&&i?this.fetchClassData(t):this.setState({isLoading:!1}),i||fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),this.props.navigation.setOptions({title:"\u5982\u5ec1 - "+n})}},{key:"checkUnsent",value:function(e){for(var t=this.props.diaper_records,n=t.new_data_for_create,r=t.old_data_for_edit,s=t.by_student_id[e].records,a=!1,i=0;i<s.length;i++)if(n.has(s[i])||r.has(s[i])){a=!0;break}return a}},{key:"fetchClassData",value:function(e){var t,n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.props.class.isConnected){a.next=4;break}return fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),a.abrupt("return");case 4:return this.props.navigation.setOptions({headerRight:function(){return Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#f4d41f",marginRight:20}})}}),t=new Date(e),n=bn(t),t.setDate(t.getDate()+1),r=bn(t),a.next=11,p.a.awrap(Dn("diaper",this.props.class.class_id,n,r));case 11:s=a.sent,this.denormalize(s),this.props.fetchClassDiaperData(s.data),this.setState({isLoading:!1}),this.props.navigation.setOptions({headerRight:function(){return Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}});case 16:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].time=new Date(t[n].time)}}},{key:"handleUpdateDiaperAmount",value:function(e,t){this.props.updateDiaperAmount(e,t)}},{key:"addDiaperRecord",value:function(e){var t=this.props.route.params.teacher_id;this.props.addDiaperRecord(e,new Date,this.state.cloth_diaper,t)}},{key:"setTime",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.record_id_for_edit;void 0!==e?(this.setState({show_time_picker:!1,record_id_for_edit:""}),this.props.editDiaperTime(n,e,t)):this.setState({show_time_picker:!1,record_id_for_edit:""})}},{key:"switchPeeOrPoo",value:function(e){var t=this.props.route.params.teacher_id;this.props.switchPeeOrPoo(e,t)}},{key:"editPooCondition",value:function(e,t){var n=this.props.route.params.teacher_id;"\u53d6\u6d88\u7de8\u8f2f"!==t&&("\u5176\u4ed6"===t?this.setState({record_id:e,other_option:"Please Fill Out"}):(this.setState({other_option:""}),this.props.editPooCondition(e,t,n)))}},{key:"confirmRemove",value:function(e,t){var n=this;pe.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"OK",onPress:function(){return n.removeDiaperRecord(e,t)}},{text:"Cancel",style:"cancel"}])}},{key:"removeDiaperRecord",value:function(e,t){var n=this,r=this.props.diaper_records.new_data_for_create,s=this.props.class.isConnected;if(r.has(t))this.props.removeDiaperRecordSuccess(e,t);else if(s){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({record_id:t})}).then((function(e){return e.json()})).then((function(r){var s=r.statusCode,a=r.message;(s>200||"Internal Server Error"===a)&&n.props.removeDiaperRecordFail(a),n.props.removeDiaperRecordSuccess(e,t)})).catch((function(e){n.props.removeDiaperRecordFail(e)}))}else fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"handleSend",value:function(){var e,t,n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(e=this.props.diaper_records,t=e.new_data_for_create,n=e.old_data_for_edit,this.props.class.isConnected){s.next=5;break}return fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),s.abrupt("return");case 5:if(!t.size&&!n.size){s.next=15;break}return s.next=8,p.a.awrap(this.createRecords());case 8:if(!(r=s.sent).success){s.next=13;break}this.props.createDiaperRecordSuccess(),s.next=15;break;case 13:return this.props.createDiaperRecordFail(r.data),s.abrupt("return");case 15:this.props.navigation.goBack();case 16:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"sendDiaperAmountData",value:function(){var e,t=this;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.props.class.isConnected){n.next=4;break}return fe.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),n.abrupt("return");case 4:return"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",n.next=7,p.a.awrap(Promise.all(Array.from(this.props.diaper_records.students_pending_amount_update).map((function(e){return fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/"+e,{method:"PUT",body:JSON.stringify({amount:t.props.diaper_records.by_student_id[e].amount}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){throw e}))}))).then((function(e){return{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,err_message:"error occured while sending diaper amount data: "+e}})));case 7:return e=n.sent,n.abrupt("return",e);case 9:case"end":return n.stop()}}),null,this,null,Promise)}},{key:"createRecords",value:function(){var e,t,n,r,s,a,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.diaper_records,t=e.new_data_for_create,n=e.old_data_for_edit,r=e.records,s=[],[].concat(I()(t),I()(n)).forEach((function(e){s.push(ys({},r.by_id[e]))})),this.normalize(s),a={date:bn(new Date),data_objs:s},"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",c.next=9,p.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(e){return 200===e.statusCode?{success:!0,status_code:200,data:e}:{success:!1,status_code:500,data:e.message}})).catch((function(e){return{success:!1,status_code:500,err_message:e}})));case 9:return i=c.sent,c.abrupt("return",i);case 11:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"editDiaperRecords",value:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),null,null,null,Promise)}},{key:"normalize",value:function(e){for(var t=0;t<e.length;t++)e[t].time=On(e[t].time)}},{key:"render",value:function(){var e=this;""!==this.props.diaper_records.err_message&&pe.a.alert("Error!",this.props.diaper_records.err_message,[{text:"OK",onPress:function(){return e.props.clearDiaperlogErrorMessage()}}]);var t=this.props.route.params.teacher_id,r=this.state,s=r.show_time_picker,a=r.cloth_diaper,i=this.props.diaper_records,c=i.by_student_id,o=i.records,l=this.props.class.students,d=this.state.date;return Object(on.jsxs)(Hn.a,{style:{flex:1,paddingBottom:15},enabled:!0,children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-evenly"},children:[Object(on.jsx)(x.a,{style:{fontSize:40},children:yn(d)}),Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(je.a,{style:{backgroundColor:a?"rgba(255,255,255,0.2)":"#ffe1d0",padding:10,marginRight:20},onPress:function(){return e.setState({cloth_diaper:!1})},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u5c3f\u5e03"})}),Object(on.jsx)(je.a,{style:{backgroundColor:a?"#ffe1d0":"rgba(255,255,255,0.2)",padding:10,marginRight:20},onPress:function(){return e.setState({cloth_diaper:!0})},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u5b78\u7fd2\u8932"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend,children:Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u9001\u51fa"})})]})]}),Object(on.jsx)(In.a,{contentContainerStyle:{alignItems:"center"},keyboardShouldPersistTaps:"handled",children:Object.keys(l).map((function(r){if(null===c[r])return null;var i=c[r].records;return Object(on.jsx)(O.a,{style:{width:"98%"},children:Object(on.jsxs)(fe.Card,{style:{flex:1,flexDirection:"row",paddingVertical:15},children:[Object(on.jsx)(O.a,{style:{width:"23%",alignItems:"center",justifyContent:"center"},children:Object(on.jsx)(je.a,{onPress:function(){return e.addDiaperRecord(r)},underlayColor:"transparent",children:Object(on.jsx)(be.a,{source:""===l[r].profile_picture?n(77):{uri:l[r].profile_picture},style:xs.thumbnailImage})})}),Object(on.jsx)(O.a,{style:{width:"77%"},children:Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(x.a,{style:{fontSize:30},children:l[r].name}),e.checkUnsent(r)?Object(on.jsx)(x.a,{style:{fontSize:15,color:"red",marginLeft:15},children:"\u672a\u9001\u51fa"}):null]})}),i.map((function(n){var s=o.by_id[n];return s.cloth_diaper!==a?null:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",marginVertical:6,justifyContent:"space-between",paddingRight:15},children:[Object(on.jsx)(je.a,{style:{width:"\u5927\u4fbf"===s.pee_or_poo?"23%":"35%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setState({record_id_for_edit:n,show_time_picker:!0})},children:Object(on.jsx)(x.a,{style:{fontSize:35,textAlign:"center"},children:s.time.getHours()+":"+s.time.getMinutes()})}),Object(on.jsx)(je.a,{style:{width:"\u5927\u4fbf"===s.pee_or_poo?"23%":"35%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.switchPeeOrPoo(n)},children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:""+s.pee_or_poo})}),"\u5927\u4fbf"===s.pee_or_poo?Object(on.jsx)(js,{teacher_id:t,record_id:n,record:s}):null,Object(on.jsx)(je.a,{style:{width:"20%",height:"100%",justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return e.confirmRemove(r,n)},children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:"\u79fb\u9664"})})]},n)})),s&&Object(on.jsx)(ds.a,{style:{width:"100%"},mode:"time",display:"spinner",value:new Date,onChange:function(t,n){return e.setTime(n)},minimumDate:new Date})]})})]})},r)}))})]})}}]),r}(b.a.Component),xs=he.a.create({thumbnailImage:{width:140,height:140,borderRadius:70}}),ms=(Object(A.b)((function(e){return{diaper_records:e.diaper,class:e.classInfo}}),(function(e){return ys({},Object(k.a)({updateDiaperAmount:He,addDiaperRecord:Ve,editDiaperTime:We,switchPeeOrPoo:Ke,editPooCondition:Ge,removeDiaperRecordSuccess:Qe,removeDiaperRecordFail:Je,fetchClassDiaperData:ht,createDiaperRecordSuccess:pt,createDiaperRecordFail:jt,editDiaperRecordSuccess:bt,editDiaperRecordFail:yt,editDiaperAmountSuccess:gt,editDiaperAmountFail:Ot,clearDiaperlogErrorMessage:Xe},e))}))(Os),he.a.create({button:{width:"80%",padding:50,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",marginVertical:20},button_text:{}})),_s=function(e){var t=Object(D.g)(),n=Object(D.f)(),r=function(e){var r=null==n?void 0:n.state,s=r.school_name,a=r.school_id,i=r.email;t(e,{state:{school_name:s,school_id:a,email:i}})};return Object(on.jsxs)(In.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center"},children:[Object(on.jsx)(je.a,{style:ms.button,onPress:function(){return r("announcement")},underlayColor:"#368cbf",children:Object(on.jsx)(x.a,{style:{fontSize:70},children:"\u516c\u544a"})}),Object(on.jsx)(je.a,{style:ms.button,onPress:function(){return r("Registration")},underlayColor:"#368cbf",children:Object(on.jsx)(x.a,{style:{fontSize:70},children:"\u65b0\u751f\u8a3b\u518a"})}),Object(on.jsx)(je.a,{style:ms.button,onPress:function(){return r("Students")},underlayColor:"#368cbf",children:Object(on.jsx)(x.a,{style:{fontSize:70},children:"\u5b78\u751f\u8cc7\u6599"})}),Object(on.jsx)(je.a,{style:ms.button,onPress:function(){return r("Teachers")},underlayColor:"#368cbf",children:Object(on.jsx)(x.a,{style:{fontSize:70},children:"\u6559\u5e2b\u8cc7\u6599"})}),Object(on.jsx)(je.a,{style:ms.button,onPress:function(){return r("DownloadPage")},underlayColor:"#368cbf",children:Object(on.jsx)(x.a,{style:{fontSize:70},children:"\u4e0b\u8f09"})})]})},ws=n(162);function vs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ss(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vs(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Cs=Object(A.b)((function(e){return{classes:e.school.classes,students:e.school.students}}))((function(e){var t=Object(D.f)(),r=Object(D.g)(),s=Object(j.useState)({date:new Date,selected_all_classes:!0,selected_classes:new Set,class_id_list:[],text:"",announcements:[],page_number:0,announcement_on_display:{},is_loading:!0,unread_list:[],read_list:[],show_more:!1}),a=ue()(s,2),i=a[0],c=a[1];Object(j.useEffect)((function(){var n=(null==t?void 0:t.state).announcement,r=e.classes,s=[];Object.keys(r).forEach((function(e){"\u7ba1\u7406\u54e1"===r[e].name||r[e].name.includes("\u7562\u696d\u751f")||s.push(e)})),c(Ss(Ss({},i),{},{class_id_list:s,selected_classes:new Set(s)})),void 0===n?o():l(n)}),[]);var o=function(){var e,n,r,s,a,o,l,u,f;return p.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return e=null==t?void 0:t.state,n=e.school_id,h.next=3,p.a.awrap(_n("/announcement/most-recent?school_id="+n));case 3:r=h.sent,s=r.success,r.statusCode,r.message,a=r.data,s&&(o=d(a.read_status),l=ue()(o,2),u=l[0],f=l[1],c(Ss(Ss({},i),{},{announcement_on_display:a,is_loading:!1,unread_list:u,read_list:f})));case 6:case"end":return h.stop()}}),null,null,null,Promise)},l=function(e){var t,n,r,s,a,o,l;return p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,p.a.awrap(_n("/announcement/"+e.id));case 2:t=u.sent,n=t.success,t.statusCode,t.message,r=t.data,n&&(s=d(r),a=ue()(s,2),o=a[0],l=a[1],c(Ss(Ss({},i),{},{announcement_on_display:e,is_loading:!1,unread_list:o,read_list:l})));case 5:case"end":return u.stop()}}),null,null,null,Promise)},d=function(e){var t=[],n=[];for(var r in e)e[r]?n.push(r):t.push(r);return[t,n]},u=function(){var e,n,s,a;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=null==t?void 0:t.state,e.school_id,n=i.announcement_on_display,c.next=4,p.a.awrap(Sn("/announcement/"+n.id));case 4:s=c.sent,a=s.success,s.statusCode,s.message,s.data,a&&r(-1);case 7:case"end":return c.stop()}}),null,null,null,Promise)},f=e.students,h=null==t?void 0:t.state,b=h.school_id,y=h.school_name,g=i.announcement_on_display,m=i.is_loading,_=i.unread_list,w=i.read_list,v=i.show_more;return Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"flex-end",paddingVertical:7},children:[Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"lightblue",marginRight:10},onPress:function(){return l(g)},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u5237\u65b0"})}),Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"lightblue",marginRight:10},onPress:function(){return r(-1)},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u6aa2\u8996\u5168\u90e8"})}),Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"lightblue",marginRight:10},onPress:function(){return r("/admin/announcement/new",{school_id:b,school_name:y})},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u65b0\u589e"})}),Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"red",marginRight:10},onPress:function(){confirm("\u78ba\u5b9a\u8981\u6c38\u4e45\u522a\u9664\u6b64\u516c\u544a?")&&u()},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u522a\u9664"})})]}),!m&&Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(fe.Card,{style:{flex:1},children:Object(on.jsxs)(In.a,{children:[Object(on.jsxs)(O.a,{style:{padding:20},children:[Object(on.jsx)(x.a,{style:{fontSize:28},children:g.title}),Object(on.jsx)(x.a,{style:{fontSize:18},children:yn(new Date(g.timestamp))})]}),Object(on.jsx)(O.a,{style:{paddingHorizontal:20,height:v?-1:100,overflow:"hidden"},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:g.text})}),v&&Object(on.jsx)(O.a,{style:{flex:1,alignItems:"flex-start",padding:20},children:g.links.map((function(e,t){return Object(on.jsx)(je.a,{style:{backgroundColor:"lightblue",padding:8,marginBottom:15},onPress:function(){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(ws.a(e.url));case 2:t.sent;case 3:case"end":return t.stop()}}),null,null,null,Promise)},children:Object(on.jsx)(x.a,{style:{fontSize:18},children:e.text})},t)}))}),v&&Object(on.jsx)(O.a,{style:{flexDirection:"row",paddingHorizontal:20,flexWrap:"wrap"},children:g.photo_url_arr.map((function(e,t){return Object(on.jsx)(je.a,{onPress:function(){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(ws.a(e));case 2:t.sent;case 3:case"end":return t.stop()}}),null,null,null,Promise)},children:Object(on.jsx)(be.a,{source:{uri:e},style:{width:150,height:150,marginRight:10,marginTop:10}})},t)}))}),Object(on.jsx)(O.a,{style:{width:"100%",paddingHorizontal:20},children:Object(on.jsx)(je.a,{style:{padding:10,alignSelf:"flex-end",backgroundColor:"lightblue"},onPress:function(){return c(Ss(Ss({},i),{},{show_more:!v}))},children:Object(on.jsx)(x.a,{children:v?"\u96b1\u85cf":"\u66f4\u591a"})})}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",flexWrap:"wrap"},children:[_.map((function(e){var t=f[e];return t?Object(on.jsx)(je.a,{style:{height:300,width:"33.3%",padding:5},children:Object(on.jsxs)(fe.Card,{style:{flex:1,padding:10,backgroundColor:"#ffe1d0"},children:[Object(on.jsx)(fe.CardItem,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===t.profile_picture?n(77):{uri:t.profile_picture},style:{height:200,width:200,borderRadius:100}})}),Object(on.jsx)(fe.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5},children:Object(on.jsx)(x.a,{style:{marginTop:-10},children:t.name})})]})},e):null})),w.map((function(e){var t=f[e];return t?Object(on.jsx)(je.a,{style:{height:300,width:"33.3%",padding:5},children:Object(on.jsxs)(fe.Card,{style:{flex:1,padding:10,backgroundColor:"#dcf3d0"},children:[Object(on.jsx)(fe.CardItem,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===t.profile_picture?n(77):{uri:t.profile_picture},style:{height:200,width:200,borderRadius:100}})}),Object(on.jsx)(fe.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5},children:Object(on.jsx)(x.a,{style:{marginTop:-10},children:t.name})})]})},e):null}))]})]})})})]})}));function Ds(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var As=function(e){o()(n,e);var t=Ds(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={studentDataArray:[{name:"",class_id:"",class_name:"",profile_picture:"",blood_type:""}]},r}return i()(n,[{key:"addStudent",value:function(){var e=this.state.studentDataArray;e.push({name:"",class_id:"",class_name:"",profile_picture:"",blood_type:""}),this.setState({studentDataArray:e})}},{key:"fillStudent",value:function(){var e=this.state.studentDataArray;e[0]={name:"John Smith",class_id:null,profile_picture:"",blood_type:"AB"},this.setState({studentDataArray:e})}},{key:"setName",value:function(e,t){var n=this.state.studentDataArray;n[t].name=e,this.setState({studentDataArray:n})}},{key:"setBloodType",value:function(e,t){var n=this.state.studentDataArray;n[t].blood_type=e,this.setState({studentDataArray:n})}},{key:"removeStudent",value:function(e){var t=this.state.studentDataArray;t.splice(e,1),this.setState({studentDataArray:t})}},{key:"handleSelectClass",value:function(e,t){for(var n=this.props.classes,r=this.state.studentDataArray,s="",a=0;a<Object.keys(n).length;a++){var i=Object.keys(n)[a];if(n[i].name===e){s=i;break}}r[t].class_id=s,r[t].class_name=e,this.setState({studentDataArray:r})}},{key:"getStudentDataArray",value:function(){return this.state.studentDataArray}},{key:"render",value:function(){var e=this,t=this.state.studentDataArray,n=this.props.classes,r=Object.keys(n).map((function(e){return n[e].name}));return Object(on.jsxs)(O.a,{style:{width:"100%",padding:"5%",backgroundColor:"#368cbf"},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:5,backgroundColor:"rgba(255,255,255,0.4)"},children:[Object(on.jsx)(x.a,{style:{fontSize:60},children:"\u5b78\u751f\u8cc7\u6599"}),Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"#b5e9e9"},onPress:function(){return e.addStudent()},children:Object(on.jsx)(x.a,{style:{fontSize:35},children:"\u65b0\u589e\u5b78\u751f"})})]}),t.map((function(n,s){var a=n.name,i=n.blood_type;return Object(on.jsxs)(O.a,{style:{width:"100%",padding:"5%",backgroundColor:"#f4d41f"},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",padding:10,backgroundColor:"white",justifyContent:"space-between"},children:[Object(on.jsx)(O.a,{style:{width:"50%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"},children:Object(on.jsx)(Vn.a,{placeholder:"\u5168\u540d",value:a,style:{fontSize:30},onChangeText:function(t){return e.setName(t,s)}})}),Object(on.jsx)(O.a,{style:{width:"20%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"},children:Object(on.jsx)(Vn.a,{placeholder:"\u8840\u578b",value:i,style:{fontSize:30},onChangeText:function(t){return e.setBloodType(t,s)}})}),Object(on.jsx)(je.a,{style:{width:"20%",padding:10,backgroundColor:"#fa625f",borderRadius:2,justifyContent:"center"},onPress:function(){return e.removeStudent(s)},children:Object(on.jsx)(x.a,{style:{alignSelf:"center",fontSize:30},children:"\u79fb\u9664"})})]}),Object(on.jsx)(O.a,{style:{padding:10,backgroundColor:"white"},children:Object(on.jsx)(Gn,{style:{padding:10,backgroundColor:"#b5e9e9"},textStyle:{fontSize:30},selectedValue:t[s].class_name||"\u9078\u64c7\u5b78\u751f\u73ed\u7d1a",options:r,handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t,s)}})})]},s)}))]})}}]),n}(b.a.Component),ks=n(170);function Ps(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Ts=function(e){o()(n,e);var t=Ps(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={parentDataArray:[{name:"",email:"",username:"",password:"",role:"\u7236",mobile:"",address:"",work_phone:"",transportation:""}],parentSignUpStatus:[!1]},r}return i()(n,[{key:"addParent",value:function(){var e=this.state,t=e.parentDataArray,n=e.parentSignUpStatus;t.push({name:"",email:"",username:"",password:"",role:"\u7236",mobile:"",address:"",work_phone:"",transportation:""}),n.push(!1),this.setState({parentDataArray:t,parentSignUpStatus:n})}},{key:"fillParent",value:function(){var e=this.state.parentDataArray;e[0]={name:"Jane Smith",email:"caleb7947@gmail.com",username:"abc123",password:"password",role:"parent#mother",mobile:"061234567",address:"SOME ADDRESS",work_phone:"061234567",transportation:"car"},this.setState({parentDataArray:e})}},{key:"setName",value:function(e,t){var n=this.state.parentDataArray;n[t].name=e,this.setState({parentDataArray:n})}},{key:"setRole",value:function(e,t){var n=this.state.parentDataArray;n[t].role=e,this.setState({parentDataArray:n})}},{key:"setEmail",value:function(e,t){var n=this.state.parentDataArray;n[t].email=e,this.setState({parentDataArray:n})}},{key:"setUsername",value:function(e,t){var n=this.state.parentDataArray;n[t].username=e,this.setState({parentDataArray:n})}},{key:"toLowerCase",value:function(e,t){var n=e.nativeEvent.text,r=this.state.parentDataArray,s=n.toLowerCase();r[t].username=s,this.setState({parentDataArray:r})}},{key:"setPassword",value:function(e,t){var n=this.state.parentDataArray;n[t].password=e,this.setState({parentDataArray:n})}},{key:"removeParent",value:function(e){var t=this.state,n=t.parentDataArray,r=t.parentSignUpStatus;n.splice(e,1),r.splice(e,1),this.setState({parentDataArray:n,parentSignUpStatus:r})}},{key:"handleSignup",value:function(e){var t=this,n=this.state.parentDataArray[e],r=n.name,s=n.email,a=n.username,i=n.password;w.a.signUp({username:a,password:i,attributes:{name:r,email:s}}).then((function(n){var r=t.state.parentSignUpStatus;r[e]=!0,t.setState({parentSignUpStatus:r})})).catch((function(e){alert("\u8a3b\u518a\u6709\u554f\u984c!\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+e.message)}))}},{key:"getParentSignUpStatus",value:function(){return this.state.parentSignUpStatus}},{key:"getParentDataArray",value:function(){return this.state.parentDataArray}},{key:"render",value:function(){var e=this,t=this.state,n=t.parentDataArray,r=t.parentSignUpStatus;return Object(on.jsxs)(O.a,{style:{width:"100%",padding:"5%",backgroundColor:"#f4d41f"},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:5,backgroundColor:"rgba(255,255,255,0.4)"},children:[Object(on.jsx)(x.a,{style:{fontSize:60},children:"\u5bb6\u9577\u8cc7\u6599"}),Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"#b5e9e9"},onPress:function(){return e.addParent()},children:Object(on.jsx)(x.a,{style:{fontSize:35},children:"\u65b0\u589e\u5bb6\u9577"})})]}),n.map((function(t,n){var s=t.name,a=t.email,i=t.username,c=t.password,o=t.role;t.mobile,t.address,t.work_phone,t.transportation;return Object(on.jsxs)(O.a,{style:{padding:10,backgroundColor:"white",marginBottom:20},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"},children:[Object(on.jsx)(O.a,{style:{width:"50%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"},children:Object(on.jsx)(Vn.a,{placeholder:"\u5168\u540d",value:s,style:{fontSize:30},onChangeText:function(t){return e.setName(t,n)}})}),Object(on.jsx)(O.a,{style:{width:"20%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"},children:Object(on.jsxs)(ks.a,{selectedValue:o,style:{height:50},onValueChange:function(t,r){return e.setRole(t,n)},children:[Object(on.jsx)(ks.a.Item,{label:"\u7236",value:"\u7236"}),Object(on.jsx)(ks.a.Item,{label:"\u6bcd",value:"\u6bcd"})]})}),Object(on.jsx)(je.a,{style:{width:"20%",padding:10,backgroundColor:"#fa625f",borderRadius:2,justifyContent:"center"},onPress:function(){return e.removeParent(n)},children:Object(on.jsx)(x.a,{style:{alignSelf:"center",fontSize:30},children:"\u79fb\u9664"})})]}),Object(on.jsx)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"},children:Object(on.jsx)(O.a,{style:{width:"100%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"},children:Object(on.jsx)(Vn.a,{placeholder:"Email",autoCapitalize:"none",keyboardType:"email-address",value:a,style:{fontSize:30},onChangeText:function(t){return e.setEmail(t,n)}})})}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"},children:[Object(on.jsx)(O.a,{style:{width:"35%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"},children:Object(on.jsx)(Vn.a,{placeholder:"\u5e33\u865f",autoCapitalize:"none",value:i,style:{fontSize:30},onChangeText:function(t){return e.setUsername(t,n)},onEndEditing:function(t){return e.toLowerCase(t,n)}})}),Object(on.jsx)(O.a,{style:{width:"35%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"},children:Object(on.jsx)(Vn.a,{secureTextEntry:!0,placeholder:"\u5bc6\u78bc",value:c,style:{fontSize:30},onChangeText:function(t){return e.setPassword(t,n)}})}),Object(on.jsx)(je.a,{style:{width:"20%",padding:5,backgroundColor:r[n]?"#dcf3d0":"#ffe1d0",justifyContent:"center"},onPress:function(){return e.handleSignup(n)},disable:r[n],children:r[n]?Object(on.jsx)(x.a,{style:{fontSize:20},children:"SUCCESS"}):Object(on.jsx)(x.a,{style:{fontSize:35,alignSelf:"center"},children:"\u8a3b\u518a"})})]})]},n)}))]})}}]),n}(b.a.Component),Es=n(556);function Rs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Is(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var zs=function(e){o()(n,e);var t=Is(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={parentSignUpStatus:[!1],createFamilyProfileStatus:"not_created"},r}return i()(n,[{key:"componentDidMount",value:function(){}},{key:"createFamilyProfile",value:function(){var e=this,t=!0;if(this.refs.parent.getParentSignUpStatus().forEach((function(e){t&=e})),t){var n=this.refs.parent.getParentDataArray(),r=this.refs.student.getStudentDataArray();this.setState({createFamilyProfileStatus:"creating"}),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/family/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({parentDataArray:n,studentDataArray:r})}).then((function(e){return e.json()})).then((function(t){t.statusCode>200||"Internal server error"===t.message?alert("Error!"+t.message):(e.fetchStudentData(),pe.a.alert("\u8a3b\u518a\u6210\u529f!","\u9ede\u9078OK\u4ee5\u96e2\u958b\u9801\u9762",[{text:"OK",onPress:function(){return e.props.navigation.goBack()}}]),e.setState({createFamilyProfileStatus:"created"}))})).catch((function(e){console.error(e)}))}else alert("Error! We cannot create family profile until all parents have been signed up")}},{key:"fetchStudentData",value:function(){var e,t,n,r,s,a,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.route.params.school_id,c.next=3,p.a.awrap(_n("/school/"+e+"/student"));case 3:if(t=c.sent,n=t.success,t.statusCode,r=t.message,s=t.data,n){c.next=8;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),c.abrupt("return");case 8:a=s.students,i=s.classes,this.props.fetchStudentsSuccess(a,i);case 10:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state,n=(t.studentDataArray,t.parentDataArray,t.parentSignUpStatus,t.createFamilyProfileStatus);return Object(on.jsx)(Hn.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsxs)(Es.a,{style:{width:"100%"},children:[Object(on.jsx)(As,{ref:"student",classes:this.props.classes}),Object(on.jsx)(Ts,{ref:"parent"}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-around"},children:[Object(on.jsx)(je.a,{style:{flex:1,padding:20,backgroundColor:"not_created"===n||"creating"===n?"#b5e9e9":"#00c07f",justifyContent:"center"},onPress:function(){return e.createFamilyProfile()},children:"not_created"===n?Object(on.jsx)(x.a,{style:{fontSize:50,textAlign:"center"},children:"\u5b8c\u6210"}):"creating"===n?Object(on.jsx)(Fn,{}):Object(on.jsx)(x.a,{style:{fontSize:50},children:"SUCCESS"})}),Object(on.jsx)(je.a,{style:{flex:1,padding:20,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.navigation.goBack()},children:Object(on.jsx)(x.a,{style:{fontSize:50,textAlign:"center"},children:"\u8fd4\u56de"})})]})]})})}}]),n}(b.a.Component),Ls=(Object(A.b)((function(e){return{classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rs(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({fetchStudentsSuccess:Wt},e))}))(zs),n(157)),Bs=n(118),Ms=n(1272);function Fs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ns(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var qs=Zn.a.get("window"),Us=qs.width,Hs=qs.height,Vs=function(e){o()(n,e);var t=Ns(n);function n(e){return s()(this,n),t.call(this,e)}return i()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.show,r=t.component,s=t.modal_padding;return n?Object(on.jsxs)(Hn.a,{style:{backgroundColor:"transparent",alignItems:"center",zIndex:2,position:"absolute",width:"100%",height:"100%"},behavior:"height",enabled:!0,children:[Object(on.jsx)(je.a,{style:{backgroundColor:"rgba(0,0,0,0.8)",width:"100%",height:"100%"},onPress:function(){return e.props.hideModal()},children:Object(on.jsx)(O.a,{})}),Object(on.jsx)(O.a,{style:{flex:1,marginTop:s,width:Us/2,height:Hs,backgroundColor:"white",zIndex:3,position:"absolute"},children:r})]}):null}}]),n}(b.a.Component),Ws=(he.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),Object(A.b)((function(e){return{students:e.school.students,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fs(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({},e))}))(Vs));function Ks(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ks(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ks(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Js=function(e){o()(r,e);var t=Qs(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={parents:[],student:null,isLoading:!0},n}return i()(r,[{key:"componentDidMount",value:function(){var e,t,n,r,s,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.props,t=e.student_id,n=e.student,i.next=3,p.a.awrap(_n("/student/"+t+"/family"));case 3:if(r=i.sent,s=r.success,r.statusCode,a=r.message,r.data,s){i.next=8;break}return alert("Sorry \u53d6\u5f97\u5bb6\u5ead\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),i.abrupt("return");case 8:this.setState({parents:r.data,student:n,isLoading:!1});case 9:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"addParent",value:function(){3!==this.state.parents.length?this.props.addParent({id:"",name:"",role:"",username:"",password:"",mobile:"",work_phone:"",address:""}):alert("Sorry \u4e00\u500b\u5bf6\u8c9d\u53ea\u80fd\u8a3b\u518a\u4e09\u4f4d\u5bb6\u9577\uff01")}},{key:"editStudentData",value:function(){var e,t,n,r,s,a,i,c;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.student_id,t=this.state.student,n=t.name,r=t.class_id,o.next=5,p.a.awrap(vn("/student/"+e,{name:n,class_id:r}));case 5:if(s=o.sent,a=s.success,s.statusCode,i=s.message,s.data,a){o.next=10;break}return alert("Sorry \u7de8\u8f2f\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+i),o.abrupt("return");case 10:this.props.hideModal(),c=this.props.student.class_id,this.props.editStudentSuccess(e,n,c,r);case 13:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"getClassNames",value:function(){var e=this.props.classes;return Object.keys(e).map((function(t){return e[t].name}))}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(r){t[r].name===e&&(n=r)})),this.setState({student:Gs(Gs({},this.state.student),{},{class_id:n})})}},{key:"render",value:function(){var e=this,t=this.props.classes,r=this.state,s=r.student,a=r.parents;return r.isLoading?Object(on.jsx)(Fn,{}):Object(on.jsxs)(O.a,{style:{flex:1,padding:30},children:[Object(on.jsxs)(O.a,{style:{flex:3,flexDirection:"row",alignItems:"center",backgroundColor:"#DCDCDC"},children:[Object(on.jsx)(O.a,{style:{flex:1,alignItems:"center"},children:Object(on.jsx)(je.a,{style:{},children:Object(on.jsx)(be.a,{source:""===s.profile_picture?n(77):{uri:s.profile_picture},style:{width:200,height:200,borderRadius:100}})})}),Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center"},children:[Object(on.jsx)(Vn.a,{style:{fontSize:50},value:s.name,onChangeText:function(t){return e.setState({student:Gs(Gs({},e.state.student),{},{name:t})})}}),Object(on.jsx)(je.a,{style:{backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:5,width:"90%",marginTop:5},children:Object(on.jsx)(x.a,{style:{fontSize:50},children:t[s.class_id].name})})]})]}),Object(on.jsx)(O.a,{style:{flex:5,backgroundColor:"#F5F5F5"},children:Object(on.jsxs)(O.a,{style:{flex:1,alignItems:"center"},children:[a.map((function(t){return Object(on.jsx)(O.a,{style:{width:"100%",height:"33%",padding:"1%"},children:Object(on.jsx)(je.a,{style:{flex:1,padding:10,backgroundColor:"#b5e9e9",justifyContent:"center"},onPress:function(){return e.props.addParent(t)},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{paddingRight:10},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:t.role})}),Object(on.jsxs)(O.a,{children:[Object(on.jsxs)(O.a,{style:{width:"100%",flexDirection:"row"},children:[Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u59d3\u540d: ",t.name,"         "]}),Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u5e33\u865f: ",t.username,"         "]})]}),Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u624b\u6a5f: ",t.mobile]}),Object(on.jsxs)(x.a,{style:{fontSize:18},children:["\u5de5\u4f5c/\u5bb6\u7528\u96fb\u8a71: ",t.work_phone]}),Object(on.jsxs)(x.a,{style:{fontSize:18},children:["\u5730\u5740: ",t.address]})]})]})})},t.id)})),a.length<3?Object(on.jsx)(O.a,{style:{width:"100%",height:"33%",padding:"1%"},children:Object(on.jsx)(je.a,{style:{flex:1,padding:10,backgroundColor:"white",justifyContent:"center",borderWidth:5,borderRadius:1,borderStyle:"dashed"},onPress:function(){return e.addParent()},children:Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:"\u65b0\u589e\u5bb6\u9577"})})})}):null]})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC"},children:[Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.hideModal()},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:"\u8fd4\u56de"})})}),Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.editStudentData()},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:"\u9001\u51fa"})})})]})]})}}]),r}(b.a.Component);function Xs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ys(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xs(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Zs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var $s=function(e){o()(r,e);var t=Zs(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={password:"",qr_data:"",name:""},n}return i()(r,[{key:"componentDidMount",value:function(){var e,t,n,r,s,a,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(e=this.props,t=e.parent_data,n=e.isConnected,this.setState(Ys(Ys({},this.state),t)),n){c.next=5;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),c.abrupt("return");case 5:if(""==t.id){c.next=14;break}return c.next=8,p.a.awrap(_n("/user/"+t.id+"/qrcode"));case 8:if(r=c.sent,s=r.success,r.statusCode,a=r.message,i=r.data,s){c.next=13;break}return alert("Sorry \u53d6\u5f97\u5bb6\u9577QR Code\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),c.abrupt("return");case 13:this.setState({qr_data:i});case 14:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"postParent",value:function(){var e,t,n,r,s,a,i,c,o,l,d,u,f,h,j,b;return p.a.async((function(y){for(;;)switch(y.prev=y.next){case 0:if(e=this.props,t=e.student_id,n=e.isConnected,r=this.state,s=r.id,a=r.name,i=r.role,c=r.email,o=r.username,l=r.mobile,d=r.work_phone,u=r.address,n||alert("\u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),""!==s){y.next=9;break}return y.next=6,p.a.awrap(this.signUpParent());case 6:if(y.sent.success){y.next=9;break}return y.abrupt("return");case 9:return f={student_id:t,parent_data:{id:s,name:a,role:i,email:c,username:o,mobile:l,work_phone:d,address:u}},y.next=12,p.a.awrap(wn("/student/"+t+"/family",f));case 12:if(h=y.sent,j=h.success,h.statusCode,b=h.message,h.data,j){y.next=17;break}return alert("Sorry \u65b0\u589e\u5bb6\u9577\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+b),y.abrupt("return");case 17:this.props.goBack();case 18:case"end":return y.stop()}}),null,this,null,Promise)}},{key:"signUpParent",value:function(){var e,t,n,r,s,a;return p.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.state,t=e.username,n=e.password,r=e.name,s=e.email,i.next=3,p.a.awrap(w.a.signUp({username:t,password:n,attributes:{name:r,email:s}}).then((function(e){return{success:!0}})).catch((function(e){return alert("\u5bb6\u9577\u8a3b\u518a\u6709\u554f\u984c!\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+e.message),{success:!1}})));case 3:return a=i.sent,i.abrupt("return",a);case 5:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state,r=t.id,s=t.name,a=t.username,i=t.password,c=t.mobile,o=t.work_phone,l=t.address,d=t.role,u=t.email;return Object(on.jsx)(O.a,{style:{flex:1,padding:30},children:Object(on.jsx)(O.a,{style:{flex:1,backgroundColor:"#F5F5F5"},children:Object(on.jsxs)(In.a,{children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",padding:10,justifyContent:"space-between"},children:[Object(on.jsxs)(O.a,{style:{width:"66%",padding:10,backgroundColor:"#ffddb7"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u59d3\u540d"}),Object(on.jsx)(Vn.a,{style:{fontSize:35,textAlign:"center"},value:s,onChangeText:function(t){return e.setState({name:t})}})]}),Object(on.jsxs)(O.a,{style:{width:"32%",padding:10,backgroundColor:"#ffddb7"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u89d2\u8272"}),Object(on.jsx)(Vn.a,{style:{fontSize:35,textAlign:"center"},value:d,onChangeText:function(t){return e.setState({role:t})}})]})]}),Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsxs)(O.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"Email"}),Object(on.jsx)(Vn.a,{style:{fontSize:35},autoCapitalize:"none",keyboardType:"email-address",placeholder:"",value:u,onChangeText:function(t){return e.setState({email:t})}})]})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",padding:10,justifyContent:"space-between"},children:[Object(on.jsxs)(O.a,{style:{width:"49%",padding:15,backgroundColor:"#ffddb7"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u5e33\u865f"}),Object(on.jsx)(Vn.a,{editable:""===r,style:{fontSize:35,textAlign:"center"},autoCapitalize:"none",value:a,onChangeText:function(t){return e.setState({username:t})}})]}),""===r?Object(on.jsxs)(O.a,{style:{width:"49%",padding:15,backgroundColor:"#ffddb7"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u5bc6\u78bc"}),Object(on.jsx)(Vn.a,{secureTextEntry:!0,style:{fontSize:35,textAlign:"center"},value:i,onChangeText:function(t){return e.setState({password:t})}})]}):Object(on.jsx)(je.a,{style:{backgroundColor:"transparent",alignItems:"center",justifyContent:"center"},onPress:function(){return e.props.viewQRCode(e.state.qr_data)},children:Object(on.jsx)(be.a,{source:n(470),style:{width:120,height:120}})})]}),Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsxs)(O.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u624b\u6a5f"}),Object(on.jsx)(Vn.a,{style:{fontSize:35},keyboardType:"number-pad",placeholder:"",value:c,onChangeText:function(t){return e.setState({mobile:t})}})]})}),Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsxs)(O.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u5de5\u4f5c/\u5bb6\u7528\u96fb\u8a71"}),Object(on.jsx)(Vn.a,{style:{fontSize:35},keyboardType:"number-pad",placeholder:"",value:o,onChangeText:function(t){return e.setState({work_phone:t})}})]})}),Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsxs)(O.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u5730\u5740"}),Object(on.jsx)(Vn.a,{style:{fontSize:35},placeholder:"",value:l,onChangeText:function(t){return e.setState({address:t})}})]})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC"},children:[Object(on.jsx)(O.a,{style:{flex:1,padding:14},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:"\u8fd4\u56de"})})}),""!==r?Object(on.jsx)(O.a,{style:{flex:1,padding:14},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:"\u79fb\u9664"})})}):null,Object(on.jsx)(O.a,{style:{flex:1,padding:14},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postParent()},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:""===r?"\u65b0\u589e":"\u9001\u51fa"})})})]})]})})})}}]),r}(b.a.Component),ea=Object(A.b)((function(e){return{isConnected:e.school.isConnected}}),null)($s),ta=n(303);function na(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var ra=function(e){o()(n,e);var t=na(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={},r}return i()(n,[{key:"render",value:function(){var e=this,t=this.props.parent_data,n=(t.name,t.role),r="\u6bcd"===n?"\u5abd\u5abd":"\u7236"===n?"\u7238\u7238":n;return Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsxs)(O.a,{style:{flex:3,justifyContent:"center",alignItems:"center"},children:[Object(on.jsxs)(x.a,{style:{fontSize:65},children:[this.props.student_name," ",r]}),Object(on.jsx)(ta.a,{value:this.props.qr_data,size:400})]}),Object(on.jsx)(O.a,{style:{flex:1,alignItems:"center"},children:Object(on.jsx)(je.a,{style:{padding:15,backgroundColor:"#b5e9e9"},onPress:function(){return e.props.goBack()},children:Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u8fd4\u56de"})})})]})}}]),n}(b.a.Component);function sa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var ia=Zn.a.get("window"),ca=(ia.width,ia.height),oa=function(e){o()(r,e);var t=aa(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).getPermissionAsync=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Wn.a.OS){t.next=6;break}return t.next=3,p.a.awrap(Ms.b(Ms.a));case 3:e=t.sent,"granted"!==e.status&&alert("Sorry, we need camera roll permissions to make this work!");case 6:case"end":return t.stop()}}),null,null,null,Promise)},n._pickImage=function(e,t){var r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(Ls.a({mediaTypes:Bs.a.All,allowsEditing:!0,aspect:[1,1],quality:.4,base64:!0}));case 3:(r=a.sent).cancelled||(s=r.base64,n.getProfilePictureURL(s,e,t)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}}),null,null,[[0,7]],Promise)},n.state={showModal:!1,modal_type:"",student_id:"",parent_data:{},qr_data:"",modal_padding:0},n}return i()(r,[{key:"componentDidMount",value:function(){this.getPermissionAsync()}},{key:"getProfilePictureURL",value:function(e,t,n){var r,s,a,i,c,o,l;return p.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return r=this.props.route.params.school_name,s=this.props.students,a={image:e,url:n,path:r+"/profile_picture_"+t+"_"+(new Date).getMilliseconds()+".jpg"},d.next=5,p.a.awrap(wn("/student/"+t+"/profile-picture",a));case 5:if(i=d.sent,c=i.success,i.statusCode,o=i.message,l=i.data,c){d.next=10;break}return alert("Sorry "+s[t].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o),d.abrupt("return");case 10:this.props.updateProfilePicture(t,l.image_url);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"getModalContent",value:function(){var e=this,t=this.props,n=t.students,r=t.classes,s=this.state,a=s.showModal,i=s.modal_type,c=s.student_id,o=s.parent_data,l=s.qr_data;return a?"student"===i?Object(on.jsx)(Js,{student_id:c,student:n[c],classes:r,addParent:function(t){return e.setState({modal_type:"add_parent",parent_data:t})},editStudentSuccess:function(t,n,r,s){return e.props.editStudentSuccess(t,n,r,s)},hideModal:function(){return e.hideModal()}}):"add_parent"===i?Object(on.jsx)(ea,{student_id:c,parent_data:o,viewQRCode:function(t){return e.setState({modal_type:"qrpage",qr_data:t})},goBack:function(){return e.setState({modal_type:"student"})}}):Object(on.jsx)(ra,{qr_data:l,student_name:n[c].name,parent_data:o,goBack:function(){return e.setState({modal_type:"add_parent"})}}):null}},{key:"hideModal",value:function(){this.setState({showModal:!1})}},{key:"confirmDeleteStudent",value:function(e){var t=this,n=this.props.students;pe.a.alert(n[e].name+" \u522a\u9664\u78ba\u8a8d","\u522a\u9664\u9019\u500b\u5bf6\u8c9d\u6703\u5c07\u4e00\u5207\u6538\u95dc\u8cc7\u6599(\u5305\u8a87\u7236\u6bcd)\u522a\u9664",[{text:"\u53d6\u6d88",style:"cancel"},{text:"OK",onPress:function(){return t.deleteStudentById(e)}}])}},{key:"deleteStudentById",value:function(e){var t,n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=this.props.students,a.next=3,p.a.awrap(Sn("/student/"+e+"/"));case 3:if(n=a.sent,r=n.success,n.statusCode,s=n.message,n.data,r){a.next=8;break}return alert("Sorry "+t[e].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),a.abrupt("return");case 8:this.fetchStudentData();case 9:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"fetchStudentData",value:function(){var e,t,n,r,s,a,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.route.params.school_id,c.next=3,p.a.awrap(_n("/school/"+e+"/student"));case 3:if(t=c.sent,n=t.success,t.statusCode,r=t.message,s=t.data,n){c.next=8;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),c.abrupt("return");case 8:a=s.students,i=s.classes,this.props.fetchStudentsSuccess(a,i);case 10:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.students,r=this.state,s=r.showModal,a=r.modal_padding;return Object(on.jsxs)(O.a,{children:[Object(on.jsx)(Ws,{modal_padding:a,show:s,component:this.getModalContent(),hideModal:function(){return e.hideModal()}}),Object(on.jsx)(In.a,{children:Object.keys(t).map((function(r,s){var a=t[r];return Object(on.jsxs)(O.a,{style:{flex:1,backgroundColor:"lightgrey",flexDirection:"row",marginBottom:10,padding:15},children:[Object(on.jsx)(je.a,{style:{},onPress:function(){return e._pickImage(r,a.profile_picture)},children:Object(on.jsx)(be.a,{source:""===a.profile_picture?n(77):{uri:a.profile_picture},style:{width:200,height:200,borderRadius:100}})}),Object(on.jsxs)(O.a,{style:{flex:5,paddingLeft:15},children:[Object(on.jsx)(O.a,{children:Object(on.jsx)(x.a,{style:{fontSize:50},children:a.name})}),Object(on.jsx)(O.a,{children:Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u5730\u5740: ",a.address]})}),Object(on.jsx)(O.a,{children:Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u624b\u6a5f(\u7236): ",a.father_phone]})}),Object(on.jsx)(O.a,{children:Object(on.jsxs)(x.a,{style:{fontSize:20},children:["\u624b\u6a5f(\u6bcd): ",a.mother_phone]})})]}),Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"space-evenly"},children:[Object(on.jsx)(O.a,{style:{backgroundColor:"white"},children:Object(on.jsx)(je.a,{style:{padding:15,justifyContent:"center"},onPress:function(t){return e.setState({showModal:!0,modal_type:"student",student_id:r,modal_padding:Math.max(0,t.nativeEvent.pageY-ca)})},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u7de8\u8f2f"})})}),Object(on.jsx)(O.a,{style:{backgroundColor:"#fa625f"},children:Object(on.jsx)(je.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.confirmDeleteStudent(r)},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u522a\u9664"})})})]})]},r)}))})]})}}]),r}(b.a.Component);Object(A.b)((function(e){return{students:e.school.students,classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sa(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({updateProfilePicture:tn,fetchStudentsSuccess:Wt,editStudentSuccess:nn},e))}))(oa);function la(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var da=function(e){o()(n,e);var t=la(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={id:"",name:"",profile_picture:"",class_id:"",passcode:"",isAdmin:!1},r}return i()(n,[{key:"componentDidMount",value:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),null,null,null,Promise)}},{key:"postTeacher",value:function(){var e,t,n,r,s,a,i,c,o,l,d,u,f;return p.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return e=this.props,e.student_id,t=e.school_id,n=this.state,r=n.id,s=n.name,a=n.profile_picture,i=n.class_id,c=n.passcode,o=n.isAdmin,l={id:r,name:s,profile_picture:a,class_id:i,passcode:c,isAdmin:o},h.next=5,p.a.awrap(wn("/school/"+t+"/teacher",l));case 5:if(d=h.sent,u=d.success,d.statusCode,f=d.message,d.data,u){h.next=10;break}return pe.a.alert("Sorry \u65b0\u589e\u6559\u5e2b\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+f,[{text:"Ok"}]),h.abrupt("return");case 10:this.props.goBack(),this.props.fetchTeacherData();case 12:case"end":return h.stop()}}),null,this,null,Promise)}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(r){t[r].name===e&&(n=r)})),this.setState({class_id:n,isAdmin:"\u7ba1\u7406\u54e1"===e})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,r=n.id,s=n.name,a=n.class_id,i=n.passcode;n.isAdmin;return Object(on.jsx)(O.a,{style:{flex:1,padding:30},children:Object(on.jsx)(O.a,{style:{flex:1,backgroundColor:"#F5F5F5"},children:Object(on.jsxs)(In.a,{children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",padding:20,justifyContent:"space-between"},children:[Object(on.jsxs)(O.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u59d3\u540d"}),Object(on.jsx)(Vn.a,{style:{fontSize:35,textAlign:"center"},value:s,onChangeText:function(t){return e.setState({name:t})}})]}),Object(on.jsxs)(O.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u5bc6\u78bc"}),Object(on.jsx)(Vn.a,{style:{fontSize:35,textAlign:"center"},value:i,keyboardType:"number-pad",onChangeText:function(t){return e.setState({passcode:t})}})]})]}),Object(on.jsx)(O.a,{style:{flex:1,padding:20},children:Object(on.jsxs)(O.a,{style:{padding:10,backgroundColor:"#ffddb7",height:"100%",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u73ed\u7d1a"}),Object(on.jsx)(Gn,{style:{backgroundColor:"rgba(255,255,255, 0)",alignItems:"center",padding:5},textStyle:{fontSize:30},selectedValue:""===a?"\u9078\u64c7\u73ed\u7d1a":t[a].name,options:Object.keys(t).map((function(e){return t[e].name})),handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t)}})]})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC",marginTop:20},children:[Object(on.jsx)(O.a,{style:{flex:1,padding:14},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:"\u8fd4\u56de"})})}),Object(on.jsx)(O.a,{style:{flex:1,padding:14},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postTeacher()},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:""===r?"\u65b0\u589e":"\u9001\u51fa"})})})]})]})})})}}]),n}(b.a.Component);function ua(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var fa=function(e){o()(n,e);var t=ua(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={id:"",name:"",profile_picture:"",class_id:"",passcode:"",isAdmin:!1},r}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.teacher_id,n=e.teacher,r=e.classes,s=n.name,a=n.profile_picture,i=n.passcode,c=this.getClassIdByTeacherId(t,r);this.setState({id:t,name:s,profile_picture:a,passcode:i,class_id:c,isAdmin:""!==c&&"\u7ba1\u7406\u54e1"===r[c].name})}},{key:"getClassIdByTeacherId",value:function(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++)for(var s=n[r],a=t[s].teachers,i=0;i<a.length;i++)if(e===a[i])return s;return""}},{key:"postTeacher",value:function(){var e,t,n,r,s,a,i,c,o,l,d,u,f;return p.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return e=this.props,e.student_id,t=e.school_id,n=this.state,r=n.id,s=n.name,a=n.profile_picture,i=n.class_id,c=n.passcode,o=n.isAdmin,l={id:r,name:s,profile_picture:a,class_id:i,passcode:c,isAdmin:o},h.next=5,p.a.awrap(wn("/school/"+t+"/teacher",l));case 5:if(d=h.sent,u=d.success,d.statusCode,f=d.message,d.data,u){h.next=10;break}return pe.a.alert("Sorry \u66f4\u6539\u6559\u5e2b\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+f,[{text:"Ok"}]),h.abrupt("return");case 10:this.props.goBack(),this.props.fetchTeacherData();case 12:case"end":return h.stop()}}),null,this,null,Promise)}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(r){t[r].name===e&&(n=r)})),this.setState({class_id:n,isAdmin:"\u7ba1\u7406\u54e1"===e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=(t.teacher,this.state),s=r.id,a=r.name,i=r.class_id,c=r.passcode;return Object(on.jsx)(O.a,{style:{flex:1,padding:30},children:Object(on.jsx)(O.a,{style:{flex:1,backgroundColor:"#F5F5F5"},children:Object(on.jsxs)(In.a,{children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",padding:20,justifyContent:"space-between"},children:[Object(on.jsxs)(O.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u59d3\u540d"}),Object(on.jsx)(Vn.a,{style:{fontSize:35,textAlign:"center"},value:a,onChangeText:function(t){return e.setState({name:t})}})]}),Object(on.jsxs)(O.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u5bc6\u78bc"}),Object(on.jsx)(Vn.a,{style:{fontSize:35,textAlign:"center"},value:c,keyboardType:"number-pad",onChangeText:function(t){return e.setState({passcode:t})}})]})]}),Object(on.jsx)(O.a,{style:{flex:1,padding:20},children:Object(on.jsxs)(O.a,{style:{padding:10,backgroundColor:"#ffddb7",height:"100%",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u73ed\u7d1a"}),Object(on.jsx)(Gn,{style:{backgroundColor:"rgba(255,255,255, 0)",alignItems:"center",padding:5},textStyle:{fontSize:30},selectedValue:""===i?"\u9078\u64c7\u73ed\u7d1a":n[i].name,options:Object.keys(n).map((function(e){return n[e].name})),handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t)}})]})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC",marginTop:20},children:[Object(on.jsx)(O.a,{style:{flex:1,padding:14},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:"\u8fd4\u56de"})})}),Object(on.jsx)(O.a,{style:{flex:1,padding:14},children:Object(on.jsx)(je.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postTeacher()},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:""===s?"\u65b0\u589e":"\u9001\u51fa"})})})]})]})})})}}]),n}(b.a.Component);function ha(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var ja=function(e){o()(r,e);var t=pa(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).getPermissionAsync=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Wn.a.OS){t.next=8;break}return t.next=3,p.a.awrap(Ms.b(Ms.a));case 3:if(e=t.sent,"granted"===e.status){t.next=8;break}return alert("Sorry, we need camera roll permissions to make this work!"),t.abrupt("return");case 8:case"end":return t.stop()}}),null,null,null,Promise)},n._pickImage=function(e,t){var r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(Ls.a({mediaTypes:Bs.a.All,allowsEditing:!0,aspect:[1,1],quality:.4,base64:!0}));case 3:(r=a.sent).cancelled||(s=r.base64,n.getProfilePictureURL(s,e,t)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}}),null,null,[[0,7]],Promise)},n.state={showModal:!1,modal_type:"",selected_teacher_id:""},n}return i()(r,[{key:"componentDidMount",value:function(){this.getPermissionAsync()}},{key:"getProfilePictureURL",value:function(e,t,n){var r,s,a,i,c,o,l;return p.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return r=this.props.route.params.school_name,s=this.props.teachers,a={image:e,url:n,path:r+"/teacher/profile_picture_"+t+"_"+(new Date).getMilliseconds()+".jpg"},d.next=5,p.a.awrap(vn("/user/"+t+"/profile-picture",a));case 5:if(i=d.sent,c=i.success,i.statusCode,o=i.message,l=i.data,c){d.next=10;break}return alert("Sorry "+s[t].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o),d.abrupt("return");case 10:this.props.updateTeacherProfilePicture(t,l.image_url);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"fetchTeacherData",value:function(){var e,t,n,r,s,a,i,c;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.route.params.school_id,o.next=3,p.a.awrap(_n("/school/"+e+"/teacher"));case 3:if(t=o.sent,n=t.success,t.statusCode,r=t.message,s=t.data,n){o.next=8;break}return alert("Sorry \u53d6\u5f97\u6559\u5e2b\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),o.abrupt("return");case 8:a=s.admins,i=s.teachers,c=s.classes,this.props.fetchTeachersSuccess(a,i,c);case 10:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"getModalContent",value:function(){var e=this,t=this.props.route.params.school_id,n=this.props,r=n.classes,s=n.teachers,a=this.state,i=a.modal_type,c=a.selected_teacher_id;return"add_teacher"===i?Object(on.jsx)(da,{classes:r,school_id:t,fetchTeacherData:function(){return e.fetchTeacherData()},goBack:function(){return e.hideModal()}}):"edit_teacher"===i?Object(on.jsx)(fa,{classes:r,teacher_id:c,teacher:s[c],fetchTeacherData:function(){return e.fetchTeacherData()},goBack:function(){return e.hideModal()}}):void 0}},{key:"hideModal",value:function(){this.setState({showModal:!1})}},{key:"confirmDeleteTeacher",value:function(e){var t=this.props.teachers;confirm(t[e].name+" \u522a\u9664\u78ba\u8a8d")&&this.deleteTeacher(e)}},{key:"deleteTeacher",value:function(e){var t,n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,p.a.awrap(Sn("/user/"+e));case 2:if(t=s.sent,n=t.success,t.statusCode,r=t.message,t.data,n){s.next=7;break}return alert("Sorry "+teachers[e].name+"\u522a\u9664\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),s.abrupt("return");case 7:this.fetchTeacherData();case 8:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.teachers,r=this.state.showModal;return Object(on.jsxs)(O.a,{children:[Object(on.jsx)(Ws,{show:r,component:this.getModalContent(),hideModal:function(){return e.hideModal()}}),Object(on.jsxs)(In.a,{children:[Object(on.jsx)(O.a,{style:{padding:20},children:Object(on.jsx)(je.a,{style:{padding:10,alignSelf:"flex-end",backgroundColor:"#ffddb7"},onPress:function(){return e.setState({showModal:!0,modal_type:"add_teacher"})},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:"\u65b0\u589e\u6559\u5e2b"})})}),Object.keys(t).map((function(r,s){var a=t[r];return Object(on.jsxs)(O.a,{style:{flex:1,backgroundColor:"lightgrey",flexDirection:"row",marginBottom:10,padding:15},children:[Object(on.jsx)(je.a,{style:{},onPress:function(){return e._pickImage(r,a.profile_picture)},children:Object(on.jsx)(be.a,{source:""===a.profile_picture?n(328):{uri:a.profile_picture},style:{width:200,height:200,borderRadius:100}})}),Object(on.jsx)(O.a,{style:{flex:5,paddingLeft:15},children:Object(on.jsx)(O.a,{children:Object(on.jsx)(x.a,{style:{fontSize:50},children:a.name})})}),Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"space-evenly"},children:[Object(on.jsx)(O.a,{style:{backgroundColor:"white"},children:Object(on.jsx)(je.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.setState({showModal:!0,modal_type:"edit_teacher",selected_teacher_id:r})},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u7de8\u8f2f"})})}),Object(on.jsx)(O.a,{style:{backgroundColor:"#fa625f"},children:Object(on.jsx)(je.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.confirmDeleteTeacher(r)},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u522a\u9664"})})})]})]},r)}))]})]})}}]),r}(b.a.Component),ba=(Object(A.b)((function(e){return{teachers:e.school.teachers,classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ha(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ha(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({updateTeacherProfilePicture:rn,fetchTeachersSuccess:Vt},e))}))(ja),function(e){var t=e.title,n=e.content,r=e.hideModal;return Object(on.jsx)(je.a,{style:{width:"100%",height:"100%",zIndex:2,position:"absolute",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.7)"},onPress:function(){return r()},children:Object(on.jsxs)(O.a,{style:{width:"80%",backgroundColor:"white"},children:[Object(on.jsx)(O.a,{style:{padding:10,fontSize:30},children:Object(on.jsx)(x.a,{children:t})}),Object(on.jsx)(O.a,{style:{padding:10},children:n})]})})}),ya=function(e){var t=e.label,n=e.value,r=e.keyboardType,s=e.onChangeText,a=e.labelStyle,i=e.inputStyle;return Object(on.jsxs)(O.a,{style:{flexDirection:"row",padding:5,width:"100%"},children:[Object(on.jsx)(x.a,{style:a,children:t+": "}),Object(on.jsx)(Vn.a,{value:n,keyboardType:r,style:i,onChangeText:function(e){return s(e)}})]})};function ga(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ga(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ga(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}he.a.create({cardContainer:{width:119,height:"100%",backgroundColor:"transparent"},thumbnailImage:{height:80,width:80,borderRadius:40}});var xa=Object(A.b)((function(e){return{class:e.classInfo,message:e.message,teachers:e.school.teachers}}),(function(e){return Oa({},Object(k.a)({writeToAll:kt,writeToOne:Pt,remindItemsToBringToAll:Tt,remindItemsToBringToOne:Et,recordActivitiesForAll:Rt,recordActivitiesForOne:It,writeItemToBringToAll:zt,writeItemToBringToOne:Lt,writeActivityForAll:Bt,writeActivityForOne:Mt,fetchClassMessageData:Ft,sendMessageOnSuccess:Gt,getParentMessageSuccess:cn},e))}))((function(e){var t=Object(D.f)(),r=Object(j.useState)({date:new Date,isLoading:!0,to_all_message:"",items_to_bring:["\u6bcd\u5976\u7c89","\u5c3f\u5e03","\u6c34\u58fa","\u8863\u7269"],other_item:"\u5176\u5b83",items_to_bring_bool:[0,0,0,0,0],activities_list:["\u5b30\u5152\u6309\u6469","\u97f3\u6a02\u5f8b\u52d5","\u6559\u5177\u64cd\u4f5c","\u7e6a\u672c\u6b23\u8cde","\u8a8d\u77e5\u5716\u7247","\u9ad4\u80fd\u6d3b\u52d5","\u85dd\u8853\u5275\u4f5c","\u591a\u5143\u8a9e\u8a00"],other_activity:"\u5176\u5b83",activities_bool:[0,0,0,0,0,0,0,0,0],message_by_student_id:{},editingOtherItemToBring:!1,editingOtherItemForStudent:"",editingOtherActivity:!1,editingOtherActivityForOne:"",showDateTimeModal:!1,growth_standard_by_student_id:{},show_growth_standard:!1,dob_year:"",dob_month:"",dob_date:""}),s=ue()(r,2),a=s[0],i=s[1];Object(j.useEffect)((function(){var n=null==t?void 0:t.state,r=n.date,s=(n.teacher_name,e.message.student_id_for_update),o=e.class.isConnected;s.size>0||!o?i(Oa(Oa({},a),{},{date:r,isLoading:!1})):(i(Oa(Oa({},a),{},{date:r})),c(r)),o||fe.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3})}),[]);var c=function(t){var n,r,s,c;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n=new Date(t),r=bn(n),n.setDate(n.getDate()+1),s=bn(n),o.next=6,p.a.awrap(Dn("message",e.class.class_id,r,s));case 6:c=o.sent,e.fetchClassMessageData(c.data),i(Oa(Oa({},a),{},{state:a,isLoading:!1}));case 9:case"end":return o.stop()}}),null,null,null,Promise)},o=function(n){var r=(null==t?void 0:t.state).teacher_id;e.writeToAll(n,r)},l=function(n,r){var s=(null==t?void 0:t.state).teacher_id;e.writeToOne(n,r,s)},d=function(n,r){var s=(null==t?void 0:t.state).teacher_id,a=e.message.message_by_student_id,i=I()(a[n].things_to_bring),c=i[r]?0:1;i.splice(r,1,c),e.remindItemsToBringToOne(n,i,s)},u=function(n){var r=(null==t?void 0:t.state).teacher_id,s=a.items_to_bring_bool,c=s[n]?0:1;s.splice(n,1,c),i(Oa(Oa({},a),{},{items_to_bring_bool:s})),e.remindItemsToBringToAll(s,r)},f=function(n,r){var s=(null==t?void 0:t.state).teacher_id,a=e.message.message_by_student_id,i=I()(a[n].activities),c=i[r]?0:1;i.splice(r,1,c),e.recordActivitiesForOne(n,i,s)},h=function(n){var r=(null==t?void 0:t.state).teacher_id,s=a.activities_bool,c=s[n]?0:1;s.splice(n,1,c),i(Oa(Oa({},a),{},{activities_bool:s})),e.recordActivitiesForAll(s,r)},b=function(t){var n=e.message,r=n.student_id_for_update,s=n.for_all,a=[];return r.forEach((function(e){a.push(Oa(Oa({},t[e]),{},{text:s.text+" \n"+t[e].text,student_id:e}))})),a},y=function(t){var n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,p.a.awrap(_n("/message/class/"+e.class.class_id+"/previous-day?date="+bn(t)));case 2:n=a.sent,r=n.statusCode,n.message,s=n.data,200===r&&e.getParentMessageSuccess(s);case 5:case"end":return a.stop()}}),null,null,null,Promise)},g=function(e){var t,n,r,s,c,o,l,d,u,f,h;return p.a.async((function(j){for(;;)switch(j.prev=j.next){case 0:if(t=a.growth_standard_by_student_id,""===(n=t[e]).weight||""===n.height||""===n.hc){j.next=9;break}return r=n.weight,s=n.height,c=n.hc,j.next=6,p.a.awrap(m(e,r,s,c));case 6:o=j.sent,l=o.success,o.statusCode,o.messate,d=o.data,l&&(u=d.weight_percentile,f=d.height_percentile,h=d.hc_percentile,i(Oa(Oa({},a),{},{growth_standard_by_student_id:Oa(Oa({},t),{},S()({},e,Oa(Oa({},t[e]),{},{weight_percentile:u,height_percentile:f,hc_percentile:h})))})));case 9:case"end":return j.stop()}}),null,null,null,Promise)},m=function(t,n,r,s){var a,i,c,o;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,p.a.awrap(wn("/student/growth-standard-percentile",{student_id:t,weight:n,height:r,head_circumference:s,date:bn(new Date)}));case 2:return a=l.sent,i=a.success,a.statusCode,c=a.message,a.data,i||(o=e.class.students,pe.a.alert(o[t].name+"\u7684\u9ad4\u4f4d\u8868\u8a08\u7b97\u51fa\u5dee\u932f",c,[{text:"OK"},{text:"\u73fe\u5728\u586b\u5165",onPress:function(){return _(t)}}])),l.abrupt("return",a);case 6:case"end":return l.stop()}}),null,null,null,Promise)},_=function(e){i(Oa(Oa({},a),{},{show_dob_modal:!0,student_id_dob_edit:e}))},w=(null==t?void 0:t.state).isAdmin,v=e.teachers,C=e.class.students,A=e.message,k=A.message_by_student_id,P=A.for_all,T=A.data_dispatched,E=A.student_id_for_update,R=A.parent_messages,z=a.items_to_bring,L=a.items_to_bring_bool,B=a.activities_list,M=a.activities_bool,F=a.editingOtherItemToBring,N=a.editingOtherItemForStudent,q=a.editingOtherActivity,U=a.editingOtherActivityForOne,H=a.date,V=a.showDateTimeModal,W=a.growth_standard_by_student_id,K=a.show_growth_standard,G=a.show_dob_modal,Q=a.dob_year,J=a.dob_month,X=a.dob_date;return Object(on.jsxs)(Hn.a,{style:{flex:1},behavior:"height",keyboardVerticalOffset:80,enabled:!0,children:[V&&Object(on.jsx)(Cr,{start_date:H,datetime_type:"date",hideModal:function(){return i(Oa(Oa({},a),{},{showDateTimeModal:!1}))},selectDatetimeConfirm:function(e){return function(e){i(Oa(Oa({},a),{},{date:e,showDateTimeModal:!1})),c(e),y(e)}(e)},minDatetime:null,maxDatetime:new Date}),G&&Object(on.jsx)(ba,{title:"\u5bf6\u8c9d\u51fa\u751f\u5e74\u6708\u65e5\u586b\u5165",content:Object(on.jsxs)(O.a,{style:{backgroundColor:"rgba(0,0,0,0.2)"},children:[Object(on.jsx)(ya,{label:"\u5e74",value:Q,keyboardType:"numeric",onChangeText:function(e){return i(Oa(Oa({},a),{},{dob_year:e}))},labelStyle:{padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)"},inputStyle:{flex:1,padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)",borderLeftWidth:1,borderColor:"white"}}),Object(on.jsx)(ya,{label:"\u6708",value:J,keyboardType:"numeric",onChangeText:function(e){return i(Oa(Oa({},a),{},{dob_month:e}))},labelStyle:{padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)"},inputStyle:{flex:1,padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)",borderLeftWidth:1,borderColor:"white"}}),Object(on.jsx)(ya,{label:"\u65e5",value:X,keyboardType:"numeric",onChangeText:function(e){return i(Oa(Oa({},a),{},{dob_date:e}))},labelStyle:{padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)"},inputStyle:{flex:1,padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)",borderLeftWidth:1,borderColor:"white"}}),Object(on.jsx)(je.a,{onPress:function(){return function(){var e,t,n,r,s,c,o,l,d;return p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return e=a.student_id_dob_edit,t=a.dob_year,n=a.dob_month,r=a.dob_date,s=a.growth_standard_by_student_id,c=s[e],c.weight,c.height,c.hc,u.next=4,p.a.awrap(vn("/student/"+e+"/dob",{dob:t+"-"+n+"-"+r}));case 4:o=u.sent,l=o.success,o.statusCode,d=o.message,o.data,l?(i(Oa(Oa({},a),{},{show_dob_modal:!1})),pe.a.alert("\u66f4\u6539\u6210\u529f\uff01","",[{text:"OK",onPress:function(){return g(e)}}])):pe.a.alert("\u51fa\u751f\u5e74\u6708\u65e5\u66f4\u6539\u672a\u6210\u529f",d,[{text:"OK"}]);case 7:case"end":return u.stop()}}),null,null,null,Promise)}()},children:Object(on.jsx)(x.a,{style:{fontSize:20,padding:15,backgroundColor:"#b5e9e9"},children:"\u9001\u51fa"})})]}),hideModal:function(){return i(Oa(Oa({},a),{},{show_dob_modal:!1}))}}),Object(on.jsxs)(O.a,{style:{padding:10,flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[Object(on.jsx)(je.a,{onPress:function(){T&&w&&i(Oa(Oa({},a),{},{showDateTimeModal:!0}))},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:yn(H)})}),Object(on.jsx)(je.a,{style:{borderWidth:K?0:2,borderColor:K?"transparent":"green",backgroundColor:K?"#dcf3d0":"transparent"},onPress:function(){return function(){var t=e.class.students,n=a.show_growth_standard,r={};Object.keys(t).map((function(e){r[e]={weight:"",height:"",hc:""}})),i(Oa(Oa({},a),{},{growth_standard_by_student_id:r,show_growth_standard:!n}))}()},children:Object(on.jsx)(x.a,{style:{fontSize:40,padding:5},children:"\u9ad4\u4f4d\u8868"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"#dcf3d0"},onPress:function(){return function(){var t=e.message,n=t.message_by_student_id,r=t.student_id_for_update,s=e.class.isConnected;if(0!==r.size)if(s){var a={date:bn(new Date),data:b(n)};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/message",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message;t.data;n>200||"Internal server error"===r?pe.a.alert("Error",r,[{text:"OK"}]):(e.sendMessageOnSuccess(),e.navigation.goBack())})).catch((function(e){pe.a.alert("Error",e,[{text:"OK"}])}))}else fe.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3});else e.navigation.goBack()}()},children:Object(on.jsx)(x.a,{style:{fontSize:40,padding:5},children:"\u9001\u51fa"})})]}),Object(on.jsxs)(In.a,{contentContainerStyle:{alignItems:"center",marginBottom:20},children:[Object(on.jsx)(O.a,{style:{width:"95%"},children:Object(on.jsx)(fe.Card,{style:{padding:10},children:Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",paddingVertical:10},children:[Object(on.jsxs)(O.a,{style:{width:"29%",backgroundColor:"#fff1b5",borderRadius:10,marginRight:5},children:[Object(on.jsx)(x.a,{style:{fontSize:35,alignSelf:"center"},children:"\u5bb6\u9577\u6e96\u5099"}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",flexWrap:"wrap"},children:[z.map((function(e,t){return Object(on.jsx)(je.a,{style:{backgroundColor:L[t]?"#f4d41f":"#fff7d6",borderRadius:3,padding:3,margin:5},onPress:function(){return u(t)},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:e})},t)})),Object(on.jsx)(je.a,{style:{backgroundColor:L[4]?"#f4d41f":"#fff7d6",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#f4d41f",onPress:function(){return u(4)},onLongPress:function(){return i(Oa(Oa({},a),{},{editingOtherItemToBring:!0}))},children:F?Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(Vn.a,{autoFocus:!0,selectTextOnFocus:!0,value:a.other_item,style:{alignSelf:"center",fontSize:20,backgroundColor:L[4]?"#f4d41f":"#fff7d6"},onChangeText:function(n){return function(n){var r=(null==t?void 0:t.state).teacher_id;i(Oa(Oa({},a),{},{other_item:n})),e.writeItemToBringToAll(n,r)}(n.trim())},onBlur:function(){return function(){var e=a.other_item;i(Oa(Oa({},a),{},{editingOtherItemToBring:!1,other_item:""===e?"\u5176\u5b83":e}))}()}})}):Object(on.jsx)(x.a,{style:{alignSelf:"center",fontSize:20},children:a.other_item})})]})]}),Object(on.jsxs)(O.a,{style:{width:"69%",backgroundColor:"#b5e9e9",borderRadius:10,marginLeft:5},children:[Object(on.jsx)(x.a,{style:{fontSize:35,alignSelf:"center"},children:"\u4eca\u65e5\u6d3b\u52d5"}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-evenly",flexWrap:"wrap"},children:[B.map((function(e,t){return Object(on.jsx)(je.a,{style:{backgroundColor:M[t]?"#368cbf":"#eaf8f8",borderRadius:3,padding:3,margin:5},onPress:function(){return h(t)},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:e})},t)})),Object(on.jsx)(je.a,{style:{backgroundColor:M[8]?"#368cbf":"#eaf8f8",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#368cbf",onPress:function(){return h(8)},onLongPress:function(){return i(Oa(Oa({},a),{},{editingOtherActivity:!0}))},children:q?Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(Vn.a,{autoFocus:!0,selectTextOnFocus:!0,value:a.other_activity,style:{alignSelf:"center",fontSize:20,backgroundColor:M[8]?"#368cbf":"#eaf8f8"},onChangeText:function(n){return function(n){var r=(null==t?void 0:t.state).teacher_id;i(Oa(Oa({},a),{},{other_activity:n})),e.writeActivityForAll(n,r)}(n.trim())},onBlur:function(){return function(){var e=a.other_activity;i(Oa(Oa({},a),{},{editingOtherActivity:!1,other_activity:""===e?"\u5176\u5b83":e}))}()}})}):Object(on.jsx)(x.a,{style:{alignSelf:"center",fontSize:20},children:a.other_activity})})]})]})]}),Object(on.jsx)(Vn.a,{value:P.text,style:{alignSelf:"center",width:"100%",borderColor:"gray",borderWidth:2,borderRadius:10,fontSize:25,padding:20},multiline:!0,onChangeText:function(e){return o(e)},onEndEditing:function(){return o(P.text.trim())}})]})})}),Object.keys(C).map((function(r){var s=k[r],c=s.text,o=s.things_to_bring,u=s.activities,h=s.other_item,p=s.other_activity,j=s.teacher_id,b=void 0===v[j]?"":"- "+v[j].name;return Object(on.jsx)(O.a,{style:{width:"95%"},children:Object(on.jsx)(fe.Card,{style:{padding:10},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsxs)(O.a,{style:{flex:1,alignItems:"center",justifyContent:"center"},children:[Object(on.jsx)(be.a,{source:""===C[r].profile_picture?n(77):{uri:C[r].profile_picture},style:{width:100,height:100,borderRadius:50}}),Object(on.jsx)(x.a,{style:{fontSize:25},children:C[r].name})]}),Object(on.jsxs)(O.a,{style:{flex:4},children:[K&&Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsxs)(O.a,{children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",paddingBottom:15},children:[Object(on.jsx)(x.a,{style:{fontSize:20,paddingRight:15},children:"\u9ad4\u91cd:"}),Object(on.jsx)(Vn.a,{value:W[r].weight,keyboardType:"numeric",style:{fontSize:20,borderBottomWidth:1,paddingHorizontal:10,paddingVertical:1},onChangeText:function(e){i(Oa(Oa({},a),{},{growth_standard_by_student_id:Oa(Oa({},W),{},S()({},r,Oa(Oa({},W[r]),{},{weight:e})))}))},onBlur:function(){return g(r)}}),Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:15},children:"kg"}),Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:15},children:W[r].weight_percentile&&"("+W[r].weight_percentile+")"})]}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",paddingBottom:15},children:[Object(on.jsx)(x.a,{style:{fontSize:20,paddingRight:15},children:"\u8eab\u9ad8:"}),Object(on.jsx)(Vn.a,{value:W[r].height,keyboardType:"numeric",style:{fontSize:20,borderBottomWidth:1,paddingHorizontal:10,paddingVertical:1},onChangeText:function(e){i(Oa(Oa({},a),{},{growth_standard_by_student_id:Oa(Oa({},W),{},S()({},r,Oa(Oa({},W[r]),{},{height:e})))}))},onBlur:function(){return g(r)}}),Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:15},children:"cm"}),Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:15},children:W[r].height_percentile&&"("+W[r].height_percentile+")"})]}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",paddingBottom:15},children:[Object(on.jsx)(x.a,{style:{fontSize:20,paddingRight:15},children:"\u982d\u570d:"}),Object(on.jsx)(Vn.a,{value:W[r].hc,keyboardType:"numeric",style:{fontSize:20,borderBottomWidth:1,paddingHorizontal:10,paddingVertical:1},onChangeText:function(e){i(Oa(Oa({},a),{},{growth_standard_by_student_id:Oa(Oa({},W),{},S()({},r,Oa(Oa({},W[r]),{},{hc:e})))}))},onBlur:function(){return g(r)}}),Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:15},children:"cm"}),Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:15},children:W[r].hc_percentile&&"("+W[r].hc_percentile+")"})]})]}),Object(on.jsx)(O.a,{style:{padding:10},children:Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"#b5e9e9"},underlayColor:"#368cbf",onPress:function(){return function(n){var r=(null==t?void 0:t.state).teacher_id,s=e.message.message_by_student_id[n].text,i=a.growth_standard_by_student_id[n],c=i.weight,o=i.height,l=i.hc,d=i.weight_percentile,u=i.height_percentile,f=i.hc_percentile;null!==d?null!==u?null!==f?(s+="\n\u9ad4\u91cd: "+c+" kg ("+d+")\n\u8eab\u9ad8: "+o+" cm ("+u+")\n\u982d\u570d: "+l+" cm ("+f+")",e.writeToOne(s,n,r)):pe.a.alert("\u982d\u570d\u767e\u5206\u6bd4\u9084\u672a\u8a08\u7b97\u51fa\u4f86","",[{text:"OK"}]):pe.a.alert("\u8eab\u9ad8\u767e\u5206\u6bd4\u9084\u672a\u8a08\u7b97\u51fa\u4f86","",[{text:"OK"}]):pe.a.alert("\u9ad4\u91cd\u767e\u5206\u6bd4\u9084\u672a\u8a08\u7b97\u51fa\u4f86","",[{text:"OK"}])}(r)},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u78ba\u8a8d\u8f09\u5165"})})})]}),Object(on.jsxs)(O.a,{style:{flex:1,paddingBottom:10},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",backgroundColor:"#fff1b5",borderRadius:10},children:[Object(on.jsx)(x.a,{style:{fontSize:28},children:"\u5bb6\u9577\u6e96\u5099"}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",flexWrap:"wrap"},children:[z.map((function(e,t){return Object(on.jsx)(je.a,{style:{backgroundColor:o[t]?"#f4d41f":"#fff7d6",borderRadius:3,padding:4,margin:5},onPress:function(){return d(r,t)},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:e})},t)})),Object(on.jsx)(je.a,{style:{backgroundColor:o[4]?"#f4d41f":"#fff7d6",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#f4d41f",onPress:function(){return d(r,4)},onLongPress:function(){return i(Oa(Oa({},a),{},{editingOtherItemForStudent:r}))},children:N===r?Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(Vn.a,{autoFocus:!0,selectTextOnFocus:!0,value:h,style:{alignSelf:"center",fontSize:20,backgroundColor:o[4]?"#f4d41f":"#fff7d6"},onChangeText:function(n){return function(n,r){var s=(null==t?void 0:t.state).teacher_id;e.writeItemToBringToOne(n,r,s)}(r,n.trim())},onBlur:function(){return function(t,n){i(Oa(Oa({},a),{},{editingOtherItemForStudent:""})),""===n&&e.writeItemToBringToOne(t,"\u5176\u5b83")}(r,h)}})}):Object(on.jsx)(x.a,{style:{alignSelf:"center",fontSize:20},children:h})})]})]}),Object(on.jsxs)(O.a,{style:{borderRadius:10,backgroundColor:"#b5e9e9"},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:2},children:Object(on.jsx)(x.a,{style:{fontSize:28},children:"\u4eca\u65e5\u6d3b\u52d5"})}),Object(on.jsx)(O.a,{style:{flex:1},children:E.has(r)?Object(on.jsx)(x.a,{style:{fontSize:15,alignSelf:"flex-end",paddingRight:10,color:"red"},children:"\u672a\u9001\u51fa"}):null})]}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",flexWrap:"wrap"},children:[B.map((function(e,t){return Object(on.jsx)(je.a,{style:{backgroundColor:u[t]?"#368cbf":"#d6f2f2",borderRadius:3,padding:4,margin:5},onPress:function(){return f(r,t)},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:e})},t)})),Object(on.jsx)(je.a,{style:{backgroundColor:u[8]?"#368cbf":"#d6f2f2",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#368cbf",onPress:function(){return f(r,8)},onLongPress:function(){return i(Oa(Oa({},a),{},{editingOtherActivityForOne:r}))},children:U===r?Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(Vn.a,{autoFocus:!0,selectTextOnFocus:!0,value:p,style:{alignSelf:"center",fontSize:20,backgroundColor:u[8]?"#368cbf":"#d6f2f2"},onChangeText:function(n){return function(n,r){var s=(null==t?void 0:t.state).teacher_id;e.writeActivityForOne(n,r,s)}(r,n.trim())},onBlur:function(){return function(t,n){i(Oa(Oa({},a),{},{editingOtherActivityForOne:""})),""===n&&e.writeActivityForOne(t,"\u5176\u5b83")}(r,p)}})}):Object(on.jsx)(x.a,{style:{alignSelf:"center",fontSize:20},children:p})})]})]})]}),void 0!==R[r]&&Object(on.jsx)(x.a,{style:{fontSize:20,padding:20},children:R[r]}),""!==P.text&&Object(on.jsx)(Vn.a,{editable:!1,value:P.text,style:{borderColor:"gray",borderTopWidth:2,borderLeftWidth:2,borderRightWidth:2,borderTopLeftRadius:10,borderTopRightRadius:10,fontSize:25,padding:20,backgroundColor:"#F5F5F5"},multiline:!0}),Object(on.jsx)(Vn.a,{value:c,style:{borderColor:"gray",borderBottomWidth:2,borderLeftWidth:2,borderRightWidth:2,borderTopWidth:""!==P.text?0:2,borderBottomLeftRadius:10,borderBottomRightRadius:10,borderTopLeftRadius:""!==P.text?0:10,borderTopRightRadius:""!==P.text?0:10,fontSize:25,padding:20},multiline:!0,onChangeText:function(e){return l(e,r)},onEndEditing:function(){return l(c.trim(),r)}}),Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"flex-end"},children:b})]})]})})},r)}))]})]})}));function ma(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ma(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ma(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wa=Object(A.b)((function(e){return{school:e.school,teacherOnDuty:e.school.teacherOnDuty,teachers:e.school.teachers,passcodeAdminId:e.school.passcodeAdminId,attendance:e.attendance}}),(function(e){return _a({},Object(k.a)({fetchTeacherAttendanceSuccess:Xt,fetchStudentAttendanceSuccess:Yt},e))}))((function(e){var t=Object(j.useState)({isLoading:!0,display_list:[],students_or_teachers:"students",selected_class_id:"all",showLoginNumberPad:!1,showModal:!1,modalStudentId:"",teacherClicked:"",teacher_id:"",pageClicked:""}),r=ue()(t,2),s=r[0],a=r[1],i=function(t){var n=e.school.classes,r=s.selected_class_id;a(_a(_a({},s),{},"all"!==r?{display_list:n[r][t],students_or_teachers:t}:{display_list:Object.keys(e.school[t]),students_or_teachers:t}))},c=function(t){var n=e.school.classes,r=s.students_or_teachers,i=s.selected_class_id,c=[],o=[];o="all"===i?Object.keys(e.school[r]):n[i][r];for(var l=0;l<o.length;l++)(e.school["student_"+t].has(o[l])||e.school["teacher_"+t].has(o[l]))&&c.push(o[l]);a(_a(_a({},s),{},{display_list:c}))},o=function(e){a(_a(_a({},s),{},{modalStudentId:e,showModal:!0}))},l=s.display_list,d=s.students_or_teachers,u=s.selected_class_id,f=s.modalStudentId,h=s.teacherClicked,p=s.teacher_id,b=s.showLoginNumberPad,y=e.school_id,g=e.school,m=e.teacherOnDuty,_=g.student_present,w=g.student_unmarked,v=(g.student_absent,g.teacher_present),S=g.teacher_unmarked;g.teacher_absent;return Object(on.jsxs)("div",{children:[b?Object(on.jsx)(fn,{handleEnterPasscode:function(t){return function(t){var n=e.school.passcodeTeacherId,r=e.passcodeAdminId,i=(e.teachers,s.pageClicked),c=s.teacherClicked,o=n[t],l=r[t];void 0!==l?a(_a(_a({},s),{},{teacher_id:l,pageClicked:"",showModal:!0,showLoginNumberPad:!1})):"student_modal"===i&&void 0!==o?a(_a(_a({},s),{},{teacher_id:o,pageClicked:"",showModal:!0,showLoginNumberPad:!1})):void 0===o||o!==c?alert("\u5bc6\u78bc\u932f\u8aa4!"):a(_a(_a({},s),{},{showModal:!0,showLoginNumberPad:!1}))}(t)},hideLoginPad:function(){a(_a(_a({},s),{},{showLoginNumberPad:!1,modalStudentId:""}))}}):null,Object(on.jsx)(br,{show:s.showModal,student_id:f,teacher_id:h,teacherOnDuty:m||p,class_id:u,school_id:y,navigation:e.navigation,fetchStudentAttendance:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return fetchStudentAttendance()})),fetchTeacherAttendance:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){return fetchTeacherAttendance()})),hideModal:function(){a(_a(_a({},s),{},{showModal:!1,modalStudentId:"",teacher_id:""}))}}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"},children:[Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"students"===d?"lightgrey":"white",justifyContent:"center"},onPress:function(){return i("students")},children:Object(on.jsx)(x.a,{style:{fontSize:40,textAlign:"center"},children:"\u5b78\u751f"})})}),Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"teachers"===d?"lightgrey":"white",justifyContent:"center"},onPress:function(){return i("teachers")},children:Object(on.jsx)(x.a,{style:{fontSize:40,textAlign:"center"},children:"\u6559\u5e2b"})})})]}),Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"},children:Object.keys(g.classes).map((function(t){return"all"===t?null:Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:u===t?"lightgrey":"white",justifyContent:"center"},onPress:function(){return function(t){var n=e.school.classes,r=s.students_or_teachers;a(_a(_a({},s),{},{display_list:n[t][r],selected_class_id:t}))}(t)},children:Object(on.jsx)(x.a,{style:{fontSize:40,textAlign:"center"},children:g.classes[t].name})})},t)}))}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"},children:[Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"#ffe1d0",justifyContent:"center"},onPress:function(){return c("absent")},children:Object(on.jsx)(x.a,{style:{fontSize:40,textAlign:"center"},children:"\u7f3a\u5e2d"})})}),Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"#fff1b5",justifyContent:"center"},onPress:function(){return c("unmarked")},children:Object(on.jsx)(x.a,{style:{fontSize:40,textAlign:"center"},children:"\u672a\u77e5"})})}),Object(on.jsx)(O.a,{style:{flex:1,padding:10},children:Object(on.jsx)(je.a,{style:{flex:1,backgroundColor:"#dcf3d0",justifyContent:"center"},onPress:function(){return c("present")},children:Object(on.jsx)(x.a,{style:{fontSize:40,textAlign:"center"},children:"\u51fa\u5e2d"})})})]}),Object(on.jsx)(O.a,{style:{flex:9,backgroundColor:"lightgrey"},children:Object(on.jsx)(In.a,{contentContainerStyle:{flexDirection:"row",flexWrap:"wrap",backgroundColor:"transparent"},children:l.map((function(t){var r=g[d][t];return Object(on.jsx)(je.a,{style:{height:200,width:"25%",padding:5},onPress:function(){return function(t){var n=e.teacherOnDuty;if("students"===s.students_or_teachers){if(""===n)return void a(_a(_a({},s),{},{showLoginNumberPad:!0,pageClicked:"student_modal",modalStudentId:t}));o(t)}else a(_a(_a({},s),{},{showLoginNumberPad:!0,teacherClicked:t}))}(t)},children:Object(on.jsxs)(O.a,{style:{flex:1,padding:10,backgroundColor:"white"},children:[Object(on.jsx)(O.a,{style:{justifyContent:"center"},children:Object(on.jsx)(be.a,{source:""===r.profile_picture&&"students"===d?n(77):""===r.profile_picture&&"teachers"===d?n(328):{uri:r.profile_picture},style:{height:150,width:150,borderRadius:75,borderWidth:10,borderColor:_.has(t)||v.has(t)?"#dcf3d0":w.has(t)||S.has(t)?"#fff1b5":"#ffe1d0"}})}),Object(on.jsx)(O.a,{footer:!0,style:{justifyContent:"center",marginTop:-5},children:Object(on.jsx)(x.a,{style:{marginTop:-10},children:r.name})})]})},t)}))})})]})}));function va(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?va(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):va(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ca=he.a.create({cardContainer:{width:170,paddingRight:5},thumbnailImage:{height:160,width:160,borderRadius:80}}),Da=Object(A.b)((function(e){return{class:e.classInfo,requests:e.medicationrequests}}),(function(e){return Sa({},Object(k.a)({},e))}))((function(e){var t=Object(D.f)(),r=Object(j.useState)({date:new Date,isLoading:!0,refreshing:!1,selected_request_id:"",showLoginNumberPad:!1,messages:[],messages_read:new Set,showDateModal:!1}),s=ue()(r,2),a=s[0],i=s[1];Object(j.useEffect)((function(){console.log("location?.state: ",t);var e=(null==t?void 0:t.state)||{},n=e.messages,r=void 0===n?[]:n,s=e.date;i(Sa(Sa({},a),{},{date:s,messages:o(r)}))}),[]);var c=function(e){for(var t=a.messages,n=a.messages_read,r=t.length;e<r-1;){var s=t[e+1].message_id;if(!n.has(s)){var c=t[e];t[e]=t[e+1],t[e+1]=c}e+=1}i(Sa(Sa({},a),{},{messages:t}))},o=function(e){for(var t=e,n=0,r=new Set,s=0;s<t.length;s++){var c=t[s],o=c.message_id,l=c.morning_reminder_id,d=c.message_read,u=c.morning_reminder_read;if(null!==d&&!d||null!==u&&!u){var f=t[n];t[n]=t[s],t[s]=f,n+=1}else null!==o&&r.add(o),null!==l&&r.add(l)}return i(Sa(Sa({},a),{},{messages_read:r})),t},l=function(e){i(Sa(Sa({},a),{},{date:e,showDateModal:!1})),function(e){var n,r,s,c,l,d;p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=(null==t?void 0:t.state)||{},r=n.class_id,u.next=3,p.a.awrap(_n("/message/class/"+r+"/unread?date="+bn(e)));case 3:if(s=u.sent,c=s.success,s.statusCode,l=s.message,d=s.data,c){u.next=8;break}return pe.a.alert("Sorry \u53d6\u5f97\u5bb6\u9577\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l,[{text:"Ok"}]),u.abrupt("return");case 8:i(Sa(Sa({},a),{},{messages:o(d)}));case 9:case"end":return u.stop()}}),null,null,null,Promise)}(e)},d=((null==t?void 0:t.state)||{}).students,u=a.messages,f=a.messages_read,h=a.date,b=a.showDateModal;return Object(on.jsxs)(O.a,{style:{flex:1,paddingBottom:40},children:[b&&Object(on.jsx)(Cr,{start_date:h,datetime_type:"date",hideModal:function(){return i(Sa(Sa({},a),{},{showDateModal:!1}))},selectDatetimeConfirm:function(e){return l(e)},minDatetime:null,maxDatetime:new Date}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between"},children:[Object(on.jsx)(O.a,{style:{width:"15%"},children:Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return function(){var e=new Date(a.date.getTime());1===e.getDay()?e.setDate(e.getDate()-3):e.setDate(e.getDate()-1),l(e)}()},children:Object(on.jsx)(be.a,{source:n(334),style:{width:40,height:40}})})}),Object(on.jsx)(je.a,{style:{alignSelf:"center",padding:10},onPress:function(){return i(Sa(Sa({},a),{},{showDateModal:!0}))},children:Object(on.jsx)(x.a,{style:{fontSize:50},children:yn(h)})}),Object(on.jsx)(O.a,{style:{width:"15%"},children:h.toDateString()!==(new Date).toDateString()&&Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return function(){var e=new Date(a.date.getTime());5===e.getDay()?e.setDate(e.getDate()+3):e.setDate(e.getDate()+1),l(e)}()},children:Object(on.jsx)(be.a,{source:n(335),style:{width:40,height:40}})})})]}),Object(on.jsx)(In.a,{children:u.map((function(e,t){var r=e.message_id,s=e.morning_reminder_id,o=(e.activities,e.items_to_bring,e.message_for_teacher),l=e.morning_reminder,u=(e.other_activity,e.other_item,e.student_id),h=(e.teacher_id,e.text),j=(e.message_read,e.morning_reminder_read,f.has(r)||f.has(s));return Object(on.jsxs)(O.a,{style:{flexDirection:"row",backgroundColor:"white",borderWidth:1,borderColor:"lightgrey",marginBottom:20,padding:20},children:[Object(on.jsxs)(O.a,{children:[Object(on.jsx)(be.a,{source:""===d[u].profile_picture?n(77):{uri:d[u].profile_picture},style:Ca.thumbnailImage}),Object(on.jsx)(O.a,{style:{justifyContent:"center",alignItems:"center",paddingTop:20},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:d[u].name})}),Object(on.jsx)(je.a,{disabled:j,style:{justifyContent:"center",justifyContent:"center",justifyContent:"center",alignItems:"center",alignItems:"center",alignItems:"center",marginTop:20,padding:15,backgroundColor:j?"#dcf3d0":"#ffe1d0"},onPress:function(){return function(e,t,n,r){var s,o,l,d;return p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,p.a.awrap(vn("/message/read",{message_id:e,morning_reminder_id:t,student_id:n}));case 2:if(s=u.sent,o=s.success,s.statusCode,l=s.message,s.data,o){u.next=7;break}return pe.a.alert("Sorry \u6a19\u8a18\u5df2\u8b80\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l,[{text:"Ok"}]),u.abrupt("return");case 7:c(r),d=new Set(I()(a.messages_read)),null!==e&&d.add(e),null!==t&&d.add(t),i(Sa(Sa({},a),{},{messages_read:d}));case 12:case"end":return u.stop()}}),null,null,null,Promise)}(r,s,u,t)},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:j?"\u5df2\u8b80":"\u672a\u8b80"})})]}),Object(on.jsxs)(O.a,{style:{flex:1,marginLeft:20},children:[Object(on.jsxs)(O.a,{style:{},children:[Object(on.jsx)(x.a,{style:{fontSize:25,fontWeight:"bold"},children:"\u8001\u5e2b\u7684\u8a71:"}),Object(on.jsx)(x.a,{style:{fontSize:20},children:h&&h+"\n"})]}),Object(on.jsxs)(O.a,{style:{},children:[Object(on.jsx)(x.a,{style:{fontSize:25,fontWeight:"bold"},children:"\u5bb6\u9577\u56de\u61c9:"}),Object(on.jsx)(x.a,{style:{fontSize:20},children:o&&o+"\n"})]}),Object(on.jsxs)(O.a,{style:{},children:[Object(on.jsx)(x.a,{style:{fontSize:25,fontWeight:"bold"},children:"\u65e9\u6668\u53ee\u5680:"}),Object(on.jsx)(x.a,{style:{fontSize:20},children:l&&l+"\n"})]})]})]},t)}))})]})}));function Aa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}!function(e){o()(n,e);var t=Aa(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={showModal:!1,modal_type:""},r}i()(n,[{key:"componentDidMount",value:function(){}},{key:"handleNavigate",value:function(e){var t=this.props.route.params,n=t.school_name,r=t.school_id;this.props.navigation.navigate(e,{school_name:n,school_id:r})}},{key:"render",value:function(){var e=this;return Object(on.jsxs)(In.a,{contentContainerStyle:{alignItems:"center",justifyContent:"space-around"},children:[Object(on.jsx)(je.a,{style:{width:"80%",padding:50,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",marginVertical:20},onPress:function(){return e.handleNavigate("DownloadTeacherAttendance")},underlayColor:"#368cbf",children:Object(on.jsx)(x.a,{style:{fontSize:70},children:"\u5b78\u751f\u51fa\u52e4\u8868"})}),Object(on.jsx)(je.a,{style:{width:"80%",padding:50,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",marginVertical:20},onPress:function(){return e.handleNavigate("DownloadTeacherAttendance")},underlayColor:"#368cbf",children:Object(on.jsx)(x.a,{style:{fontSize:70},children:"\u6559\u5e2b\u51fa\u52e4\u8868"})})]})}}])}(b.a.Component);function ka(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}!function(e){o()(n,e);var t=ka(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={showModal:!1,modal_type:""},r}i()(n,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.school_name,n=e.school_id;console.log("school_name, school_id: ",t,n)}},{key:"render",value:function(){return Object(on.jsx)(In.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center"}})}}])}(b.a.Component);function Pa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ta(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pa(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ea=Object(A.b)((function(e){return{classes:e.school.classes,students:e.school.students}}))((function(e){var t=Object(D.f)(),n=Object(D.g)(),r=Object(j.useState)({date:new Date,selected_all_classes:!0,selected_classes:new Set,class_id_list:[],text:"",announcements:[],page_number:0,is_loading:!0}),s=ue()(r,2),a=s[0],i=s[1];Object(j.useEffect)((function(){c()}),[]);var c=function(){var e,n,r,s,c,o;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=null==t?void 0:t.state,n=e.school_id,r=a.page_number,l.next=4,p.a.awrap(_n("/announcement?school_id="+n+"&page="+r));case 4:s=l.sent,c=s.success,s.statusCode,s.message,o=s.data,c&&i(Ta(Ta({},a),{},{announcements:o}));case 7:case"end":return l.stop()}}),null,null,null,Promise)},o=null==t?void 0:t.state,l=o.school_id,d=o.school_name,u=(e.classes,e.students,a.announcements);return Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{flexDirection:"row",justifyContent:"flex-end",paddingVertical:7},children:Object(on.jsx)(je.a,{style:{padding:10,backgroundColor:"lightblue",marginRight:10},onPress:function(){return n("new",{school_id:l,school_name:d})},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u65b0\u589e"})})}),Object(on.jsx)(In.a,{contentContainerStyle:{alignItems:"center"},children:u.map((function(e,t){var r=e.id,s=yn(new Date(e.timestamp));return Object(on.jsx)(je.a,{style:{width:"90%"},onPress:function(){return n(""+r,{state:{school_id:l,announcement:e,school_name:d}})},children:Object(on.jsx)(fe.Card,{style:{padding:20,width:"95%",height:200,flexDirection:"row"},children:Object(on.jsxs)(O.a,{style:{width:"100%",overflow:"hidden"},children:[Object(on.jsxs)(O.a,{style:{paddingBottom:20},children:[Object(on.jsx)(x.a,{style:{fontSize:25},children:e.title}),Object(on.jsx)(x.a,{style:{fontSize:15},children:s})]}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsx)(x.a,{style:{fontSize:18},children:e.text})})]})})},r)}))})]})}));function Ra(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Ia=function(e){o()(n,e);var t=Ra(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).getPermissionAsync=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Wn.a.OS){t.next=6;break}return t.next=3,p.a.awrap(Ms.b(Ms.a));case 3:e=t.sent,"granted"!==e.status&&alert("Sorry, we need camera roll permissions to make this work!");case 6:case"end":return t.stop()}}),null,null,null,Promise)},r._pickImage=function(){var e,t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,p.a.awrap(Ls.a({mediaTypes:Bs.a.All,allowsEditing:!1,quality:.4,base64:!0}));case 3:(e=n.sent).cancelled||(t=e.base64,r.setState({images:[].concat(I()(r.state.images),[t])})),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}}),null,null,[[0,7]],Promise)},r.state={date:new Date,selected_all_classes:!0,selected_classes:new Set,class_id_list:[],text:"",title:"",images:[],sendLoading:!1,links:[]},r}return i()(n,[{key:"componentDidMount",value:function(){this.getPermissionAsync();var e=this.props.classes,t=[];Object.keys(e).forEach((function(e){t.push(e)})),this.setState({class_id_list:t,selected_classes:new Set(t)})}},{key:"selectClass",value:function(e){var t=this.state,n=t.selected_classes,r=t.class_id_list,s=new Set(I()(n));s.has(e)?s.delete(e):s.add(e),this.setState({selected_classes:s,selected_all_classes:s.size===r.length})}},{key:"selectAllClasses",value:function(){var e=this.state.selected_all_classes;this.setState({selected_all_classes:!e,selected_classes:e?new Set:new Set(this.state.class_id_list)})}},{key:"postAnnouncement",value:function(){var e,t,n,r,s,a,i,c,o,l,d,u;return p.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:if(e=this.props.route.params,t=e.school_id,n=e.school_name,r=this.state,s=r.text,a=r.date,i=r.selected_classes,c=r.title,o=r.images,l=r.links,0!==i.size){f.next=5;break}return alert("\u8acb\u9078\u64c7\u73ed\u7d1a"),f.abrupt("return");case 5:if(""!==c){f.next=8;break}return alert("Title \u672a\u586b"),f.abrupt("return");case 8:return this.setState({sendLoading:!0}),f.next=11,p.a.awrap(wn("/announcement",{school_id:t,title:c,text:s,timestamp:bn(a)+" "+On(a),class_id_list:I()(i),images:o,school_name:n,links:l}));case 11:if(d=f.sent,u=d.success,d.statusCode,d.message,d.data,!u){f.next=17;break}this.props.navigation.navigate("AnnouncementHome",{school_id:t,school_name:n,update_page:!0}),f.next=19;break;case 17:return alert("\u9001\u51fa\u8a0a\u606f\u6642\u51fa\u72c0\u6cc1"),f.abrupt("return");case 19:case"end":return f.stop()}}),null,this,null,Promise)}},{key:"removeImage",value:function(e){var t=this.state.images;t.splice(e,1),this.setState({images:t})}},{key:"handleAddLink",value:function(){var e=this.state.links;e.push({text:"",url:""}),this.setState({links:e})}},{key:"handleChangeLinkText",value:function(e,t){var n=this.state.links;n[t].text=e,this.setState({links:n})}},{key:"handleChangeUrl",value:function(e,t){var n=this.state.links;n[t].url=e,this.setState({links:n})}},{key:"handleDeleteUrl",value:function(e){var t=this.state.links;t.splice(e,1),this.setState({links:t})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,r=n.selected_all_classes,s=n.class_id_list,a=n.selected_classes,i=n.text,c=n.title,o=n.images,l=n.sendLoading,d=n.links;return Object(on.jsx)(Hn.a,{style:{flex:1},behavior:"height",keyboardVerticalOffset:80,enabled:!0,children:Object(on.jsxs)(In.a,{contentContainerStyle:{},keyboardShouldPersistTaps:"never",children:[Object(on.jsxs)(O.a,{style:{padding:15,flexDirection:"row",alignItems:"center",flexWrap:"wrap"},children:[Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u73ed\u7d1a:"}),s.map((function(n){return Object(on.jsx)(je.a,{style:{backgroundColor:a.has(n)?"#368cbf":"rgba(0, 0, 0, 0.1)",marginLeft:15},underlayColor:"#368cbf",onPress:function(){return e.selectClass(n)},children:Object(on.jsx)(x.a,{style:{padding:10,fontSize:25,color:a.has(n)?"rgba(255,255,255,0.6)":"rgba(0, 0, 0, 0.5)"},children:t[n].name})},n)})),Object(on.jsx)(je.a,{style:{backgroundColor:r?"#368cbf":"rgba(0, 0, 0, 0.1)",marginLeft:15},underlayColor:"#368cbf",onPress:function(){return e.selectAllClasses()},children:Object(on.jsx)(x.a,{style:{padding:10,fontSize:25,color:r?"rgba(255,255,255,0.6)":"rgba(0, 0, 0, 0.5)"},children:"\u6240\u6709"})})]}),Object(on.jsxs)(O.a,{style:{padding:15,backgroundColor:"lightgrey"},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",width:"100%"},children:[Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u6a19\u984c: "}),Object(on.jsx)(Vn.a,{value:c,placeholder:"\u5fc5\u586b",style:{flex:1,fontSize:25,borderBottomWidth:1,borderBottomColor:"gray"},onChangeText:function(t){return e.setState({title:t})}})]}),Object(on.jsx)(Vn.a,{value:i,style:{backgroundColor:"white",alignSelf:"center",width:"100%",borderColor:"gray",borderWidth:2,borderRadius:10,fontSize:25,padding:20,paddingTop:20,marginVertical:15},multiline:!0,onChangeText:function(t){return e.setState({text:t})}}),Object(on.jsxs)(O.a,{style:{},children:[Object(on.jsx)(x.a,{style:{fontSize:20,marginRight:20},children:"\u9023\u7d50"}),d.map((function(t,n){return Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",marginTop:15},children:[Object(on.jsxs)(O.a,{style:{flex:7,backgroundColor:"rgba(255,255,255,0.7)",padding:8,borderRadius:7},children:[Object(on.jsx)(x.a,{style:{},children:"\u986f\u793a\u6587\u5b57"}),Object(on.jsx)(Vn.a,{value:t.text,style:{padding:5,borderBottomWidth:1},onChangeText:function(t){return e.handleChangeLinkText(t,n)}}),Object(on.jsx)(x.a,{style:{marginTop:10},children:"\u9023\u7d50"}),Object(on.jsx)(Vn.a,{value:t.url,style:{padding:5,borderBottomWidth:1},onChangeText:function(t){return e.handleChangeUrl(t,n)}})]}),Object(on.jsx)(O.a,{style:{flex:1,backgroundColor:"grey"},children:Object(on.jsx)(je.a,{style:{flex:1,padding:10,backgroundColor:"#ffe1d0",alignItems:"center",justifyContent:"center"},onPress:function(){return e.handleDeleteUrl(n)},children:Object(on.jsx)(x.a,{children:"\u522a\u9664"})})})]},n)})),Object(on.jsx)(O.a,{style:{flexDirection:"row",alignItems:"center",marginVertical:15},children:Object(on.jsx)(je.a,{style:{backgroundColor:"rgba(255,255,255,0.7)",paddingVertical:10,paddingHorizontal:20,borderWidth:2,borderRadius:10,borderStyle:"dashed"},onPress:function(){return e.handleAddLink()},children:Object(on.jsx)(x.a,{children:"\u65b0\u589e"})})})]}),Object(on.jsxs)(O.a,{children:[Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u76f8\u7247"}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",marginTop:20},children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[o.map((function(t,n){return Object(on.jsx)(je.a,{onPress:function(){return e.removeImage(n)},children:Object(on.jsx)(be.a,{style:{width:100,height:100,marginRight:10,borderRadius:10},source:{uri:"data:image/png;base64,"+t}})},n)})),Object(on.jsx)(je.a,{style:{backgroundColor:"rgba(255,255,255,0.7)",width:100,height:100,justifyContent:"center",alignItems:"center",borderWidth:2,borderRadius:10,borderStyle:"dashed"},onPress:function(){return e._pickImage()},children:Object(on.jsx)(x.a,{children:"\u65b0\u589e"})})]}),Object(on.jsx)(je.a,{disabled:l,style:{backgroundColor:"lightblue",padding:10,alignSelf:"flex-end"},onPress:function(){return e.postAnnouncement()},children:l?Object(on.jsx)(Fn,{}):Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u9001\u51fa"})})]})]})]})]})})}}]),n}(b.a.Component),za=Object(A.b)((function(e){return{classes:e.school.classes}}))(Ia),La=n(125),Ba=n(299),Ma=n.n(Ba),Fa=n(300),Na=n(122),qa=n.n(Na);function Ua(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ha(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ua(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ua(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Va=Object(La.a)((function(e,t){return console.log("inboundState: ",e),Ha(Ha({},e),{},{record_id_for_update:I()(e.record_id_for_update),records_with_error:I()(e.records_with_error)})}),(function(e,t){return Ha(Ha({},e),{},{record_id_for_update:new Set(e.record_id_for_update),records_with_error:new Set(e.records_with_error)})}),{whitelist:["healthstatus"]}),Wa=Object(La.a)((function(e,t){return Ha(Ha({},e),{},{student_id_for_update:I()(e.student_id_for_update)})}),(function(e,t){return Ha(Ha({},e),{},{student_id_for_update:new Set(e.student_id_for_update)})}),{whitelist:["message"]}),Ka=Object(La.a)((function(e,t){return Ha(Ha({},e),{},{updatedStudents:I()(e.updatedStudents)})}),(function(e,t){return Ha(Ha({},e),{},{updatedStudents:new Set(e.updatedStudents)})}),{whitelist:["appetite"]}),Ga=Object(La.a)((function(e,t){return Ha(Ha({},e),{},{records:Ha(Ha({},e.records),{},{all_id:I()(e.records.all_id)}),newDataForCreate:I()(e.newDataForCreate),oldDataForEdit:I()(e.oldDataForEdit),records_with_error:I()(e.records_with_error)})}),(function(e,t){return Ha(Ha({},e),{},{records:Ha(Ha({},e.records),{},{all_id:new Set(e.records.all_id)}),newDataForCreate:qa()(Set,I()(e.newDataForCreate)),oldDataForEdit:qa()(Set,I()(e.oldDataForEdit)),records_with_error:qa()(Set,I()(e.records_with_error))})}),{whitelist:["sleep"]});function Qa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ja(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qa(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Xa={key:"root",storage:Ma.a,transforms:[Va,Wa,Ka,Ga]},Ya=Object(La.b)(Xa,le),Za=Object(k.c)(Ya),$a=Object(La.c)(Za),ei=function(e){return Object(on.jsx)(A.a,{store:Za,children:Object(on.jsx)(Fa.a,{loading:null,persistor:$a,children:Object(on.jsx)(C.a,{children:Object(on.jsxs)(D.d,{children:[Object(on.jsx)(D.b,{exact:!0,path:"/",element:Object(on.jsx)(Rr,Ja({},e))}),Object(on.jsx)(D.b,{path:"/class",element:Object(on.jsx)(Pr,{})}),Object(on.jsx)(D.b,{path:"/class/inbox",element:Object(on.jsx)(Da,{})}),Object(on.jsx)(D.b,{path:"/class/medication",element:Object(on.jsx)(Wr,{})}),Object(on.jsx)(D.b,{path:"/class/wellness",element:Object(on.jsx)(Jr,{})}),Object(on.jsx)(D.b,{path:"/class/message",element:Object(on.jsx)(xa,{})}),Object(on.jsx)(D.b,{path:"/class/appetite",element:Object(on.jsx)(es,{})}),Object(on.jsx)(D.b,{path:"/class/sleep",element:Object(on.jsx)(ss,{})}),Object(on.jsx)(D.b,{path:"/admin",element:Object(on.jsx)(_s,{})}),Object(on.jsx)(D.b,{path:"/admin/announcement",element:Object(on.jsx)(Ea,{})}),Object(on.jsx)(D.b,{path:"/admin/announcement/:id",element:Object(on.jsx)(Cs,{})}),Object(on.jsx)(D.b,{path:"/admin/announcement/new",element:Object(on.jsx)(za,{})}),Object(on.jsx)(D.b,{path:"/attendance",element:Object(on.jsx)(wa,{})})]})})})})};function ti(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var ni=function(e){o()(r,e);var t=ti(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={username:"",password:"",errMessage:"",user_type:"",isLoading:!1},n}return i()(r,[{key:"componentDidMount",value:function(){}},{key:"handleSignIn",value:function(){var e=this;this.setState({isLoading:!0});var t=this.state,n=t.username,r=t.password;w.a.signIn(n,r).then((function(t){console.log("user: ",t),"NEW_PASSWORD_REQUIRED"!==t.challengeName?(e.setState({isLoading:!1}),e.props.loadAuth()):e.completeNewPassword(t)})).catch((function(t){console.log("err.code: ",t.code),"UserNotConfirmedException"===t.code?e.props.changeAuthState("ConfirmSignUpPage",n):(e.props.changeAuthState("signedout",n),e.setState({errMessage:t.message,isLoading:!1}))}))}},{key:"completeNewPassword",value:function(e){var t=this;w.a.completeNewPassword(e,"barRoco",{name:"barroco"}).then((function(e){t.setState({isLoading:!1}),t.props.loadAuth()})).catch((function(e){t.setState({errMessage:e.message,isLoading:!1})}))}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return Object(on.jsx)(Fn,{});var t="ios"===Wn.a.OS?60:0,r=this.state.errMessage?Object(on.jsx)(fe.Text,{style:{color:"red"},children:this.state.errMessage}):null;return Object(on.jsxs)(Hn.a,{style:ri.container,behavior:"padding",keyboardVerticalOffset:t,enabled:!0,children:[Object(on.jsx)(be.a,{source:n(476),style:{width:200,height:200}}),Object(on.jsx)(fe.Text,{style:{fontSize:40},children:"\u8acb\u767b\u5165"}),r,Object(on.jsx)(Vn.a,{placeholder:"Email / \u5e33\u865f",keyboardType:"email-address",autoCapitalize:"none",style:ri.textInput,onChangeText:function(t){return e.setState({username:t})},value:this.state.username}),Object(on.jsx)(Vn.a,{secureTextEntry:!0,placeholder:"\u5bc6\u78bc",style:ri.textInput,onChangeText:function(t){return e.setState({password:t})},value:this.state.password}),Object(on.jsx)(fe.View,{style:{marginTop:20},children:Object(on.jsx)(je.a,{style:{backgroundColor:"grey",padding:20},onPress:function(){return e.handleSignIn()},children:Object(on.jsx)(fe.Text,{style:{fontSize:30},children:"\u767b\u5165"})})})]})}}]),r}(b.a.Component),ri=he.a.create({container:{flex:1,justifyContent:"center",alignItems:"center"},textInput:{height:80,width:"90%",borderColor:"gray",borderWidth:1,marginTop:20,fontSize:30,padding:10}}),si=ni,ai=n(292);function ii(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}!function(e){o()(n,e);var t=ii(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={username:"",name:"",user_type:"",email:"",password:"",errMessage:""},r}i()(n,[{key:"handleSignup",value:function(){var e=this,t=this.state,n=t.username,r=t.password,s=t.name,a=t.email,i=t.user_type;this.state.user_type?w.a.signUp({username:n,password:r,attributes:{name:s,email:a}}).then((function(t){console.log(e.state.user_type),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/user/"+n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:s,email:a,role:i})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.props.changeAuthState("ConfirmSignUpPage")})).catch((function(e){console.error(e)}))})).catch((function(t){e.setState({errMessage:t.message})})):this.setState({errMessage:"Please select user role"})}},{key:"setUserRole",value:function(e){this.setState({user_type:e})}},{key:"render",value:function(){var e=this;return Object(on.jsxs)(Hn.a,{style:ci.container,behavior:"padding",enabled:!0,children:[Object(on.jsxs)(O.a,{style:{width:"45%",marginBottom:20,flexDirection:"row",justifyContent:"space-around"},children:[Object(on.jsx)(je.a,{style:{width:80,height:85},onPress:function(){e.setUserRole("teacher")},children:Object(on.jsx)(ai.default,{name:"food-apple",size:80,color:"#C93D1B"})}),Object(on.jsx)(je.a,{style:{width:80,height:85},onPress:function(){e.setUserRole("parent")},children:Object(on.jsx)(ai.default,{name:"baby-buggy",size:80,color:"#f8c43a"})})]}),Object(on.jsxs)(x.a,{children:[this.state.user_type," Sign Up"]}),""===this.state.errMessage?null:Object(on.jsx)(x.a,{style:{color:"red"},children:this.state.errMessage}),Object(on.jsx)(Vn.a,{placeholder:"username",style:ci.textInput,onChangeText:function(t){return e.setState({username:t})},value:this.state.username}),Object(on.jsx)(Vn.a,{secureTextEntry:!0,placeholder:"password",style:ci.textInput,onChangeText:function(t){return e.setState({password:t})},value:this.state.password}),Object(on.jsx)(Vn.a,{placeholder:"Name",style:ci.textInput,onChangeText:function(t){return e.setState({name:t})},value:this.state.name}),Object(on.jsx)(Vn.a,{placeholder:"Email",style:ci.textInput,onChangeText:function(t){return e.setState({email:t})},value:this.state.email}),Object(on.jsxs)(O.a,{style:{width:"90%",margin:10,flexDirection:"row",justifyContent:"space-around"},children:[Object(on.jsx)(je.a,{style:{backgroundColor:"#35D0BA"},onPress:this.handleSignup.bind(this),children:Object(on.jsx)(x.a,{children:"Sign up"})}),Object(on.jsx)(je.a,{style:{backgroundColor:"#35D0BA"},onPress:function(){return e.props.changeAuthState("signedout")},children:Object(on.jsx)(x.a,{children:" Already have an account? Sign in here"})})]})]})}}])}(b.a.Component);var ci=he.a.create({container:{flex:1,justifyContent:"center",alignItems:"center"},textInput:{height:40,width:"90%",borderColor:"gray",borderWidth:1,marginTop:8}});function oi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function li(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oi(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ui(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?di(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):di(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fi(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pi=Object(k.b)({parent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isConnected:!0,child_of_id:{},med_requests:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONNECT_STATE":var n=t.isConnected;return li(li({},e),{},{isConnected:n});case"INITIALIZE_CHILDREN":var r=t.data;return r.forEach((function(t){var n=t.id,r=t.name,s=t.class_id,a=t.profile_picture,i=t.school_id,c=t.school_name;e.child_of_id[n]={name:r,class_id:s,profile_picture:a,school_id:i,school_name:c}})),li({},e);case"MARK_PRESENT":var s=t.student_id;return e.child_of_id[s].present=!0,li({},e);case"GET_MED_REQUEST_SUCCESS":var a=t.med_requests;return li(li({},e),{},{med_requests:a});case"EDIT_PROFILE_PICTURE":var i=t.student_id,c=t.image_url;return li(li({},e),{},{child_of_id:li(li({},e.child_of_id),{},S()({},i,li(li({},e.child_of_id[i]),{},{profile_picture:c})))});case"CLEAR_STATE":return{isConnected:!0,child_of_id:{},med_requests:[]};default:return e}},attendance:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{days:{1:[],2:[],3:[],4:[],5:[]},attendance:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_ATTENDANCE":return ui(ui({},e),{},{days:ui(ui({},e.days),{},S()({},t.day,[].concat(I()(e.days[t.day]),[t.attendance_id]))),attendance:ui(ui({},e.attendance),{},S()({},t.attendance_id,t.attendance_obj))});default:return e}},inbox:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{current_conversation_id:"",conversations_by_id:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE_DATA":var n=hi({},e),r=t.messages,s=t.most_recently_read_message_id,a=t.conversation_id;return n.conversations_by_id[a]={messages:r,most_recently_read_message_id:s},n.current_conversation_id=a,n;case"SET_CURRENT_CONVERSATION_ID":return hi(hi({},e),{},{current_conversation_id:t.conversation_id});case"CLEAR_CURRENT_CONVERSATION_ID":return hi(hi({},e),{},{current_conversation_id:""});default:return e}}}),ji=n(28),bi=n(103),yi=function(e){return{type:"INITIALIZE_CHILDREN",data:e}},gi=function(){return{type:"CLEAR_STATE"}},Oi=function(e){return{type:"GET_MED_REQUEST_SUCCESS",med_requests:e}},xi=function(e){return{type:"MARK_PRESENT",student_id:e}},mi=function(e){return{type:"SET_CONNECT_STATE",isConnected:e}},_i=function(e,t){return{type:"EDIT_PROFILE_PICTURE",student_id:e,image_url:t}};function wi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var vi=function(e){o()(r,e);var t=wi(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={child_id:n.props.child_id,isLoading:!0},n.fetchData=n.fetchData.bind(g()(n)),n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.state.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date))}},{key:"fetchData",value:function(e,t){var n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("WellnessCard / fetchData / date: ",t),n=bn(t),t.setDate(t.getDate()+1),r=bn(t),a.next=6,p.a.awrap(Cn("wellness",e,n,r));case 6:s=a.sent,this.setState({wellnessData:s,isLoading:!1}),s&&s[n]?this.props.updateTitleTemp(s[n][0][1]):this.props.updateTitleTemp("");case 9:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.wellnessData,r=e.isLoading,s=bn(this.props.date);return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:n(902),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u5065\u5eb7"})}),r?Object(on.jsx)(Fn,{}):t&&t[s]?Object(on.jsxs)(O.a,{style:{flex:1,paddingVertical:8},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",paddingBottom:5},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u6642\u9593"})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u9ad4\u6eab"})}),Object(on.jsx)(O.a,{style:{flex:2,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u4eca\u65e5\u72c0\u6cc1"})})]}),t[s].map((function(e,t){return Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center",color:"#404040"},children:e[0]})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsxs)(x.a,{style:{fontSize:25,textAlign:"center",color:"#404040"},children:[e[1],"\xb0"]})}),Object(on.jsx)(O.a,{style:{flex:2,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center",color:"#404040"},children:e[2]})})]},t)}))]}):Object(on.jsx)(O.a,{style:{flex:1,paddingVertical:8},children:Object(on.jsx)(x.a,{style:{fontSize:17},children:"\u6c92\u6709\u65b0\u7d00\u9304"})})]})]})})}}]),r}(b.a.Component);function Si(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Ci=function(e){o()(r,e);var t=Si(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={child_id:n.props.child_id,fruit_name:null,isLoading:!0,breakfast:null,fruit:null,lunch:null,snack:null},n.fetchData=n.fetchData.bind(g()(n)),n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.state.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(t.getHours()<17)){a.next=3;break}return this.setState({isLoading:!1}),a.abrupt("return");case 3:return n=bn(t),t.setDate(t.getDate()+1),r=bn(t),a.next=8,p.a.awrap(Cn("appetite",e,n,r));case 8:s=a.sent,this.denormalizeAppetiteData(s.data,t);case 10:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"denormalizeAppetiteData",value:function(e){var t=this.props.date,n=bn(t);if(e&&e[n]){var r=e[n],s=r.fruit_name,a=r.breakfast_rating,i=r.fruit_rating,c=r.lunch_rating,o=r.snack_rating,l=this.parseData(a),d=this.parseData(i),u=this.parseData(c),f=this.parseData(o);this.setState({fruit_name:s,breakfast:l,fruit:d,lunch:u,snack:f,appetiteData:e,isLoading:!1})}else this.setState({appetiteData:e,isLoading:!1})}},{key:"parseData",value:function(e){return{rating:e.slice(0,-1),water_drunk:parseInt(e.slice(-1))}}},{key:"getEmoji",value:function(){}},{key:"getWaterDrinkingStatus",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.appetiteData,r=e.isLoading,s=e.breakfast,a=e.fruit,i=e.lunch,c=e.snack,o=(e.rating,e.fruit_name),l=bn(this.props.date);return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:n(903),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u98f2\u98df"})}),r?Object(on.jsx)(Fn,{}):t&&t[l]?Object(on.jsxs)(O.a,{children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",paddingVertical:8},children:[s?Object(on.jsxs)(O.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"},children:[Object(on.jsx)(O.a,{style:{padding:5},children:Object(on.jsx)(x.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"},children:"\u65e9\u9910"})}),Object(on.jsx)(O.a,{style:{justifyContent:"center",alignItems:"center",padding:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:s.rating||" "})}),Object(on.jsx)(O.a,{style:{padding:5,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:17,textAlign:"center"},children:s.water_drunk?"\u6709\u559d\u6c34":" "})})]}):null,a?Object(on.jsxs)(O.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"},children:[Object(on.jsx)(O.a,{style:{padding:5},children:Object(on.jsx)(x.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"},children:"\u6c34\u679c"!==o&&"\u6c34\u679c\u9910: "+o||"\u6c34\u679c"})}),Object(on.jsx)(O.a,{style:{justifyContent:"center",alignItems:"center",padding:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:a.rating||" "})}),Object(on.jsx)(O.a,{style:{padding:5,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:17,textAlign:"center"},children:a.water_drunk?"\u6709\u559d\u6c34":" "})})]}):null]}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",paddingVertical:8},children:[i?Object(on.jsxs)(O.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"},children:[Object(on.jsx)(O.a,{style:{padding:5},children:Object(on.jsx)(x.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"},children:"\u5348\u9910"})}),Object(on.jsx)(O.a,{style:{justifyContent:"center",alignItems:"center",padding:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:i.rating||" "})}),Object(on.jsx)(O.a,{style:{padding:5,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:17,textAlign:"center"},children:i.water_drunk?"\u6709\u559d\u6c34":" "})})]}):null,c?Object(on.jsxs)(O.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"},children:[Object(on.jsx)(O.a,{style:{padding:5},children:Object(on.jsx)(x.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"},children:"\u9ede\u5fc3"})}),Object(on.jsx)(O.a,{style:{justifyContent:"center",alignItems:"center",padding:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:c.rating||" "})}),Object(on.jsx)(O.a,{style:{padding:5,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:17,textAlign:"center"},children:c.water_drunk?"\u6709\u559d\u6c34":" "})})]}):null]})]}):Object(on.jsx)(O.a,{style:{flex:1,paddingVertical:8},children:Object(on.jsx)(x.a,{style:{fontSize:17},children:"\u6c92\u6709\u65b0\u7d00\u9304"})})]})]})})}}]),r}(b.a.Component);function Di(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Ai=function(e){o()(r,e);var t=Di(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(g()(n)),n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(t.getHours()<17)){a.next=3;break}return this.setState({isLoading:!1}),a.abrupt("return");case 3:return n=bn(t),t.setDate(t.getDate()+1),r=bn(t),a.next=8,p.a.awrap(Cn("milkintake",e,n,r));case 8:s=a.sent,this.setState({milkIntakeData:s,isLoading:!1});case 10:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.milkIntakeData,r=e.isLoading,s=bn(this.props.date);return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:n(904),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u559d\u5976"})}),r?Object(on.jsx)(Fn,{}):t&&t[s]?Object(on.jsxs)(O.a,{style:{flex:1,paddingVertical:8},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",paddingBottom:5},children:[Object(on.jsx)(O.a,{style:{width:"25%",justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u6642\u9593"})}),Object(on.jsx)(O.a,{style:{width:"28%",justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u91cf"})}),Object(on.jsx)(O.a,{style:{width:"28%",justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u4e73\u54c1"})}),Object(on.jsx)(O.a,{style:{width:"19%",justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u8001\u5e2b"})})]}),t[s].map((function(e,t){var n=e.time,r=e.amount,s=e.milk_type,a=e.teacher_name;return Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:"25%"},children:Object(on.jsx)(x.a,{style:{fontSize:20,textAlign:"center",color:"#404040"},children:n})}),Object(on.jsx)(O.a,{style:{width:"28%"},children:Object(on.jsxs)(x.a,{style:{fontSize:20,textAlign:"center",color:"#404040"},children:[r," c.c."]})}),Object(on.jsx)(O.a,{style:{width:"28%"},children:Object(on.jsx)(x.a,{style:{fontSize:20,textAlign:"center",color:"#404040"},children:s})}),Object(on.jsx)(O.a,{style:{width:"19%"},children:Object(on.jsx)(x.a,{style:{fontSize:20,textAlign:"center",color:"#404040"},children:null!==a&&a.slice(1)})})]},t)}))]}):Object(on.jsx)(O.a,{style:{flex:1,paddingVertical:8},children:Object(on.jsx)(x.a,{style:{fontSize:17},children:"\u6c92\u6709\u65b0\u7d00\u9304"})})]})]})})}}]),r}(b.a.Component);function ki(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Pi=function(e){o()(r,e);var t=ki(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(g()(n)),n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(t.getHours()<17)){a.next=3;break}return this.setState({isLoading:!1}),a.abrupt("return");case 3:return n=bn(t),t.setDate(t.getDate()+1),r=bn(t),a.next=8,p.a.awrap(Cn("sleep",e,n,r));case 8:s=a.sent,this.setState({sleepData:s,isLoading:!1});case 10:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.sleepData,r=e.isLoading,s=bn(this.props.date);return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:n(905),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u7761\u7720"})}),r?Object(on.jsx)(Fn,{}):t&&t[s]?Object(on.jsxs)(O.a,{style:{flex:1,paddingVertical:8},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",paddingBottom:5},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u5f9e"})}),Object(on.jsx)(O.a,{style:{flex:1}}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u5230"})})]}),t[s].map((function(e,t){var n=e.sleep_time,r=e.wake_time,s=e.hours,a=e.minutes;return Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center",color:"#404040"},children:n})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsxs)(x.a,{style:{fontSize:15,textAlign:"center",color:"#404040"},children:[s,"H ",a,"M"]})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center",color:"#404040"},children:r})})]},t)}))]}):Object(on.jsx)(O.a,{style:{flex:1,paddingVertical:8},children:Object(on.jsx)(x.a,{style:{fontSize:17},children:"\u6c92\u6709\u65b0\u7d00\u9304"})})]})]})})}}]),r}(b.a.Component);function Ti(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Ei=function(e){o()(r,e);var t=Ti(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(g()(n)),n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(t.getHours()<17)){a.next=3;break}return this.setState({isLoading:!1}),a.abrupt("return");case 3:return n=bn(t),t.setDate(t.getDate()+1),r=bn(t),a.next=8,p.a.awrap(Cn("diaper",e,n,r));case 8:s=a.sent,this.setState({isLoading:!1,diaperData:s});case 10:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,r=e.diaperData,s=bn(this.props.date);return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:n(906),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u5982\u5ec1"})}),t?Object(on.jsx)(Fn,{}):r&&r[s]?Object(on.jsxs)(O.a,{style:{flex:1,paddingVertical:8},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",paddingBottom:5},children:[Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u6642\u9593"})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u6392\u6cc4"})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u4f7f\u7528"})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:15,textAlign:"center",color:"#606060"},children:"\u72c0\u6cc1"})})]}),r[s].map((function(e,t){var n=e.time,r=e.cloth_diaper,s=e.pee_or_poo,a=e.condition;e.teacher_id;return Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:23,textAlign:"center",color:"#404040"},children:n})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:23,textAlign:"center",color:"#404040"},children:s})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:23,textAlign:"center",color:"#404040"},children:r?"\u5b78\u7fd2\u8932":"\u5c3f\u5e03"})}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(x.a,{style:{fontSize:23,textAlign:"center",color:"#404040"},children:a})})]},t)}))]}):Object(on.jsx)(O.a,{style:{flex:1,paddingVertical:8},children:Object(on.jsx)(x.a,{style:{fontSize:17},children:"\u6c92\u6709\u65b0\u7d00\u9304"})})]})]})})}}]),r}(b.a.Component);function Ri(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ii(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ri(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ri(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zi=function(e){var t=Object(j.useState)({child_id:e.child_id,isLoading:!0,data_available:!1,items_to_bring:[],activities:[],text:"",teacher_id:"",message_id:null,message_for_teacher:"",isConnected:!0,scrollHeight:"100%",message_read:!1}),r=ue()(t,2),s=r[0],a=r[1];Object(j.useEffect)((function(){var t=e.date;c(s.child_id,new Date(t.getTime()))}),[]),Object(j.useEffect)((function(){a(Ii(Ii({},s),{},{isLoading:!0,message_for_teacher:"",scrollHeight:"100%"})),c(e.child_id,new Date(e.date.getTime()))}),[e.date]),Object(j.useEffect)((function(){a({isLoading:!0,message_for_teacher:"",scrollHeight:"100%"}),c(e.child_id,new Date)}),[e.child_id]);var i=function(e){a(Ii(Ii({},s),{},{scrollHeight:e}))},c=function(e,t){var n,r,i,c;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(console.log("fetchMessageData / propDate: "+t),!((n=new Date(t.getTime())).getHours()<17)){l.next=5;break}return a(Ii(Ii({},s),{},{isLoading:!1,message_for_teacher:"",data_available:!1})),l.abrupt("return");case 5:return r=bn(n),n.setDate(n.getDate()+1),i=bn(n),l.next=10,p.a.awrap(Cn("message",e,r,i));case 10:if(void 0!==(c=l.sent).data&&void 0!==c.data[r]){l.next=14;break}return a(Ii(Ii({},s),{},{isLoading:!1,message_for_teacher:"",data_available:!1})),l.abrupt("return");case 14:o(c.data[r]);case 15:case"end":return l.stop()}}),null,null,null,Promise)},o=function(e){for(var t=["\u6bcd\u5976\u7c89","\u5c3f\u5e03","\u6c34\u58fa","\u8863\u7269"],n=["\u5b30\u5152\u6309\u6469","\u97f3\u6a02\u5f8b\u52d5","\u6559\u5177\u64cd\u4f5c","\u7e6a\u672c\u6b23\u8cde","\u8a8d\u77e5\u5716\u7247","\u9ad4\u80fd\u6d3b\u52d5","\u85dd\u8853\u5275\u4f5c","\u591a\u5143\u8a9e\u8a00"],r=[],i=[],c=0;c<e.items_to_bring.length-1;c++)e.items_to_bring[c]&&r.push(t[c]);e.items_to_bring[e.items_to_bring.length-1]&&r.push(e.other_item);for(c=0;c<e.activities.length-1;c++)e.activities[c]&&i.push(n[c]);e.activities[e.activities.length-1]&&i.push(e.other_activity),a(Ii(Ii({},s),{},{isLoading:!1,data_available:!0,message_id:e.message_id,items_to_bring:r,activities:i,text:e.text,teacher_id:e.teacher_id,message_for_teacher:e.message_for_teacher,message_read:e.message_read}))},l=function(){var t,n,r,a,i,o,l,u,f;return p.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(t=e.class_id,n=e.parent_id,r=e.date,a=s.message_for_teacher,i=s.message_id,s.isConnected,d()&&""!==a){h.next=4;break}return h.abrupt("return");case 4:return o={student_id:e.child_id,parent_id:n,message_id:i,message_for_teacher:a,timestamp:bn(r)+" "+On(r)},h.next=7,p.a.awrap(wn("/message/class/"+t,o));case 7:if(l=h.sent,u=l.success,l.statusCode,f=l.message,l.data,u){h.next=12;break}return alert("Sorry \u50b3\u9001\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+f),h.abrupt("return");case 12:alert("\u8a0a\u606f\u50b3\u9054\u6210\u529f\uff01"),c(s.child_id,new Date(r.getTime()));case 14:case"end":return h.stop()}}),null,null,null,Promise)},d=function(){var t=e.date,n=new Date;return 6===n.getDay()?n.setDate(n.getDate()-1):0===n.getDay()&&n.setDate(n.getDate()-2),n.setHours(17,0,0,0),t.getTime()>=n.getTime()||u()},u=function(){var t=e.date,n=new Date,r=new Date;return 1===n.getDay()?(r.setDate(r.getDate()-3),t.toDateString()===r.toDateString()&&n.getHours()<4):n.getDay()>1&&n.getDay()<6&&(r.setDate(r.getDate()-1),t.toDateString()===r.toDateString()&&n.getHours()<4)},f=s.items_to_bring,h=s.activities,b=s.text,y=(s.teacher_id,s.isLoading),g=s.data_available,m=s.message_for_teacher,_=s.scrollHeight,w=s.message_read;e.date;return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,alignItems:"center",justifyContent:"center"},children:Object(on.jsx)(be.a,{source:n(907),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u8a0a\u606f"})}),y?Object(on.jsx)(Fn,{}):g?Object(on.jsxs)(O.a,{style:{flex:1,paddingVertical:8,paddingRight:8},children:[Object(on.jsxs)(O.a,{style:{padding:5,marginBottom:6,backgroundColor:"#F5F5F5"},children:[Object(on.jsx)(x.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15},children:"\u611b\u7684\u5c0f\u8a9e"}),Object(on.jsx)(x.a,{style:{fontSize:25,paddingVertical:7},children:b})]}),Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsxs)(O.a,{style:{flex:1,padding:5,backgroundColor:"#F5F5F5",marginRight:3},children:[Object(on.jsx)(x.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15},children:"\u5bb6\u9577\u6e96\u5099"}),f.length?Object(on.jsx)(O.a,{style:{alignItems:"center",paddingVertical:7},children:f.map((function(e,t){return Object(on.jsx)(x.a,{style:{padding:5,backgroundColor:"lightgrey",marginBottom:3,fontSize:25},children:e},t)}))}):null]}),Object(on.jsxs)(O.a,{style:{flex:1,padding:5,backgroundColor:"#F5F5F5",marginLeft:3},children:[Object(on.jsx)(x.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15},children:"\u4eca\u65e5\u6d3b\u52d5"}),h.length?Object(on.jsx)(O.a,{style:{alignItems:"center",paddingVertical:7},children:h.map((function(e,t){return Object(on.jsx)(x.a,{style:{padding:5,backgroundColor:"lightgrey",marginBottom:3,fontSize:25},children:e},t)}))}):null]})]}),Object(on.jsxs)(O.a,{style:{backgroundColor:"#ffddb7",marginTop:5},children:[Object(on.jsxs)(O.a,{style:{padding:5,flexDirection:"row",justifyContent:"space-between"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u7d66\u8001\u5e2b\u7684\u8a71"}),""!==m&&Object(on.jsx)(x.a,{style:{fontSize:15},children:w?"\u5df2\u8b80":"\u672a\u8b80"})]}),Object(on.jsx)(Vn.a,{editable:d(),style:{height:_,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.7)",paddingTop:10,padding:10,fontSize:25},placeholder:d()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":y?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",scrollEnabled:!1,multiline:!0,value:m,onChangeText:function(e){return a(Ii(Ii({},s),{},{message_for_teacher:e}))},onChange:function(e){return i(e.target.scrollHeight)},onLayout:function(e){var t=e.nativeEvent.target.scrollHeight;a(Ii(Ii({},s),{},{scrollHeight:t}))}}),Object(on.jsx)(ji.a,{disabled:!d(),style:{padding:10,justifyContent:"center"},onPress:function(){return l()},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u9001\u51fa"})})]})]}):Object(on.jsxs)(O.a,{style:{flex:1,paddingVertical:8,paddingRight:8},children:[Object(on.jsx)(x.a,{style:{fontSize:17},children:"\u6c92\u6709\u65b0\u7d00\u9304"}),function(){var t=e.date,n=new Date;return n.setHours(0,0,0,1),!(t.toDateString()!==n.toDateString()||!d())||t<n}()&&Object(on.jsxs)(O.a,{style:{backgroundColor:"#ffddb7",marginTop:5},children:[Object(on.jsxs)(O.a,{style:{padding:5,flexDirection:"row",justifyContent:"space-between"},children:[Object(on.jsx)(x.a,{style:{fontSize:15},children:"\u7d66\u8001\u5e2b\u7684\u8a71"}),""!==m&&Object(on.jsx)(x.a,{style:{fontSize:15},children:w?"\u5df2\u8b80":"\u672a\u8b80"})]}),Object(on.jsx)(Vn.a,{editable:d(),style:{height:_,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.7)",paddingTop:10,padding:10,fontSize:25},placeholder:d()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":y?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",scrollEnabled:!1,multiline:!0,value:m,onChangeText:function(e){return a(Ii(Ii({},s),{},{message_for_teacher:e}))},onChange:function(e){return i(e.target.scrollHeight)}}),Object(on.jsx)(ji.a,{disabled:!d(),style:{padding:10,justifyContent:"center"},onPress:function(){return l()},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u9001\u51fa"})})]})]})]})]})})};function Li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Mi=function(e){o()(r,e);var t=Bi(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).getPermissionAsync=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Wn.a.OS){t.next=6;break}return t.next=3,p.a.awrap(Ms.b(Ms.a));case 3:e=t.sent,"granted"!==e.status&&alert("Sorry, we need camera roll permissions to make this work!");case 6:case"end":return t.stop()}}),null,null,null,Promise)},n._pickImage=function(e,t){var r,s;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p.a.awrap(Ls.a({mediaTypes:Bs.a.All,allowsEditing:!0,aspect:[1,1],quality:.4,base64:!0}));case 3:(r=a.sent).cancelled||(s=r.uri,n.getProfilePictureURL(s.replace(/^data:image\/\w+;base64,/,""),e,t)),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.log(a.t0);case 10:case"end":return a.stop()}}),null,null,[[0,7]],Promise)},n.state={temperature:"",borderRadius:0},n}return i()(r,[{key:"componentDidMount",value:function(){this.getPermissionAsync()}},{key:"componentDidUpdate",value:function(e){this.props.temperature!==e.temperature&&this.setState({temperature:this.props.temperature})}},{key:"getProfilePictureURL",value:function(e,t,n){var r,s,a,i,c,o,l,d;return p.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return r=this.props,s=r.student_name,a=r.student,i={image:e,url:n,path:a.school_name+"/profile_picture_"+t+"_"+(new Date).getMilliseconds()+".jpg"},u.next=4,p.a.awrap(wn("/student/"+t+"/profile-picture",i));case 4:if(c=u.sent,o=c.success,c.statusCode,l=c.message,d=c.data,o){u.next=9;break}return alert("Sorry "+s+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l),u.abrupt("return");case 9:this.props.editProfilePicture(t,d.image_url);case 10:case"end":return u.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state,r=t.temperature,s=(t.borderRadius,this.props),a=s.student_id,i=s.student,c=s.student_name;return Object(on.jsxs)(O.a,{style:{width:"97%",marginLeft:"3%",alignSelf:"flex-start",flexDirection:"row"},children:[Object(on.jsxs)(fe.Card,{style:{flexDirection:"row",width:"85%",alignItems:"center",paddingVertical:15},children:[Object(on.jsx)(je.a,{style:{flex:1,width:"50%",alignItems:"center"},onLayout:function(t){var n=t.nativeEvent.layout.width;e.setState({borderRadius:n/2})},onPress:function(){return e._pickImage(a,i.profile_picture)},children:Object(on.jsx)(be.a,{source:""===i.profile_picture?n(77):{uri:i.profile_picture},style:""===i.profile_picture?{width:130,height:130}:{width:130,height:130,borderRadius:65}})}),Object(on.jsx)(O.a,{style:{height:"90%",width:"50%",paddingLeft:10},children:Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{height:"50%",alignItems:"flex-start",justifyContent:"flex-end"},children:Object(on.jsx)(x.a,{style:{fontSize:40},children:c})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",paddingTop:5},children:[Object(on.jsxs)(O.a,{style:{flex:1,height:"100%",backgroundColor:"#F5F5F5",justifyContent:"center"},children:[Object(on.jsx)(x.a,{style:{padding:5},children:"\u65e9\u4e0a\u9ad4\u6eab"}),Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:""===r?"\u672a\u91cf":r+"\xb0"})]}),Object(on.jsx)(ji.a,{style:{backgroundColor:"#F5F5F5",alignItems:"center",justifyContent:"center"},onPress:function(){return e.props.viewQRCode()},children:Object(on.jsx)(be.a,{source:n(470),style:{width:65,height:65}})})]})]})})]}),Object(on.jsx)(fe.Card,{style:{width:"20%"},children:Object(on.jsx)(ji.a,{style:{flex:1,justifyContent:"center",paddingLeft:5},underlayColor:"#F5F5F5",onPress:function(){return e.props.selectOtherChildProfile()},children:Object(on.jsx)(be.a,{source:n(908),style:{width:43,height:43,opacity:.6}})})})]})}}]),r}(b.a.Component),Fi=Object(A.b)(null,(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Li(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({editProfilePicture:_i},e))}))(Mi),Ni=n(40);function qi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ui(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Hi=Object(j.forwardRef)((function(e,t){var r=Object(j.useState)({showSelector:!1,SlideInRight:new Ni.a.Value(0)}),s=ue()(r,2),a=s[0],i=s[1];Object(j.useImperativeHandle)(t,(function(){return{slideIn:function(){i(Ui(Ui({},a),{},{showSelector:!0})),Ni.a.timing(a.SlideInRight,{toValue:1,duration:200,useNativeDriver:!0}).start()}}}));var c=Zn.a.get("window").width,o=a.showSelector,l=a.SlideInRight,d=e.student_of_id;return o?Object(on.jsx)(Ni.a.View,{style:{zIndex:2,width:"100%",height:"100%",position:"absolute",backgroundColor:"rgba(0,0,0,0.7)",transform:[{translateX:l.interpolate({inputRange:[0,1],outputRange:[c,0]})}],alignItems:"center"},children:Object.keys(d).map((function(t){return Object(on.jsx)(je.a,{style:{marginTop:c/4},onPress:function(){return function(t){e.onSelectStudent(t),Ni.a.timing(a.SlideInRight,{toValue:0,duration:500,useNativeDriver:!0}).start(),i(Ui(Ui({},a),{},{showSelector:!1}))}(t)},underlayColor:"transparent",children:Object(on.jsx)(be.a,{source:""===d[t].profile_picture?n(77):{uri:d[t].profile_picture},style:{width:160,height:160,borderRadius:80,backgroundColor:"rgba(255,255,255,0.6)"}})},t)}))}):null}));function Vi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Wi=Zn.a.get("window"),Ki=(Wi.width,Wi.height),Gi=function(e){o()(n,e);var t=Vi(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={isLoading:!0,data:""},r}return i()(n,[{key:"componentDidMount",value:function(){var e,t,n,r,s,a,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props,t=e.parent_id,n=e.isConnected,c.next=3,p.a.awrap(_n("/user/"+t+"/qrcode"));case 3:if(r=c.sent,s=r.success,r.statusCode,a=r.message,i=r.data,n){c.next=8;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),c.abrupt("return");case 8:if(s){c.next=11;break}return alert("Sorry \u53d6\u5f97\u5bb6\u9577QR Code\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),c.abrupt("return");case 11:this.setState({isLoading:!1,data:i});case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this;return Object(on.jsx)(O.a,{style:{height:Ki,zIndex:2,width:"100%",position:"absolute",backgroundColor:"white",justifyContent:"space-evenly",alignItems:"center"},children:Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{flex:3,justifyContent:"center",alignItems:"center"},children:this.state.isLoading?Object(on.jsx)(Fn,{}):Object(on.jsx)(ta.a,{value:this.state.data,size:300})}),Object(on.jsx)(O.a,{style:{flex:1,alignItems:"center"},children:Object(on.jsx)(je.a,{style:{padding:15,backgroundColor:"#b5e9e9"},onPress:function(){return e.props.hideQRCode()},children:Object(on.jsx)(x.a,{style:{fontSize:30},children:"\u8fd4\u56de"})})})]})})}}]),n}(b.a.Component),Qi=Object(A.b)((function(e){return{isConnected:e.parent.isConnected}}))(Gi);function Ji(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var Yi=function(e){o()(r,e);var t=Xi(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={isLoading:!0,med_requests:[]},n}return i()(r,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date))}},{key:"afterFive",value:function(){return this.props.date.getHours()>=17}},{key:"fetchData",value:function(e,t){var n,r=this;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/medicationrequest/student/"+e+"?date="+bn(t),s.next=3,p.a.awrap(fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.data,s=r.get_todays_requests(n,t);r.setState({med_requests:s}),r.setState({isLoading:!1})})).catch((function(e){alert("Sorry \u53d6\u5f97\u4eca\u65e5\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when fetching medication request")})));case 3:case"end":return s.stop()}}),null,null,null,Promise)}},{key:"get_todays_requests",value:function(e,t){for(var n=[],r=0;r<e.length;r++){if(new Date(e[r].title).toDateString()===t.toDateString()){n=e[r].data;for(var s=0;s<n.length;s++)n[s].timestamp=new Date(n[s].timestamp);break}}return n}},{key:"render",value:function(){var e=this,t=this.state.med_requests,r=this.state.isLoading;return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:n(909),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u4eca\u65e5\u85e5\u55ae"})}),r?Object(on.jsx)(Fn,{}):t.length?Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",paddingVertical:8},children:Object(on.jsx)(In.a,{horizontal:!0,contentContainerStyle:{paddingBottom:10},children:t.map((function(r,s){return Object(on.jsx)(ji.a,{style:{padding:10,backgroundColor:"#F5F5F5",marginRight:15,justifyContent:"center"},underlayColor:"#ff8944",onPress:function(){return e.props.viewMedRequest(s,t)},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center"},children:[e.afterFive()&&r.administered?Object(on.jsx)(be.a,{source:n(477),style:{width:20,height:20}}):null,Object(on.jsx)(x.a,{style:{alignSelf:"center",fontSize:25,color:"rgba(0,0,0,0.8)"},children:xn(r.timestamp)})]})},r.id)}))})}):Object(on.jsx)(O.a,{style:{flex:1,paddingVertical:8},children:Object(on.jsx)(x.a,{style:{fontSize:17},children:"\u6c92\u6709\u65b0\u7d00\u9304"})})]})]})})}}]),r}(b.a.Component),Zi=Object(A.b)((function(e){return{med_requests:e.parent.med_requests}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ji(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ji(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({getMedRequestSuccess:Oi},e))}),null,{forwardRef:!0})(Yi);n(39);function $i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ec(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$i(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tc=Object(j.forwardRef)((function(e,t){var r=Object(j.useState)({morning_reminder_id:null,text:"",reminder_read:!1,isConnected:!0,milk_timestamp:new Date,diaper_timestamp:new Date,milk_amount:"",diaper_type:"\u5c0f\u4fbf",showDateTimeModal:!1,showDateTimeModalType:"",includeMilkIntake:!1,includeDiaper:!1}),s=ue()(r,2),a=s[0],i=s[1],c=Object(j.useState)(!0),o=ue()(c,2),l=o[0],d=o[1],u=Object(j.useState)("100%"),f=ue()(u,2),h=f[0],b=f[1];Object(j.useImperativeHandle)(t,(function(){return{selectDatetimeConfirm:function(e){var t=a.showDateTimeModalType;"milkintake"===t?i(ec(ec({},a),{},{milk_timestamp:e})):"diaper"===t&&i(ec(ec({},a),{},{diaper_timestamp:e}))}}})),Object(j.useEffect)((function(){var t=e.date;y(e.student_id,new Date(t.getTime()))}),[]),Object(j.useEffect)((function(){i(ec(ec({},a),{},{text:"",includeMilkIntake:!1,milk_timestamp:new Date,milk_amount:"",includeDiaper:!1,diaper_timestamp:new Date,diaper_type:"\u5c0f\u4fbf"})),d(!0),b("100%"),y(e.student_id,new Date(e.date.getTime()))}),[e.date]),Object(j.useEffect)((function(){i(ec(ec({},a),{},{text:"",includeMilkIntake:!1,milk_timestamp:new Date,milk_amount:"",includeDiaper:!1,diaper_timestamp:new Date,diaper_type:"\u5c0f\u4fbf"})),d(!0),b("100%"),y(e.student_id,new Date)}),[e.student_id]);var y=function(e,t){var n,r,s;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=bn(t),t.setDate(t.getDate()+1),r=bn(t),c.next=5,p.a.awrap(Cn("morningreminder",e,n,r));case 5:if(void 0!==(s=c.sent).data&&void 0!==s.data[n]){c.next=10;break}return i(ec(ec({},a),{},{morning_reminder_id:null,text:"",reminder_read:!1})),d(!1),c.abrupt("return");case 10:i(ec(ec({},a),{},{morning_reminder_id:s.data[n].morning_reminder_id,text:s.data[n].text,reminder_read:s.data[n].reminder_read})),d(!1);case 12:case"end":return c.stop()}}),null,null,null,Promise)},g=function(){var t=e.date,n=new Date;return n.setHours(17,0,0),t.toDateString()===(new Date).toDateString()&&new Date<n||t.toDateString()!==(new Date).toDateString()&&t>new Date},m=a.text,_=a.morning_reminder_id,w=a.reminder_read,v=a.milk_timestamp,S=a.milk_amount,C=a.diaper_timestamp,D=a.diaper_type,A=(a.showDateTimeModal,a.includeMilkIntake),k=a.includeDiaper;return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:n(910),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsxs)(O.a,{style:{paddingTop:8,flexDirection:"row",justifyContent:"space-between",paddingRight:8},children:[Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u611b\u7684\u53ee\u5680"}),""!==m&&Object(on.jsx)(x.a,{style:{fontSize:20},children:w?"\u5df2\u8b80":"\u672a\u8b80"})]}),Object(on.jsxs)(O.a,{style:{flex:1,paddingVertical:8,paddingRight:8},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center",backgroundColor:A?"#dcf3d0":"transparent"},children:[Object(on.jsx)(ji.a,{onPress:function(){g()&&i(ec(ec({},a),{},{includeMilkIntake:!A}))},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:A?"#00c07f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:10,alignSelf:"center"},children:"\u9935\u5976: "})]})}),Object(on.jsx)(ji.a,{style:{justifyContent:"center",alignItems:"center",padding:10},onPress:function(){g()&&(i(ec(ec({},a),{},{showDateTimeModalType:"milkintake",includeMilkIntake:!0})),e.showTimeModal())},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:""+xn(v)})}),Object(on.jsx)(Vn.a,{editable:g(),style:{marginLeft:15,width:55,fontSize:25},keyboardType:"decimal-pad",placeholder:"_____",value:""+S,onChangeText:function(e){return i(ec(ec({},a),{},{milk_amount:e}))},onFocus:function(){g()&&i(ec(ec({},a),{},{includeMilkIntake:!0}))}}),Object(on.jsx)(x.a,{style:{fontSize:20},children:"  c.c."})]}),Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center",marginTop:10,backgroundColor:k?"#dcf3d0":"transparent"},children:[Object(on.jsx)(ji.a,{onPress:function(){g()&&i(ec(ec({},a),{},{includeDiaper:!k}))},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:k?"#00c07f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:20,marginLeft:10,alignSelf:"center"},children:"\u5982\u5ec1: "})]})}),Object(on.jsx)(ji.a,{style:{justifyContent:"center",alignItems:"center",padding:5},onPress:function(){g()&&(i(ec(ec({},a),{},{showDateTimeModalType:"diaper",includeDiaper:!0})),e.showTimeModal())},children:Object(on.jsx)(x.a,{style:{fontSize:25,padding:5},children:""+xn(C)})}),Object(on.jsx)(ji.a,{style:{marginLeft:15,justifyContent:"center",alignItems:"center",padding:10},onPress:function(){g()&&i(ec(ec({},a),{},{diaper_type:"\u5c0f\u4fbf"===D?"\u5927\u4fbf":"\u5927\u4fbf"===D?"\u7121\u6392\u4fbf":"\u5c0f\u4fbf",includeDiaper:!0}))},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:D})})]}),Object(on.jsx)(Vn.a,{editable:g(),style:{width:"100%",height:h,backgroundColor:"#dcf3d0",fontSize:25,paddingTop:10,padding:10,marginTop:10},placeholder:g()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":l?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",value:m,multiline:!0,scrollEnabled:!1,onChangeText:function(e){return i(ec(ec({},a),{},{text:e}))},onChange:function(e){return b(e.target.scrollHeight)},onLayout:function(e){var t=e.nativeEvent.target.scrollHeight;b(t)}},_),Object(on.jsx)(ji.a,{disabled:!g(),style:{backgroundColor:"#00c07f",padding:10,justifyContent:"center",alignItems:"center"},underlayColor:"transparent",onPress:function(){return function(){var t,n,r,s,c,o,l,u,f,h,j,b,O,x,m,_;return p.a.async((function(w){for(;;)switch(w.prev=w.next){case 0:if(console.log("sendMessage"),d(!0),t=e.class_id,n=e.date,r=e.parent_id,s=a.text,c=a.morning_reminder_id,a.isConnected,o=a.includeMilkIntake,l=a.milk_timestamp,u=a.milk_amount,f=a.includeDiaper,h=a.diaper_timestamp,j=a.diaper_type,g()&&(""!==s||o||f)){w.next=6;break}return w.abrupt("return");case 6:return b=s,f&&(b="\u5982\u5ec1: "+xn(h)+" "+j+"\n"+b),o&&(b="\u9935\u5976: "+xn(l)+" "+u+" c.c.\n"+b),O={morning_reminder_id:c,student_id:e.student_id,parent_id:r,timestamp:bn(n)+" "+On(n),text:b},w.next=12,p.a.awrap(wn("/morningreminder/class/"+t,O));case 12:if(x=w.sent,m=x.success,x.statusCode,_=x.message,x.data,m){w.next=17;break}return alert("Sorry \u50b3\u9001\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+_),w.abrupt("return");case 17:alert("\u8a0a\u606f\u50b3\u9054\u6210\u529f\uff01"),i(ec(ec({},a),{},{includeMilkIntake:!1,milk_timestamp:new Date,milk_amount:"",includeDiaper:!1,diaper_timestamp:new Date,diaper_type:"\u5c0f\u4fbf",morning_reminder_id:""})),y(e.student_id,new Date(e.date));case 20:case"end":return w.stop()}}),null,null,null,Promise)}()},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u9001\u51fa"})})]})]})]})})}));function nc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nc(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var sc=function(e){var t=Object(j.useState)({announcements:[]}),r=ue()(t,2),s=r[0],a=r[1];Object(j.useEffect)((function(){i()}),[]);var i=function(){var t,n,r,i;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.parent_id,c.next=3,p.a.awrap(_n("/announcement/unread?parent_id="+t+"&page=0"));case 3:n=c.sent,r=n.success,n.statusCode,n.message,i=n.data,r&&a(rc(rc({},s),{},{announcements:i}));case 6:case"end":return c.stop()}}),null,null,null,Promise)},c=s.announcements;return 0===c.length?null:Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(ji.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},onClick:function(){return e.viewMore(c)},children:Object(on.jsx)(be.a,{source:n(911),style:{width:38,height:38}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u65b0\u516c\u544a"})}),Object(on.jsx)(O.a,{style:{flex:1,paddingVertical:8},children:Object(on.jsx)(In.a,{horizontal:!0,contentContainerStyle:{paddingBottom:10},children:c.map((function(t,r){var s=new Date(t.timestamp);return Object(on.jsx)(ji.a,{style:{padding:10,backgroundColor:"#F5F5F5",marginRight:15,justifyContent:"center"},underlayColor:"#ff8944",onClick:function(){return e.viewAnnouncement(r,c)},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",alignItems:"center"},children:[t.read?Object(on.jsx)(be.a,{source:n(477),style:{width:20,height:20}}):null,Object(on.jsx)(x.a,{style:{marginLeft:3,alignSelf:"center",fontSize:25,color:"rgba(0,0,0,0.8)"},children:gn(s)})]})},t.id)}))})})]})]})})},ac=function(e){var t=e.student_id,r=Object(j.useState)(!0),s=ue()(r,2),a=s[0],i=s[1],c=Object(j.useState)(null),o=ue()(c,2),l=o[0],d=o[1],u=Object(j.useState)(null),f=ue()(u,2),h=f[0],b=f[1],y=Object(j.useState)(null),g=ue()(y,2),m=g[0],_=g[1],w=Object(j.useState)(null),v=ue()(w,2),S=v[0],C=v[1];Object(j.useEffect)((function(){var t=e.date;D(t)}),[e.date,e.student_id]);var D=function(e){var n,r,s,a,c,o,l,u;return p.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:return console.log("fetchAttendanceByStudentId"),f.next=3,p.a.awrap(_n("/attendance/"+t+"?date="+bn(e)));case 3:n=f.sent,r=n.success,s=n.statusCode,n.message,a=n.data,r?(console.log("fetchAttendanceByStudentId / response: ",n),c=a.in_time,o=a.out_time,l=a.excuse_type,u=a.absence_time,"none-medical"===l&&(l="\u4e8b\u5047"),d(c),b(o),_(l),C(u),i(!1)):400===s&&(d(null),b(null),_(null),C(null),i(!1));case 6:case"end":return f.stop()}}),null,null,null,Promise)};return Object(on.jsx)(fe.Card,{style:{width:"93%"},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(be.a,{source:n(912),style:{width:48,height:48}})}),Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{paddingTop:8},children:Object(on.jsx)(x.a,{style:{fontSize:20},children:"\u51fa\u52e4"})}),a?Object(on.jsx)(Fn,{}):null!==l||null!==h||null!==m?Object(on.jsxs)(O.a,{style:{flex:1,paddingVertical:8,alignItems:"center"},children:[null!==m&&Object(on.jsx)(O.a,{style:{flex:1,paddingBottom:8},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u8acb\u5047: "+m+" ("+{morning:"\u65e9\u4e0a",evening:"\u4e0b\u5348",all_day:"\u5168\u5929"}[S]+")"})}),Object(on.jsxs)(O.a,{style:{flex:1,width:"100%",flexDirection:"row"},children:[Object(on.jsxs)(O.a,{style:{flex:1,alignItems:"center"},children:[Object(on.jsx)(x.a,{children:"\u5230\u6821"}),null!==l&&Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:l})]}),Object(on.jsxs)(O.a,{style:{flex:1,alignItems:"center"},children:[Object(on.jsx)(x.a,{children:"\u96e2\u6821"}),null!==h&&Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:h})]})]})]}):Object(on.jsx)(O.a,{style:{flex:1,paddingVertical:8},children:Object(on.jsx)(x.a,{style:{fontSize:17},children:"\u6c92\u6709\u65b0\u7d00\u9304"})})]})]})})},ic=function(e){return Object(on.jsx)(O.a,{style:{zIndex:2,width:"100%",height:"100%",position:"absolute",backgroundColor:"rgba(0,0,0,1)",alignItems:"center"},children:Object(on.jsx)(ji.a,{style:{paddingTop:30,paddingBottom:15,borderBottomWidth:2,borderBottomColor:"grey"},onClick:function(){return e.onItemClick("DownloadPage")},children:Object(on.jsx)(x.a,{style:{fontSize:25,color:"grey",fontWeight:"bold"},children:" \u4e0b\u8f09 "})})})};function cc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cc(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var lc=Zn.a.get("window").width,dc=(he.a.create({button_text:{fontSize:18,textAlign:"center"},button:{width:"30%",padding:20,justifyContent:"center"}}),Object(A.b)((function(e){return{parent:e.parent,isConnected:e.parent.isConnected}}),(function(e){return oc({},Object(k.a)({setConnectState:mi,initializeChildren:yi,markPresent:xi,clearState:gi},e))}))((function(e){var t=Object(D.g)(),r=Object(j.useState)({date:null,child_id:"",student_id_array:[],message:"",refreshing:!1,showQR:!1,temperature:"",present:!1,showMainMenu:!1}),s=ue()(r,2),a=s[0],i=s[1],c=Object(j.useState)(!1),o=ue()(c,2),l=o[0],d=o[1],u=Object(j.useState)(!1),f=ue()(u,2),h=f[0],b=f[1],y=Object(j.useState)(!1),g=ue()(y,2),m=g[0],_=g[1],w=Object(j.useRef)(bi.a.currentState),v=Object(j.useRef)(),S=Object(j.useRef)();Object(j.useEffect)((function(){return window.addEventListener("offline",(function(t){e.setConnectState(!1)})),window.addEventListener("online",(function(t){e.setConnectState(!0)})),p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:P();case 1:case"end":return e.stop()}}),null,null,null,Promise),bi.a.addEventListener("change",T),function(){bi.a.removeEventListener("change",T),e.clearState()}}),[]),Object(j.useEffect)((function(){l&&E(a.child_id)}),[l]);var C=function(){var e=new Date(a.date.getTime());console.log("date: ",e),5!==e.getDay()||A()?6===e.getDay()&&function(e){var t=new Date;return t.setMonth(2,25),e.toDateString()===t.toDateString()}(e)?e.setDate(e.getDate()+2):e.setDate(e.getDate()+1):e.setDate(e.getDate()+3),z(e)},A=function(){var e=new Date(a.date);e.setDate(e.getDate()+1);var t=new Date;return t.setMonth(2,25),e.toDateString()===t.toDateString()},k=function(){var e=new Date;0===e.getDay()&&e.setDate(e.getDate()-1);var t=new Date;return t.setHours(0,0,0,0),e.getTime()<t.getTime()?e.setHours(18):e.toDateString()===(new Date).toDateString()?e.setTime(new Date):e.setHours(16,0,0),e},P=function(){var t=e.parent_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/family/"+t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message,s=t.data;if(n>200||"Internal server error"===r)alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r);else{e.initializeChildren(s);var c=Object.keys(e.parent.child_of_id);i(oc(oc({},a),{},{child_id:c[0],student_id_array:c,date:k()})),d(!0)}})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when initializing student profiles")}))},T=function(e){w.current.match(/inactive|background/)&&"active"===e&&d(!0),w.current=e},E=function(e){var t,n,r,s,c,o,l,u,f,h;return p.a.async((function(j){for(;;)switch(j.prev=j.next){case 0:if(t=a.date||new Date,""!==(n=e||a.child_id)){j.next=4;break}return j.abrupt("return");case 4:if(t.toDateString()===(new Date).toDateString()){j.next=6;break}return j.abrupt("return");case 6:return j.next=8,p.a.awrap(_n("/attendance/"+n+"?date="+bn(t)));case 8:r=j.sent,s=r.success,r.statusCode,r.message,c=r.data,s&&(o=c.in_time,l=c.out_time,u=c.excuse_type,f=c.absence_time,(R(o,l,u)||I(f))&&((h=new Date).setHours(18,0,0,0),i(oc(oc({},a),{},{date:h})))),d(!1);case 12:case"end":return j.stop()}}),null,null,null,Promise)},R=function(e,t,n){return null!==e&&null!==t},I=function(e){return null!==e&&"all_day"===e},z=function(e){var t=new Date;t.setHours(0,0,0,0),e.getTime()<t.getTime()?e.setHours(18):e.toDateString()===(new Date).toDateString()?e.setTime(new Date):e.setHours(16,0,0),i(oc(oc({},a),{},{date:e})),_(!1),d(!0)},L=e.parent_id,B=e.isConnected,M=a.date,F=a.child_id,N=a.showQR,q=a.temperature,U=a.present,H=a.showMainMenu;if(""===F||null===M)return Object(on.jsx)(Fn,{});var V=e.parent.child_of_id[F],W=function(e,t){var n=new Date(e),r=new Date(t);n.setHours(0),r.setHours(0);return Math.round((r-n)/864e5)}(M,new Date);return Object(on.jsxs)(Hn.a,{enabled:!0,behavior:"padding",keyboardVerticalOffset:100,style:{flex:1,zIndex:1},children:[Object(on.jsx)(Hi,{ref:S,student_of_id:e.parent.child_of_id,onSelectStudent:function(e){return function(e){i(oc(oc({},a),{},{child_id:e}))}(e)}}),N?Object(on.jsx)(Qi,{hideQRCode:function(){i(oc(oc({},a),{},{showQR:!1})),d(!0)},parent_id:L}):null,m?Object(on.jsx)(Cr,{start_date:M,datetime_type:"date",hideModal:function(){return _(!1)},selectDatetimeConfirm:function(e){return z(e)},minDatetime:(new Date).setDate((new Date).getDate()-30),maxDatetime:(new Date).setDate((new Date).getDate()+1),paddingVertical:100}):null,h&&Object(on.jsx)(Cr,{start_date:new Date,datetime_type:"time",hideModal:function(){return b(!1)},selectDatetimeConfirm:function(e){return v.current.selectDatetimeConfirm(e)},minDatetime:null,maxDatetime:null,minTime:null,maxTime:null,paddingVertical:400}),H&&Object(on.jsx)(ic,{onItemClick:function(n){return function(n){var r=a.child_id;i(oc(oc({},a),{},{showMainMenu:!1})),t(n,{student_id:r,students:e.parent.child_of_id})}(n)},onHide:function(){return i(oc(oc({},a),{},{showMainMenu:!1}))}}),Object(on.jsxs)(In.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center",paddingBottom:30},refreshControl:Object(on.jsx)(Mr.a,{style:{backgroundColor:"transparent"},refreshing:a.refreshing,onRefresh:P,tintColor:"#ff8944",title:"Loading...",titleColor:"#368cbf",colors:["#ff8944","#368cbf","#0000ff"],progressBackgroundColor:"#ffff00"}),children:[Object(on.jsxs)(O.a,{style:{width:"100%",flexDirection:"row",backgroundColor:"white"},children:[Object(on.jsx)(O.a,{style:{width:"15%"},children:W<30?Object(on.jsx)(ji.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return function(){var e=new Date(a.date.getTime()),t=new Date;t.setMonth(2,27),1===e.getDay()&&e.toDateString()!==t.toDateString()?e.setDate(e.getDate()-3):e.toDateString()===t.toDateString()?e.setDate(e.getDate()-2):e.setDate(e.getDate()-1),z(e)}()},children:Object(on.jsx)(be.a,{source:n(334),style:{width:40,height:40}})}):null}),Object(on.jsx)(ji.a,{style:{width:"70%",justifyContent:"center"},onPress:function(){return _(!0)},children:Object(on.jsx)(x.a,{style:{fontSize:.12*lc,textAlign:"center"},children:yn(M)})}),Object(on.jsx)(O.a,{style:{width:"15%"},children:W>=0?Object(on.jsx)(je.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return C()},children:Object(on.jsx)(be.a,{source:n(335),style:{width:40,height:40}})}):null})]}),Object(on.jsx)(Fi,{student_id:F,student:V,students:e.parent.child_of_id,student_name:e.parent.child_of_id[F].name,selectOtherChildProfile:function(){return S.current.slideIn()},viewQRCode:function(){return i(oc(oc({},a),{},{showQR:!0}))},temperature:q}),Object(on.jsxs)(O.a,{style:{flex:1,width:"93%",flexDirection:"row",justifyContent:"space-between",marginVertical:5},children:[Object(on.jsx)(je.a,{style:{width:"30%",padding:10,backgroundColor:"#ffe1d0"},onPress:function(){return t("/pickup",{state:{child_id:F,school_id:V.school_id}})},children:Object(on.jsx)(x.a,{style:{fontSize:.05*lc,textAlign:"center"},children:"\u63a5\u56de\u544a\u77e5"})}),Object(on.jsx)(ji.a,{style:{width:"30%",padding:10,backgroundColor:"#fff1b5"},onPress:function(){return t("/med-request",{state:{student_id:F,class_id:V.class_id}})},children:Object(on.jsx)(x.a,{style:{fontSize:.05*lc,textAlign:"center"},children:"\u6258\u85e5\u55ae"})}),Object(on.jsx)(ji.a,{style:{width:"30%",padding:10,backgroundColor:"#b5e9e9"},onPress:function(){return t("/absence-request",{state:{student_id:F,class_id:null===V.class_id?"":V.class_id,school_id:V.school_id}})},children:Object(on.jsx)(x.a,{style:{fontSize:.05*lc,textAlign:"center"},children:"\u8acb\u5047\u55ae"})})]}),Object(on.jsx)(sc,{child_id:F,date:M,parent_id:L,viewAnnouncement:function(e,n){return t("AnnouncementPage",{index:e,data:n,parent_id:L})},viewMore:function(e){return t("AnnouncementListPage",{announcements:e,parent_id:L,viewAnnouncement:function(e,n){return t("AnnouncementPage",{index:e,data:n,parent_id:L})}})}}),Object(on.jsx)(tc,{student_id:F,date:M,class_id:V.class_id,ref:v,present:U,isConnected:B,parent_id:L,showTimeModal:function(){return b(!0)}}),Object(on.jsx)(ac,{student_id:F,date:M}),Object(on.jsx)(Zi,{child_id:F,date:M,viewMedRequest:function(e,n){return t("/add-med-request",{state:{student_id:F,class_id:null===V.class_id?"":V.class_id,index:e,data:n}})}}),Object(on.jsx)(vi,{child_id:F,date:M,updateTitleTemp:function(e){return function(e){a.date;i(oc(oc({},a),{},{temperature:e,present:""!==e}))}(e)}}),Object(on.jsx)(zi,{child_id:F,date:M,class_id:V.class_id,parent_id:L}),Object(on.jsx)(Ci,{child_id:F,date:M}),Object(on.jsx)(Ai,{child_id:F,date:M}),Object(on.jsx)(Pi,{child_id:F,date:M}),Object(on.jsx)(Ei,{child_id:F,date:M})]})]})}))),uc=n(153);function fc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}Zn.a.get("window").width;var hc=function(e){o()(n,e);var t=fc(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={"\u85e5\u7c89":0},r}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u7c89;this.setState({"\u85e5\u7c89":parseInt(e)})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u7c89,n=this.props,r=n.width,s=n.height;return Object(on.jsx)(O.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"},children:Object(on.jsxs)(O.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"},children:[Object(on.jsx)(O.a,{style:{height:s,flexDirection:"row",flexDirection:"row"},children:Object(on.jsx)(O.a,{style:{width:r,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u85e5\u7c89"})})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(je.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",height:.8*s,aspectRatio:1,justifyContent:"center",borderRadius:.4*s},onPress:function(){return e.setState({"\u85e5\u7c89":0===t?0:t-1})},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center",color:"white"},children:"-"})}),Object(on.jsxs)(x.a,{style:{fontSize:40,paddingHorizontal:15},children:[t," \u5305"]}),Object(on.jsx)(je.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",height:.8*s,aspectRatio:1,justifyContent:"center",borderRadius:.4*s},onPress:function(){return e.setState({"\u85e5\u7c89":t+1})},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center",color:"white"},children:"+"})})]}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()},children:Object(on.jsx)(x.a,{style:{fontSize:.12*r,textAlign:"center"},children:"\u53d6\u6d88\u9078\u53d6"})})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"OK"})})})]})]})})}}]),n}(b.a.Component);function pc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var jc=function(e){o()(n,e);var t=pc(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={"\u85e5\u6c34":0},r}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u6c34;this.setState({"\u85e5\u6c34":e})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u6c34,n=this.props,r=n.width,s=n.height;return Object(on.jsx)(O.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"},children:Object(on.jsxs)(O.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"},children:[Object(on.jsx)(O.a,{style:{height:s,flexDirection:"row",flexDirection:"row"},children:Object(on.jsx)(O.a,{style:{width:r,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u85e5\u6c34"})})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center",marginTop:-20},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",backgroundColor:"rgba(255,255,255,0.4)",alignItems:"center"},children:[Object(on.jsx)(Vn.a,{style:{fontSize:40,padding:10},keyboardType:"decimal-pad",autoFocus:!0,selectTextOnFocus:!0,value:""+t,onChangeText:function(t){return e.setState({"\u85e5\u6c34":t})}}),Object(on.jsx)(x.a,{style:{paddingLeft:10,fontSize:40},children:"c.c."})]})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()},children:Object(on.jsx)(x.a,{style:{fontSize:20,textAlign:"center"},children:"\u53d6\u6d88\u9078\u53d6"})})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"OK"})})})]})]})})}}]),n}(b.a.Component);function bc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var yc=function(e){o()(n,e);var t=bc(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={"\u85e5\u818f":""},r}return i()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u818f;this.setState({"\u85e5\u818f":e})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u818f,n=this.props,r=n.width,s=n.height;return Object(on.jsx)(O.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"},children:Object(on.jsxs)(O.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"},children:[Object(on.jsx)(O.a,{style:{height:s,flexDirection:"row",flexDirection:"row"},children:Object(on.jsx)(O.a,{style:{width:r,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u85e5\u818f"})})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center",marginTop:-20},children:Object(on.jsx)(O.a,{style:{flexDirection:"row",backgroundColor:"rgba(255,255,255,0.4)",alignItems:"center"},children:Object(on.jsx)(Vn.a,{style:{fontSize:40,padding:10},placeholder:"\u90e8\u4f4d",autoFocus:!0,selectTextOnFocus:!0,value:t,onChangeText:function(t){return e.setState({"\u85e5\u818f":t})}})})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()},children:Object(on.jsx)(x.a,{style:{fontSize:20,textAlign:"center"},children:"\u53d6\u6d88\u9078\u53d6"})})}),Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(je.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"OK"})})})]})]})})}}]),n}(b.a.Component);function gc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}!function(e){o()(n,e);var t=gc(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={optionButtonWidth:0,optionButtonHeight:0,show_date_picker:!1,show_time_picker:!1,date:new Date,time:new Date,show_editor:"","\u85e5\u7c89":null,need_refrigeration:!1,"\u85e5\u6c34":null,"\u85e5\u818f":null,note:"",access_mode:"create"},r}i()(n,[{key:"componentDidMount",value:function(){}},{key:"getHeader",value:function(){var e=this.state,t=e.access_mode,n=e.date;if("read"===t){if(bn(n)===bn(new Date))return"\u4eca\u5929\u6258\u85e5\u55ae";return"\u661f\u671f"+["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][n.getDay()]}return"create"===t?"\u65b0\u589e\u6258\u85e5\u55ae":"edit"===t?"\u7de8\u8f2f\u4e2d...":void 0}},{key:"fetchAccessMode",value:function(){return this.state.access_mode}},{key:"componentDidUpdate",value:function(e){if(e.request!==this.props.request){var t=this.props.request;if(!t)return void this.setState({date:new Date,time:new Date,"\u85e5\u7c89":null,need_refrigeration:!1,"\u85e5\u6c34":null,"\u85e5\u818f":null,note:"",access_mode:"create"});var n=t.timestamp,r=t.medication,s=t.note,a=r.\u85e5\u7c89,i=r.need_refrigeration,c=r.\u85e5\u6c34,o=r.\u85e5\u818f;this.setState({date:n,time:n,"\u85e5\u7c89":a,need_refrigeration:i,"\u85e5\u6c34":c,"\u85e5\u818f":o,note:s,access_mode:"read"})}}},{key:"setDate",value:function(e){"ios"===Wn.a.OS?this.iosSetDate(e):this.androidSetDate(e)}},{key:"iosSetDate",value:function(e){"read"!==this.state.access_mode&&this.setState({date:e,time:e})}},{key:"androidSetDate",value:function(e){void 0!==e?this.setState({date:e,time:e,show_date_picker:!1}):this.setState({show_date_picker:!1})}},{key:"setTime",value:function(e){"ios"===Wn.a.OS?this.iosSetTime(e):this.androidSetTime(e)}},{key:"iosSetTime",value:function(e){"read"!==this.state.access_mode&&this.setState({time:e})}},{key:"androidSetTime",value:function(e){void 0!==e?this.setState({time:e,show_time_picker:!1}):this.setState({show_time_picker:!1})}},{key:"onFinishEdit",value:function(e,t){this.setState(S()({show_editor:""},e,t))}},{key:"onCancelSelect",value:function(e){this.setState(S()({show_editor:""},e,null))}},{key:"handleClickConfirmButton",value:function(){var e=this.state.access_mode;if("read"===e)this.setState({access_mode:"edit"});else if("create"===e)this.sendRequest(null);else if("edit"===e){var t=this.props.request.id;this.sendRequest(t)}}},{key:"sendRequest",value:function(e){var t=this,n=this.state,r=n.date,s=n.time,a=n.\u85e5\u7c89,i=n.need_refrigeration,c=n.\u85e5\u6c34,o=n.\u85e5\u818f,l=n.note,d=this.props,u=d.student_id,f=d.class_id,h={request_id:e,timestamp:bn(r)+" "+On(s),class_id:f,"\u85e5\u7c89":a,need_refrigeration:i,"\u85e5\u6c34":c,"\u85e5\u818f":o,note:l};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/medicationrequest/student/"+u,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(h)}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message,s=e.data;n>200||"Internal server error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):t.props.onCreateRequestSuccess(s.id)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending medication request")}))}},{key:"deleteRequestConfirm",value:function(){confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest()}},{key:"deleteRequest",value:function(){var e=this,t=this.props,n=t.request,r=t.class_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/medicationrequest/"+n.id,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:r})}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message,s=t.data;n>200||"Internal Server Error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):e.props.onDeleteRequestSuccess(s.id)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.show_date_picker,r=t.show_time_picker,s=t.date,a=t.time,i=t.\u85e5\u7c89,c=t.\u85e5\u6c34,o=t.\u85e5\u818f,l=t.note,d=t.optionButtonWidth,u=t.optionButtonHeight,f=t.show_editor,h=t.access_mode;return n?Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{flex:3,justifyContent:"center"}}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(je.a,{style:{width:"50%",padding:10,backgroundColor:"rgba(255,255,255,0.4)",alignSelf:"flex-end"},onPress:function(){return e.setState({show_date_picker:!1})},children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:"OK"})})})]}):r?Object(on.jsxs)(O.a,{style:{flex:1},children:[Object(on.jsx)(O.a,{style:{flex:3,justifyContent:"center"}}),Object(on.jsx)(O.a,{style:{flex:1},children:Object(on.jsx)(je.a,{style:{width:"50%",padding:10,backgroundColor:"rgba(255,255,255,0.4)",alignSelf:"flex-end"},onPress:function(){return e.setState({show_time_picker:!1})},children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:"OK"})})})]}):Object(on.jsxs)(Hn.a,{style:{flex:1},behavior:"padding",enabled:!0,children:[Object(on.jsx)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:this.getHeader()})}),Object(on.jsxs)(O.a,{style:{flex:7},children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-between",paddingVertical:10},children:[Object(on.jsx)(je.a,{disabled:"read"===h||""!==f,style:{backgroundColor:"rgba(255,255,255,0.4)",justifyContent:"center",padding:10,height:"100%"},onPress:function(){return e.setState({show_date_picker:!n})},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:yn(s)})}),Object(on.jsx)(je.a,{disabled:"read"===h||""!==f,style:{backgroundColor:"rgba(255,255,255,0.4)",justifyContent:"center",padding:10,height:"100%"},onPress:function(){return e.setState({show_time_picker:!r})},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:xn(a)})})]}),"\u85e5\u7c89"===f?Object(on.jsx)(hc,{"\u85e5\u7c89":i,width:d,height:u,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u7c89",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u7c89")}}):"\u85e5\u6c34"===f?Object(on.jsx)(jc,{"\u85e5\u6c34":c,width:d,height:u,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u6c34",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u6c34")}}):"\u85e5\u818f"===f?Object(on.jsx)(yc,{"\u85e5\u818f":o,width:d,height:u,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u818f",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u818f")}}):Object(on.jsxs)(O.a,{style:{flex:4},children:[Object(on.jsxs)(O.a,{style:{flex:3,backgroundColor:"rgba(255,255,255,0.4)"},children:[Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(je.a,{disabled:"read"===h,style:{flex:1,backgroundColor:i?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:14,marginTop:14,marginRight:7,marginBottom:7},onLayout:function(t){var n=t.nativeEvent.layout,r=n.width,s=n.height;e.setState({optionButtonWidth:r,optionButtonHeight:s})},underlayColor:"#ff8944",onPress:function(){return e.setState({show_editor:"\u85e5\u7c89","\u85e5\u7c89":i||1})},children:i?Object(on.jsxs)(x.a,{style:{fontSize:25,textAlign:"center"},children:["\u85e5\u7c89: ",i," \u5305"]}):Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"\u85e5\u7c89"})}),Object(on.jsx)(je.a,{disabled:"read"===h,style:{flex:1,backgroundColor:this.state.need_refrigeration?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:7,marginTop:14,marginRight:14,marginBottom:7},underlayColor:"#ff8944",onPress:function(){return e.setState({need_refrigeration:!e.state.need_refrigeration})},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"\u85e5\u54c1\u9700\u51b7\u85cf"})})]}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row"},children:[Object(on.jsx)(je.a,{disabled:"read"===h,style:{flex:1,backgroundColor:c?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:14,marginTop:7,marginRight:7,marginBottom:14},onPress:function(){return e.setState({show_editor:"\u85e5\u6c34","\u85e5\u6c34":c||0})},children:c?Object(on.jsxs)(x.a,{style:{fontSize:20,textAlign:"center"},children:["\u85e5\u6c34: ",c," c.c."]}):Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"\u85e5\u6c34"})}),Object(on.jsx)(je.a,{disabled:"read"===h,style:{flex:1,backgroundColor:o?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:7,marginTop:7,marginRight:14,marginBottom:14},onPress:function(){return e.setState({show_editor:"\u85e5\u818f"})},children:o?Object(on.jsxs)(x.a,{style:{fontSize:20,textAlign:"center"},children:["\u85e5\u818f\u90e8\u4f4d: ",o]}):Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"\u85e5\u818f"})})]})]}),Object(on.jsx)(O.a,{style:{backgroundColor:"#b5e9e9"},children:Object(on.jsx)(Vn.a,{editable:"read"!==h,placeholder:"\u5099\u8a3b",placeholderTextColor:"grey",value:l,style:{backgroundColor:"#eaf8f8",borderRadius:3,fontSize:20,padding:20},onChangeText:function(t){return e.setState({note:t})}})})]}),void 0!==this.props.request&&this.props.request.administered?Object(on.jsx)(O.a,{style:{flex:1,flexDirection:"row",paddingVertical:10,justifyContent:"center",alignItems:"center"},children:Object(on.jsxs)(x.a,{style:{fontSize:30},children:["\u5582\u85e5\u8001\u5e2b: ",this.props.request.teacher_name]})}):Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",paddingVertical:10},children:[Object(on.jsx)(O.a,{style:{flex:1,marginHorizontal:7},children:"edit"===h?Object(on.jsx)(je.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.deleteRequestConfirm()},children:Object(on.jsx)(x.a,{style:{fontSize:17,textAlign:"center"},children:"\u522a\u9664"})}):null}),Object(on.jsx)(O.a,{style:{flex:1,marginHorizontal:7},children:"edit"===h?Object(on.jsx)(je.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.setState({access_mode:"read"})},children:Object(on.jsx)(x.a,{style:{fontSize:17,textAlign:"center"},children:"\u53d6\u6d88\u7de8\u8f2f"})}):null}),Object(on.jsx)(O.a,{style:{flex:1,marginHorizontal:7},children:Object(on.jsx)(je.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.handleClickConfirmButton()},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"read"===h?"\u7de8\u8f2f":"create"===h?"\u65b0\u589e":"edit"===h?"\u9001\u51fa":null})})})]})]})]})}}])}(b.a.Component);function Oc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oc(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mc=Zn.a.get("window").width,_c=Object(A.b)((function(e){return{isConnected:e.parent.isConnected}}),(function(e){return xc({},Object(k.a)({getMedRequestSuccess:Oi},e))}))((function(e){var t=Object(D.f)(),n=Object(D.g)(),r=Object(j.useState)({today:new Date,tomorrow:new Date,SlideInRight:new Ni.a.Value(0),SlideInLeft:new Ni.a.Value(0),total_height:1,total_width:1,height:0,width:0,left:0,top:0,requests:[],day_of_week:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],selected_request_index:-1}),s=ue()(r,2),a=s[0],i=s[1];Object(j.useEffect)((function(){console.log("init");var e=a.tomorrow;e.setDate(e.getDate()+1),i(xc(xc({},a),{},{tomorrow:e})),o()}),[]);var c=function(){return"ios"===Wn.a.OS},o=function(){var e,n,r,s,c,o;return p.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e=t.state.student_id,n=bn(new Date),d.next=4,p.a.awrap(_n("/medicationrequest/student/"+e+"?date="+n));case 4:if(r=d.sent,s=r.success,r.statusCode,c=r.message,o=r.data,console.log("fetchMedicationRequest: ",r),s){d.next=10;break}return alert("Sorry \u53d6\u5f97\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u6216\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+c),d.abrupt("return");case 10:l(o),i(xc(xc({},a),{},{requests:o}));case 12:case"end":return d.stop()}}),null,null,null,Promise)},l=function(e){for(var t=0;t<e.length;t++){e[t].title=new Date(e[t].title);for(var n=0;n<e[t].data.length;n++)e[t].data[n].timestamp=new Date(e[t].data[n].timestamp)}},d=function(e){var n=t.state.class_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/medicationrequest/"+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:n})}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message;e.data;t>200||"Internal Server Error"===n?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+n):o()})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))},u=(a.SlideInRight,a.SlideInLeft,a.total_width,a.requests),f=(a.today,a.tomorrow,a.day_of_week),h=a.selected_request_index,b=t.state,y=b.student_id,g=b.class_id;u[h];return Object(on.jsxs)(O.a,{style:{flex:1,paddingHorizontal:20},children:[0===u.length&&Object(on.jsx)(O.a,{style:{padding:20,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(x.a,{style:{fontSize:50},children:"\u7121\u6258\u85e5\u55ae"})}),Object(on.jsx)(uc.a,{sections:u,keyExtractor:function(e,t){return e+t},renderItem:function(e){var t=e.item,r=e.index,s=e.section;return Object(on.jsxs)(O.a,{style:{width:"100%",aspectRatio:5,flexDirection:"row",marginVertical:7,justifyContent:"space-between",alignItems:"center"},children:[Object(on.jsx)(ji.a,{style:{width:"65%",height:"100%",padding:20,backgroundColor:"#368cbf",borderRadius:40,justifyContent:"center",alignItems:"center"},onPress:function(){return n("/add-med-request",{state:{student_id:y,class_id:g,index:r,data:s.data}})},children:Object(on.jsx)(x.a,{style:{fontSize:30},children:xn(t.timestamp)})}),Object(on.jsx)(ji.a,{style:{width:"30%",height:"100%",padding:20,backgroundColor:"#fa625f",justifyContent:"center",borderRadius:40},onPress:function(){return e=t.id,void(confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&d(e));var e},children:Object(on.jsx)(x.a,{style:{fontSize:.07*mc,textAlign:"center"},children:"\u522a\u9664"})})]})},renderSectionHeader:function(e){var t=e.section.title;return Object(on.jsxs)(O.a,{style:{width:"100%",backgroundColor:"rgba(0,0,0,0.5)",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:c()?20:12,marginTop:15,marginBottom:7,borderRadius:40},children:[Object(on.jsx)(x.a,{style:{fontSize:30,color:"white"},children:""+gn(t)}),Object(on.jsx)(x.a,{style:{fontSize:30,color:"white"},children:"\u661f\u671f"+f[t.getDay()]})]})}}),Object(on.jsx)(O.a,{style:{width:"100%",paddingVertical:10,justifyContent:"center",backgroundColor:"transparent"},children:Object(on.jsx)(ji.a,{style:{backgroundColor:"#f4d41f",padding:c()?20:12,justifyContent:"center",borderRadius:40},onPress:function(){return n("/add-med-request",{state:{student_id:y,class_id:g,index:-1,data:null}})},children:Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:"\u65b0\u589e"})})})]})}));function wc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wc(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Sc=Zn.a.get("window"),Cc=Sc.width,Dc=Sc.height,Ac=[{value:"\u611f\u5192",label:"\u611f\u5192"},{value:"\u6d41\u611f",label:"\u6d41\u611f"},{value:"\u8178\u75c5\u6bd2",label:"\u8178\u75c5\u6bd2"},{value:"\u6c34\u75d8",label:"\u6c34\u75d8"},{value:"\u8178\u80c3\u708e",label:"\u8178\u80c3\u708e"},{value:"\u5176\u4ed6",label:"\u5176\u4ed6"},{value:"Cancel",label:"\u8fd4\u56de"}],kc=Object(j.forwardRef)((function(e,t){var n=Object(D.g)(),r=Object(j.useState)({max_date:(new Date).setDate((new Date).getDate()+30),cached_date:null,startDate:new Date,endDate:new Date,childIsSick:0,excuse_type:"none-medical",editing_other_option:!1,days:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],months:["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"],access_mode:"create",note:"",absence_time:"all_day",scrollHeight:"100%",request_id:""}),s=ue()(r,2),a=s[0],i=s[1],c=Object(j.useState)(!1),o=ue()(c,2),l=o[0],d=o[1],u=Object(j.useState)(!1),f=ue()(u,2),h=f[0],p=f[1],b=Object(j.useState)(!1),y=ue()(b,2),g=y[0],m=y[1];Object(j.useImperativeHandle)(t,(function(){return{fetchAccessMode:function(){return a.access_mode},duplicateDateFound:function(){var e=a.cached_date;i(vc(vc({},a),{},{startDate:e,cached_date:null}))}}})),Object(j.useEffect)((function(){var t=e.request;if(t){var n=t.id,r=t.date,s=t.excuse_type,c=t.note,o=t.absence_time;i(vc(vc({},a),{},{startDate:r,endDate:null,childIsSick:"none-medical"===s?0:1,excuse_type:s,note:c,absence_time:o,access_mode:"read",cached_date:null,request_id:n}))}else i(vc(vc({},a),{},{startDate:new Date,endDate:new Date,childIsSick:0,excuse_type:"none-medical",note:"",absence_time:"all_day",access_mode:"create",cached_date:null,scrollHeight:"100%",request_id:""}))}),[e.request]);var _=function(e){"Cancel"===e?m(!1):"\u5176\u4ed6"===e?(i(vc(vc({},a),{},{editing_other_option:!0,excuse_type:"\u5176\u4ed6"})),m(!1)):(i(vc(vc({},a),{},{excuse_type:e})),m(!1))},w=function(e){var t=a.endDate;if("edit"===a.access_mode){var n=a.cached_date,r=a.startDate;i(vc(vc({},a),{},{cached_date:null===n?r:n,startDate:e}))}else i(vc(vc({},a),{},{startDate:e,endDate:e<t?t:e}))},v=function(t){if(void 0!==t){var n=a.endDate;if("edit"===a.access_mode){var r=a.cached_date,s=a.startDate,c=e.request.id;i(vc(vc({},a),{},{cached_date:null===r?s:r,startDate:t})),d(!1),e.checkUniqueStudentDate(c,t)}else i(vc(vc({},a),{},{startDate:t,endDate:t<n?n:t})),d(!1)}else d(!1)},S=function(e){var t=a.startDate;i(vc(vc({},a),{},{startDate:e<t?e:t,endDate:e}))},C=function(e){if(void 0!==e){var t=a.startDate;i(vc(vc({},a),{},{startDate:e<t?e:t,endDate:e}))}else p(!1)},A=function(){var t=a.access_mode;if("read"===t)i(vc(vc({},a),{},{access_mode:"edit"}));else if("create"===t)k();else if("edit"===t){var n=e.request.id;P(n)}},k=function(){var t=a.excuse_type,r=a.note,s=a.absence_time,i=e.student_id,c=e.class_id,o=e.school_id,l=(e.isConnected,{student_id:i,class_id:c,school_id:o,startDate:bn(a.startDate),endDate:bn(a.endDate),excuse_type:t,note:r,absence_time:s});fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/absence-excuse",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(l)}).then((function(e){return e.json()})).then((function(t){var r=t.statusCode,s=t.message,a=t.data;r>200||"Internal server error"===s?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01 \u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+s):(e.onCreateRequestSuccess(a.id),n(-1))})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01 \u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending absence request")}))},P=function(t){var r=a.excuse_type,s=a.note,i=a.absence_time,c=e.class_id,o=bn(a.startDate);fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/absence-excuse",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:t,excuse_type:r,note:s,date:o,class_id:c,absence_time:i})}).then((function(e){return e.json()})).then((function(r){var s=r.statusCode,a=r.message;r.data;s>200||"Internal server error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):(e.onCreateRequestSuccess(t),n(-1))})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when editing absence request")}))},T=function(){var t=e.request.id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/absence-excuse",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:t})}).then((function(e){return e.json()})).then((function(r){var s=r.statusCode,a=r.message;r.data;s>200||"Internal server error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):(e.onDeleteRequestSuccess(t),n(-1))})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting absence request")}))},E=a.max_date,R=a.access_mode,I=a.startDate,z=a.endDate,L=a.excuse_type,B=a.editing_other_option,M=a.note,F=a.absence_time,N=a.scrollHeight,q=a.request_id;return l?Object(on.jsx)(O.a,{style:{height:Dc,marginTop:-120},children:Object(on.jsx)(Cr,{start_date:I,datetime_type:"date",hideModal:function(){return d(!1)},selectDatetimeConfirm:function(e){return function(e){"ios"===Wn.a.OS?w(e):v(e)}(e)},minDatetime:new Date,maxDatetime:E,paddingVertical:100})}):h?Object(on.jsx)(O.a,{style:{height:Dc,marginTop:-120},children:Object(on.jsx)(Cr,{start_date:z,datetime_type:"date",hideModal:function(){return p(!1)},selectDatetimeConfirm:function(e){return function(e){"ios"===Wn.a.OS?S(e):C(e)}(e)},minDatetime:new Date,maxDatetime:E,paddingVertical:100})}):g?Object(on.jsx)(O.a,{style:{padding:30,height:"100%",alignItems:"center"},children:Ac.map((function(e,t){var n=e.label,r=e.value;return Object(on.jsx)(ji.a,{style:{width:"50%",padding:15,backgroundColor:"white",borderWidth:1,borderColor:"lightgrey"},onPress:function(){return _(r)},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:n})},t)}))}):Object(on.jsxs)(O.a,{style:{paddingHorizontal:30,paddingVertical:30,height:"100%"},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row"},children:[Object(on.jsx)(ji.a,{disabled:"read"===R,style:{flex:1,padding:15,justifyContent:"center",backgroundColor:0===a.childIsSick?"#368cbf":"rgba(0,0,0,0.1)",borderTopLeftRadius:30,borderBottomLeftRadius:30},underlayColor:"#368cbf",onPress:function(){"read"!==a.access_mode&&i(vc(vc({},a),{},{childIsSick:0,excuse_type:"none-medical"}))},children:Object(on.jsx)(x.a,{style:{fontSize:25,color:0===a.childIsSick?"white":"black",textAlign:"center"},children:"\u4e8b\u5047"})}),B?Object(on.jsx)(O.a,{style:{flex:1,padding:15,borderTopRightRadius:30,borderBottomRightRadius:30,justifyContent:"center",backgroundColor:a.childIsSick?"#368cbf":"rgba(0,0,0,0.1)"},children:Object(on.jsx)(Vn.a,{autoFocus:!0,selectTextOnFocus:!0,style:{fontSize:25,color:a.childIsSick?"white":"black",textAlign:"center",paddingVertical:-1},value:L,onChangeText:function(e){return i(vc(vc({},a),{},{excuse_type:e}))},onBlur:function(){return function(){var e=a.excuse_type;i(vc(vc({},a),{},{editing_other_option:!1,childIsSick:""===e?0:1,excuse_type:""===e?"none-medical":e}))}()}})}):Object(on.jsx)(Gn,{style:{flex:1,padding:15,borderTopRightRadius:30,borderBottomRightRadius:30,justifyContent:"center",backgroundColor:0===a.childIsSick?"rgba(0,0,0,0.1)":"#368cbf"},disabled:"read"===R,textStyle:{fontSize:25,color:a.childIsSick?"white":"black",textAlign:"center"},selectedValue:"none-medical"===L?"\u75c5\u5047":L,showSelect:function(){return i(vc(vc({},a),{},{childIsSick:1})),void m(!0)},handleOnClick:function(){i(vc(vc({},a),{},{childIsSick:1}))},handleSelectValue:function(e){return _(e)}})]}),Object(on.jsxs)(O.a,{style:{width:"100%"},children:[null===z?Object(on.jsx)(O.a,{style:{paddingVertical:20,width:"70%",alignSelf:"center"},children:Object(on.jsx)(ji.a,{disabled:"read"===R,style:{backgroundColor:"rgba(0,0,0,0.4)"},onPress:function(){"read"!==R&&d(!0)},children:Object(on.jsxs)(O.a,{style:{padding:15,justifyContent:"center"},children:[Object(on.jsx)(O.a,{style:{},children:Object(on.jsx)(x.a,{style:{color:"white",fontSize:.12*Cc,fontWeight:"bold"},children:I.getFullYear()})}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsxs)(x.a,{style:{color:"white",fontSize:.12*Cc,fontWeight:"bold"},children:[I.getMonth()+1,"/",I.getDate()]})}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsxs)(x.a,{style:{fontSize:.12*Cc,color:"white",fontWeight:"bold"},children:["\u661f\u671f",a.days[I.getDay()]]})})]})})}):Object(on.jsxs)(O.a,{style:{alignItems:"center",paddingVertical:15},children:[Object(on.jsxs)(O.a,{style:{width:"100%"},children:[Object(on.jsx)(x.a,{style:{color:"rgba(0,0,0,0.4)",fontSize:.1*Cc},children:"\u958b\u59cb"}),Object(on.jsx)(ji.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",padding:15},onPress:function(){return d(!0)},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[Object(on.jsx)(x.a,{style:{color:"white",fontSize:.09*Cc,fontWeight:"bold"},children:gn(I)}),Object(on.jsxs)(x.a,{style:{fontSize:.09*Cc,color:"white",fontWeight:"bold"},children:["\u661f\u671f",a.days[I.getDay()]]})]})})]}),Object(on.jsx)(O.a,{style:{width:"100%",alignItems:"center",justifyContent:"center",padding:20},children:Object(on.jsxs)(x.a,{style:{fontSize:25},children:["\u7e3d\u8a08 ",function(){var e=a.startDate,t=a.endDate;return Math.round(Math.abs((t-e)/864e5))+1}()," \u5929"]})}),Object(on.jsxs)(O.a,{style:{width:"100%"},children:[Object(on.jsx)(ji.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",padding:15},onPress:function(){return p(!0)},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[Object(on.jsx)(x.a,{style:{color:"white",fontSize:.09*Cc,fontWeight:"bold"},children:gn(z)}),Object(on.jsxs)(x.a,{style:{fontSize:.09*Cc,color:"white",fontWeight:"bold"},children:["\u661f\u671f",a.days[z.getDay()]]})]})}),Object(on.jsx)(x.a,{style:{color:"rgba(0,0,0,0.4)",fontSize:.1*Cc,textAlign:"right"},children:"\u7d50\u675f"})]})]}),Object(on.jsx)(O.a,{style:{flex:1,width:"100%",alignItems:"center"},children:Object(on.jsx)(Vn.a,{editable:"read"!==R,placeholder:"\u5099\u8a3b",placeholderTextColor:"grey",multiline:!0,scrollEnabled:!1,value:M,style:{width:"100%",height:N,backgroundColor:"#eaf8f8",borderRadius:3,fontSize:25,paddingTop:20,paddingBottom:20,paddingHorizontal:20,textAlignVertical:"center"},onChangeText:function(e){return i(vc(vc({},a),{},{note:e}))},onChange:function(e){return function(e){i(vc(vc({},a),{},{scrollHeight:e}))}(e.target.scrollHeight)},onLayout:function(e){var t=e.nativeEvent.target.scrollHeight;i(vc(vc({},a),{},{scrollHeight:t}))}},q)}),Object(on.jsxs)(O.a,{style:{flex:1,width:"100%",alignItems:"center",flexDirection:"row",justifyContent:"space-between"},children:[Object(on.jsx)(ji.a,{disabled:"read"===R,style:{flex:1,paddingVertical:15,justifyContent:"center"},underlayColor:"transparent",onPress:function(){"read"!==R&&i(vc(vc({},a),{},{absence_time:"all_day"}))},children:Object(on.jsx)(x.a,{style:{width:"90%",fontSize:25,backgroundColor:"all_day"===F?"#368cbf":"rgba(0,0,0,0.1)",color:"all_day"===F?"white":"black",padding:15,textAlign:"center"},children:"\u5168\u5929"})}),Object(on.jsx)(ji.a,{disabled:"read"===R,style:{flex:1,paddingVertical:10,justifyContent:"center",alignItems:"center"},underlayColor:"transparent",onPress:function(){"read"!==R&&i(vc(vc({},a),{},{absence_time:"morning"}))},children:Object(on.jsx)(x.a,{style:{width:"90%",fontSize:25,backgroundColor:"morning"===F?"#368cbf":"rgba(0,0,0,0.1)",color:"morning"===F?"white":"black",padding:15,textAlign:"center"},children:"\u65e9\u4e0a"})}),Object(on.jsx)(ji.a,{disabled:"read"===R,style:{flex:1,paddingVertical:10,justifyContent:"center",alignItems:"flex-end"},underlayColor:"transparent",onPress:function(){"read"!==R&&i(vc(vc({},a),{},{absence_time:"evening"}))},children:Object(on.jsx)(x.a,{style:{width:"90%",fontSize:25,backgroundColor:"evening"===F?"#368cbf":"rgba(0,0,0,0.1)",color:"evening"===F?"white":"black",padding:15,textAlign:"center"},children:"\u4e0b\u5348"})})]}),Object(on.jsx)(O.a,{style:{marginVertical:20,width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"center"},children:"edit"!==R?Object(on.jsx)(ji.a,{style:{width:"100%",padding:20,justifyContent:"center",backgroundColor:"rgba(0,0,0,0.1)"},onPress:function(){return A()},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"read"===R?"\u7de8\u8f2f":"create"===R?"\u65b0\u589e":null})}):"edit"===R?Object(on.jsxs)(O.a,{style:{width:"100%",flex:1,flexDirection:"row"},children:[Object(on.jsx)(ji.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"#fa625f"},onPress:function(){confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&T()},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"\u522a\u9664"})}),Object(on.jsx)(ji.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"rgba(0,0,0,0.1)"},onPress:function(){return i(vc(vc({},a),{},{access_mode:"read"}))},children:Object(on.jsx)(x.a,{style:{fontSize:20,textAlign:"center"},children:"\u53d6\u6d88\u7de8\u8f2f"})}),Object(on.jsx)(ji.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"#00c07f"},onPress:function(){return A()},children:Object(on.jsx)(x.a,{style:{fontSize:25,textAlign:"center"},children:"\u9001\u51fa"})})]}):null})]})]})})),Pc=(he.a.create({dateContainer:{flex:1,width:"35%",justifyContent:"center"}}),kc);function Tc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ec(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tc(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Zn.a.get("window").height;var Rc=Object(A.b)((function(e){return{isConnected:e.parent.isConnected}}),null)((function(e){var t=Object(D.f)(),n=Object(j.useRef)(),r=Object(j.useState)({todays_date:bn(new Date),SlideInRight:new Ni.a.Value(0),SlideInLeft:new Ni.a.Value(0),total_height:1,total_width:1,height:0,width:0,left:0,top:0,requests:[],day_of_week:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],selected_request_index:-1}),s=ue()(r,2),a=s[0],i=s[1];Object(j.useEffect)((function(){c()}),[]);var c=function(){var e,n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=t.state.student_id,n=bn(new Date),r="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/absence-excuse/student/"+e+"?date="+n,s.next=5,p.a.awrap(fetch(r,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message,r=e.data;t>200||"Internal server error"===n?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+n):(o(r),i(Ec(Ec({},a),{},{requests:r})))})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when fetching absence request")})));case 5:case"end":return s.stop()}}),null,null,null,Promise)},o=function(e){for(var t=0;t<e.length;t++)e[t].date=new Date(e[t].date)},l=function(e){"edit"!==n.current.fetchAccessMode()?i(Ec(Ec({},a),{},{selected_request_index:e})):alert("\u9084\u5728\u7de8\u8f2f\u4e2d\u5594\u8acb\u5b8c\u6210\u518d\u96e2\u958b \u591a\u8b1d")},d=a.SlideInRight,u=(a.SlideInLeft,a.total_width),f=a.requests,h=a.todays_date,b=a.day_of_week,y=a.selected_request_index,g=t.state,m=g.student_id,_=g.class_id,w=g.school_id,v=f[y];return console.log("requests: ",f),console.log("selected_request: ",v),console.log("selected_request_index: ",y),Object(on.jsx)(Hn.a,{style:{flex:1,width:"100%",alignItems:"center"},behavior:"padding",keyboardVerticalOffset:85,enabled:!0,children:Object(on.jsxs)(In.a,{style:{width:"100%"},children:[Object(on.jsx)(O.a,{style:{width:"100%"},children:Object(on.jsxs)(In.a,{horizontal:!0,showsHorizontalScrollIndicator:!1,children:[f.map((function(e,t){var n=b[e.date.getDay()],r=e.date.getMonth()+1+"/"+e.date.getDate();return Object(on.jsx)(Ni.a.View,{style:{padding:10,transform:[{translateX:d.interpolate({inputRange:[0,1],outputRange:[u,0]})}]},children:Object(on.jsx)(ji.a,{style:{height:100,width:100,padding:10,backgroundColor:y===t?"#368cbf":"rgba(0,0,0,0.2)",borderRadius:10},underlayColor:"#368cbf",onPress:function(){return l(t)},children:Object(on.jsxs)(O.a,{children:[bn(e.date)===h?Object(on.jsx)(x.a,{style:{fontSize:20,color:y===t?"white":"black"},children:"\u4eca\u5929"}):Object(on.jsxs)(x.a,{style:{fontSize:20,color:y===t?"white":"black"},children:["\u661f\u671f",n]}),Object(on.jsx)(x.a,{style:{fontSize:20,color:y===t?"white":"black"},children:r})]})})},e.id)})),Object(on.jsx)(Ni.a.View,{style:{padding:10,transform:[{translateX:d.interpolate({inputRange:[0,1],outputRange:[u,0]})}]},children:Object(on.jsx)(ji.a,{style:{height:100,width:100,padding:10,backgroundColor:-1===y?"#368cbf":"rgba(0,0,0,0.2)",borderRadius:10},underlayColor:"#ff8944",onPress:function(){return l(-1)},children:Object(on.jsx)(O.a,{children:Object(on.jsx)(x.a,{style:{fontSize:20,color:-1===y?"white":"black"},children:"\u65b0\u589e"})})})})]})}),Object(on.jsx)(O.a,{style:{width:"100%",borderRadius:40,backgroundColor:"#b5e9e9"},children:Object(on.jsx)(Pc,{ref:n,student_id:m,class_id:_,school_id:w,request:v,onCreateRequestSuccess:function(e){return function(e){var t,n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,p.a.awrap(c());case 2:t=a.requests,n=-1,r=0;case 5:if(!(r<t.length)){s.next=12;break}if(t[r].id!==e){s.next=9;break}return n=r,s.abrupt("break",12);case 9:r++,s.next=5;break;case 12:i(Ec(Ec({},a),{},{selected_request_index:n}));case 13:case"end":return s.stop()}}),null,null,null,Promise)}(e)},onDeleteRequestSuccess:function(e){return function(e){for(var t=a.requests,n=[],r=0;r<t.length;r++)t[r].id!==e&&n.push(t[r]);i(Ec(Ec({},a),{},{requests:n,selected_request_index:0}))}(e)},checkUniqueStudentDate:function(e,t){return function(e,t){for(var r=a.requests,s=!1,i=0;i<r.length;i++)if(e!==r[i].id&&bn(t)===bn(r[i].date)){s=!0;break}s&&(alert("\u5df2\u7d93\u5728\u9019\u500b\u65e5\u671f\u8acb\u904e\u5047\u4e86"),n.current.duplicateDateFound())}(e,t)}})})]})})}));function Ic(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ic(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ic(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Lc=Zn.a.get("window"),Bc=Lc.width,Mc=Lc.height,Fc=Object(A.b)((function(e){return{isConnected:e.parent.isConnected}}))((function(e){var t=Object(D.f)(),n=Object(D.g)(),r=Object(j.useState)({time:null,provided_times:["5","10","15","20","25"],colors:["#ffe1d0","#ffddb7","#fff1b5","#dcf3d0","#b5e9e9"],hightlighted_colors:["#fa625f","#ff8944","#f4d41f","#00c07f","#368cbf"],choose_other_option:!1,total_height:Mc-55,total_width:Bc}),s=ue()(r,2),a=s[0],i=s[1],c=a.time,o=a.provided_times,l=a.colors,d=a.hightlighted_colors,u=a.choose_other_option,f=a.total_height,h=a.total_width;return Object(on.jsx)(Hn.a,{style:{flex:1},behavior:"padding",keyboardVerticalOffset:100,enabled:!0,children:Object(on.jsxs)(In.a,{children:[Object(on.jsxs)(O.a,{style:{flex:3,flexDirection:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},children:[o.map((function(e,t){return Object(on.jsx)(O.a,{style:{width:"50%",height:.28*f,backgroundColor:c==e?d[t]:l[t],alignItems:"center",justifyContent:"center"},children:Object(on.jsx)(ji.a,{style:{width:"90%",height:"90%",borderWidth:c==e?5:0,borderColor:"white",backgroundColor:c==e?d[t]:l[t]},underlayColor:d[t],onPress:function(){return i(zc(zc({},a),{},{time:e,choose_other_option:!1}))},children:Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(x.a,{style:{fontSize:.2*h},children:e}),Object(on.jsx)(x.a,{style:{fontSize:.09*h},children:"\u5206\u9418"})]})})},t)})),Object(on.jsx)(O.a,{style:{width:"50%",height:.28*f,alignItems:"center",justifyContent:"center",backgroundColor:u?"black":"white"},children:Object(on.jsx)(ji.a,{style:{flexDirection:"row",width:"90%",height:"90%",backgroundColor:u?"black":"white",borderWidth:u?5:0,borderColor:"white",alignItems:"center",justifyContent:"center"},onPress:function(){return i(zc(zc({},a),{},{choose_other_option:!0,time:""}))},children:u?Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%"},children:[Object(on.jsx)(Vn.a,{autoFocus:!0,selectTextOnFocus:!0,onBlur:function(){return function(){var e=a.time,t=a.choose_other_option,n=a.provided_times;t&&(""===e||n.includes(e))&&i(zc(zc({},a),{},{choose_other_option:!1}))}()},keyboardType:"numeric",value:c+"",style:{fontSize:.2*h,color:"white",width:"100%"},onChangeText:function(e){i(zc(zc({},a),{},{time:e}))}}),Object(on.jsx)(x.a,{style:{fontSize:.09*h,color:"white"},children:"\u5206\u9418"})]}):Object(on.jsx)(x.a,{style:{fontSize:50},children:"\u5176\u4ed6"})})})]}),Object(on.jsx)(O.a,{style:{height:.16*f},children:Object(on.jsx)(ji.a,{style:{flex:1,backgroundColor:"lightgrey",alignItems:"center",justifyContent:"center"},onPress:function(){return function(){if(e.isConnected){var r=t.state,s=r.child_id,i=r.school_id,c="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/attendance/pickup-request",o=s,l=new Date;l.setMinutes(l.getMinutes()+parseInt(a.time));var d={school_id:i,student_id:o,arrival_time:bn(l)+" "+On(l)};fetch(c,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(d)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,r=e.message;t>200||"Internal server error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+r):n(-1)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending pickup request")}))}else alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}()},children:Object(on.jsx)(x.a,{style:{fontSize:50},children:"\u9001\u51fa"})})})]})})}));function Nc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nc(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Uc=Zn.a.get("window").width,Hc=Object(A.b)((function(e){return{isConnected:e.parent.isConnected}}))((function(e){var t=Object(D.f)(),r=Object(D.g)(),s=Object(j.useState)({isLoading:!0,request_id:null,today:new Date,datetime_type:"",time_array:[],time_selected_index:null,before_meal:null,powder:!1,powder_refrigerated:!1,syrup:[],gel:null,other_type:null,note:"",administered:!1,teacher_name:"",medicated_timestamp:null,fever_entry:{temperature:"",powder:!1,powder_refrigerated:!1,syrup:[],other_type:null},data:null,index:-1,access_mode:"create",scrollHeight:"100%",date_array:[],date_selected_index:null}),a=ue()(s,2),i=a[0],c=a[1],o=Object(j.useState)(!1),l=ue()(o,2),d=l[0],u=l[1];Object(j.useEffect)((function(){var e=t.state,n=e.index;null!==e.data?f(n):c(qc(qc({},i),{},{date_array:[new Date],isLoading:!1}))}),[]);var f=function(e){var n=t.state.data,r=n[e],s=r.id,a=r.timestamp,o=r.administered,l=r.fever_entry,d=r.medication,u=r.note,f=r.teacher_name,h=r.medicated_timestamp;c(qc(qc(qc({},i),{},{index:e,data:n,request_id:s,date_array:[a],time_array:[a]},d),{},{note:u,fever_entry:l,administered:o,teacher_name:f,medicated_timestamp:null!==h?new Date(h):null,access_mode:"read",isLoading:!1}))},h=function(e){var t=i.date_array,n=i.date_selected_index;if(null!==n){for(var r=[],s=0;s<t.length;s++)s!==n?r.push(t[s]):r.push(e);c(qc(qc({},i),{},{date_array:r,date_selected_index:null})),u(!1)}else c(qc(qc({},i),{},{date_array:[].concat(I()(t),[e])})),u(!1)},b=function(e){var t=i.time_array,n=i.time_selected_index;if(null!==n){for(var r=[],s=0;s<t.length;s++)s!==n?r.push(t[s]):r.push(e);c(qc(qc({},i),{},{time_array:r,time_selected_index:null})),u(!1)}else c(qc(qc({},i),{},{time_array:[].concat(I()(t),[e])})),u(!1)},y=function(){var e=t.state.class_id,n=i.request_id,r=i.date_array,s=i.time_array,a=i.before_meal,c=i.powder,o=i.powder_refrigerated,l=i.syrup,d=i.gel,u=i.other_type,f=i.note,h=i.fever_entry;return{request_id:n,class_id:e,date_array:r.map((function(e){return bn(e)})),time_array:s.map((function(e){return On(e)})),before_meal:a,powder:c,powder_refrigerated:o,syrup:l,gel:null===d?d:d.trim(),other_type:null===u?u:u.trim(),note:f.trim(),fever_entry:{temperature:h.temperature,powder:h.powder,powder_refrigerated:h.powder_refrigerated,syrup:h.syrup,other_type:null===h.other_type?h.other_type:h.other_type.trim()}}},g=function(){var e=i.date_array[0],t=new Date;t.setHours(10,0,0,0);var n=new Date;return n.setDate(n.getDate()+1),n.setHours(0,0,0,0),e.toDateString()===(new Date).toDateString()&&new Date<t||e.getTime()>n.getTime()},m=function(){var n=i.access_mode;if("create"===n||"edit"===n){if(0===i.time_array.length&&(alert("\u81f3\u5c11\u8981\u9078\u64c7\u4e00\u500b\u6642\u9593\uff01"),1))return;!function(){var n,s,a,o,l;p.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:if(e.isConnected){d.next=4;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),d.abrupt("return");case 4:return n=t.state.student_id,s=y(),d.next=8,p.a.awrap(wn("/medicationrequest/student/"+n,s));case 8:if(a=d.sent,o=a.success,a.statusCode,l=a.message,a.data,o){d.next=13;break}return alert("Sorry \u9001\u51fa\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l),d.abrupt("return");case 13:c(qc(qc({},i),{},{access_mode:"read"})),r(-1);case 15:case"end":return d.stop()}}),null,null,null,Promise)}()}else c(qc(qc({},i),{},{access_mode:"edit"}))},_=function(n){if(e.isConnected){var s=t.state.class_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/medicationrequest/"+n,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:s})}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message;e.data;t>200||"Internal Server Error"===n?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+n):r(-1)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))}else alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")},w=i.isLoading,v=i.time_array,S=i.datetime_type,C=i.time_selected_index,A=i.before_meal,k=i.powder,P=i.powder_refrigerated,T=i.syrup,E=i.gel,R=i.other_type,z=i.note,L=i.fever_entry,B=i.administered,M=i.teacher_name,F=i.medicated_timestamp,N=i.data,q=i.access_mode,U=i.scrollHeight,H=i.date_array;i.date_selected_index;return w?Object(on.jsx)(Fn,{}):Object(on.jsxs)(Hn.a,{style:{flex:1,width:"100%",alignItems:"center"},behavior:"padding",enabled:!0,children:[d?Object(on.jsx)(Cr,{start_date:null===C?new Date:v[C],datetime_type:S,hideModal:function(){return u(!1)},selectDatetimeConfirm:function(e){return function(e){"date"===i.datetime_type?h(e):b(e)}(e)},minDatetime:new Date,maxDatetime:(new Date).setDate((new Date).getDate()+7),minTime:(new Date).setHours(7,0,0),maxTime:(new Date).setHours(20,0,0),paddingVertical:100}):null,Object(on.jsxs)(In.a,{style:{width:"100%"},children:[null!==N&&N.length>1&&Object(on.jsx)(O.a,{style:{width:"100%"},children:Object(on.jsx)(In.a,{horizontal:!0,showsHorizontalScrollIndicator:!1,children:N.map((function(e,t){return Object(on.jsx)(O.a,{style:{padding:10},children:Object(on.jsx)(ji.a,{style:{padding:10,backgroundColor:i.index===t?"#ffddb7":"rgba(0,0,0,0.5)",justifyContent:"center",borderRadius:30},underlayColor:"#ffddb7",onPress:function(){return f(t)},children:Object(on.jsx)(x.a,{style:{fontSize:25,color:i.index===t?"grey":"white"},children:xn(e.timestamp)})},e.id)},t)}))})}),Object(on.jsxs)(O.a,{style:{backgroundColor:"white",borderTopRightRadius:30,borderTopLeftRadius:30},children:[B&&Object(on.jsx)(O.a,{style:{alignItems:"center"},children:Object(on.jsxs)(O.a,{style:{width:"100%",backgroundColor:"white",padding:20},children:[Object(on.jsxs)(x.a,{style:{fontSize:25},children:["\u9935\u85e5\u8001\u5e2b\uff1a",M]}),Object(on.jsxs)(x.a,{style:{fontSize:25},children:["\u9935\u85e5\u6642\u9593\uff1a",xn(F)]})]})}),Object(on.jsxs)(O.a,{style:{alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:"#ff8944",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u65e5\u671f "})}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",width:"100%",backgroundColor:"white",padding:20,alignItems:"flex-start"},children:[Object(on.jsxs)(O.a,{style:{flex:1,alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q||"edit"===q,style:{width:"80%",paddingBottom:15},underlayColor:"transparent",onPress:function(){"read"!==q&&"edit"!==q&&(c(qc(qc({},i),{},{datetime_type:"date"})),u(!0))},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{flex:1,paddingLeft:15},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u65e5\u671f"})}),"create"===q&&Object(on.jsx)(be.a,{source:n(478),style:{width:32,height:32,alignSelf:"flex-end"}})]})}),H.map((function(e,t){return Object(on.jsxs)(O.a,{style:{width:"90%",justifyContent:"center",flexDirection:"row",paddingBottom:10},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{width:"70%",backgroundColor:"#ffddb7",borderTopLeftRadius:15,borderBottomLeftRadius:15,justifyContent:"center"},underlayColor:"transparent",onPress:function(){"read"!==q&&(c(qc(qc({},i),{},{datetime_type:"date",date_selected_index:t})),u(!0))},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:gn(e)})}),Object(on.jsx)(ji.a,{disabled:"read"===q,style:{width:"30%",justifyContent:"center",padding:5,backgroundColor:"#ffddb7",borderBottomRightRadius:15,borderTopRightRadius:15},underlayColor:"transparent",onPress:function(){"read"!==q&&function(e){var t=i.date_array;t.splice(e,1),c(qc(qc({},i),{},{date_array:t}))}(t)},children:Object(on.jsx)(be.a,{source:n(236),style:{width:32,height:32}})})]},t)}))]}),Object(on.jsxs)(O.a,{style:{flex:1,alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q||"edit"===q,style:{width:"80%",paddingBottom:15},underlayColor:"transparent",onPress:function(){"read"!==q&&"edit"!==q&&(c(qc(qc({},i),{},{datetime_type:"time"})),u(!0))},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{flex:1,paddingLeft:15},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u6642\u9593"})}),"create"===q&&Object(on.jsx)(be.a,{source:n(478),style:{width:32,height:32,alignSelf:"flex-end"}})]})}),v.map((function(e,t){return Object(on.jsxs)(O.a,{style:{width:"90%",justifyContent:"center",flexDirection:"row",paddingBottom:10},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{width:"70%",backgroundColor:"#ffddb7",borderTopLeftRadius:15,borderBottomLeftRadius:15,justifyContent:"center"},underlayColor:"transparent",onPress:function(){"read"!==q&&(c(qc(qc({},i),{},{datetime_type:"time",time_selected_index:t})),u(!0))},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:xn(e)})}),Object(on.jsx)(ji.a,{disabled:"read"===q,style:{width:"30%",justifyContent:"center",padding:5,backgroundColor:"#ffddb7",borderBottomRightRadius:15,borderTopRightRadius:15},underlayColor:"transparent",onPress:function(){"read"!==q&&function(e){var t=i.time_array;t.splice(e,1),c(qc(qc({},i),{},{time_array:t}))}(t)},children:Object(on.jsx)(be.a,{source:n(236),style:{width:32,height:32}})})]},t)}))]})]}),Object(on.jsxs)(O.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center",paddingBottom:20},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{padding:15,borderWidth:1,borderColor:"grey",backgroundColor:null!==A&&A?"#ffddb7":"white"},underlayColor:"#ff8944",onPress:function(){"read"!==q&&c(qc(qc({},i),{},{before_meal:!A||null}))},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u9910\u524d"})}),Object(on.jsx)(ji.a,{disabled:"read"===q,style:{padding:15,borderWidth:1,borderLeftWidth:0,borderColor:"grey",backgroundColor:null===A||A?"white":"#ffddb7"},underlayColor:"#ff8944",onPress:function(){"read"!==q&&c(qc(qc({},i),{},{before_meal:!1===A&&null}))},children:Object(on.jsx)(x.a,{style:{fontSize:25},children:"\u9910\u5f8c"})})]})]}),Object(on.jsxs)(O.a,{style:{alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{width:"100%",justifyContent:"center",backgroundColor:"#00c07f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u85e5\u7269"})}),Object(on.jsxs)(O.a,{style:{width:"100%",backgroundColor:"white",paddingHorizontal:20},children:[Object(on.jsx)(O.a,{style:{backgroundColor:""},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingTop:20,paddingBottom:10},onPress:function(){"read"!==q&&c(qc(qc({},i),{},{powder:!k}))},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:k?"#00c07f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginLeft:10,alignSelf:"center"},children:"\u85e5\u7c89    "})]})}),Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingTop:20,paddingBottom:10},onPress:function(){"read"!==q&&c(qc(qc({},i),{},{powder_refrigerated:!P}))},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:P?"#00c07f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginHorizontal:5},children:"\u9700\u51b7\u85cf"})]})})]})}),Object(on.jsxs)(O.a,{style:{backgroundColor:""},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingVertical:10},onPress:function(){"read"!==q&&function(){var e=i.syrup;c(qc(qc({},i),{},{syrup:e.length?[]:[{amount:"",need_refrigerated:!1,note:""}]}))}()},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:T.length?"#00c07f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginLeft:10},children:"\u85e5\u6c34    "})]})}),T.length&&"read"!==q?Object(on.jsx)(ji.a,{style:{padding:10},onPress:function(){return c(qc(qc({},i),{},{syrup:[].concat(I()(T),[{amount:"",need_refrigerated:!1,note:""}])}))},underlayColor:"transparent",children:Object(on.jsx)(be.a,{source:n(913),style:{width:32,height:32}})}):null]}),T.map((function(e,t){return Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center",alignSelf:"center",marginBottom:20},children:[Object(on.jsx)(Vn.a,{editable:"read"!==q,style:{width:35,fontSize:25,textAlign:"center",marginHorizontal:10},keyboardType:"decimal-pad",autoFocus:!0,placeholder:"____",value:e.amount,onChangeText:function(e){return function(e,t){var n=i.syrup;n[t].amount=e,c(qc(qc({},i),{},{syrup:n}))}(e,t)}}),Object(on.jsx)(x.a,{style:{fontSize:20,marginRight:5},children:"c.c."}),Object(on.jsx)(ji.a,{disabled:"read"===q,style:{padding:5},onPress:function(){"read"!==q&&function(e,t){var n=i.syrup;n[t].need_refrigerated=e,c(qc(qc({},i),{},{syrup:n}))}(!e.need_refrigerated,t)},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:e.need_refrigerated?"#00c07f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginHorizontal:5},children:"\u9700\u51b7\u85cf"})]})}),Object(on.jsx)(Vn.a,{editable:"read"!==q,style:{fontSize:25,textAlign:"center",marginHorizontal:10,width:60},placeholder:"\u5099\u8a3b",value:e.note,onChangeText:function(e){return function(e,t){var n=i.syrup;n[t].note=e,c(qc(qc({},i),{},{syrup:n}))}(e,t)}}),"read"!==q&&Object(on.jsx)(ji.a,{style:{paddingHorizontal:10},onPress:function(){return function(e){var t=i.syrup;t.splice(e,1),c(qc(qc({},i),{},{syrup:t}))}(t)},underlayColor:"transparent",children:Object(on.jsx)(be.a,{source:n(236),style:{width:32,height:32}})})]},t)}))]}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingVertical:10},onPress:function(){"read"!==q&&c(qc(qc({},i),{},{gel:null===E?"":null}))},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===E?"white":"#00c07f"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginHorizontal:10},children:"\u85e5\u818f"})]})}),null===E?null:Object(on.jsx)(Vn.a,{editable:"read"!==q,style:{flex:1,fontSize:25},autoFocus:!0,placeholder:"\u90e8\u4f4d",value:E,onChangeText:function(e){return c(qc(qc({},i),{},{gel:e}))}})]})}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingVertical:10},onPress:function(){"read"!==q&&c(qc(qc({},i),{},{other_type:null===R?"":null}))},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===R?"white":"#00c07f"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginHorizontal:10},children:"\u5176\u4ed6"})]})}),null===R?null:Object(on.jsx)(Vn.a,{editable:"read"!==q,style:{flex:1,fontSize:22,paddingHorizontal:10,paddingTop:3,paddingBottom:5,paddingLeft:0},placeholder:"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...",autoFocus:!0,textAlignVertical:"top",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:R,onChangeText:function(e){return c(qc(qc({},i),{},{other_type:e}))}})]})})]})]}),Object(on.jsxs)(O.a,{style:{alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{width:"100%",justifyContent:"center",backgroundColor:"#f4d41f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u5099\u8a3b"})}),Object(on.jsx)(O.a,{style:{width:"100%",backgroundColor:"white",padding:20},children:Object(on.jsx)(Vn.a,{editable:"read"!==q,style:{height:U,padding:15,fontSize:25},placeholder:"\u9ede\u64ca\u586b\u5beb...",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:z,onChangeText:function(e){return c(qc(qc({},i),{},{note:e}))},onChange:function(e){return c(qc(qc({},i),{},{scrollHeight:e.target.scrollHeight}))},onLayout:function(e){var t=e.nativeEvent.target.scrollHeight;c(qc(qc({},i),{},{scrollHeight:t}))}})})]}),Object(on.jsxs)(O.a,{style:{alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{width:"100%",justifyContent:"center",backgroundColor:"#fa625f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30},children:Object(on.jsx)(x.a,{style:{fontSize:25,alignSelf:"center"},children:"\u767c\u71d2\u9935\u85e5"})}),Object(on.jsx)(O.a,{style:{width:"100%",backgroundColor:"white",padding:20},children:Object(on.jsxs)(O.a,{style:{paddingVertical:10},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(x.a,{style:{fontSize:.06*Uc,marginHorizontal:10},children:"\u767c\u71d2\u8d85\u904e"}),Object(on.jsx)(Vn.a,{editable:"read"!==q,style:{width:55,fontSize:25},keyboardType:"decimal-pad",value:L.temperature,onChangeText:function(e){return c(qc(qc({},i),{},{fever_entry:qc(qc({},L),{},{temperature:e})}))}}),Object(on.jsx)(x.a,{style:{fontSize:.06*Uc},children:"\xb0C \u4ee5\u4e0a\u624d\u7528\u85e5"})]}),Object(on.jsx)(O.a,{style:{backgroundColor:""},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingTop:20,paddingBottom:10},onPress:function(){"read"!==q&&c(qc(qc({},i),{},{fever_entry:qc(qc({},L),{},{powder:!L.powder})}))},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:L.powder?"#fa625f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginLeft:10},children:"\u85e5\u7c89    "})]})}),Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingTop:20,paddingBottom:10},onPress:function(){"read"!==q&&c(qc(qc({},i),{},{fever_entry:qc(qc({},L),{},{powder_refrigerated:!L.powder_refrigerated})}))},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:L.powder_refrigerated?"#fa625f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginHorizontal:5},children:"\u9700\u51b7\u85cf"})]})})]})}),Object(on.jsxs)(O.a,{style:{backgroundColor:""},children:[Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingVertical:10},onPress:function(){"read"!==q&&function(){var e=i.fever_entry;c(qc(qc({},i),{},{fever_entry:qc(qc({},e),{},{syrup:e.syrup.length?[]:[{amount:"",need_refrigerated:!1}]})}))}()},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:L.syrup.length?"#fa625f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginLeft:10},children:"\u85e5\u6c34    "})]})}),L.syrup.length&&"read"!==q?Object(on.jsx)(ji.a,{style:{padding:10},onPress:function(){return c(qc(qc({},i),{},{fever_entry:qc(qc({},L),{},{syrup:[].concat(I()(L.syrup),[{amount:"",need_refrigerated:!1}])})}))},underlayColor:"transparent",children:Object(on.jsx)(be.a,{source:n(914),style:{width:32,height:32}})}):null]}),L.syrup.map((function(e,t){return Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center",alignSelf:"center",marginBottom:20},children:[Object(on.jsx)(Vn.a,{editable:"read"!==q,style:{width:62,fontSize:25},keyboardType:"decimal-pad",autoFocus:!0,placeholder:"____",value:e.amount,onChangeText:function(e){return function(e,t){var n=i.fever_entry;n.syrup[t].amount=e,c(qc(qc({},i),{},{fever_entry:n}))}(e,t)}}),Object(on.jsx)(x.a,{style:{fontSize:25,marginRight:5},children:"c.c."}),Object(on.jsx)(ji.a,{disabled:"read"===q,style:{padding:5},onPress:function(){"read"!==q&&function(e,t){var n=i.fever_entry;n.syrup[t].need_refrigerated=e,c(qc(qc({},i),{},{fever_entry:n}))}(!e.need_refrigerated,t)},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:e.need_refrigerated?"#fa625f":"white"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginHorizontal:5},children:"\u9700\u51b7\u85cf"})]})}),"read"!==q&&Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingHorizontal:10},onPress:function(){"read"!==q&&function(e){var t=i.fever_entry;t.syrup.splice(e,1),c(qc(qc({},i),{},{fever_entry:t}))}(t)},underlayColor:"transparent",children:Object(on.jsx)(be.a,{source:n(236),style:{width:32,height:32}})})]},t)}))]}),Object(on.jsx)(O.a,{style:{},children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",alignItems:"center"},children:[Object(on.jsx)(ji.a,{disabled:"read"===q,style:{paddingVertical:10},onPress:function(){"read"!==q&&c(qc(qc({},i),{},{fever_entry:qc(qc({},L),{},{other_type:null===L.other_type?"":null})}))},underlayColor:"transparent",children:Object(on.jsxs)(O.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(O.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"},children:Object(on.jsx)(O.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===L.other_type?"white":"#fa625f"}})}),Object(on.jsx)(x.a,{style:{fontSize:25,marginHorizontal:10},children:"\u5176\u4ed6"})]})}),null===L.other_type?null:Object(on.jsx)(Vn.a,{editable:"read"!==q,style:{flex:1,fontSize:22,paddingHorizontal:10,paddingTop:3,paddingBottom:5,paddingLeft:0},placeholder:"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...",autoFocus:!0,textAlignVertical:"top",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:L.other_type,onChangeText:function(e){return c(qc(qc({},i),{},{fever_entry:qc(qc({},L),{},{other_type:e})}))}})]})})]})})]})]})]}),Object(on.jsx)(O.a,{style:{height:90,width:"100%",paddingHorizontal:20},children:"read"===q?Object(on.jsx)(ji.a,{disabled:!g(),style:{width:"100%",height:"70%",backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onPress:function(){g()&&m()},underlayColor:"transparent",children:Object(on.jsx)(x.a,{style:{fontSize:40,textAlign:"center",color:"white"},children:"\u7de8\u8f2f"})}):"edit"===q?Object(on.jsxs)(O.a,{style:{width:"100%",height:"70%",flexDirection:"row"},children:[Object(on.jsx)(ji.a,{style:{flex:1,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return function(){var e=i.request_id;confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&_(e)}()},underlayColor:"transparent",children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:"\u522a\u9664"})}),Object(on.jsx)(ji.a,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onPress:function(){return function(){var e=i.index;f(e)}()},underlayColor:"transparent",children:Object(on.jsx)(x.a,{style:{fontSize:.06*Uc,textAlign:"center",color:"white"},children:"\u53d6\u6d88\u7de8\u8f2f"})}),Object(on.jsx)(ji.a,{style:{flex:1,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return m()},underlayColor:"transparent",children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center"},children:"\u9001\u51fa"})})]}):Object(on.jsx)(ji.a,{style:{width:"100%",height:"70%",backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onPress:function(){return m()},underlayColor:"transparent",children:Object(on.jsx)(x.a,{style:{fontSize:30,textAlign:"center",color:"white"},children:"\u9001\u51fa"})})})]})}));n(1258);function Vc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}!function(e){o()(n,e);var t=Vc(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={index:-1,data:[]},r}i()(n,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.index,n=e.data;this.setState({index:t,data:n}),this.markRead(n[t].id)}},{key:"markRead",value:function(e){var t,n,r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=this.props.route.params.parent_id,n=bn(new Date)+" "+On(new Date),s.next=4,p.a.awrap(vn("/announcement/"+e+"/read",{parent_id:t,timestamp:n}));case 4:r=s.sent,r.success,r.statusCode,r.message,r.data;case 6:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"componentWillUnmount",value:function(){(0,this.props.route.params.onGoBack)()}},{key:"render",value:function(){var e=this,t=this.state,n=t.index,r=t.data;if(n<0)return Object(on.jsx)(Fn,{});var s=r[n];return Object(on.jsxs)(fe.Card,{style:{flex:1},children:[Object(on.jsxs)(O.a,{style:{padding:20,alignItems:"center"},children:[Object(on.jsx)(x.a,{style:{fontSize:25},children:s.title}),Object(on.jsx)(x.a,{children:yn(new Date(s.timestamp))})]}),Object(on.jsxs)(O.a,{style:{flex:1,padding:20},children:[Object(on.jsx)(x.a,{children:s.text}),Object(on.jsx)(O.a,{style:{paddingTop:50,alignItems:"flex-start"},children:s.links.map((function(e,t){return Object(on.jsx)(ji.a,{style:{padding:8,backgroundColor:"lightblue"},onClick:function(){return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.awrap(ws.a(e.url));case 2:t.sent;case 3:case"end":return t.stop()}}),null,null,null,Promise)},children:Object(on.jsx)(x.a,{children:e.text})},t)}))}),Object(on.jsx)(O.a,{style:{flexDirection:"row",paddingTop:50,flexWrap:"wrap"},children:s.photo_url_arr.map((function(t,n){return Object(on.jsx)(je.a,{onPress:function(){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(ws.a(t));case 2:n=r.sent,e.setState({result:n});case 4:case"end":return r.stop()}}),null,null,null,Promise)},children:Object(on.jsx)(be.a,{source:{uri:t},style:{width:150,height:150,marginRight:10,marginTop:10}})},n)}))})]})]})}}])}(b.a.Component);function Wc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Wc(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Gc={key:"root",storage:Ma.a,transforms:[]},Qc=Object(La.b)(Gc,pi),Jc=Object(k.c)(Qc),Xc=Object(La.c)(Jc),Yc=function(e){return Object(on.jsxs)("div",{children:[Object(on.jsx)(Xr,{title:e.title,headerRight:e.headerRight}),Object(on.jsx)("main",{className:"main",children:Object(on.jsx)(D.a,{})})]})},Zc=function(e){return Object(on.jsx)(A.a,{store:Jc,children:Object(on.jsx)(Fa.a,{loading:null,persistor:Xc,children:Object(on.jsx)(C.a,{basename:"/gina_web_app",children:Object(on.jsxs)(D.d,{children:[Object(on.jsx)(D.b,{path:"/",element:Object(on.jsx)(Yc,{title:"\u5c0f\u5df4\u6d1b\u53ef\u806f\u7d61\u7c3f",headerRight:Object(on.jsx)(je.a,{style:{padding:10,margin:10,backgroundColor:"#b5e9e9"},onPress:function(){return e.handleSignOut()},children:Object(on.jsx)(x.a,{children:"\u767b\u51fa"})})}),children:Object(on.jsx)(D.b,{exact:!0,path:"/",element:Object(on.jsx)(dc,Kc({},e))})}),Object(on.jsx)(D.b,{path:"/pickup",element:Object(on.jsx)(Fc,{})}),Object(on.jsx)(D.b,{path:"/med-request",element:Object(on.jsx)(_c,{})}),Object(on.jsx)(D.b,{path:"/absence-request",element:Object(on.jsx)(Rc,{})}),Object(on.jsx)(D.b,{path:"/add-med-request",element:Object(on.jsx)(Hc,{})})]})})})})};function $c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}var eo=function(e){o()(n,e);var t=$c(n);function n(e){var r;return s()(this,n),(r=t.call(this,e)).state={code:""},r.confirmCode=r.confirmCode.bind(g()(r)),r}return i()(n,[{key:"confirmCode",value:function(){var e=this;w.a.confirmSignUp(this.props.username,this.state.code).then((function(t){console.log("data: ",t),e.props.getCurrentUser()})).catch((function(e){pe.a.alert("Error!",e.message,[{text:"OK",onPress:function(){return console.log("err occured when setting up account for parent(s): ",e)}}])}))}},{key:"render",value:function(){var e=this;return console.log("this.state.code: ",this.state.code),Object(on.jsx)(fe.Container,{children:Object(on.jsxs)(fe.Content,{keyboardShouldPersistTaps:"always",children:[Object(on.jsxs)(O.a,{style:{paddingTop:"20%",flexDirection:"row",justifyContent:"space-around",paddingBottom:"15%"},children:[Object(on.jsx)(Vn.a,{style:{position:"absolute",color:"transparent"},autoFocus:!0,maxLength:6,caretHidden:!0,keyboardType:"numeric",onChangeText:function(t){e.setState({code:t})}}),Array(6).fill(0).map((function(t,n){return Object(on.jsx)(fe.Card,{style:{width:50,height:50,backgroundColor:"white",borderColor:"black",justifyContent:"center"},children:e.state.code.length>n?Object(on.jsx)(x.a,{style:{fontSize:30,alignSelf:"center"},children:e.state.code.charAt(n)}):Object(on.jsx)(x.a,{})},n)}))]}),Object(on.jsx)(fe.Button,{rounded:!0,success:!0,style:{alignSelf:"center"},onPress:this.confirmCode,children:Object(on.jsx)(x.a,{style:{paddingHorizontal:5,color:"white"},children:"Confirm code"})})]})})}}]),n}(b.a.Component),to=(he.a.create({input:{borderColor:"black",borderWidth:1}}),eo);function no(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}n(242).a.ignoreWarnings(["Non-serializable values were found in the navigation state"]);var ro=function(e){o()(r,e);var t=no(r);function r(e){var n;return s()(this,r),(n=t.call(this,e)).state={status:"",id:"",username:""},n.getCurrentUser=n.getCurrentUser.bind(g()(n)),n}return i()(r,[{key:"componentDidMount",value:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.awrap(_.b({Roboto:n(923),Roboto_medium:n(924)}));case 2:this.getCurrentUser();case 3:case"end":return e.stop()}}),null,this,null,Promise)}},{key:"getCurrentUser",value:function(){var e=this;this.setState({status:"loading"}),w.a.currentAuthenticatedUser().then((function(t){console.log(t.username),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+hn+"/user?username="+t.username,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(n){var r=n.statusCode,s=(n.message,n.data);200===r?e.setState({status:s.role,id:s.id,username:t.username}):e.setState({status:"signedout"})})).catch((function(t){console.log("err: ",t),e.setState({status:"signedout"})}))})).catch((function(t){"not authenticated"==t&&e.setState({status:"signedout"}),e.setState({status:"signedout"})}))}},{key:"changeAuthState",value:function(e,t){this.setState({status:e,username:t})}},{key:"handleSignOut",value:function(){var e=this;w.a.signOut().then((function(){e.getCurrentUser()})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this;console.log("ENV: ",hn);var t=this.state,n=t.status,r=t.username;return console.log("status: ",n),Object(on.jsx)(O.a,{style:{flex:1},children:n.includes("parent")?Object(on.jsx)(Zc,{parent_id:this.state.id,handleSignOut:function(){return e.handleSignOut()}}):"school"===n?Object(on.jsx)(ei,{school_id:this.state.id,school_name:r,handleSignOut:function(){return e.handleSignOut()}}):"ConfirmSignUpPage"===n?Object(on.jsx)(to,{getCurrentUser:this.getCurrentUser,username:this.state.username}):"signedout"===n||"school"===n?Object(on.jsx)(si,{loadAuth:this.getCurrentUser,changeAuthState:function(t,n){return e.changeAuthState(t,n)}}):Object(on.jsxs)(O.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:[Object(on.jsx)(x.a,{children:"Loading..."}),Object(on.jsx)(m.a,{size:"large"})]})})}}]),r}(b.a.Component),so=n(555),ao={identityPooId:"us-east-1:0a3c861f-48ca-4832-af57-28b4209e695e",region:"us-east-1",userPoolId:"us-east-1_QlbPkQ8Ds",userPoolWebClientId:"6maqsbp3gi2vj0tid4akmoiat6"},io=n(1271);function co(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f()(e);if(t){var s=f()(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return d()(this,n)}}so.a.configure(ao);var oo=function(e){o()(r,e);var t=co(r);function r(e){var a;return s()(this,r),(a=t.call(this,e))._cacheSplashResourcesAsync=function(){var e;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n(1249),t.abrupt("return",io.a.fromModule(e).downloadAsync());case 2:case"end":return t.stop()}}),null,null,null,Promise)},a._cacheResourcesAsync=function(){var e,t;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=[n(476)],t=e.map((function(e){return io.a.fromModule(e).downloadAsync()})),r.next=4,p.a.awrap(Promise.all(t));case 4:a.setState({isAppReady:!0});case 5:case"end":return r.stop()}}),null,null,null,Promise)},a.state={isSplashReady:!1,isAppReady:!1},a}return i()(r,[{key:"render",value:function(){return Object(on.jsx)(ro,{})}}]),r}(b.a.Component);x.a.defaultProps=x.a.defaultProps||{},x.a.defaultProps.allowFontScaling=!1,Vn.a.defaultProps=Vn.a.defaultProps||{},Vn.a.defaultProps.allowFontScaling=!1},566:function(e,t,n){e.exports=n(1253)},733:function(e,t,n){e.exports=n.p+"static/media/icon-checked-box.aa9eb83a.png"},734:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsSAAALEgHS3X78AAACN0lEQVR42u3dv28ScRzG8efbKkPLdcPE6OKPja2QuiqjCxCjf4FJdz0lcbrN0KK7iX/BxdTDoaOG0VK6uVWHpumikx4O1vBxqDFRcgmed9TA+zWXkjzv+wHLIQEAAAAAAGBeuCz+STkIC0teqenM6pJblXRR0vKMbTWUdCjZnpmir8NP0bvgzrdTD3DtyetbZgsbkl2es4P3vcke9v3a1qkEuB2GiwcHpbZJ9+f5EmKmTn/YaykIRmlev5D2jRn/5xHs5K8Vrz+e6hlwctlxL7iF/qa549+Icj8DykFYMHNt9h7ztByEhdwDLHmlpqQr7D3m0rJ3rp7/PcDUYOvEO3L+AZxUYelE1Wl8CjrPzoku/O0LzqR4k+Ikf7R9d3Wmlr35fC+zbTL5HoBsEIAABAABCAACEAAEIAAIQAAQgAAgAAFAAAKAAAQAAQgAAhAABCAACEAAEIAAIAABQAACgAAEAAEIAAIQAAQgAAhAABCAACAAAUAAAoAA/7c0z4yLNcGz0SZ8xtqMcZ+ncAa4I47bhGVkR1MIMBowdQLTbu4BzBSxdOIp0M09wGhl5aWkfdYeW/9DHH98lXuAwXr12GQtBv9jfhvdS/OTJqk+hvb92paZOsz+69LTfvug1k3z0tTfA/rDXkuyTdZ3Gztfeo/St/tHa503DUmbkq7O2fL7zsxPe+RnFkCSKs92zy7GcUNmdSdV7ORnrIozNnjspEOTBk6Kvnted7BePeYKAAAAAAAAgEn9AI63ihVnDPNHAAAAAElFTkSuQmCC"},77:function(e,t,n){e.exports=n.p+"static/media/icon-thumbnail.f43c1b7d.png"},794:function(e,t,n){e.exports=n.p+"static/media/icon-medication-powder.faee4a4a.png"},795:function(e,t,n){e.exports=n.p+"static/media/icon-medication-syrup.a136c9bb.png"},796:function(e,t,n){e.exports=n.p+"static/media/icon-medication-gel.6faabb6e.png"},797:function(e,t,n){e.exports=n.p+"static/media/icon-medication-pill.30288641.png"},798:function(e,t,n){e.exports=n.p+"static/media/icon-snowflake.2a93c038.png"},902:function(e,t,n){e.exports=n.p+"static/media/icon-wellness.250aefe7.png"},903:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAC2UlEQVRo3u2Xv24TQRDGv9mzHdt3tmMHCiQiJNqYylBAwRMgurwBSoNooKG0y4gyosk78BRI0IQulihxEiRiXETIh2WMdygSoZx3cv98ZA/J293c7ml++30zuwesxmosNSjpAv5wu+LXnZ8A4LUHBADjwzssPbs/5lV6dDIRv9PfKvnwX4L5udcebKYFKCRdMHF5I/bcKloAvhrJH3SKPo/eAXiyrAIq6QJN1Iw9V6Elxcfl0dsskk8FwFTYWGauf7j5gIBnWdWASr6EW8vMZaJXaWovMwBFaKWdO+zf9AB6mmUXSmEhuhF7LoIFX9WVh2BUrAKA0Uzw+aBaSnWyPgeSA1D8NsoLNcDMd60DUAIFFII1QMAt6wBMSKCAUfAV+xYCxW+jREFY5qJ9AI5fA8Y5QJhkDVBILgCa4IsrwcWl7e8VYeEZRg2QzzlQoBeflXcXQt+sW8hrH+0C/Dra/tx1t456C4fgcQ6K+ByCmXpXi0S9xeQv2tIgFwAAULv3pSspQcTd83diD+5b/yML5LO9XZrVqtPLsWJhrUT7+zNx/kGn6JdHYwCloKIDunYFAAD1umfEnLF35W7d/zQD8DkXFgKAidauEZuRG97E+GNuABznt7HbDlQt1LOK3ucGgDTcOLEgoJMpQGEpAOV4rHnxthoKUH7zeDhTwTX8or5Ge3vT61dgrj0TSnnhW1ZoGLGzs4YVC82FZOeaQwGm9MtIduo4dgCI2RUUCLWQmikjWaXmdgBAwm5HKEBKN8zTW9lSQOhCFA6gQUaymsgOgIZpFykWBDSTpTlbUgDmbke1UWghWVsKgAW7RFiIhWQZWLcDIHccN6Ju1gUl7SjAggIMeBGVLyVrqwZIqgEv4gekIZwnlmoA5kEGCrcQC3Zha0Us28WL0C1PFkoDgPwAsNxx3P8GIJ2FUM+ThU6F8GnEmu9CeGjrKrFDwMml0DER7WS9ZjVW4x+OPysh2phhVbaOAAAAAElFTkSuQmCC"},904:function(e,t,n){e.exports=n.p+"static/media/icon-milk.c4e5b66a.png"},905:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0UlEQVRo3u2YwQnCQBBF/wQL0GMwdmAFWoJ9iAUJbprJSTvwpBcFIVc7GC8iRBNBRbIJ753CJId5mRmYXQkAIBp8o50HuQdtu5JbUvnKNLs/zaP7uw25JV3vGgQQ+JFB49QHORVoswK2kjVV5fndv+PvOoIhRgABBBBAAAEEWOZqOBXlwmS55ONH8JBKks5FWV2s/hu/uGupY/pZBUwKleTbIzNT/k0LZRF1yoQhjhVrOvVc93ElOpzWnxZpIQQQ6OsqMVq/3s20CfdCCAAA9JIb9gROYBxbOFYAAAAASUVORK5CYII="},906:function(e,t,n){e.exports=n.p+"static/media/icon-diaper.5b00e1fa.png"},907:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABvklEQVRo3u2ZO0sDQRSFv1lFfGBg7SysLC20T62CIFb+D8EmhWUsxf+hpYUEtRBMZyCFQewCihZGQuIjMdmZa2MKQx6smSVZMqe9LHPPnHP37OyAg4NDrKHCPiCZnSW0OUaxAczbbki+azSKBUz5FXTwLnClIZVI8zAwAcnsLGFMHliIYjflu0Y9f40EzfZSWQmrs4c8the8UCtocxxV8wCNYqFT8wC+eBx1KnghDbcRpZ9N+bWHPGwOTiACz//pUQe9ygkbBEYOjsCwMTlKzcylw+eSFQJB4SzcoivbzkJWFbC5o3GagReEHErlEJPDm7qNm4WmUfggPuBDc2FoCvQb4i4W84EkkEQpkP99HY/KEGdR3vpYDvGoKJBEzIXLAZfELomjVkCbZZTaA7LxPA9MejMIv8kZRwsJd63ItJDEbohdErszMbwAN6Au0frSKTAELAK7ILtMeP86D3Qk8HnQ4V0JfGXPBup2Nrnthng8CCh4j2KxPn+fK9YICFxFQcBUSr3KGWsENKSAsm0CzeJ9txuYNyTYt0YgkeZBCasoToGqNQVqH9Tz1+jSc8tOVeAECdbU1vkTDg4O44cfoDWTjXIjQSwAAAAASUVORK5CYII="},908:function(e,t,n){e.exports=n.p+"static/media/icon-babies.313b1ac6.png"},909:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAACTklEQVRo3u2Zz2sTQRzFPzO7KbSaUkOjUAwIFQsipDnlD6hEqQd/FEoPFSke9FSkXuJJ8NZDTHuu1EtCxYL2YH9Y2j/AWw+5LNaTEay/ohUvNrvroWlcY6KB3U1SMu+0OzM7M2/ee18WBhSaC+HHpKmFpYhmmWlskSg1bWBr9+5cv2y0PIHUwlJEM60tIFTR9UViRyfHR/Jerie9JqBZZhoICVi2zOJJiR0BVoGQhXjo9XqeEziwjcC+PXVj9N3k+Eje1OStUu8Fr5fT6xmUGJuIIGXaQiQEBA/aLw0P1/zm/cdPUSAPsLPzIdbX2wvQPZN5ZleOXV5Z+c0fvoPY1KWZXMvMG64zkBibiNhSq+bpfxLYK+79LBS+XisKoYV7ehYDut5Ra6yTgAMFYZnR9SeP37pTQMp0tc3/DwE90HE8HH7hwh3HbKmngFFXBEq2AWDmfpKzZ/rLfbPZ5574eD07V37OGdtMPZim3szIOjxW9rxz8wBHuzpdbz5YMce5gdPOitDtaxUaisdckQh2dTIUj/lfhWrhVN8Jbl692NRfCckhhyLQbOheTfTjfPyP9yMbr/4as2W8qfrt4EC/UqAhcHPSvhCotE2tvmp2OpQKqAyoDFTA6e16yqjKgMpAnXZqZAbaW4Fanm5kdWpvBfzwtFJAZUBlQCmgMqAy0FYKKAItT2D/zmofOWPb9w3ljNfO128ehFhsgn0FcN6cNAaCl64V0KWZBApNcMdnHe66JrCWmTeEZUZBLILYbcCx7yJ4qgsGV7OP8ii0OH4Bz96jqU9mE24AAAAASUVORK5CYII="},910:function(e,t,n){e.exports=n.p+"static/media/icon-morningreminder.49ff255d.png"},911:function(e,t,n){e.exports=n.p+"static/media/icon-announcement.cf2640d0.png"},912:function(e,t,n){e.exports=n.p+"static/media/icon-attendance.0eadec86.png"},913:function(e,t,n){e.exports=n.p+"static/media/icon-plus-green.800f9d00.png"},914:function(e,t,n){e.exports=n.p+"static/media/icon-plus-red.d8af4a19.png"},918:function(e,t){},922:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAACBklEQVRoge2Yyy4EQRSGvyEZKxazE3GJEFsmsRMLtzXhgWx4AIvBM7jMA1jyEojLIFbuFkRGWFThzJjqS1XXTEJ9SSWnp8+p8/9d09NdA4FAIPBXGQEugHNg2FeTNl8TA4tAL9APLPlq4tNAXsQdvpr4NNAUgoFWEwy0mmCg1fwLAwPAJnAJVIGPBuMFWEnRd1XXNJqrqnttoJ7iTswBT4ZG9eO5rnZZnFsWn+d0bpI5H4GZKIFRKzAAbAOdkRYVr8Bagjy0sDVdE0cXsAP0JZy7hk1+rsQpMEXt+00cphWIIw9MA2eifj1F/TeXYoIpi3pbA19Mi/qKKSnqK9Qt4gMLAa7si7jHlBRloF3Eb85y0iN7tpuS/sVzII5B4Bg4AYoJ8os6t0IGW80sDMwDQygje0SbKOqcQdRP44Jr8ywM7AJ3Oi6gBI41yBvT5wr6+A7YyqC/EflEjKMI3Ir8W6AsjssNzif5uqXR4Fw8Ctzw+3WgftwD4540OBfHmUgj3laDc7HJRFrxLhqci+tN2Ih31eBWjLpJj4BDkt2wVhpyMcVJ8nwSq+FPv0q8izjNPiArZM93U1KUgWsRTzjLSc+kiK9sJtjg5wY6Q+1Nm7ESeWCW2h1ZyWaiftSmOsnm2+d4wHJPDOqqt9LEA2pr6UQfagkrmP8XynJUda8SDlc+EAgEmsMnirAThvyxHLsAAAAASUVORK5CYII="}},[[566,1,2]]]);
//# sourceMappingURL=app.a8d60136.chunk.js.map