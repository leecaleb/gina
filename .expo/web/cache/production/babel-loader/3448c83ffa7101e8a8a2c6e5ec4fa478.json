{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Image from\"react-native-web/dist/exports/Image\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import Alert from\"react-native-web/dist/exports/Alert\";import{Card}from'native-base';import{connect}from'react-redux';import{bindActionCreators}from'redux';import{initializeRequests}from\"../../redux/school/actions/index\";import{formatHourMinute}from\"../util\";var MedicationReqeustCard=function(_React$Component){_inherits(MedicationReqeustCard,_React$Component);var _super=_createSuper(MedicationReqeustCard);function MedicationReqeustCard(props){var _this;_classCallCheck(this,MedicationReqeustCard);_this=_super.call(this,props);_this.state={timerId:null};return _this;}_createClass(MedicationReqeustCard,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchData();}},{key:\"fetchData\",value:function fetchData(){var _this2=this;var d=new Date();var date=d.getFullYear()+'-'+(d.getMonth()+1)+'-'+d.getDate();fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/medicationrequest?date='+date+'&class_id='+this.props.class_id,{method:'GET',headers:{Accept:'application/json','Content-Type':'application/json'}}).then(function(res){return res.json();}).then(function(resJson){var statusCode=resJson.statusCode,message=resJson.message,data=resJson.data;var requests=data.requests,finished=data.finished,unfinished=data.unfinished;if(statusCode>200||message==='Internal server error'){alert('托藥單取不完整，請和工程師聯繫'+message);return;}_this2.props.initializeRequests(requests,finished,unfinished);}).catch(function(err){alert('Error, please try again 托藥單取不完整，請和工程師聯繫：'+err.message);});}},{key:\"render\",value:function render(){var _this3=this;var students=this.props.students;var _this$props$medicatio=this.props.medication_requests,requests=_this$props$medicatio.requests,unfinished=_this$props$medicatio.unfinished;return React.createElement(Card,{style:{flex:1,width:'90%'}},React.createElement(View,{style:{height:80,justifyContent:'center',marginTop:5}},React.createElement(Text,{style:{fontSize:30,alignSelf:'center',position:'absolute'}},\"\\u6258\\u85E5\\u55AE\"),React.createElement(TouchableHighlight,{style:{width:'25%',alignSelf:'flex-end',position:'absolute',padding:5,backgroundColor:'#b5e9e9'},onPress:function onPress(){_this3.props.navigation.push('TeacherMedicineLog',{request_id:null});}},React.createElement(Text,{style:styles.button_text},\"\\u67E5\\u770B\"))),React.createElement(View,{style:{}},React.createElement(ScrollView,{horizontal:true},unfinished.map(function(request_id){var _requests$request_id=requests[request_id],student_id=_requests$request_id.student_id,timestamp=_requests$request_id.timestamp,medication=_requests$request_id.medication,note=_requests$request_id.note,administered=_requests$request_id.administered,teacher_id=_requests$request_id.teacher_id;var time=formatHourMinute(new Date(timestamp));return React.createElement(TouchableHighlight,{key:request_id,style:{flex:1,margin:3},onPress:function onPress(){_this3.props.navigation.push('TeacherMedicineLog',{request_id:request_id});}},React.createElement(Card,{style:{flex:1,alignItems:'center',paddingHorizontal:15}},React.createElement(View,{style:{justifyContent:'center'}},React.createElement(Text,{style:{fontSize:35}},time)),React.createElement(View,{style:{justifyContent:'center'}},React.createElement(Image,{source:students[student_id].profile_picture===''?require(\"../../assets/icon-thumbnail.png\"):{uri:students[student_id].profile_picture},style:styles.thumbnailImage})),React.createElement(View,{style:{justifyContent:'center'}},React.createElement(Text,{style:{fontSize:25}},students[student_id].name))));}))));}}]);return MedicationReqeustCard;}(React.Component);var styles=StyleSheet.create({card:{width:'90%',flex:1},button:{width:'30%',backgroundColor:\"#b5e9e9\"},button_text:{width:'100%',textAlign:'center',color:'gray',fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}});var mapDispatchToProps=function mapDispatchToProps(dispatch){return _objectSpread({},bindActionCreators({initializeRequests:initializeRequests},dispatch));};export default connect(null,mapDispatchToProps,null,{forwardRef:true})(MedicationReqeustCard);","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/teacher/medicationrequestcard.js"],"names":["React","Card","connect","bindActionCreators","initializeRequests","formatHourMinute","MedicationReqeustCard","props","state","timerId","fetchData","d","Date","date","getFullYear","getMonth","getDate","fetch","class_id","method","headers","Accept","then","res","json","resJson","statusCode","message","data","requests","finished","unfinished","alert","catch","err","students","medication_requests","flex","width","height","justifyContent","marginTop","fontSize","alignSelf","position","padding","backgroundColor","navigation","push","request_id","styles","button_text","map","student_id","timestamp","medication","note","administered","teacher_id","time","margin","alignItems","paddingHorizontal","profile_picture","require","uri","thumbnailImage","name","Component","StyleSheet","create","card","button","textAlign","color","borderRadius","mapDispatchToProps","dispatch","forwardRef"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { View, Text, StyleSheet, Image, TouchableHighlight, ScrollView, Alert } from 'react-native'\nimport { Card } from 'native-base'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport { initializeRequests } from '../../redux/school/actions/index'\nimport { formatHourMinute } from '../util'\n\nclass MedicationReqeustCard extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            timerId: null\n        }\n    }\n\n    componentDidMount() {\n        this.fetchData()\n    }\n\n    fetchData() {\n        const d = new Date()\n        const date = d.getFullYear() + '-' + (d.getMonth() + 1) + '-' + d.getDate()\n        fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/medicationrequest?date=' + date + '&class_id=' + this.props.class_id, {\n            method: 'GET',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            }\n        })\n            .then(res => res.json())\n            .then(resJson => {\n                const { statusCode, message, data } = resJson\n                const { requests, finished, unfinished } = data\n                if (statusCode > 200 || message === 'Internal server error') {\n                    alert('托藥單取不完整，請和工程師聯繫' + message)\n                    return\n                }\n                this.props.initializeRequests(requests, finished, unfinished)\n            })\n            .catch(err => {\n                alert('Error, please try again 托藥單取不完整，請和工程師聯繫：' + err.message)\n            })\n    }\n\n    render() {\n        const { students } = this.props\n        const { requests, unfinished } = this.props.medication_requests\n        // console.log('this.props.medication_requests: ', this.props.medication_requests)\n        return (\n            <Card style={{ flex: 1, width: '90%'}}>\n                <View style={{ height: 80, justifyContent: 'center', marginTop: 5 }}>\n                    <Text style={{ fontSize: 30, alignSelf: 'center', position: 'absolute' }}>托藥單</Text>\n                    <TouchableHighlight\n                        style={{\n                            width: '25%',\n                            alignSelf: 'flex-end',\n                            position: 'absolute',\n                            padding: 5,\n                            backgroundColor: '#b5e9e9'\n                        }}\n                        onPress={() => {\n                            this.props.navigation.push('TeacherMedicineLog', {\n                                request_id: null\n                            })\n                        }}\n                    >\n                        <Text style={styles.button_text}>查看</Text>\n                    </TouchableHighlight>\n                </View>\n                <View style={{ }}>\n                    <ScrollView horizontal={true}>\n                        {unfinished.map((request_id) => {\n                            const { student_id, timestamp, medication, note, administered, teacher_id } = requests[request_id]\n                            const time = formatHourMinute(new Date(timestamp))\n                            return (\n                                <TouchableHighlight\n                                    key={request_id}\n                                    style={{ flex: 1, margin: 3 }}\n                                    onPress={() => {\n                                        this.props.navigation.push('TeacherMedicineLog', {\n                                            request_id\n                                        })\n                                    }}\n                                >\n                                    <Card style={{ flex:1, alignItems: 'center', paddingHorizontal: 15 }}>\n                                        <View style={{ justifyContent: 'center' }}>\n                                            <Text style={{ fontSize: 35 }}>{time}</Text>\n                                        </View>\n                                        <View style={{ justifyContent: 'center' }}>\n                                            <Image\n                                                source={\n                                                    students[student_id].profile_picture === '' ?\n                                                        require('../../assets/icon-thumbnail.png')\n                                                        : {uri: students[student_id].profile_picture} \n                                                }\n                                                style={styles.thumbnailImage}/>\n                                        </View>\n                                        <View\n                                            style={{ justifyContent: 'center' }}\n                                        >\n                                            <Text style={{ fontSize: 25 }}>{students[student_id].name}</Text>\n                                        </View>\n                                    </Card>\n                                </TouchableHighlight>\n                            )\n                        })}\n                    </ScrollView>\n                </View>\n            </Card>\n        )\n    }\n}\n\nconst styles = StyleSheet.create({\n    card: {\n        width: '90%',\n        flex: 1\n    },\n    button: {\n        width: '30%',\n        backgroundColor:\"#b5e9e9\"\n    },\n    button_text: {\n        width: '100%',\n        textAlign: 'center',\n        color: 'gray',\n        fontSize: 30,\n    },\n    thumbnailImage: {\n        height: 150,\n        width: 150,\n        borderRadius: 75\n    }\n})\n\n// const mapStateToProps = (state) => {\n//     return {\n//         medication_requests: state.medicationrequests\n//     }\n// }\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        ...bindActionCreators({ initializeRequests }, dispatch)\n    }\n}\n\nexport default connect(null, mapDispatchToProps, null, { forwardRef: true }) (MedicationReqeustCard)"]},"metadata":{},"sourceType":"module"}