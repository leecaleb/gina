{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import Image from\"react-native-web/dist/exports/Image\";import Alert from\"react-native-web/dist/exports/Alert\";import TextInput from\"react-native-web/dist/exports/TextInput\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import{Toast}from'native-base';import{post,get}from\"../../util\";import Auth from'@aws-amplify/auth';import{connect}from'react-redux';var AddParent=function(_React$Component){_inherits(AddParent,_React$Component);var _super=_createSuper(AddParent);function AddParent(props){var _this;_classCallCheck(this,AddParent);_this=_super.call(this,props);_this.state={password:'',qr_data:'',name:''};return _this;}_createClass(AddParent,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props,parent_data,isConnected,response,success,statusCode,message,data;return _regeneratorRuntime.async(function componentDidMount$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props=this.props,parent_data=_this$props.parent_data,isConnected=_this$props.isConnected;this.setState(_objectSpread(_objectSpread({},this.state),parent_data));if(isConnected){_context.next=5;break;}alert('網路連不到! 等一下再試試看');return _context.abrupt(\"return\");case 5:if(!(parent_data.id!='')){_context.next=14;break;}_context.next=8;return _regeneratorRuntime.awrap(get(\"/user/\"+parent_data.id+\"/qrcode\"));case 8:response=_context.sent;success=response.success,statusCode=response.statusCode,message=response.message,data=response.data;if(success){_context.next=13;break;}alert('Sorry 取得家長QR Code時電腦出狀況了！請截圖和與工程師聯繫\\n\\n'+message);return _context.abrupt(\"return\");case 13:this.setState({qr_data:data});case 14:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"postParent\",value:function postParent(){var _this$props2,student_id,isConnected,_this$state,id,name,role,email,username,mobile,work_phone,address,_response,body,response,success,statusCode,message,data;return _regeneratorRuntime.async(function postParent$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this$props2=this.props,student_id=_this$props2.student_id,isConnected=_this$props2.isConnected;_this$state=this.state,id=_this$state.id,name=_this$state.name,role=_this$state.role,email=_this$state.email,username=_this$state.username,mobile=_this$state.mobile,work_phone=_this$state.work_phone,address=_this$state.address;if(!isConnected){alert('網路連不到! 等一下再試試看');}if(!(id==='')){_context2.next=9;break;}_context2.next=6;return _regeneratorRuntime.awrap(this.signUpParent());case 6:_response=_context2.sent;if(_response.success){_context2.next=9;break;}return _context2.abrupt(\"return\");case 9:body={student_id:student_id,parent_data:{id:id,name:name,role:role,email:email,username:username,mobile:mobile,work_phone:work_phone,address:address}};_context2.next=12;return _regeneratorRuntime.awrap(post(\"/student/\"+student_id+\"/family\",body));case 12:response=_context2.sent;success=response.success,statusCode=response.statusCode,message=response.message,data=response.data;if(success){_context2.next=17;break;}alert('Sorry 新增家長時電腦出狀況了！請截圖和與工程師聯繫\\n\\n'+message);return _context2.abrupt(\"return\");case 17:this.props.goBack();case 18:case\"end\":return _context2.stop();}}},null,this,null,Promise);}},{key:\"signUpParent\",value:function signUpParent(){var _this$state2,username,password,name,email,response;return _regeneratorRuntime.async(function signUpParent$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$state2=this.state,username=_this$state2.username,password=_this$state2.password,name=_this$state2.name,email=_this$state2.email;_context3.next=3;return _regeneratorRuntime.awrap(Auth.signUp({username:username,password:password,attributes:{name:name,email:email}}).then(function(values){return{success:true};}).catch(function(err){alert('家長註冊有問題!請與工程師聯繫\\n\\n'+err.message);return{success:false};}));case 3:response=_context3.sent;return _context3.abrupt(\"return\",response);case 5:case\"end\":return _context3.stop();}}},null,this,null,Promise);}},{key:\"render\",value:function render(){var _this2=this;var _this$state3=this.state,id=_this$state3.id,name=_this$state3.name,username=_this$state3.username,password=_this$state3.password,mobile=_this$state3.mobile,work_phone=_this$state3.work_phone,address=_this$state3.address,role=_this$state3.role,email=_this$state3.email;return React.createElement(View,{style:{flex:1,padding:30}},React.createElement(View,{style:{flex:1,backgroundColor:'#F5F5F5'}},React.createElement(ScrollView,null,React.createElement(View,{style:{flex:1,flexDirection:'row',padding:10,justifyContent:'space-between'}},React.createElement(View,{style:{width:'66%',padding:10,backgroundColor:'#ffddb7'}},React.createElement(Text,{style:{fontSize:15}},\"\\u59D3\\u540D\"),React.createElement(TextInput,{style:{fontSize:35,textAlign:'center'},value:name,onChangeText:function onChangeText(name){return _this2.setState({name:name});}})),React.createElement(View,{style:{width:'32%',padding:10,backgroundColor:'#ffddb7'}},React.createElement(Text,{style:{fontSize:15}},\"\\u89D2\\u8272\"),React.createElement(TextInput,{style:{fontSize:35,textAlign:'center'},value:role,onChangeText:function onChangeText(role){return _this2.setState({role:role});}}))),React.createElement(View,{style:{flex:1,padding:10}},React.createElement(View,{style:{padding:15,backgroundColor:'#ffddb7',height:'100%'}},React.createElement(Text,{style:{fontSize:15}},\"Email\"),React.createElement(TextInput,{style:{fontSize:35},autoCapitalize:'none',keyboardType:'email-address',placeholder:'',value:email,onChangeText:function onChangeText(email){return _this2.setState({email:email});}}))),React.createElement(View,{style:{flex:1,flexDirection:'row',padding:10,justifyContent:'space-between'}},React.createElement(View,{style:{width:'49%',padding:15,backgroundColor:'#ffddb7'}},React.createElement(Text,{style:{fontSize:15}},\"\\u5E33\\u865F\"),React.createElement(TextInput,{editable:id==='',style:{fontSize:35,textAlign:'center'},autoCapitalize:'none',value:username,onChangeText:function onChangeText(username){return _this2.setState({username:username});}})),id===''?React.createElement(View,{style:{width:'49%',padding:15,backgroundColor:'#ffddb7'}},React.createElement(Text,{style:{fontSize:15}},\"\\u5BC6\\u78BC\"),React.createElement(TextInput,{secureTextEntry:true,style:{fontSize:35,textAlign:'center'},value:password,onChangeText:function onChangeText(password){return _this2.setState({password:password});}})):React.createElement(TouchableHighlight,{style:{backgroundColor:'transparent',alignItems:'center',justifyContent:'center'},onPress:function onPress(){return _this2.props.viewQRCode(_this2.state.qr_data);}},React.createElement(Image,{source:require(\"../../../assets/icon-qr.png\"),style:{width:120,height:120}}))),React.createElement(View,{style:{flex:1,padding:10}},React.createElement(View,{style:{padding:15,backgroundColor:'#ffddb7',height:'100%'}},React.createElement(Text,{style:{fontSize:15}},\"\\u624B\\u6A5F\"),React.createElement(TextInput,{style:{fontSize:35},keyboardType:'number-pad',placeholder:'',value:mobile,onChangeText:function onChangeText(mobile){return _this2.setState({mobile:mobile});}}))),React.createElement(View,{style:{flex:1,padding:10}},React.createElement(View,{style:{padding:15,backgroundColor:'#ffddb7',height:'100%'}},React.createElement(Text,{style:{fontSize:15}},\"\\u5DE5\\u4F5C/\\u5BB6\\u7528\\u96FB\\u8A71\"),React.createElement(TextInput,{style:{fontSize:35},keyboardType:'number-pad',placeholder:'',value:work_phone,onChangeText:function onChangeText(work_phone){return _this2.setState({work_phone:work_phone});}}))),React.createElement(View,{style:{flex:1,padding:10}},React.createElement(View,{style:{padding:15,backgroundColor:'#ffddb7',height:'100%'}},React.createElement(Text,{style:{fontSize:15}},\"\\u5730\\u5740\"),React.createElement(TextInput,{style:{fontSize:35},placeholder:'',value:address,onChangeText:function onChangeText(address){return _this2.setState({address:address});}}))),React.createElement(View,{style:{flex:1,flexDirection:'row',backgroundColor:'#DCDCDC'}},React.createElement(View,{style:{flex:1,padding:14}},React.createElement(TouchableHighlight,{style:{flex:1,padding:5,backgroundColor:'#fa625f',justifyContent:'center'},onPress:function onPress(){return _this2.props.goBack();}},React.createElement(Text,{style:{fontSize:30,alignSelf:'center'}},\"\\u8FD4\\u56DE\"))),id!==''?React.createElement(View,{style:{flex:1,padding:14}},React.createElement(TouchableHighlight,{style:{flex:1,padding:5,backgroundColor:'#fa625f',justifyContent:'center'}},React.createElement(Text,{style:{fontSize:30,alignSelf:'center'}},\"\\u79FB\\u9664\"))):null,React.createElement(View,{style:{flex:1,padding:14}},React.createElement(TouchableHighlight,{style:{flex:1,padding:5,backgroundColor:'#00c07f',justifyContent:'center'},onPress:function onPress(){return _this2.postParent();}},React.createElement(Text,{style:{fontSize:30,alignSelf:'center'}},id===''?'新增':'送出')))))));}}]);return AddParent;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{isConnected:state.school.isConnected};};export default connect(mapStateToProps,null)(AddParent);","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/teacher/admin/addparent.js"],"names":["React","Toast","post","get","Auth","connect","AddParent","props","state","password","qr_data","name","parent_data","isConnected","setState","alert","id","response","success","statusCode","message","data","student_id","role","email","username","mobile","work_phone","address","signUpParent","body","goBack","signUp","attributes","then","values","catch","err","flex","padding","backgroundColor","flexDirection","justifyContent","width","fontSize","textAlign","height","alignItems","viewQRCode","require","alignSelf","postParent","Component","mapStateToProps","school"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { View, Text, TouchableHighlight, Image, Alert, TextInput, ScrollView} from 'react-native'\nimport { Toast } from 'native-base'\nimport { post, get } from '../../util'\nimport Auth from '@aws-amplify/auth'\nimport { connect } from 'react-redux'\n\nclass AddParent extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state={\n            password: '',\n            qr_data: '',\n            name: ''\n        }\n    }\n\n    async componentDidMount() {\n        const { parent_data, isConnected } = this.props\n        this.setState({\n            ...this.state,\n            ...parent_data\n        })\n\n        if (!isConnected) {\n            alert('網路連不到! 等一下再試試看')\n            return\n            // Toast.show({\n            //     text: '網路連不到! 等一下再試試看',\n            //     buttonText: 'Okay',\n            //     buttonTextStyle: { fontSize: 25 },\n            //     position: \"top\",\n            //     type: \"warning\",\n            //     duration: 2000\n            // })\n        }\n\n        if (parent_data.id != ''){\n            const response = await get(`/user/${parent_data.id}/qrcode`)\n            const { success, statusCode, message, data } = response\n            if (!success) {\n                alert('Sorry 取得家長QR Code時電腦出狀況了！請截圖和與工程師聯繫\\n\\n' + message)\n                return \n            }\n            this.setState({\n                qr_data: data\n            })\n        }\n    }\n\n    async postParent() {\n        const { student_id, isConnected } = this.props\n        const { id, name, role, email, username, mobile, work_phone, address } = this.state\n\n        if (!isConnected) {\n            alert('網路連不到! 等一下再試試看')\n            // Toast.show({\n            //     text: '網路連不到! 等一下再試試看',\n            //     buttonText: 'Okay',\n            //     buttonTextStyle: { fontSize: 25 },\n            //     position: \"top\",\n            //     type: \"warning\",\n            //     duration: 2000\n            // })\n        }\n\n        if (id === '') { // we register and then add parent to database\n            const response = await this.signUpParent()\n            if (!response.success) {\n                return\n            }\n        }\n        const body = {\n            student_id,\n            parent_data: {\n                id,\n                name, \n                role,\n                email,\n                username, \n                mobile, \n                work_phone, \n                address\n            }\n        }\n        const response = await post(`/student/${student_id}/family`, body)\n        const { success, statusCode, message, data } = response\n        if (!success) {\n            alert('Sorry 新增家長時電腦出狀況了！請截圖和與工程師聯繫\\n\\n' + message)\n            return \n          }\n        this.props.goBack()\n    }\n\n    async signUpParent() {\n        const { username, password, name, email } = this.state\n        const response = await Auth.signUp({\n            username,\n            password,\n            attributes: {\n                name,\n                email\n            }\n          })\n            .then(values => {\n                return {\n                    success: true\n                }\n            })\n            .catch(err => {\n                alert('家長註冊有問題!請與工程師聯繫\\n\\n' + err.message)\n                return {\n                    success: false\n                }\n          })\n        return response\n    }\n\n    render() {\n        const { id, name, username, password, mobile, work_phone, address, role, email } = this.state\n        // console.log('this.state: ', this.state)\n        return (\n            <View style={{ flex: 1, padding: 30 }}>\n                <View style={{ flex: 1, backgroundColor: '#F5F5F5' }}>\n                    <ScrollView>\n                    <View\n                        style={{\n                            flex: 1,\n                            flexDirection: 'row',\n                            padding: 10,\n                            justifyContent: 'space-between'\n                        }}\n                    >\n                        <View\n                            style={{\n                                // flexDirection: 'row',\n                                width: '66%',\n                                padding: 10,\n                                backgroundColor: '#ffddb7',\n                                // alignSelf: 'flex-start',\n                                // marginBottom: 10\n                            }}\n                        >\n                            <Text style={{ fontSize: 15 }}>姓名</Text>\n                            <TextInput \n                                style={{ fontSize: 35, textAlign: 'center' }}\n                                value={name}\n                                onChangeText={(name) => this.setState({ name })}\n                            />\n                        </View>\n\n                        <View\n                            style={{\n                                // flexDirection: 'row',\n                                width: '32%',\n                                padding: 10,\n                                backgroundColor: '#ffddb7',\n                                // alignSelf: 'flex-start',\n                                // marginBottom: 10\n                            }}\n                        >\n                            <Text style={{ fontSize: 15 }}>角色</Text>\n                            <TextInput \n                                style={{ fontSize: 35, textAlign: 'center' }}\n                                value={role}\n                                onChangeText={(role) => this.setState({ role })}\n                            />\n                        </View>\n\n                        {/* <TouchableHighlight\n                            style={{\n                                width: '20%',\n                                padding: 15,\n                                backgroundColor: '#fa625f',\n                                justifyContent: 'center'\n                            }}\n                            // onPress={() => }\n                        >\n                            <Text style={{fontSize: 20, textAlign: 'center'}}>移除</Text>\n                        </TouchableHighlight> */}\n                    </View>\n\n                    <View\n                        style={{\n                            flex: 1,\n                            padding: 10\n                        }}\n                    >\n                        <View\n                            style={{\n                                padding: 15,\n                                backgroundColor: '#ffddb7',\n                                height: '100%'\n                            }}\n                        >\n                            <Text style={{ fontSize: 15 }}>Email</Text>\n                            <TextInput \n                                style={{ fontSize: 35 }}\n                                autoCapitalize={'none'}\n                                keyboardType={'email-address'}\n                                placeholder={''}\n                                value={email}\n                                onChangeText={(email) => this.setState({ email })}\n                            />\n                        </View>\n                    </View>\n\n                    <View\n                        style={{\n                            flex: 1,\n                            flexDirection: 'row',\n                            padding: 10,\n                            justifyContent: 'space-between'\n                        }}\n                    >\n                        <View\n                            style={{\n                                // flexDirection: 'row',\n                                width: '49%',\n                                padding: 15,\n                                backgroundColor: '#ffddb7',\n                                // alignSelf: 'flex-start',\n                                // marginBottom: 10\n                            }}\n                        >\n                            <Text style={{ fontSize: 15 }}>帳號</Text>\n                            <TextInput\n                                editable={id === ''}\n                                style={{ fontSize: 35, textAlign: 'center' }}\n                                autoCapitalize={'none'}\n                                value={username}\n                                onChangeText={(username) => this.setState({ username })}\n                            />\n                        </View>\n\n                        {id === '' ? \n                            <View\n                                style={{\n                                    // flexDirection: 'row',\n                                    width: '49%',\n                                    padding: 15,\n                                    backgroundColor: '#ffddb7',\n                                    // alignSelf: 'flex-start',\n                                    // marginBottom: 10\n                                }}\n                            >\n                                <Text style={{ fontSize: 15 }}>密碼</Text>\n                                <TextInput\n                                    secureTextEntry={true}\n                                    style={{ fontSize: 35, textAlign: 'center' }}\n                                    value={password}\n                                    onChangeText={(password) => this.setState({ password })}\n                                />\n                            </View>\n                        :   <TouchableHighlight\n                                style={{ backgroundColor: 'transparent', alignItems: 'center', justifyContent: 'center' }}\n                                onPress={() => this.props.viewQRCode(this.state.qr_data)}\n                            >\n                                <Image\n                                    source={require('../../../assets/icon-qr.png')}\n                                    style={{\n                                        width: 120,\n                                        height: 120,\n                                    }}\n                                />\n                            </TouchableHighlight>\n                        }\n                    </View>\n\n                    <View\n                        style={{\n                            flex: 1,\n                            padding: 10\n                        }}\n                    >\n                        <View\n                            style={{\n                                padding: 15,\n                                backgroundColor: '#ffddb7',\n                                height: '100%'\n                            }}\n                        >\n                            <Text style={{ fontSize: 15 }}>手機</Text>\n                            <TextInput \n                                style={{ fontSize: 35 }}\n                                keyboardType={'number-pad'}\n                                placeholder={''}\n                                value={mobile}\n                                onChangeText={(mobile) => this.setState({ mobile })}\n                            />\n                        </View>\n                    </View>\n                    \n                    <View\n                        style={{\n                            flex: 1,\n                            padding: 10\n                        }}\n                    >\n                        <View\n                            style={{\n                                padding: 15,\n                                backgroundColor: '#ffddb7',\n                                height: '100%'\n                            }}\n                        >\n                            <Text style={{ fontSize: 15 }}>工作/家用電話</Text>\n                            <TextInput \n                                style={{ fontSize: 35 }}\n                                keyboardType={'number-pad'}\n                                placeholder={''}\n                                value={work_phone}\n                                onChangeText={(work_phone) => this.setState({ work_phone })}\n                            />\n                        </View>\n                    </View>\n\n                    <View\n                        style={{\n                            flex: 1,\n                            padding: 10\n                        }}\n                    >\n                        <View\n                            style={{\n                                padding: 15,\n                                backgroundColor: '#ffddb7',\n                                height: '100%'\n                            }}\n                        >\n                            <Text style={{ fontSize: 15 }}>地址</Text>\n                            <TextInput \n                                style={{ fontSize: 35 }}\n                                placeholder={''}\n                                value={address}\n                                onChangeText={(address) => this.setState({ address })}\n                            />\n                        </View>\n                    </View>\n\n                    <View style={{ flex: 1, flexDirection: 'row', backgroundColor: '#DCDCDC' }}>\n                        <View style={{ flex: 1, padding: 14 }}>\n                            <TouchableHighlight\n                                style={{ flex:1, padding: 5, backgroundColor: '#fa625f', justifyContent: 'center' }}\n                                onPress={() => this.props.goBack()}\n                            >\n                                <Text style={{ fontSize: 30, alignSelf: 'center' }}>返回</Text>\n                            </TouchableHighlight>\n                        </View>\n                        {id !== '' ? \n                            <View style={{ flex: 1, padding: 14 }}>\n                                <TouchableHighlight\n                                    style={{ flex:1, padding: 5, backgroundColor: '#fa625f', justifyContent: 'center' }}\n                                    // onPress={() => this.props.goBack()}\n                                >\n                                    <Text style={{ fontSize: 30, alignSelf: 'center' }}>移除</Text>\n                                </TouchableHighlight>\n                            </View>\n                        : null\n                        }\n                        <View style={{ flex: 1, padding: 14 }}>\n                            <TouchableHighlight\n                                style={{ flex: 1, padding: 5, backgroundColor: '#00c07f',justifyContent: 'center' }}\n                                onPress={() => this.postParent()}\n                            >\n                                <Text style={{ fontSize: 30, alignSelf: 'center' }}>{id === '' ? '新增' : '送出'}</Text>\n                            </TouchableHighlight>\n                        </View>\n                    </View>\n                    </ScrollView>\n                </View>\n\n                \n            </View>\n        )\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n      isConnected: state.school.isConnected\n    }\n}\n\nexport default connect(mapStateToProps, null) (AddParent)"]},"metadata":{},"sourceType":"module"}