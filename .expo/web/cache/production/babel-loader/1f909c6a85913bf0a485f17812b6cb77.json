{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}var initial_state={by_student_id:{},records:{by_id:{},all_id:[]},all_dispatched:true,students_pending_amount_update:new Set(),data_to_update:[],new_data_for_create:new Set(),old_data_for_edit:new Set(),err_message:''};export default function diaper(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initial_state;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'INITIALIZE_CLASS':{by_student_id={};action.students.forEach(function(student){var id=student.id;by_student_id[id]={amount:'',records:[]};});return _objectSpread(_objectSpread({},state),{},{by_student_id:by_student_id});}case'FETCH_CLASS_DIAPER_DATA':{return _objectSpread(_objectSpread({},state),action.diaperData);}case'ADD_DIAPER_RECORD':{var student_id=action.student_id,time=action.time,cloth_diaper=action.cloth_diaper,teacher_id=action.teacher_id;var newState=_objectSpread({},state);var id=newState.records.all_id.length;newState.by_student_id[student_id].records.push(id);if(!cloth_diaper){newState.by_student_id[student_id].amount-=1;newState.students_pending_amount_update.add(student_id);}newState.records.by_id[id]={student_id:student_id,time:time,cloth_diaper:cloth_diaper,pee_or_poo:'小便',poo_condition:'正常',teacher_id:teacher_id};newState.records.all_id.push(id);newState.all_dispatched=false;newState.new_data_for_create.add(id);return newState;}case'EDIT_DIAPER_TIME':{var record_id=action.record_id,_time=action.time,_teacher_id=action.teacher_id;var new_data_for_create=state.new_data_for_create;var _newState=_objectSpread({},state);_newState.records.by_id[record_id].time=_time;_newState.records.by_id[record_id].teacher_id=_teacher_id;if(!new_data_for_create.has(record_id)){_newState.old_data_for_edit.add(record_id);}return _newState;}case'SWITCH_PEE_OR_POO':{var _record_id=action.record_id,_teacher_id2=action.teacher_id;var _new_data_for_create=state.new_data_for_create;var _newState2=_objectSpread({},state);var current_pee_or_poo=_newState2.records.by_id[_record_id].pee_or_poo;_newState2.records.by_id[_record_id].pee_or_poo=current_pee_or_poo==='小便'?'大便':'小便';_newState2.records.by_id[_record_id].teacher_id=_teacher_id2;if(current_pee_or_poo==='小便'){_newState2.records.by_id[_record_id].poo_condition='正常';}if(!_new_data_for_create.has(_record_id)){_newState2.old_data_for_edit.add(_record_id);}return _newState2;}case'EDIT_POO_CONDITION':{var _record_id2=action.record_id,condition=action.condition,_teacher_id3=action.teacher_id;var _new_data_for_create2=state.new_data_for_create;var _newState3=_objectSpread({},state);console.log('EDIT_POO_CONDITION: ',_record_id2,condition,_teacher_id3);_newState3.records.by_id[_record_id2].poo_condition=condition;_newState3.records.by_id[_record_id2].teacher_id=_teacher_id3;if(!_new_data_for_create2.has(_record_id2)){_newState3.old_data_for_edit.add(_record_id2);}return _newState3;}case'REMOVE_DIAPER_RECORD_SUCCESS':{var _student_id=action.student_id,_record_id3=action.record_id;var _newState4=_objectSpread({},state);var new_records=[];var records=state.by_student_id[_student_id].records;if(!state.records.by_id[_record_id3].cloth_diaper){_newState4.by_student_id[_student_id].amount+=1;}for(var i=0;i<records.length;i++){if(records[i]!==_record_id3){new_records.push(records[i]);}}_newState4.by_student_id[_student_id].records=new_records;var _new_data_for_create3=new Set(_toConsumableArray(state.new_data_for_create));_new_data_for_create3.delete(_record_id3);_newState4.new_data_for_create=_new_data_for_create3;var old_data_for_edit=new Set(_toConsumableArray(state.old_data_for_edit));old_data_for_edit.delete(_record_id3);_newState4.old_data_for_edit=old_data_for_edit;return _newState4;}case'REMOVE_DIAPER_RECORD_FAIL':{var err_message=action.err_message;return _objectSpread(_objectSpread({},state),{},{err_message:err_message});}case'UPDATE_DIAPER_AMOUNT':{var _student_id2=action.student_id,amount=action.amount;var students_pending_amount_update=new Set([].concat(_toConsumableArray(state.students_pending_amount_update),[_student_id2]));return _objectSpread(_objectSpread({},state),{},{by_student_id:_objectSpread(_objectSpread({},state.by_student_id),{},_defineProperty({},_student_id2,_objectSpread(_objectSpread({},state.by_student_id[_student_id2]),{},{amount:amount}))),students_pending_amount_update:students_pending_amount_update});}case'CREATE_DIAPER_RECORD_SUCCESS':{return _objectSpread(_objectSpread({},state),{},{new_data_for_create:new Set(),old_data_for_edit:new Set()});}case'CREATE_DIAPER_RECORD_FAIL':{var _err_message=action.err_message;return _objectSpread(_objectSpread({},state),{},{err_message:_err_message});}case'EDIT_DIAPER_RECORD_SUCCESS':{return _objectSpread(_objectSpread({},state),{},{old_data_for_edit:new Set()});}case'EDIT_DIAPER_RECORD_FAIL':{var _err_message2=action.err_message;return _objectSpread(_objectSpread({},state),{},{err_message:_err_message2});}case'EDIT_DIAPER_AMOUNT_SUCCESS':{return _objectSpread(_objectSpread({},state),{},{students_pending_amount_update:new Set()});}case'EDIT_DIAPER_AMOUNT_FAIL':{var _err_message3=action.err_message;return _objectSpread(_objectSpread({},state),{},{err_message:_err_message3});}case'CLEAR_ERR_MESSAGE':{return _objectSpread(_objectSpread({},state),{},{err_message:''});}case'CLEAR_STATE':{return{by_student_id:{},records:{by_id:{},all_id:[]},all_dispatched:true,students_pending_amount_update:new Set(),data_to_update:[],new_data_for_create:new Set(),old_data_for_edit:new Set(),err_message:''};}default:return state;}}","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/redux/school/reducers/diaper.js"],"names":["initial_state","by_student_id","records","by_id","all_id","all_dispatched","students_pending_amount_update","Set","data_to_update","new_data_for_create","old_data_for_edit","err_message","diaper","state","action","type","students","forEach","student","id","amount","diaperData","student_id","time","cloth_diaper","teacher_id","newState","length","push","add","pee_or_poo","poo_condition","record_id","has","current_pee_or_poo","condition","console","log","new_records","i","delete"],"mappings":"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","sourcesContent":["var initial_state = {\n  by_student_id: {\n    /*\n    {student_id}: {\n      amount: 16,\n      records: [{record_id}, {...}]\n    }\n    */\n  },\n  records: {\n    by_id: {\n      /*\n      {record_id}: {\n        student_id,\n        time: {Datetime},\n        cloth_diaper: true/false,\n        pee_or_poo: {小便/大便},\n        poo_condition: {varchar(4)}\n        teacher_id\n      }\n      */\n    },\n    all_id: []\n  },\n  all_dispatched: true,\n  students_pending_amount_update: new Set(),\n  data_to_update: [],\n  new_data_for_create: new Set(),\n  old_data_for_edit: new Set(),\n  err_message: ''\n}\n\nexport default function diaper(state = initial_state, action) {\n  switch (action.type) {\n    case 'INITIALIZE_CLASS': {\n      by_student_id = {}\n      action.students.forEach(student => {\n        const { id } = student\n        by_student_id[id] = {\n          amount: '',\n          records: []\n        }\n      })\n      // initial_state = {\n      //   ...state,\n      //   by_student_id\n      // }\n      return {\n        ...state,\n        by_student_id\n      }\n    }\n    case 'FETCH_CLASS_DIAPER_DATA': { // TODO: fix bug\n      return {\n        ...state,\n        ...action.diaperData\n      }\n    }\n    case 'ADD_DIAPER_RECORD': {\n      const { student_id, time, cloth_diaper, teacher_id } = action\n      const newState = { ...state }\n      const id = newState.records.all_id.length\n      newState.by_student_id[student_id].records.push(id)\n      if (!cloth_diaper) {\n        newState.by_student_id[student_id].amount -= 1\n        newState.students_pending_amount_update.add(student_id)\n      }\n\n      newState.records.by_id[id] = {\n        student_id,\n        time,\n        cloth_diaper,\n        pee_or_poo: '小便',\n        poo_condition: '正常',\n        teacher_id\n      }\n      newState.records.all_id.push(id)\n      newState.all_dispatched = false\n      newState.new_data_for_create.add(id)\n      return newState\n    }\n      \n    case 'EDIT_DIAPER_TIME': {\n      const { record_id, time, teacher_id } = action\n      const { new_data_for_create } = state\n      const newState = { ...state }\n      newState.records.by_id[record_id].time = time\n      newState.records.by_id[record_id].teacher_id = teacher_id\n      if (!new_data_for_create.has(record_id)) {\n        newState.old_data_for_edit.add(record_id)\n      }\n      return newState\n    }\n    \n    case 'SWITCH_PEE_OR_POO': {\n      const { record_id, teacher_id } = action\n      const { new_data_for_create } = state\n      const newState = { ...state }\n      const current_pee_or_poo = newState.records.by_id[record_id].pee_or_poo\n      newState.records.by_id[record_id].pee_or_poo = current_pee_or_poo === '小便' ? '大便' : '小便'\n      newState.records.by_id[record_id].teacher_id = teacher_id\n      if (current_pee_or_poo === '小便') {\n        newState.records.by_id[record_id].poo_condition = '正常'\n      }\n      if (!new_data_for_create.has(record_id)) {\n        newState.old_data_for_edit.add(record_id)\n      }\n      return newState\n    }\n\n    case 'EDIT_POO_CONDITION': {\n      const { record_id, condition, teacher_id } = action\n      const { new_data_for_create } = state\n      const newState = { ...state }\n\n      console.log('EDIT_POO_CONDITION: ', record_id, condition, teacher_id)\n      newState.records.by_id[record_id].poo_condition = condition\n      newState.records.by_id[record_id].teacher_id = teacher_id\n      if (!new_data_for_create.has(record_id)) {\n        newState.old_data_for_edit.add(record_id)\n      }\n      return newState\n    }\n      \n    case 'REMOVE_DIAPER_RECORD_SUCCESS': {\n      const { student_id, record_id } = action\n      const newState = { ...state }\n      const new_records = []\n      \n      const records = state.by_student_id[student_id].records\n      if(!state.records.by_id[record_id].cloth_diaper) {\n        newState.by_student_id[student_id].amount += 1\n      }\n\n      for (var i = 0; i < records.length; i++){\n        if (records[i] !== record_id) {\n          new_records.push(records[i])\n        }\n      }\n      newState.by_student_id[student_id].records = new_records\n\n      const new_data_for_create = new Set([...state.new_data_for_create])\n      new_data_for_create.delete(record_id)\n      newState.new_data_for_create = new_data_for_create\n\n      const old_data_for_edit = new Set([...state.old_data_for_edit])\n      old_data_for_edit.delete(record_id)\n      newState.old_data_for_edit = old_data_for_edit\n\n      return newState\n    }\n    \n    case 'REMOVE_DIAPER_RECORD_FAIL': {\n      const { err_message } = action\n      return {\n        ...state,\n        err_message\n      }\n    }\n\n    case 'UPDATE_DIAPER_AMOUNT': {\n      const { student_id, amount } = action\n      const students_pending_amount_update = new Set([...state.students_pending_amount_update, student_id])\n      return {\n        ...state,\n        by_student_id: {\n          ...state.by_student_id,\n          [student_id]: {\n            ...state.by_student_id[student_id],\n            amount\n          }\n        },\n        students_pending_amount_update\n      }\n    }\n    \n    case 'CREATE_DIAPER_RECORD_SUCCESS': {\n      return {\n        ...state,\n        new_data_for_create: new Set(),\n        old_data_for_edit: new Set()\n      }\n    }\n      \n    case 'CREATE_DIAPER_RECORD_FAIL': {\n      const { err_message } = action\n      return {\n        ...state,\n        err_message\n      }\n    }\n\n    case 'EDIT_DIAPER_RECORD_SUCCESS': {\n      return {\n        ...state,\n        old_data_for_edit: new Set()\n      }\n    }\n\n    case 'EDIT_DIAPER_RECORD_FAIL': {\n      const { err_message } = action\n      return {\n        ...state,\n        err_message\n      }\n    }\n\n    case 'EDIT_DIAPER_AMOUNT_SUCCESS': {\n      return {\n        ...state,\n        students_pending_amount_update: new Set()\n      }\n    }\n      \n    case 'EDIT_DIAPER_AMOUNT_FAIL': {\n      const { err_message } = action\n      return {\n        ...state,\n        err_message\n      }\n    }\n      \n    case 'CLEAR_ERR_MESSAGE': {\n      return {\n        ...state,\n        err_message: ''\n      }\n    }\n      \n    case 'CLEAR_STATE': {\n      return {\n        by_student_id: {},\n        records: {\n          by_id: {},\n          all_id: []\n        },\n        all_dispatched: true,\n        students_pending_amount_update: new Set(),\n        data_to_update: [],\n        new_data_for_create: new Set(),\n        old_data_for_edit: new Set(),\n        err_message: ''\n      }\n    }\n\n    default:\n      return state\n  }\n}"]},"metadata":{},"sourceType":"module"}