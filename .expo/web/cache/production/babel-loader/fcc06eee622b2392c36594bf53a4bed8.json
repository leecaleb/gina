{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Platform from\"react-native-web/dist/exports/Platform\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import Image from\"react-native-web/dist/exports/Image\";import{View,Text}from'native-base';import Auth from'@aws-amplify/auth';import Reloading from\"../reloading\";var Signin=function(_React$Component){_inherits(Signin,_React$Component);var _super=_createSuper(Signin);function Signin(props){var _this;_classCallCheck(this,Signin);_this=_super.call(this,props);_this.state={username:'',password:'',errMessage:'',user_type:'',isLoading:false};return _this;}_createClass(Signin,[{key:\"componentDidMount\",value:function componentDidMount(){}},{key:\"handleSignIn\",value:function handleSignIn(){var _this2=this;this.setState({isLoading:true});var _this$state=this.state,username=_this$state.username,password=_this$state.password;Auth.signIn(username,password).then(function(user){if(user.challengeName==='NEW_PASSWORD_REQUIRED'){_this2.completeNewPassword(user);return;}_this2.setState({isLoading:false});_this2.props.loadAuth();}).catch(function(err){if(err.code==='UserNotConfirmedException'){_this2.props.changeAuthState('ConfirmSignUpPage',username);}else{_this2.props.changeAuthState('signedout',username);_this2.setState({errMessage:err.message,isLoading:false});}});}},{key:\"completeNewPassword\",value:function completeNewPassword(user){var _this3=this;Auth.completeNewPassword(user,'barRoco',{name:'barroco'}).then(function(user){_this3.setState({isLoading:false});_this3.props.loadAuth();}).catch(function(err){_this3.setState({errMessage:err.message,isLoading:false});});}},{key:\"render\",value:function render(){var _this4=this;var isLoading=this.state.isLoading;if(isLoading){return React.createElement(Reloading,null);}var keyboardVerticalOffset=Platform.OS==='ios'?60:0;var errMessage=this.state.errMessage?React.createElement(Text,{style:{color:'red'}},this.state.errMessage):null;return React.createElement(KeyboardAvoidingView,{style:styles.container,behavior:'padding',keyboardVerticalOffset:keyboardVerticalOffset,enabled:true},React.createElement(Image,{source:require(\"../../assets/app_logo.png\"),style:{width:200,height:200}}),React.createElement(Text,{style:{fontSize:40}},\"\\u8ACB\\u767B\\u5165\"),errMessage,React.createElement(TextInput,{placeholder:\"Email / \\u5E33\\u865F\",keyboardType:\"email-address\",autoCapitalize:\"none\",style:styles.textInput,onChangeText:function onChangeText(username){return _this4.setState({username:username});},value:this.state.username}),React.createElement(TextInput,{secureTextEntry:true,placeholder:\"\\u5BC6\\u78BC\",style:styles.textInput,onChangeText:function onChangeText(pass){return _this4.setState({password:pass});},value:this.state.password}),React.createElement(View,{style:{marginTop:20}},React.createElement(TouchableHighlight,{style:{backgroundColor:'grey',padding:20},onPress:function onPress(){return _this4.handleSignIn();}},React.createElement(Text,{style:{fontSize:30}},\"\\u767B\\u5165\"))));}}]);return Signin;}(React.Component);var styles=StyleSheet.create({container:{flex:1,justifyContent:'center',alignItems:'center'},textInput:{height:80,width:'90%',borderColor:'gray',borderWidth:1,marginTop:20,fontSize:30,padding:10}});export default Signin;","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/auth/signin.js"],"names":["React","View","Text","Auth","Reloading","Signin","props","state","username","password","errMessage","user_type","isLoading","setState","signIn","then","user","challengeName","completeNewPassword","loadAuth","catch","err","code","changeAuthState","message","name","keyboardVerticalOffset","Platform","OS","color","styles","container","require","width","height","fontSize","textInput","pass","marginTop","backgroundColor","padding","handleSignIn","Component","StyleSheet","create","flex","justifyContent","alignItems","borderColor","borderWidth"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { StyleSheet, TextInput, Platform, KeyboardAvoidingView, TouchableHighlight, Image } from 'react-native'\nimport { View, Text } from 'native-base'\nimport Auth from '@aws-amplify/auth'\nimport Reloading from '../reloading'\n\nclass Signin extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            username: '',\n            password: '',\n            errMessage: '',\n            user_type: '',\n            isLoading: false\n        }\n    }\n\n    componentDidMount() {\n        // this.props.clearState\n    }\n\n    handleSignIn() {\n        // invoke google auth with scopes, ask for school's authorization\n        // allow requests to googple photo api\n        this.setState({\n            isLoading: true\n        })\n        const { username, password } = this.state\n        Auth.signIn(username, password)\n            .then((user) => {\n                if (user.challengeName === 'NEW_PASSWORD_REQUIRED') {\n                    // const {requiredAttributes} = user.challengeParam\n                    this.completeNewPassword(user)\n                    return\n                }\n                this.setState({\n                    isLoading: false\n                })\n                this.props.loadAuth()\n            })\n            .catch((err) => {\n                if (err.code === 'UserNotConfirmedException') {\n                    this.props.changeAuthState('ConfirmSignUpPage', username)\n                } else {\n                    this.props.changeAuthState('signedout', username)\n                    this.setState({ \n                        errMessage: err.message,\n                        isLoading: false\n                    })\n                }\n            })\n    }\n\n    completeNewPassword(user) {\n        Auth.completeNewPassword(\n            user,\n            'barRoco',\n            { name: 'barroco' }\n        )\n        .then((user) => {\n            this.setState({\n                isLoading: false\n            })\n            this.props.loadAuth()\n        })\n        .catch((err) => {\n            this.setState({\n                errMessage: err.message,\n                isLoading: false\n            })\n        })\n    }\n\n    render () {\n        const { isLoading } = this.state\n        if (isLoading) {\n            return (\n                <Reloading />\n            )\n        }\n        const keyboardVerticalOffset = Platform.OS === 'ios' ? 60 : 0\n        const errMessage = this.state.errMessage ? (\n            <Text style={{ color: 'red'}}>\n                {this.state.errMessage}\n            </Text>\n        ) : (\n            null\n        )\n\n        return (\n            <KeyboardAvoidingView \n                style={styles.container} \n                behavior={'padding'}\n                keyboardVerticalOffset={keyboardVerticalOffset} \n                enabled\n            >\n                <Image\n                    source={require('../../assets/app_logo.png')}\n                    style={{\n                        width: 200,\n                        height: 200,\n                    }}\n                />\n\n                <Text style={{ fontSize: 40 }}>請登入</Text>\n                {errMessage}\n                <TextInput\n                    placeholder=\"Email / 帳號\"\n                    keyboardType=\"email-address\"\n                    autoCapitalize=\"none\"\n                    style={styles.textInput}\n                    onChangeText={(username) => this.setState({ username })}\n                    value={this.state.username}\n                />\n\n                <TextInput\n                    secureTextEntry\n                    placeholder=\"密碼\"\n                    style={styles.textInput}\n                    onChangeText={(pass) => this.setState({ password: pass })}\n                    value={this.state.password}\n                />\n\n                <View style={{ marginTop: 20 }}>\n                    <TouchableHighlight\n                        style={{ backgroundColor: 'grey', padding: 20 }}\n                        onPress={() => this.handleSignIn()}\n                    >\n                        <Text style={{ fontSize: 30 }}>登入</Text>\n                    </TouchableHighlight>\n                </View>\n                \n                {/*<View style={{ width: '90%', margin: 10, flexDirection: 'row', justifyContent: 'space-around' }}>\n                    <Button style={{ backgroundColor: '#35D0BA' }} onPress={() => this.handleSignIn('','')}>\n                        <Text>Sign in</Text>\n                    </Button>\n                    <Button style={{ backgroundColor: '#35D0BA' }} onPress={() => this.props.changeAuthState('SignupPage', '')}>\n                        <Text>No Account? Sign up here!</Text>\n                    </Button>\n                </View>\n                <Button style={{ backgroundColor: '#35D0BA' }} onPress={() => this.handleSignIn('abc123', 'password')}>\n                    <Text>我是家長</Text>\n                </Button>\n                <Button style={{ backgroundColor: '#35D0BA' }} onPress={() => this.handleSignIn('formosa', 'formosaADMIN')}>\n                    <Text>我是校方</Text>\n                </Button>*/}\n            </KeyboardAvoidingView>\n        )\n    }\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        justifyContent: 'center',\n        alignItems: 'center'\n    },\n    textInput: {\n        height: 80,\n        width: '90%',\n        borderColor: 'gray',\n        borderWidth: 1,\n        marginTop: 20,\n        fontSize: 30,\n        padding: 10\n    }\n})\n\n// const mapDispatchToProps = (dispatch) => {\n//     return {\n//         ...bindActionCreators({addUserType, clearState}, dispatch)\n//     }\n// }\n\n// function mapStateToProps(state) {\n//     return({\n//         user: state.user\n//     })\n// }\n\n// export default connect(mapStateToProps, mapDispatchToProps) (Signin)\nexport default Signin"]},"metadata":{},"sourceType":"module"}