{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Image from\"react-native-web/dist/exports/Image\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import Alert from\"react-native-web/dist/exports/Alert\";import{Container,Content,Text,View,Card,Toast}from'native-base';import{connect}from'react-redux';import{bindActionCreators}from'redux';import{setSleepTime,setWakeTime,fetchClassSleepData,clearPendingSleepUpdate,createSleepRecordSuccess,createSleepRecordFail,editSleepRecordSuccess,editSleepRecordFail,removeSleepRecord,removeSleepRecordSuccess,removeSleepRecordFail,alertSleeplogErrorMessage,clearSleeplogErrorMessage,removeWakeTime,markRecordError,markRecordCorrect}from\"../../../redux/school/actions/index\";import{formatDate,formatTime,fetchClassData as _fetchClassData}from\"../../util\";import Reloading from\"../../reloading\";import TimeModal from\"../../parent/timemodal\";var TeacherSleepLog=function(_React$Component){_inherits(TeacherSleepLog,_React$Component);var _super=_createSuper(TeacherSleepLog);function TeacherSleepLog(props){var _this;_classCallCheck(this,TeacherSleepLog);_this=_super.call(this,props);_this.state={isLoading:true,date:new Date(),showIOSDatePicker:false,student_id:'',index:-1,recordType:'',teacher_id:'',confirmDelete:false,showDateTimeModal:false};_this.handleOnClick=_this.handleOnClick.bind(_assertThisInitialized(_this));_this.handleSend=_this.handleSend.bind(_assertThisInitialized(_this));_this.updateReducerTime=_this.updateReducerTime.bind(_assertThisInitialized(_this));_this.setTime=_this.setTime.bind(_assertThisInitialized(_this));return _this;}_createClass(TeacherSleepLog,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props$sleep=this.props.sleep,newDataForCreate=_this$props$sleep.newDataForCreate,oldDataForEdit=_this$props$sleep.oldDataForEdit;var isConnected=this.props.class.isConnected;var teacher_id=this.props.route.params.teacher_id;this.setState({teacher_id:teacher_id});if(newDataForCreate.size+oldDataForEdit.size===0&&isConnected){this.fetchClassData();}else{this.setState({isLoading:false});}if(!isConnected){Toast.show({text:'拍謝 網路連不到! 等一下再試試看',buttonText:'Okay',position:\"top\",type:\"warning\",duration:2000});}}},{key:\"fetchClassData\",value:function fetchClassData(){var date,start_date,end_date,sleepData;return _regeneratorRuntime.async(function fetchClassData$(_context){while(1){switch(_context.prev=_context.next){case 0:date=new Date();start_date=formatDate(date);date.setDate(date.getDate()+1);end_date=formatDate(date);_context.next=6;return _regeneratorRuntime.awrap(_fetchClassData('sleep',this.props.class.class_id,start_date,end_date));case 6:sleepData=_context.sent;this.denormalize(sleepData);this.props.fetchClassSleepData(sleepData.data);this.setState({isLoading:false});case 10:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"denormalize\",value:function denormalize(sleepData){if(!sleepData.data.records.all_id.length){return;}var by_id=sleepData.data.records.by_id;for(var record_id in by_id){by_id[record_id].sleep_time=new Date(by_id[record_id].sleep_time);by_id[record_id].wake_time=by_id[record_id].wake_time===null?null:new Date(by_id[record_id].wake_time);}sleepData.data.records.by_id=by_id;}},{key:\"hasUnsentRecord\",value:function hasUnsentRecord(student_id){var _this$props$sleep2=this.props.sleep,newDataForCreate=_this$props$sleep2.newDataForCreate,oldDataForEdit=_this$props$sleep2.oldDataForEdit,by_student_id=_this$props$sleep2.by_student_id;record_id_array=by_student_id[student_id];var hasUnsentRecord=false;for(var i=0;i<record_id_array.length;i++){if(newDataForCreate.has(record_id_array[i])||oldDataForEdit.has(record_id_array[i])){hasUnsentRecord=true;break;}}return hasUnsentRecord;}},{key:\"handleOnClick\",value:function handleOnClick(student_id){var record_id_array=this.props.sleep.by_student_id[student_id];var records=this.props.sleep.records.by_id;var last_record=record_id_array.length>0?records[record_id_array[record_id_array.length-1]]:null;var current_wake_time=last_record?last_record.wake_time:null;if(!record_id_array.length||current_wake_time){this.props.setSleepTime(student_id,null,new Date(),this.state.teacher_id);}else{this.props.setWakeTime(student_id,record_id_array.length-1,new Date(),this.state.teacher_id);}this.checkLastRecord(student_id,records,record_id_array);}},{key:\"checkLastRecord\",value:function checkLastRecord(student_id,records,record_id_array){var n=record_id_array.length;var last_record_id=record_id_array[record_id_array.length-1];var last_record=records[last_record_id];if(last_record.wake_time!==null&&last_record.sleep_time.getTime()>=last_record.wake_time.getTime()){this.props.markRecordError([last_record_id]);}if(n>1){var last_second_record_id=record_id_array[record_id_array.length-2];var last_second_record=records[last_second_record_id];if(last_record.sleep_time>=last_second_record.sleep_time&&last_record.sleep_time<=last_second_record.wake_time){this.props.markRecordError([last_record_id]);}}}},{key:\"setTime\",value:function setTime(recordType,student_id,index,start_time){this.setState({student_id:student_id,index:index,recordType:recordType,showDateTimeModal:true,start_time:start_time?start_time:new Date()});}},{key:\"updateReducerTime\",value:function updateReducerTime(index,time){this.setState({showDateTimeModal:false});if(this.state.recordType==='sleep'){this.props.setSleepTime(this.state.student_id,index,time,this.state.teacher_id);}else{this.props.setWakeTime(this.state.student_id,index,time,this.state.teacher_id);}this.checkRecord(this.state.student_id,index);}},{key:\"checkRecord\",value:function checkRecord(student_id,index){var record_id_array=this.props.sleep.by_student_id[student_id];var records=this.props.sleep.records.by_id;var record_id=record_id_array[index];var record=records[record_id];var records_with_error=this.props.sleep.records_with_error;var prev_record_id=null;var next_record_id=null;if(index<0||index>record_id_array.length-1){return;}if(record.wake_time!==null){if(record.sleep_time.getTime()>=record.wake_time.getTime()){this.props.markRecordError([record_id]);return;}}if(index>0){prev_record_id=record_id_array[index-1];var prev_record=records[prev_record_id];if(prev_record.wake_time!==null&&record.sleep_time.getTime()<=prev_record.wake_time.getTime()){this.props.markRecordError([record_id]);return;}}if(index<record_id_array.length-1){next_record_id=record_id_array[index+1];var next_record=records[next_record_id];if(record.wake_time>=next_record.sleep_time){this.props.markRecordError([record_id]);return;}}this.props.markRecordCorrect(record_id);if(prev_record_id!==null&&records_with_error.has(prev_record_id)){this.checkRecord(student_id,index-1);}if(next_record_id!==null&&records_with_error.has(next_record_id)){this.checkRecord(student_id,index+1);}}},{key:\"confirmToRemoveWakeTime\",value:function confirmToRemoveWakeTime(record_id,index,student_id){var _this2=this;var record_id_array=this.props.sleep.by_student_id[student_id];if(index!==record_id_array.length-1){this.props.alertSleeplogErrorMessage('這個睡眠記錄並不能刪除，只能改選');return;}Alert.alert('確定要刪除?','',[{text:'Yes',onPress:function onPress(){return _this2.props.removeWakeTime(record_id,_this2.state.teacher_id);}},{text:'Cancel',style:'cancel'}]);}},{key:\"handleSend\",value:function handleSend(){var isConnected,_this$props$sleep3,newDataForCreate,oldDataForEdit,createSleepRecordRes,editSleepRecordRes;return _regeneratorRuntime.async(function handleSend$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:isConnected=this.props.class.isConnected;if(isConnected){_context2.next=4;break;}Toast.show({text:'拍謝 網路連不到! 等一下再試試看',buttonText:'Okay',position:\"top\",type:\"warning\",duration:2000});return _context2.abrupt(\"return\");case 4:this.setState({isLoading:true});_this$props$sleep3=this.props.sleep,newDataForCreate=_this$props$sleep3.newDataForCreate,oldDataForEdit=_this$props$sleep3.oldDataForEdit;if(!newDataForCreate.size){_context2.next=16;break;}_context2.next=9;return _regeneratorRuntime.awrap(this.createRecord());case 9:createSleepRecordRes=_context2.sent;if(!createSleepRecordRes.success){_context2.next=14;break;}this.props.createSleepRecordSuccess();_context2.next=16;break;case 14:this.props.createSleepRecordFail();return _context2.abrupt(\"return\");case 16:if(!oldDataForEdit.size){_context2.next=26;break;}_context2.next=19;return _regeneratorRuntime.awrap(this.editRecord());case 19:editSleepRecordRes=_context2.sent;if(!editSleepRecordRes.success){_context2.next=24;break;}this.props.editSleepRecordSuccess();_context2.next=26;break;case 24:this.props.editSleepRecordFail();return _context2.abrupt(\"return\");case 26:this.props.navigation.goBack();case 27:case\"end\":return _context2.stop();}}},null,this,null,Promise);}},{key:\"createRecord\",value:function createRecord(){var _this$props$sleep4,newDataForCreate,records,data_objs,request_body,createSleepRecordRes;return _regeneratorRuntime.async(function createRecord$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this$props$sleep4=this.props.sleep,newDataForCreate=_this$props$sleep4.newDataForCreate,records=_this$props$sleep4.records;data_objs=[];newDataForCreate.forEach(function(record_id){data_objs.push(_objectSpread({},records.by_id[record_id]));});this.normalize(data_objs);request_body={date:formatDate(this.state.date),data_objs:data_objs};_context3.next=7;return _regeneratorRuntime.awrap(fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep',{method:'POST',headers:{Accept:'application/json','Content-Type':'application/json'},body:JSON.stringify(request_body)}).then(function(res){return res.json();}).then(function(resJson){if(resJson['statusCode']>200){return{success:false,status_code:resJson['statusCode'],data:resJson.message};}return{success:true,status_code:200,data:resJson};}).catch(function(err){return{success:false,status_code:500,data:err};}));case 7:createSleepRecordRes=_context3.sent;return _context3.abrupt(\"return\",createSleepRecordRes);case 9:case\"end\":return _context3.stop();}}},null,this,null,Promise);}},{key:\"editRecord\",value:function editRecord(){var _this$props$sleep5,oldDataForEdit,records,data_objs,request_body,editRecordRes;return _regeneratorRuntime.async(function editRecord$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this$props$sleep5=this.props.sleep,oldDataForEdit=_this$props$sleep5.oldDataForEdit,records=_this$props$sleep5.records;data_objs=[];oldDataForEdit.forEach(function(record_id){data_objs.push(_objectSpread({record_id:record_id},records.by_id[record_id]));});this.normalize(data_objs);request_body={date:formatDate(new Date()),data_objs:data_objs};_context4.next=7;return _regeneratorRuntime.awrap(fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep',{method:'PUT',headers:{Accept:'application/json','Content-Type':'application/json'},body:JSON.stringify(request_body)}).then(function(res){return res.json();}).then(function(resJson){if(resJson['statusCode']>200){return{success:false,status_code:resJson['statusCode'],data:resJson.message};}return{success:true,status_code:200,data:resJson};}).catch(function(err){return{success:false,status_code:500,data:err};}));case 7:editRecordRes=_context4.sent;return _context4.abrupt(\"return\",editRecordRes);case 9:case\"end\":return _context4.stop();}}},null,this,null,Promise);}},{key:\"confirmToRemoveRecord\",value:function confirmToRemoveRecord(record_id,student_id){var _this3=this;Alert.alert('確定要刪除？','',[{text:'Yes',onPress:function onPress(){return _this3.removeRecord(record_id,student_id);}},{text:'Cancel',style:'cancel'}]);}},{key:\"removeRecord\",value:function removeRecord(record_id,student_id){var _this4=this;var newDataForCreate=this.props.sleep.newDataForCreate;var isConnected=this.props.class.isConnected;if(newDataForCreate.has(record_id)){this.props.removeSleepRecordSuccess(record_id,student_id);return;}if(!isConnected){Toast.show({text:'拍謝 網路連不到! 等一下再試試看',buttonText:'Okay',position:\"top\",type:\"warning\",duration:2000});return;}var query=\"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep\";fetch(query,{method:'DELETE',headers:{Accept:'application/json','Content-Type':'application/json'},body:JSON.stringify({record_id:record_id})}).then(function(res){return res.json();}).then(function(resJson){var statusCode=resJson.statusCode,message=resJson.message;if(statusCode>200||message==='Internal Server Error'){_this4.props.removeSleepRecordFail(message);return{success:false,statusCode:statusCode,message:message};}_this4.props.removeSleepRecordSuccess(record_id,student_id);return{success:true,statusCode:statusCode,message:message};}).catch(function(err){_this4.props.removeSleepRecordFail(err);return{success:false,message:err};});}},{key:\"normalize\",value:function normalize(data_objs){for(var i=0;i<data_objs.length;i++){data_objs[i].sleep_time=formatTime(data_objs[i].sleep_time);data_objs[i].wake_time=data_objs[i].wake_time===null?null:formatTime(data_objs[i].wake_time);}}},{key:\"render\",value:function render(){var _this5=this;if(this.props.sleep.errorMessage!==''){Alert.alert('Add new record fail',this.props.sleep.errorMessage,[{text:'OK',onPress:function onPress(){return _this5.props.clearSleeplogErrorMessage();}}]);}var records_with_error=this.props.sleep.records_with_error;var _this$state=this.state,showDateTimeModal=_this$state.showDateTimeModal,start_time=_this$state.start_time,date=_this$state.date;if(this.state.isLoading){return React.createElement(Reloading,null);}return React.createElement(Container,null,showDateTimeModal?React.createElement(TimeModal,{start_date:start_time,datetime_type:'time',hideModal:function hideModal(){return _this5.setState({showDateTimeModal:false});},selectDatetimeConfirm:function selectDatetimeConfirm(time){return _this5.updateReducerTime(_this5.state.index,time);},minDatetime:null,maxDatetime:null}):null,React.createElement(View,{style:styles.subHeading},React.createElement(View,{style:{flex:1,alignItems:'center'}},React.createElement(Text,{style:{fontSize:40}},date.getFullYear()+'.'+(date.getMonth()+1)+'.'+date.getDate())),React.createElement(View,{style:{flex:1,justifyContent:'center'}},React.createElement(TouchableHighlight,{style:{alignSelf:'flex-end',backgroundColor:'#dcf3d0',padding:10,marginRight:50},onPress:this.handleSend,underlayColor:\"#00c07f\"},React.createElement(Text,{style:{fontSize:40,color:'grey'}},\"\\u9001\\u51FA\")))),React.createElement(Content,{contentContainerStyle:{alignItems:'center'}},Object.keys(this.props.class.students).map(function(student_id){var record_id_array=_this5.props.sleep.by_student_id[student_id];var records=_this5.props.sleep.records.by_id;var last_record=record_id_array.length>0?records[record_id_array[record_id_array.length-1]]:null;var current_sleep_time=last_record?last_record.sleep_time:null;var current_wake_time=last_record?last_record.wake_time:null;return React.createElement(View,{key:student_id,style:{width:'98%'}},React.createElement(Card,{style:{flex:1,paddingVertical:15}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{flex:1,justifyContent:'center',alignItems:'center'}},React.createElement(TouchableHighlight,{key:student_id,style:styles.thumbnail,onPress:function onPress(){return _this5.handleOnClick(student_id);}},React.createElement(Image,{source:_this5.props.class.students[student_id].profile_picture===''?require(\"../../../assets/icon-thumbnail.png\"):{uri:_this5.props.class.students[student_id].profile_picture},style:{width:140,height:140,borderRadius:70,borderWidth:8,borderColor:current_sleep_time!==null?current_wake_time===null?'#ffe1d0':'#dcf3d0':'#dcf3d0'}}))),React.createElement(View,{style:{flex:3}},React.createElement(View,{style:{flex:1,flexDirection:'row',padding:10}},React.createElement(View,{style:{flex:1}},React.createElement(Text,{style:{fontSize:30}},_this5.props.class.students[student_id].name)),React.createElement(View,{style:{flex:1,alignItems:'flex-end'}},_this5.hasUnsentRecord(student_id)?React.createElement(Text,{style:{color:'red',fontSize:15}},\"\\u672A\\u9001\\u51FA\"):null)),React.createElement(View,{style:styles.cardBody},React.createElement(View,{style:{width:'40%',height:'100%',paddingLeft:5}},React.createElement(Text,{style:{fontSize:20}},\"\\u5F9E\")),React.createElement(View,{style:{width:'40%',height:'100%',paddingLeft:5}},React.createElement(Text,{style:{fontSize:20}},\"\\u5230\"))),record_id_array.map(function(record_id,index){var _records$record_id=records[record_id],sleep_time=_records$record_id.sleep_time,wake_time=_records$record_id.wake_time;return React.createElement(View,{key:record_id,style:_objectSpread(_objectSpread({},styles.cardBody),{},{borderWidth:2,borderColor:records_with_error.has(record_id)?'red':'white'})},React.createElement(View,{style:{width:'35%',marginRight:'3%',height:'100%'}},React.createElement(TouchableHighlight,{style:{flex:1,justifyContent:'center',backgroundColor:'#fef6dd',borderRadius:10},onPress:function onPress(){return _this5.setTime('sleep',student_id,index,sleep_time);}},sleep_time===null?React.createElement(Text,{style:{fontSize:30,textAlign:'center'}},\"\\u9078\\u64C7\\u6642\\u9593\"):React.createElement(Text,{style:{fontSize:35,textAlign:'center'}},sleep_time.getHours()+':'+sleep_time.getMinutes()))),React.createElement(View,{style:{width:'35%',marginRight:'3%',height:'100%'}},React.createElement(TouchableHighlight,{style:{flex:1,justifyContent:'center',backgroundColor:'#fef6dd',borderRadius:10},onPress:function onPress(){return _this5.setTime('wake',student_id,index,wake_time);},onLongPress:function onLongPress(){return _this5.confirmToRemoveWakeTime(record_id,index,student_id);}},wake_time===null?React.createElement(Text,{style:{fontSize:30,textAlign:'center'}},\"\\u9078\\u64C7\\u6642\\u9593\"):React.createElement(Text,{style:{fontSize:35,textAlign:'center'}},wake_time.getHours()+':'+wake_time.getMinutes()))),React.createElement(View,{style:{width:'20%',marginRight:'4%',height:'100%'}},React.createElement(TouchableHighlight,{style:{flex:1,justifyContent:'center',backgroundColor:'#ffe1d0',borderRadius:10},onPress:function onPress(){return _this5.confirmToRemoveRecord(record_id,student_id);}},React.createElement(Text,{style:{fontSize:30,textAlign:'center'}},\"\\u79FB\\u9664\"))));})))));})));}}]);return TeacherSleepLog;}(React.Component);var styles=StyleSheet.create({thumbnail:{},subHeading:{flexDirection:'row',alignItems:'center'},cardBody:{flex:1,flexDirection:'row',marginVertical:6}});var mapStateToProps=function mapStateToProps(state){return{class:state.classInfo,sleep:state.sleep};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return _objectSpread({},bindActionCreators({setSleepTime:setSleepTime,setWakeTime:setWakeTime,fetchClassSleepData:fetchClassSleepData,clearPendingSleepUpdate:clearPendingSleepUpdate,createSleepRecordSuccess:createSleepRecordSuccess,createSleepRecordFail:createSleepRecordFail,editSleepRecordSuccess:editSleepRecordSuccess,editSleepRecordFail:editSleepRecordFail,removeSleepRecord:removeSleepRecord,removeSleepRecordSuccess:removeSleepRecordSuccess,removeSleepRecordFail:removeSleepRecordFail,alertSleeplogErrorMessage:alertSleeplogErrorMessage,clearSleeplogErrorMessage:clearSleeplogErrorMessage,removeWakeTime:removeWakeTime,markRecordError:markRecordError,markRecordCorrect:markRecordCorrect},dispatch));};export default connect(mapStateToProps,mapDispatchToProps)(TeacherSleepLog);","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/teacher/logs/sleeplog.js"],"names":["React","Container","Content","Text","View","Card","Toast","connect","bindActionCreators","setSleepTime","setWakeTime","fetchClassSleepData","clearPendingSleepUpdate","createSleepRecordSuccess","createSleepRecordFail","editSleepRecordSuccess","editSleepRecordFail","removeSleepRecord","removeSleepRecordSuccess","removeSleepRecordFail","alertSleeplogErrorMessage","clearSleeplogErrorMessage","removeWakeTime","markRecordError","markRecordCorrect","formatDate","formatTime","fetchClassData","Reloading","TimeModal","TeacherSleepLog","props","state","isLoading","date","Date","showIOSDatePicker","student_id","index","recordType","teacher_id","confirmDelete","showDateTimeModal","handleOnClick","bind","handleSend","updateReducerTime","setTime","sleep","newDataForCreate","oldDataForEdit","isConnected","class","route","params","setState","size","show","text","buttonText","position","type","duration","start_date","setDate","getDate","end_date","class_id","sleepData","denormalize","data","records","all_id","length","by_id","record_id","sleep_time","wake_time","by_student_id","record_id_array","hasUnsentRecord","i","has","last_record","current_wake_time","checkLastRecord","n","last_record_id","getTime","last_second_record_id","last_second_record","start_time","time","checkRecord","record","records_with_error","prev_record_id","next_record_id","prev_record","next_record","Alert","alert","onPress","style","createRecord","createSleepRecordRes","success","editRecord","editSleepRecordRes","navigation","goBack","data_objs","forEach","push","normalize","request_body","fetch","method","headers","Accept","body","JSON","stringify","then","res","json","resJson","status_code","message","catch","err","editRecordRes","removeRecord","query","statusCode","errorMessage","styles","subHeading","flex","alignItems","fontSize","getFullYear","getMonth","justifyContent","alignSelf","backgroundColor","padding","marginRight","color","Object","keys","students","map","current_sleep_time","width","paddingVertical","flexDirection","thumbnail","profile_picture","require","uri","height","borderRadius","borderWidth","borderColor","name","cardBody","paddingLeft","textAlign","getHours","getMinutes","confirmToRemoveWakeTime","confirmToRemoveRecord","Component","StyleSheet","create","marginVertical","mapStateToProps","classInfo","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { StyleSheet, Image, TouchableHighlight, Alert } from 'react-native'\nimport { Container, Content, Text, View, Card, Toast} from 'native-base'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport {\n    setSleepTime,\n    setWakeTime,\n    fetchClassSleepData,\n    clearPendingSleepUpdate,\n    createSleepRecordSuccess,\n    createSleepRecordFail,\n    editSleepRecordSuccess,\n    editSleepRecordFail,\n    removeSleepRecord,\n    removeSleepRecordSuccess,\n    removeSleepRecordFail,\n    alertSleeplogErrorMessage,\n    clearSleeplogErrorMessage,\n    removeWakeTime,\n    markRecordError,\n    markRecordCorrect\n} from '../../../redux/school/actions/index'\nimport { formatDate, formatTime, fetchClassData } from '../../util'\nimport Reloading from '../../reloading'\nimport TimeModal from '../../parent/timemodal'\n\n\nclass TeacherSleepLog extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            isLoading: true,\n            date: new Date(),\n            showIOSDatePicker: false,\n            student_id: '',\n            index: -1,\n            recordType: '',\n            teacher_id: '',\n            confirmDelete: false,\n            showDateTimeModal: false\n        }\n        this.handleOnClick = this.handleOnClick.bind(this)\n        this.handleSend = this.handleSend.bind(this)\n        this.updateReducerTime = this.updateReducerTime.bind(this)\n        this.setTime = this.setTime.bind(this)\n    }\n\n    componentDidMount() {\n        const { newDataForCreate, oldDataForEdit } = this.props.sleep\n        const { isConnected } = this.props.class\n        const { teacher_id } = this.props.route.params\n        this.setState({ teacher_id })\n        if ((newDataForCreate.size + oldDataForEdit.size === 0) && isConnected) {\n            this.fetchClassData()\n        }\n        else {\n            this.setState({\n                isLoading: false\n            })\n        }\n\n        if (!isConnected) {\n            Toast.show({\n                text: '拍謝 網路連不到! 等一下再試試看',\n                buttonText: 'Okay',\n                position: \"top\",\n                type: \"warning\",\n                duration: 2000\n            })\n        }\n    }\n\n    async fetchClassData() {\n        const date = new Date()\n        const start_date = formatDate(date)\n        date.setDate(date.getDate() + 1)\n        const end_date = formatDate(date)\n        const sleepData = await fetchClassData('sleep', this.props.class.class_id, start_date, end_date)\n        this.denormalize(sleepData)\n        this.props.fetchClassSleepData(sleepData.data)\n        this.setState({\n            isLoading: false\n        })\n    }\n\n    denormalize(sleepData) {\n        if (!sleepData.data.records.all_id.length) {\n            return\n        }\n        const { by_id } = sleepData.data.records\n        for (var record_id in by_id) {\n            by_id[record_id].sleep_time = new Date(by_id[record_id].sleep_time)\n            by_id[record_id].wake_time = by_id[record_id].wake_time === null ? null : new Date(by_id[record_id].wake_time)\n        }\n        sleepData.data.records.by_id = by_id\n    }\n\n    hasUnsentRecord(student_id) {\n        const { newDataForCreate, oldDataForEdit, by_student_id } = this.props.sleep\n        record_id_array = by_student_id[student_id]\n        var hasUnsentRecord = false\n        for (var i = 0; i < record_id_array.length; i++) {\n            if (newDataForCreate.has(record_id_array[i]) || oldDataForEdit.has(record_id_array[i])) {\n                hasUnsentRecord = true\n                break\n            }\n        }\n        return hasUnsentRecord\n    }\n\n    handleOnClick(student_id) {\n        const record_id_array = this.props.sleep.by_student_id[student_id]\n        const records = this.props.sleep.records.by_id\n        const last_record = record_id_array.length > 0 ? records[record_id_array[record_id_array.length - 1]] : null\n        const current_wake_time = last_record ? last_record.wake_time : null\n\n        if (!record_id_array.length || current_wake_time) {\n            this.props.setSleepTime(student_id, null, new Date(), this.state.teacher_id)\n        } else {\n            this.props.setWakeTime(student_id, record_id_array.length - 1, new Date(), this.state.teacher_id)\n        }\n        this.checkLastRecord(student_id, records, record_id_array)\n    }\n\n    checkLastRecord(student_id, records, record_id_array) {\n        const n = record_id_array.length\n        const last_record_id = record_id_array[record_id_array.length - 1]\n        const last_record = records[last_record_id]\n        if (last_record.wake_time !== null && last_record.sleep_time.getTime() >= last_record.wake_time.getTime()) {\n            this.props.markRecordError([last_record_id])\n        } \n        \n        if (n > 1) {\n            const last_second_record_id = record_id_array[record_id_array.length - 2]\n            const last_second_record = records[last_second_record_id]\n            if (last_record.sleep_time >= last_second_record.sleep_time && last_record.sleep_time <= last_second_record.wake_time) {\n                this.props.markRecordError([last_record_id])\n            }\n        }\n    }\n\n    setTime(recordType, student_id, index, start_time) {\n        this.setState({\n            student_id,\n            index,\n            recordType,\n            showDateTimeModal: true,\n            start_time: start_time ? start_time : new Date()\n        })\n    }\n\n    updateReducerTime(index, time) {\n        this.setState({ showDateTimeModal: false })\n        if (this.state.recordType === 'sleep') {\n            this.props.setSleepTime(this.state.student_id, index, time, this.state.teacher_id)\n        } else {\n            this.props.setWakeTime(this.state.student_id, index, time, this.state.teacher_id)\n        }\n        this.checkRecord(this.state.student_id, index)\n    }\n\n    checkRecord(student_id, index) {\n        const record_id_array = this.props.sleep.by_student_id[student_id]\n        const records = this.props.sleep.records.by_id\n        const record_id = record_id_array[index]\n        const record = records[record_id]\n        const { records_with_error } = this.props.sleep\n        let prev_record_id = null\n        let next_record_id = null\n\n        if (index < 0 || index > record_id_array.length - 1) {\n            return\n        }\n\n        if (record.wake_time !== null) {\n            if(record.sleep_time.getTime() >= record.wake_time.getTime()) {\n                this.props.markRecordError([record_id])\n                return\n            }\n        }\n\n        if (index > 0) {\n            prev_record_id = record_id_array[index-1]\n            const prev_record = records[prev_record_id]\n            if (//record.sleep_time.getTime() >= prev_record.sleep_time.getTime() && \n                prev_record.wake_time !== null &&\n                record.sleep_time.getTime() <= prev_record.wake_time.getTime()) {\n                this.props.markRecordError([record_id])\n                return\n            }\n        }\n\n        if (index < record_id_array.length - 1) {\n            next_record_id = record_id_array[index+1]\n            const next_record = records[next_record_id]\n            if (record.wake_time >= next_record.sleep_time) {\n                this.props.markRecordError([record_id])\n                return\n            }\n        }\n\n        this.props.markRecordCorrect(record_id)\n\n        if (prev_record_id !== null && records_with_error.has(prev_record_id)) {\n            this.checkRecord(student_id, index-1)\n            // console.log('records_with_error.has(prev_record_id: ', records_with_error.has(prev_record_id))\n        }\n\n        if (next_record_id !== null && records_with_error.has(next_record_id)) {\n            // console.log('records_with_error.has(next_record_id: ', records_with_error.has(next_record_id))\n            this.checkRecord(student_id, index+1)\n        }\n    }\n\n    confirmToRemoveWakeTime(record_id, index, student_id) {\n        const record_id_array = this.props.sleep.by_student_id[student_id]\n        if (index !== record_id_array.length - 1) {\n            // cannot remove wake time if it is not the most recent record\n            this.props.alertSleeplogErrorMessage('這個睡眠記錄並不能刪除，只能改選')\n            return\n        }\n        Alert.alert(\n            '確定要刪除?',\n            '',\n            [\n                { text: 'Yes', onPress: () => this.props.removeWakeTime(record_id, this.state.teacher_id) },\n                { text: 'Cancel', style: 'cancel'}]\n        )\n    }\n\n    async handleSend() {\n        const { isConnected } = this.props.class\n        if (!isConnected) {\n            Toast.show({\n                text: '拍謝 網路連不到! 等一下再試試看',\n                buttonText: 'Okay',\n                position: \"top\",\n                type: \"warning\",\n                duration: 2000\n            })\n            return\n        }\n        this.setState({\n            isLoading: true\n        })\n        const { newDataForCreate, oldDataForEdit } = this.props.sleep\n        \n        if (newDataForCreate.size) {\n            const createSleepRecordRes = await this.createRecord()\n            if (createSleepRecordRes.success) {\n                // console.log('SUCCESS')\n                this.props.createSleepRecordSuccess()\n            } else {\n                this.props.createSleepRecordFail()\n                return\n            }\n        }\n\n        if (oldDataForEdit.size) {\n            const editSleepRecordRes = await this.editRecord()\n            if (editSleepRecordRes.success) {\n                this.props.editSleepRecordSuccess()\n            } else {\n                this.props.editSleepRecordFail()\n                return\n            }\n        }\n\n        this.props.navigation.goBack()\n    }\n\n    async createRecord() {\n        const { newDataForCreate, records } = this.props.sleep\n        \n        const data_objs = []\n        newDataForCreate.forEach(record_id => {\n            data_objs.push({\n                ...records.by_id[record_id]\n            })\n        })\n\n        this.normalize(data_objs)\n\n        var request_body = {\n            date: formatDate(this.state.date),\n            data_objs\n        }\n\n        const createSleepRecordRes = await fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep', {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(request_body)\n        })\n            .then(res => res.json())\n            .then(resJson => {\n                // console.log('sleep resJson: ', resJson)\n                if (resJson['statusCode'] > 200) {\n                    return {\n                        success: false,\n                        status_code: resJson['statusCode'],\n                        data: resJson.message\n                    }\n                }\n                return {\n                    success: true,\n                    status_code: 200,\n                    data: resJson\n                }\n            })\n            .catch(err => {\n                return {\n                    success: false,\n                    status_code: 500,\n                    data: err\n                }\n            })\n        return createSleepRecordRes\n    }\n\n    async editRecord() {\n        const { oldDataForEdit, records } = this.props.sleep\n        const data_objs = []\n        oldDataForEdit.forEach(record_id => {\n            data_objs.push({\n                record_id,\n                ...records.by_id[record_id]\n            })\n        })\n\n        this.normalize(data_objs)\n\n        const request_body = {\n            date: formatDate(new Date()),\n            data_objs\n        }\n\n        const editRecordRes = await fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep', {\n            method: 'PUT',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(request_body)\n        }).then(res => res.json())\n        .then(resJson => {\n            if (resJson['statusCode'] > 200) {\n                return {\n                    success: false,\n                    status_code: resJson['statusCode'],\n                    data: resJson.message\n                }\n            }\n            return {\n                success: true,\n                status_code: 200,\n                data: resJson\n            }\n        })\n        .catch(err => {\n            return {\n                success: false,\n                status_code: 500,\n                data: err\n            }\n        })\n        return editRecordRes\n    }\n\n    confirmToRemoveRecord(record_id, student_id) {\n        Alert.alert(\n            '確定要刪除？',\n            '',\n            [\n                { text: 'Yes', onPress: () => this.removeRecord(record_id, student_id) },\n                { text: 'Cancel', style: 'cancel' }\n            ]\n        )\n    }\n\n    removeRecord(record_id, student_id) {\n        const { newDataForCreate } = this.props.sleep\n        const { isConnected } = this.props.class\n\n        if (newDataForCreate.has(record_id)) {\n            this.props.removeSleepRecordSuccess(record_id, student_id)\n            return\n        }\n\n        if (!isConnected) {\n            Toast.show({\n                text: '拍謝 網路連不到! 等一下再試試看',\n                buttonText: 'Okay',\n                position: \"top\",\n                type: \"warning\",\n                duration: 2000\n            })\n            return\n        }\n\n        const query = `https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep`\n        fetch(query, {\n            method: 'DELETE',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                record_id\n            })\n        })\n            .then(res => res.json())\n            .then(resJson => {\n                const { statusCode, message } = resJson\n                if (statusCode > 200 || message === 'Internal Server Error') {\n                    this.props.removeSleepRecordFail(message)\n                    return {\n                        success: false,\n                        statusCode,\n                        message\n                    }\n                }\n                this.props.removeSleepRecordSuccess(record_id, student_id)\n                return {\n                    success: true,\n                    statusCode,\n                    message\n                }\n            })\n            .catch(err => {\n                this.props.removeSleepRecordFail(err)\n                return {\n                    success: false,\n                    message: err\n            }\n        })\n    }\n\n    normalize(data_objs) {\n        for (var i = 0; i < data_objs.length; i++) {\n            data_objs[i].sleep_time = formatTime(data_objs[i].sleep_time)\n            data_objs[i].wake_time = data_objs[i].wake_time === null ? null : formatTime(data_objs[i].wake_time)\n        }\n    }\n\n    render() {\n        if (this.props.sleep.errorMessage !== ''){\n            Alert.alert(\n                'Add new record fail',\n                this.props.sleep.errorMessage,\n                [{text: 'OK', onPress: () => this.props.clearSleeplogErrorMessage()}]\n            )\n        }\n        const { records_with_error } = this.props.sleep\n        const { showDateTimeModal, start_time, date } = this.state\n        // console.log('records_with_error: ', records_with_error)\n        // console.log('showDateTimeModal: ', showDateTimeModal)\n        if (this.state.isLoading) {\n            return <Reloading />\n        }\n        return (\n            <Container>\n                {showDateTimeModal ?\n                    <TimeModal\n                        start_date={start_time}\n                        datetime_type={'time'}\n                        hideModal={() => this.setState({ showDateTimeModal: false })}\n                        selectDatetimeConfirm={(time) => this.updateReducerTime(this.state.index, time)}\n                        minDatetime={null}\n                        maxDatetime={null}\n                    />\n                    : null\n                }\n                <View style={styles.subHeading}>\n                    <View style={{ flex: 1, alignItems: 'center' }}>\n                        <Text style={{ fontSize: 40 }}>{date.getFullYear() + '.' + (date.getMonth()+1) + '.' + date.getDate()}</Text>\n                    </View>\n                    \n                    <View style={{ flex: 1, justifyContent: 'center' }}>\n                        <TouchableHighlight\n                            style={{ alignSelf: 'flex-end', backgroundColor: '#dcf3d0', padding: 10, marginRight: 50 }}\n                            onPress={this.handleSend}\n                            underlayColor=\"#00c07f\"\n                        >\n                            <Text style={{ fontSize: 40, color: 'grey' }}>送出</Text>\n                        </TouchableHighlight>\n                    </View>\n                </View>\n                <Content contentContainerStyle={{ alignItems: 'center' }}>\n                    {Object.keys(this.props.class.students).map((student_id) => {\n                        const record_id_array = this.props.sleep.by_student_id[student_id] // [record_id, ...]\n                        const records = this.props.sleep.records.by_id\n                        const last_record = record_id_array.length > 0 ? records[record_id_array[record_id_array.length - 1]] : null\n                        const current_sleep_time = last_record ? last_record.sleep_time : null\n                        const current_wake_time = last_record ? last_record.wake_time : null\n                        return(\n                            <View key={student_id} style={{ width: '98%' }}>\n                                <Card style={{ flex: 1, paddingVertical: 15 }}>\n                                    <View style={{ flex: 1, flexDirection: 'row' }}>\n                                        <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n                                            <TouchableHighlight\n                                                key={student_id}\n                                                style={styles.thumbnail}\n                                                onPress={() => this.handleOnClick(student_id)}>\n                                                <Image\n                                                    source={\n                                                        this.props.class.students[student_id].profile_picture === '' ?\n                                                            require('../../../assets/icon-thumbnail.png')\n                                                            : {uri: this.props.class.students[student_id].profile_picture}\n                                                    }\n                                                    style={{\n                                                        width: 140,\n                                                        height: 140,\n                                                        borderRadius: 70,\n                                                        borderWidth: 8,\n                                                        borderColor: current_sleep_time !== null ? (current_wake_time === null ? '#ffe1d0' : '#dcf3d0') : '#dcf3d0'\n                                                    }} />\n                                            </TouchableHighlight>\n                                        </View>\n                                        <View style={{ flex: 3 }}>\n                                            <View style={{ flex: 1, flexDirection: 'row', padding: 10 }}>\n                                                <View style={{ flex: 1 }}>\n                                                    <Text style={{ fontSize: 30 }}>{this.props.class.students[student_id].name}</Text>\n                                                </View>\n                                                <View style={{ flex: 1, alignItems: 'flex-end' }}>\n                                                    {this.hasUnsentRecord(student_id) ? \n                                                        <Text style={{ color: 'red', fontSize: 15 }}>未送出</Text>\n                                                    : null}\n                                                </View>\n                                            </View>\n                                            <View style={styles.cardBody}>\n                                                <View style={{ width: '40%', height: '100%', paddingLeft: 5 }}>\n                                                    <Text style={{ fontSize: 20 }}>從</Text>\n                                                </View>\n                                                <View style={{ width: '40%', height: '100%', paddingLeft: 5 }}>\n                                                    <Text style={{ fontSize: 20 }}>到</Text>\n                                                </View>\n                                            </View>\n                                            {record_id_array.map((record_id, index) => {\n                                                let { sleep_time, wake_time } = records[record_id]\n                                                return (\n                                                    <View key={record_id} style={{\n                                                        ...styles.cardBody, \n                                                        borderWidth: 2, \n                                                        borderColor: records_with_error.has(record_id) ? 'red' : 'white'\n                                                    }}>\n                                                        <View style={{ width: '35%', marginRight: '3%', height: '100%' }}>\n                                                            <TouchableHighlight\n                                                                style={{ flex: 1, justifyContent: 'center', backgroundColor: '#fef6dd', borderRadius: 10}}\n                                                                onPress={() => this.setTime('sleep', student_id, index, sleep_time)}\n                                                            >\n                                                                {sleep_time === null ?\n                                                                    <Text style={{ fontSize: 30, textAlign: 'center' }}>選擇時間</Text> :\n                                                                    <Text style={{ fontSize: 35, textAlign: 'center' }}>\n                                                                        {sleep_time.getHours() + ':' + sleep_time.getMinutes()}\n                                                                    </Text>}\n                                                            </TouchableHighlight>\n                                                        </View>\n                                                        <View style={{ width: '35%', marginRight: '3%', height: '100%' }}>\n                                                            <TouchableHighlight\n                                                                style={{ flex: 1, justifyContent: 'center', backgroundColor: '#fef6dd', borderRadius: 10 }}\n                                                                onPress={() => this.setTime('wake', student_id, index, wake_time)}\n                                                                onLongPress={() => this.confirmToRemoveWakeTime(record_id, index, student_id)}\n                                                            >\n                                                                {wake_time === null ?\n                                                                    <Text style={{ fontSize: 30, textAlign: 'center' }}>選擇時間</Text> :\n                                                                    <Text style={{ fontSize: 35, textAlign: 'center' }}>\n                                                                        {wake_time.getHours() + ':' + wake_time.getMinutes()}\n                                                                    </Text>}\n                                                            </TouchableHighlight>\n                                                        </View>\n                                                        <View style={{ width: '20%', marginRight: '4%', height: '100%' }}>\n                                                            <TouchableHighlight\n                                                                style={{ flex: 1, justifyContent: 'center', backgroundColor: '#ffe1d0', borderRadius: 10 }}\n                                                                onPress={() => this.confirmToRemoveRecord(record_id, student_id)}\n                                                            >\n                                                                <Text style={{ fontSize: 30, textAlign: 'center' }}>移除</Text>\n                                                            </TouchableHighlight>\n                                                        </View>\n                                                    </View>\n                                                )\n                                            })}\n                                        </View>\n                                    </View>\n                                </Card>\n                            </View>\n                        )\n                    })}\n                </Content>\n                {/* {this.state.showIOSDatePicker ?\n                    <View style={{ height: 200, justifyContent: 'center'}}>\n                        <DatePickerIOS\n                            mode={'time'}\n                            date={new Date()}\n                            onDateChange={(time) => this.updateReducerTime(this.state.index, time)}\n                        />\n                    </View> : null} */}\n            </Container>\n        )\n    }\n}\n\nconst styles = StyleSheet.create({\n    thumbnail: {\n        // width: 100,\n        // height: 100,\n        // borderRadius: 50,\n        // backgroundColor: 'transparent',\n        // marginLeft: -7,\n    },\n    subHeading: {\n        // width: 355,\n        // height: 45,\n        // marginTop: 10,\n        // padding: 10,\n        flexDirection: 'row',\n        alignItems: 'center',\n        // justifyContent: 'space-between',\n    },\n    cardBody: {\n        flex: 1,\n        flexDirection: 'row',\n        marginVertical: 6\n    },\n})\n\nconst mapStateToProps = (state) => {\n    return {\n        class: state.classInfo,\n        sleep: state.sleep\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        ...bindActionCreators({\n            setSleepTime,\n            setWakeTime,\n            fetchClassSleepData,\n            clearPendingSleepUpdate,\n            createSleepRecordSuccess,\n            createSleepRecordFail,\n            editSleepRecordSuccess,\n            editSleepRecordFail,\n            removeSleepRecord,\n            removeSleepRecordSuccess,\n            removeSleepRecordFail,\n            alertSleeplogErrorMessage,\n            clearSleeplogErrorMessage,\n            removeWakeTime,\n            markRecordError,\n            markRecordCorrect\n        }, dispatch)\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps) (TeacherSleepLog)"]},"metadata":{},"sourceType":"module"}