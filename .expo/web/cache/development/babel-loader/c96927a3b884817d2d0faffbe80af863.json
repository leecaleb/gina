{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/home/caleb_lee/gina_web_app/components/teacher/admin/registration.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function () { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableHighlight from \"react-native-web/dist/exports/TouchableHighlight\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Reloading from \"../../reloading\";\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport RegisterNewStudents from \"./registernewstudents\";\nimport RegisterParents from \"./registerparents\";\nimport { ScrollView } from 'react-native-gesture-handler';\nimport { fetchStudentsSuccess } from \"../../../redux/school/actions/index\";\nimport { get } from \"../../util\";\n\nvar Registration = function (_React$Component) {\n  _inherits(Registration, _React$Component);\n\n  var _super = _createSuper(Registration);\n\n  function Registration(props) {\n    var _this;\n\n    _classCallCheck(this, Registration);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      parentSignUpStatus: [false],\n      createFamilyProfileStatus: 'not_created'\n    };\n    return _this;\n  }\n\n  _createClass(Registration, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {}\n  }, {\n    key: \"createFamilyProfile\",\n    value: function createFamilyProfile() {\n      var _this2 = this;\n\n      var all_parents_signed_up = true;\n      var parentSignUpStatus = this.refs['parent'].getParentSignUpStatus();\n      parentSignUpStatus.forEach(function (status) {\n        all_parents_signed_up &= status;\n      });\n\n      if (!all_parents_signed_up) {\n        alert('Error! We cannot create family profile until all parents have been signed up');\n        return;\n      }\n\n      var parentDataArray = this.refs['parent'].getParentDataArray();\n      var studentDataArray = this.refs['student'].getStudentDataArray();\n      this.setState({\n        createFamilyProfileStatus: 'creating'\n      });\n      fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/family/', {\n        method: 'POST',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          parentDataArray: parentDataArray,\n          studentDataArray: studentDataArray\n        })\n      }).then(function (response) {\n        return response.json();\n      }).then(function (resJson) {\n        if (resJson.statusCode > 200 || resJson.message === 'Internal server error') {\n          alert('Error!' + resJson.message);\n        } else {\n          _this2.fetchStudentData();\n\n          Alert.alert('註冊成功!', '點選OK以離開頁面', [{\n            text: 'OK',\n            onPress: function onPress() {\n              return _this2.props.navigation.goBack();\n            }\n          }]);\n\n          _this2.setState({\n            createFamilyProfileStatus: 'created'\n          });\n        }\n      }).catch(function (err) {\n        console.error(err);\n      });\n    }\n  }, {\n    key: \"fetchStudentData\",\n    value: function fetchStudentData() {\n      var school_id, response, success, statusCode, message, data, students, classes;\n      return _regeneratorRuntime.async(function fetchStudentData$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              school_id = this.props.route.params.school_id;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(get(\"/school/\" + school_id + \"/student\"));\n\n            case 3:\n              response = _context.sent;\n              success = response.success, statusCode = response.statusCode, message = response.message, data = response.data;\n\n              if (success) {\n                _context.next = 8;\n                break;\n              }\n\n              alert('Sorry 取得學生資料時電腦出狀況了！請截圖和與工程師聯繫\\n\\n' + message);\n              return _context.abrupt(\"return\");\n\n            case 8:\n              students = data.students, classes = data.classes;\n              this.props.fetchStudentsSuccess(students, classes);\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, this, null, Promise);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          studentDataArray = _this$state.studentDataArray,\n          parentDataArray = _this$state.parentDataArray,\n          parentSignUpStatus = _this$state.parentSignUpStatus,\n          createFamilyProfileStatus = _this$state.createFamilyProfileStatus;\n      return React.createElement(KeyboardAvoidingView, {\n        style: {\n          flex: 1,\n          justifyContent: 'center',\n          alignItems: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 7\n        }\n      }, React.createElement(ScrollView, {\n        style: {\n          width: '100%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 9\n        }\n      }, React.createElement(RegisterNewStudents, {\n        ref: \"student\",\n        classes: this.props.classes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }\n      }), React.createElement(RegisterParents, {\n        ref: \"parent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }\n      }), React.createElement(View, {\n        style: {\n          flex: 1,\n          flexDirection: 'row',\n          justifyContent: 'space-around'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }\n      }, React.createElement(TouchableHighlight, {\n        style: {\n          flex: 1,\n          padding: 20,\n          backgroundColor: createFamilyProfileStatus === 'not_created' ? '#b5e9e9' : createFamilyProfileStatus === 'creating' ? '#b5e9e9' : '#00c07f',\n          justifyContent: 'center'\n        },\n        onPress: function onPress() {\n          return _this3.createFamilyProfile();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 13\n        }\n      }, createFamilyProfileStatus === 'not_created' ? React.createElement(Text, {\n        style: {\n          fontSize: 50,\n          textAlign: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 17\n        }\n      }, \"\\u5B8C\\u6210\") : createFamilyProfileStatus === 'creating' ? React.createElement(Reloading, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 19\n        }\n      }) : React.createElement(Text, {\n        style: {\n          fontSize: 50\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 19\n        }\n      }, \"SUCCESS\")), React.createElement(TouchableHighlight, {\n        style: {\n          flex: 1,\n          padding: 20,\n          backgroundColor: '#fa625f',\n          justifyContent: 'center'\n        },\n        onPress: function onPress() {\n          return _this3.props.navigation.goBack();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 13\n        }\n      }, React.createElement(Text, {\n        style: {\n          fontSize: 50,\n          textAlign: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 15\n        }\n      }, \"\\u8FD4\\u56DE\")))));\n    }\n  }]);\n\n  return Registration;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    classes: state.school.classes\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return _objectSpread({}, bindActionCreators({\n    fetchStudentsSuccess: fetchStudentsSuccess\n  }, dispatch));\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Registration);","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/teacher/admin/registration.js"],"names":["React","Reloading","connect","bindActionCreators","RegisterNewStudents","RegisterParents","ScrollView","fetchStudentsSuccess","get","Registration","props","state","parentSignUpStatus","createFamilyProfileStatus","all_parents_signed_up","refs","getParentSignUpStatus","forEach","status","alert","parentDataArray","getParentDataArray","studentDataArray","getStudentDataArray","setState","fetch","method","headers","Accept","body","JSON","stringify","then","response","json","resJson","statusCode","message","fetchStudentData","Alert","text","onPress","navigation","goBack","catch","err","console","error","school_id","route","params","success","data","students","classes","flex","justifyContent","alignItems","width","flexDirection","padding","backgroundColor","createFamilyProfile","fontSize","textAlign","Component","mapStateToProps","school","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { View, TextInput, TouchableHighlight, Text, Alert, KeyboardAvoidingView } from 'react-native'\n// import Auth from '@aws-amplify/auth'\nimport Reloading from '../../reloading'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport RegisterNewStudents from './registernewstudents'\nimport RegisterParents from './registerparents'\nimport { ScrollView } from 'react-native-gesture-handler'\nimport { fetchStudentsSuccess } from '../../../redux/school/actions/index'\nimport { get } from '../../util'\n\n/*\n1. Page where we connect parents to amplify for their login:\n  Auth.signUp({\n    username: 'USERNAME',\n    password: 'PASSWORD',\n    attributes: {\n        given_name: 'John',\n        family_name: 'Smith',\n        email: 'EMAIL@email.com'\n    }\n  })\n\n2. Save their credential in database in table users:\n  -id: 'UUID',\n  -firstName: 'John',\n  -lastName: 'Smith',\n  -email: 'EMAIL@email.com',\n  -username: 'USERNAME',\n  -role: 'parent'\n\n3. And initialize child/ren's data in database including but not limited to \n  -first_name,\n  -last_name,\n  -profile_picture,\n  -class_id <<====== list all classes and assign a class_id to child/ren\n\n****Leave sign up confirmation to parent side of the app(first time sign in)****\n\n*/\nclass Registration extends React.Component{\n  constructor(props) {\n    super(props)\n    this.state = {\n      \n      \n      parentSignUpStatus: [false],\n      createFamilyProfileStatus: 'not_created'\n    }\n  }\n\n  componentDidMount() {\n    //  fetch class info for class assinment or get it from redux store\n  }\n\n  \n\n  createFamilyProfile() {\n    let all_parents_signed_up = true\n    let parentSignUpStatus = this.refs['parent'].getParentSignUpStatus()\n    parentSignUpStatus.forEach(status => {\n      all_parents_signed_up &= status\n    })\n\n    if (!all_parents_signed_up) {\n      alert('Error! We cannot create family profile until all parents have been signed up')\n      return\n    }\n\n    let parentDataArray = this.refs['parent'].getParentDataArray()\n    let studentDataArray = this.refs['student'].getStudentDataArray()\n\n    this.setState({\n      createFamilyProfileStatus: 'creating'\n    })\n\n    fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/family/', {\n      method: 'POST',\n      headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        parentDataArray,  //name, email, username, role\n        studentDataArray  //name, class_id, profile_picture, blood_type\n      })\n    })\n    .then((response) => response.json())\n    .then((resJson) => {\n      // console.log(resJson)\n      if (resJson.statusCode > 200 || resJson.message === 'Internal server error') {\n        alert('Error!' + resJson.message)\n      } else {\n        this.fetchStudentData()\n        Alert.alert(\n          '註冊成功!',\n          '點選OK以離開頁面',\n          [\n              { text: 'OK', onPress: () => this.props.navigation.goBack()}\n          ]\n        )\n        this.setState({\n          createFamilyProfileStatus: 'created'\n        })\n      }\n    })\n    .catch((err) => {\n      console.error(err)\n    })\n  }\n\n  async fetchStudentData() {\n    const { school_id } = this.props.route.params\n    const response = await get(`/school/${school_id}/student`)\n    const { success, statusCode, message, data } = response\n    if (!success) {\n        alert('Sorry 取得學生資料時電腦出狀況了！請截圖和與工程師聯繫\\n\\n' + message)\n        return \n    }\n\n    const {students, classes} = data\n    this.props.fetchStudentsSuccess(students, classes)\n  }\n\n  render() {\n    const { studentDataArray, parentDataArray, parentSignUpStatus, createFamilyProfileStatus } = this.state\n    // console.log(this.props.classes)\n    return (\n      <KeyboardAvoidingView style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n        <ScrollView style={{ width: '100%'}}>\n\n          <RegisterNewStudents \n            ref=\"student\"\n            classes={this.props.classes}\n          />\n\n          <RegisterParents ref=\"parent\" />\n\n          <View style={{ flex: 1, flexDirection: 'row', justifyContent: 'space-around' }}>\n            <TouchableHighlight\n              style={{\n                flex: 1,\n                padding: 20,\n                backgroundColor: createFamilyProfileStatus === 'not_created' ?\n                  '#b5e9e9'\n                  : createFamilyProfileStatus === 'creating' ?\n                    '#b5e9e9'\n                  : '#00c07f',\n                  justifyContent: 'center'\n              }}\n              onPress={() => this.createFamilyProfile()}\n            >\n              {createFamilyProfileStatus === 'not_created' ?\n                <Text style={{ fontSize: 50, textAlign: 'center' }}>完成</Text>\n                : createFamilyProfileStatus === 'creating' ?\n                  <Reloading />\n                : <Text style={{ fontSize: 50 }}>SUCCESS</Text>\n              }\n            </TouchableHighlight>\n\n            <TouchableHighlight\n              style={{ flex:1, padding: 20, backgroundColor: '#fa625f', justifyContent: 'center' }}\n              onPress={() => this.props.navigation.goBack()}\n            >\n              <Text style={{ fontSize: 50, textAlign: 'center'}}>返回</Text>\n            </TouchableHighlight>\n          </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    )\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    classes: state.school.classes\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    ...bindActionCreators({fetchStudentsSuccess}, dispatch)\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps) (Registration)"]},"metadata":{},"sourceType":"module"}