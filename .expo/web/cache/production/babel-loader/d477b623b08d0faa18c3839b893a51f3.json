{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import Image from\"react-native-web/dist/exports/Image\";import{Card}from'native-base';import{formatDate,fetchData as _fetchData}from\"../util\";import Reloading from\"../reloading\";var SleepCard=function(_React$Component){_inherits(SleepCard,_React$Component);var _super=_createSuper(SleepCard);function SleepCard(props){var _this;_classCallCheck(this,SleepCard);_this=_super.call(this,props);_this.state={isLoading:true};_this.fetchData=_this.fetchData.bind(_assertThisInitialized(_this));return _this;}_createClass(SleepCard,[{key:\"componentDidMount\",value:function componentDidMount(){var date=this.props.date;this.fetchData(this.props.child_id,new Date(date.getTime()));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(this.props.date!==prevProps.date){this.setState({isLoading:true});this.fetchData(this.props.child_id,new Date(this.props.date.getTime()));}else if(this.props.child_id!==prevProps.child_id){this.setState({isLoading:true});this.fetchData(this.props.child_id,new Date(this.props.date.getTime()));}}},{key:\"fetchData\",value:function fetchData(child_id,date){var start_date,end_date,sleepData;return _regeneratorRuntime.async(function fetchData$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(date.getHours()<17)){_context.next=3;break;}this.setState({isLoading:false});return _context.abrupt(\"return\");case 3:start_date=formatDate(date);date.setDate(date.getDate()+1);end_date=formatDate(date);_context.next=8;return _regeneratorRuntime.awrap(_fetchData('sleep',child_id,start_date,end_date));case 8:sleepData=_context.sent;this.setState({sleepData:sleepData,isLoading:false});case 10:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"render\",value:function render(){var _this$state=this.state,sleepData=_this$state.sleepData,isLoading=_this$state.isLoading;var today=formatDate(this.props.date);return React.createElement(Card,{style:{width:'93%'}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{width:56,height:56,justifyContent:'center',alignItems:'center'}},React.createElement(Image,{source:require(\"../../assets/icon-sleep.png\"),style:{width:48,height:48}})),React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{paddingTop:8}},React.createElement(Text,{style:{fontSize:20}},\"\\u7761\\u7720\")),isLoading?React.createElement(Reloading,null):sleepData&&sleepData[today]?React.createElement(View,{style:{flex:1,paddingVertical:8}},React.createElement(View,{style:{flexDirection:'row',paddingBottom:5}},React.createElement(View,{style:{flex:1,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:15,textAlign:'center',color:'#606060'}},\"\\u5F9E\")),React.createElement(View,{style:{flex:1}}),React.createElement(View,{style:{flex:1,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:15,textAlign:'center',color:'#606060'}},\"\\u5230\"))),sleepData[today].map(function(record,index){var sleep_time=record.sleep_time,wake_time=record.wake_time,hours=record.hours,minutes=record.minutes;return React.createElement(View,{key:index,style:{flexDirection:'row'}},React.createElement(View,{style:{flex:1,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:25,textAlign:'center',color:'#404040'}},sleep_time)),React.createElement(View,{style:{flex:1,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:15,textAlign:'center',color:'#404040'}},hours,\"H \",minutes,\"M\")),React.createElement(View,{style:{flex:1,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:25,textAlign:'center',color:'#404040'}},wake_time)));})):React.createElement(View,{style:{flex:1,paddingVertical:8}},React.createElement(Text,{style:{fontSize:17}},\"\\u6C92\\u6709\\u65B0\\u7D00\\u9304\")))));}}]);return SleepCard;}(React.Component);export{SleepCard as default};","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/parent/sleepcard.js"],"names":["React","Card","formatDate","fetchData","Reloading","SleepCard","props","state","isLoading","bind","date","child_id","Date","getTime","prevProps","setState","getHours","start_date","setDate","getDate","end_date","sleepData","today","width","flex","flexDirection","height","justifyContent","alignItems","require","paddingTop","fontSize","paddingVertical","paddingBottom","textAlign","color","map","record","index","sleep_time","wake_time","hours","minutes","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { View, Text, Image } from 'react-native'\nimport { Card } from 'native-base'\nimport { formatDate, fetchData } from '../util';\nimport Reloading from '../reloading'\n\nexport default class SleepCard extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      isLoading: true\n    }\n    this.fetchData = this.fetchData.bind(this)\n  }\n\n  componentDidMount() {\n    const { date } = this.props\n    this.fetchData(this.props.child_id, new Date(date.getTime()))\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.date !== prevProps.date) {\n      this.setState({ isLoading: true })\n      this.fetchData(this.props.child_id, new Date(this.props.date.getTime()));\n    } else if (this.props.child_id !== prevProps.child_id) {\n      this.setState({ isLoading: true })\n      this.fetchData(this.props.child_id, new Date(this.props.date.getTime()));\n    }\n  }\n\n  async fetchData(child_id, date) {\n    if (date.getHours() < 17) {\n      this.setState({\n        isLoading: false\n      })\n      return\n    }\n    const start_date = formatDate(date)\n    date.setDate(date.getDate() + 1)\n    const end_date = formatDate(date)\n    const sleepData = await fetchData('sleep', child_id, start_date, end_date)\n    this.setState({\n      sleepData,\n      isLoading: false\n    })\n  }\n\n  render() {\n    const { sleepData, isLoading } = this.state\n    const today = formatDate(this.props.date)\n    return (\n      <Card style={{ width: '93%' }}>\n        <View style={{ flex: 1, flexDirection: 'row' }}>\n          <View style={{ width: 56, height: 56, justifyContent: 'center', alignItems: 'center'}}>\n            <Image\n              source={require('../../assets/icon-sleep.png')}\n              style={{\n                  width: 48,\n                  height: 48\n              }}\n            />\n          </View>\n          <View style={{ flex: 1 }}>\n            <View style={{ paddingTop: 8 }}>\n              <Text style={{ fontSize: 20 }}>睡眠</Text>\n            </View>\n            {isLoading ? \n              <Reloading />\n              : sleepData && sleepData[today] ?\n                <View style={{ flex: 1, paddingVertical: 8 }}>\n                  <View\n                    style={{ flexDirection: 'row', paddingBottom: 5 }}\n                  >\n                    <View style={{ flex: 1, justifyContent: 'center' }}>\n                      <Text style={{ fontSize: 15, textAlign: 'center', color: '#606060' }}>從</Text>\n                    </View>\n                    <View style={{ flex: 1}}>\n                    </View>\n                    <View style={{ flex: 1, justifyContent: 'center' }}>\n                      <Text style={{ fontSize: 15, textAlign: 'center', color: '#606060' }}>到</Text>\n                    </View>\n                  </View>\n                  {sleepData[today].map((record, index) => {\n                    const { sleep_time, wake_time, hours, minutes } = record\n                    return (\n                      <View\n                        key={index}\n                        style={{ flexDirection: 'row' }}\n                      >\n                        <View style={{ flex: 1, justifyContent: 'center' }}>\n                          <Text style={{ fontSize: 25, textAlign: 'center', color: '#404040' }}>{sleep_time}</Text>\n                        </View>\n                        <View style={{ flex: 1, justifyContent: 'center'}}>\n                          <Text style={{ fontSize: 15, textAlign: 'center', color: '#404040' }}>{hours}H {minutes}M</Text>\n                        </View>\n                        <View style={{ flex: 1, justifyContent: 'center' }}>\n                          <Text style={{ fontSize: 25, textAlign: 'center', color: '#404040' }}>{wake_time}</Text>\n                        </View>\n                      </View>\n                    )\n                  })}\n                </View>\n                : <View style={{ flex: 1, paddingVertical: 8 }}>\n                  <Text style={{ fontSize: 17 }}>沒有新紀錄</Text>\n                </View>\n            }\n          </View>\n        </View>\n      </Card>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}