{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Image from\"react-native-web/dist/exports/Image\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import Alert from\"react-native-web/dist/exports/Alert\";import Keyboard from\"react-native-web/dist/exports/Keyboard\";import{Container,Content,Card,CardItem,Body,Button,Toast}from'native-base';import{connect}from'react-redux';import Header from\"../../header\";import{bindActionCreators}from'redux';import{rateAppetite,clearRatings,setAllRatingsToGreat,fetchClassAppetiteData,onSendAppetiteSuccess,alertErrMessage,markWaterDrank,editFruitName,clearAppetiteErrorMessage,addStudentIdForUpdate}from\"../../../redux/school/actions/index\";import{formatDate,fetchClassData as _fetchClassData}from\"../../util\";var TeacherAppetiteLog=function(_React$Component){_inherits(TeacherAppetiteLog,_React$Component);var _super=_createSuper(TeacherAppetiteLog);function TeacherAppetiteLog(props){var _this;_classCallCheck(this,TeacherAppetiteLog);_this=_super.call(this,props);_this.state={isLoading:true,mealType:'',selectedForCustomize:new Set(),editingFruitType:false,students_with_records:[]};_this.handleRateFoodWellness=_this.handleRateFoodWellness.bind(_assertThisInitialized(_this));_this.handleSend=_this.handleSend.bind(_assertThisInitialized(_this));_this.handleClearAll=_this.handleClearAll.bind(_assertThisInitialized(_this));_this.handleSetAll=_this.handleSetAll.bind(_assertThisInitialized(_this));return _this;}_createClass(TeacherAppetiteLog,[{key:\"componentDidMount\",value:function componentDidMount(){var updatedStudents=this.props.appetite.updatedStudents;var isConnected=this.props.class.isConnected;if(updatedStudents.size>0||!isConnected){this.setState({isLoading:false});}else{this.fetchClassData();}if(!isConnected){Toast.show({text:'拍謝 網路連不到! 等一下再試試看',buttonText:'Okay',position:\"top\",type:\"warning\",duration:2000});}}},{key:\"fetchClassData\",value:function fetchClassData(){var date,start_date,end_date,appetiteData,_appetiteData$data$st,fruit_name,ratings;return _regeneratorRuntime.async(function fetchClassData$(_context){while(1){switch(_context.prev=_context.next){case 0:date=new Date();start_date=formatDate(date);date.setDate(date.getDate()+1);end_date=formatDate(date);_context.next=6;return _regeneratorRuntime.awrap(_fetchClassData('appetite',this.props.class.class_id,start_date,end_date));case 6:appetiteData=_context.sent;if(!(appetiteData.data[start_date]===undefined)){_context.next=9;break;}return _context.abrupt(\"return\");case 9:_appetiteData$data$st=appetiteData.data[start_date],fruit_name=_appetiteData$data$st.fruit_name,ratings=_appetiteData$data$st.ratings;this.props.fetchClassAppetiteData(fruit_name,ratings);this.setState({isLoading:false,students_with_records:Object.keys(ratings)});case 12:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"editFruitName\",value:function editFruitName(fruit_name){this.props.editFruitName(fruit_name);}},{key:\"fruitNameEditorOnBlur\",value:function fruitNameEditorOnBlur(){var students_with_records=this.state.students_with_records;this.setState({editingFruitType:false});if(this.props.appetite.fruit_name===''){this.props.editFruitName('水果');}if(students_with_records.length>1){this.props.addStudentIdForUpdate(students_with_records);}}},{key:\"handleRateFoodWellness\",value:function handleRateFoodWellness(student_id,rating){if(this.state.mealType===''){Toast.show({text:'請選擇餐時',buttonText:'Okay',position:'top',duration:3000});}else{var selectedForCustomize=this.state.selectedForCustomize;var teacher_id=this.props.route.params.teacher_id;selectedForCustomize.delete(student_id);this.setState({selectedForCustomize:selectedForCustomize});this.props.rateAppetite(student_id,this.state.mealType,rating,teacher_id);}}},{key:\"onClickOther\",value:function onClickOther(student_id){var _this$state=this.state,mealType=_this$state.mealType,selectedForCustomize=_this$state.selectedForCustomize;var teacher_id=this.props.route.params.teacher_id;if(mealType===''){Toast.show({text:'請選擇餐時',buttonText:'Okay',position:'top',duration:3000});}else{this.setState({selectedForCustomize:new Set([].concat(_toConsumableArray(selectedForCustomize),[student_id]))});this.props.rateAppetite(student_id,this.state.mealType,'',teacher_id);}}},{key:\"isRatingCustomized\",value:function isRatingCustomized(rating){var mealType=this.state.mealType;if(mealType===''){return false;}else if(rating==='Awesome'||rating==='Good'||rating==='Ok'||rating===''){return false;}return true;}},{key:\"onCustomizeRating\",value:function onCustomizeRating(student_id,customized_text){var teacher_id=this.props.route.params.teacher_id;this.props.rateAppetite(student_id,this.state.mealType,customized_text,teacher_id);}},{key:\"customizedRatingOnBlur\",value:function customizedRatingOnBlur(student_id){var selectedForCustomize=this.state.selectedForCustomize;selectedForCustomize.delete(student_id);this.setState({selectedForCustomize:selectedForCustomize});}},{key:\"markWaterDrank\",value:function markWaterDrank(student_id){var teacher_id=this.props.route.params.teacher_id;if(this.state.mealType===''){Toast.show({text:'請選擇餐時',buttonText:'Okay',position:'top',duration:3000});}else{this.props.markWaterDrank(student_id,this.state.mealType,teacher_id);}}},{key:\"handleSetAll\",value:function handleSetAll(){var teacher_id=this.props.route.params.teacher_id;if(this.state.mealType===''){Toast.show({text:'請選擇餐時',buttonText:'Okay',position:'top',duration:3000});}else{this.props.setAllRatingsToGreat(this.state.mealType,teacher_id);}}},{key:\"handleClearAll\",value:function handleClearAll(){if(this.state.mealType===''){Toast.show({text:'請選擇餐時',buttonText:'Okay',position:'top',duration:3000});}else{this.props.clearRatings(this.state.mealType);}}},{key:\"handleSend\",value:function handleSend(){var _this2=this;var isConnected=this.props.class.isConnected;var _this$props$appetite=this.props.appetite,updatedStudents=_this$props$appetite.updatedStudents,fruit_name=_this$props$appetite.fruit_name;var data_objs=[],appetite_log=this.props.appetite.ratings;if(updatedStudents.size===0){this.props.navigation.goBack();}if(!isConnected){Toast.show({text:'拍謝 網路連不到! 等一下再試試看',buttonText:'Okay',position:\"top\",type:\"warning\",duration:2000});return;}updatedStudents.forEach(function(student_id){var ratings=appetite_log[student_id];var data={student_id:student_id,b_rating:ratings.Breakfast,f_rating:ratings.Fruit,l_rating:ratings.Lunch,s_rating:ratings.Snack,teacher_id:ratings.teacher_id};data_objs.push(data);});var request_body={date:formatDate(new Date()),fruit_name:fruit_name,obj:data_objs};fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/appetite',{method:'POST',headers:{Accept:'application/json','Content-Type':'application/json'},body:JSON.stringify(request_body)}).then(function(res){return res.json();}).then(function(resJson){var statusCode=resJson.statusCode,message=resJson.message;if(statusCode>200||message==='Internal Server Error'){_this2.props.alertErrMessage(message);}else{_this2.props.onSendAppetiteSuccess();_this2.props.navigation.goBack();}}).catch(function(err){_this2.props.alertErrMessage(err);});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){}},{key:\"render\",value:function render(){var _this3=this;if(this.props.appetite.err_message!==''){Alert.alert('Error!',this.props.appetite.err_message,[{text:'OK',onPress:function onPress(){return _this3.props.clearAppetiteErrorMessage();}}]);}var _this$state2=this.state,mealType=_this$state2.mealType,selectedForCustomize=_this$state2.selectedForCustomize,editingFruitType=_this$state2.editingFruitType;var date=new Date();return React.createElement(KeyboardAvoidingView,{style:{flex:1,backgroundColor:mealType==='Breakfast'?'#ffe1d0':mealType==='Fruit'?'#ffddb7':mealType==='Lunch'?'#fff1b5':mealType==='Snack'?'#dcf3d0':'transparent'},enabled:true},React.createElement(View,{style:styles.subHeading},React.createElement(Text,{style:{fontSize:40}},date.getFullYear()+'.'+(date.getMonth()+1)+'.'+date.getDate()),React.createElement(TouchableHighlight,{style:{backgroundColor:'#b5e9e9',padding:10},onPress:this.handleSetAll},React.createElement(Text,{style:{color:'grey',fontSize:40}},\"\\u5168\\u8B9A\")),React.createElement(TouchableHighlight,{style:{backgroundColor:'#ffe1d0',padding:10},onPress:this.handleClearAll},React.createElement(Text,{style:{color:'grey',fontSize:40}},\"\\u5168\\u90E8\\u6E05\\u9664\")),React.createElement(TouchableHighlight,{style:{backgroundColor:'#dcf3d0',padding:10},onPress:this.handleSend},React.createElement(Text,{style:{color:'grey',fontSize:40}},\"\\u9001\\u51FA\"))),React.createElement(Content,{contentContainerStyle:{alignItems:'center'}},React.createElement(View,{style:styles.mealButtons},React.createElement(TouchableHighlight,{style:{backgroundColor:mealType==='Breakfast'?'#fa625f':'#ffe1d0',width:'23%',height:60,justifyContent:'center',marginHorizontal:'1%',padding:10},underlayColor:\"#fa625f\",onPress:function onPress(){return _this3.setState({mealType:'Breakfast',editingFruitType:false});}},React.createElement(Text,{style:styles.mealButtonText},\"\\u65E9\\u9910\")),React.createElement(TouchableHighlight,{style:{backgroundColor:mealType==='Fruit'?'#ff8944':'#ffddb7',width:'23%',height:60,justifyContent:'center',marginHorizontal:'1%'},underlayColor:\"#ff8944\",onPress:function onPress(){return _this3.setState({mealType:'Fruit'});},onLongPress:function onLongPress(){return _this3.setState({mealType:'Fruit',editingFruitType:true});}},editingFruitType?React.createElement(View,{style:{flex:1}},React.createElement(Text,{style:{paddingLeft:5}},\"\\u6C34\\u679C:\"),React.createElement(TextInput,{autoFocus:true,selectTextOnFocus:true,style:{width:'95%',alignSelf:'center',fontSize:25,textAlign:'center',color:'grey',borderWidth:1},onChangeText:function onChangeText(fruit_name){return _this3.editFruitName(fruit_name);},value:this.props.appetite.fruit_name,onBlur:function onBlur(){return _this3.fruitNameEditorOnBlur();}})):React.createElement(Text,{style:styles.mealButtonText},this.props.appetite.fruit_name)),React.createElement(TouchableHighlight,{style:{backgroundColor:mealType==='Lunch'?'#f4d41f':'#fff1b5',width:'23%',height:60,justifyContent:'center',marginHorizontal:'1%',padding:10},underlayColor:\"#f4d41f\",onPress:function onPress(){return _this3.setState({mealType:'Lunch',editingFruitType:false});}},React.createElement(Text,{style:styles.mealButtonText},\"\\u5348\\u9910\")),React.createElement(TouchableHighlight,{style:{backgroundColor:mealType==='Snack'?'#00c07f':'#dcf3d0',width:'23%',height:60,justifyContent:'center',marginHorizontal:'1%',padding:10},underlayColor:\"#00c07f\",onPress:function onPress(){return _this3.setState({mealType:'Snack',editingFruitType:false});}},React.createElement(Text,{style:styles.mealButtonText},\"\\u9EDE\\u5FC3\"))),Object.keys(this.props.class.students).map(function(student_id){var meal_rating=mealType===''?'':_this3.props.appetite.ratings[student_id][mealType].slice(0,-1);var water_drank=mealType===''?false:_this3.props.appetite.ratings[student_id][mealType].slice(-1)==='1';return React.createElement(View,{key:student_id,style:{width:'98%'}},React.createElement(Card,null,React.createElement(CardItem,null,React.createElement(View,{style:styles.childThumbnail},React.createElement(Image,{source:_this3.props.class.students[student_id].profile_picture===''?require(\"../../../assets/icon-thumbnail.png\"):{uri:_this3.props.class.students[student_id].profile_picture},style:styles.thumbnailImage})),React.createElement(View,{style:{width:'75%'}},React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{flex:1,alignItems:'center',justifyContent:'center'}},React.createElement(Text,{style:{fontSize:30,paddingLeft:18,alignSelf:'center'}},_this3.props.class.students[student_id].name)),React.createElement(View,{style:{flex:1,justifyContent:'center',alignItems:'center'}},React.createElement(TouchableHighlight,{style:{width:'80%',borderWidth:2,borderColor:'#368cbf',padding:10,justifyContent:'center',backgroundColor:water_drank?'#368cbf':'white'},onPress:function onPress(){return _this3.markWaterDrank(student_id);}},React.createElement(Text,{style:{textAlign:'center',color:water_drank?'#D3D3D3':'grey',fontSize:17}},\"\\u6709\\u559D\\u6C34\"))),React.createElement(View,{style:{flex:2,alignItems:'flex-end'}},_this3.props.appetite.updatedStudents.has(student_id)?React.createElement(Text,{style:{color:'red',fontSize:15}},\"\\u672A\\u9001\\u51FA\"):null)),React.createElement(View,{style:styles.cardBody},React.createElement(TouchableHighlight,{style:{width:'22%',height:'100%',margin:5,justifyContent:'center',backgroundColor:meal_rating==='Awesome'?'#368cbf':'#b5e9e9',padding:10},onPress:function onPress(){return _this3.handleRateFoodWellness(student_id,'Awesome');}},React.createElement(Text,{style:{textAlign:'center',color:meal_rating==='Awesome'?'#D3D3D3':'grey',fontSize:20}},\"\\u975E\\u5E38\\u597D\")),React.createElement(TouchableHighlight,{style:{width:'22%',height:'100%',margin:5,justifyContent:'center',backgroundColor:meal_rating==='Good'?'#368cbf':'#b5e9e9',padding:10},onPress:function onPress(){return _this3.handleRateFoodWellness(student_id,'Good');}},React.createElement(Text,{style:{textAlign:'center',color:meal_rating==='Good'?'#D3D3D3':'grey',fontSize:20}},\"\\u9084\\u4E0D\\u932F\")),React.createElement(TouchableHighlight,{style:{width:'22%',height:'100%',margin:5,justifyContent:'center',backgroundColor:meal_rating==='Ok'?'#368cbf':'#b5e9e9',padding:10},onPress:function onPress(){return _this3.handleRateFoodWellness(student_id,'Ok');}},React.createElement(Text,{style:{textAlign:'center',color:meal_rating==='Ok'?'#D3D3D3':'grey',fontSize:20}},\"\\u5403\\u4E0D\\u591A\")),React.createElement(TouchableHighlight,{style:{width:'22%',height:'100%',margin:5,justifyContent:'center',backgroundColor:_this3.isRatingCustomized(meal_rating)||selectedForCustomize.has(student_id)?'#368cbf':'#b5e9e9',padding:10},onPress:function onPress(){return _this3.onClickOther(student_id);}},_this3.isRatingCustomized(meal_rating)||selectedForCustomize.has(student_id)?React.createElement(TextInput,{style:{textAlign:'center',color:'#D3D3D3',fontSize:20},autoFocus:meal_rating===''?true:false,onChangeText:function onChangeText(customized_text){return _this3.onCustomizeRating(student_id,customized_text);},value:meal_rating,onBlur:function onBlur(){return _this3.customizedRatingOnBlur(student_id);}}):React.createElement(Text,{style:{textAlign:'center',color:_this3.isRatingCustomized(meal_rating)||selectedForCustomize.has(student_id)?'#D3D3D3':'grey',fontSize:20}},\"Other\"))))))));})));}}]);return TeacherAppetiteLog;}(React.Component);var styles=StyleSheet.create({childThumbnail:{width:'25%',justifyContent:'center',alignItems:'center'},cardBody:{flex:1,flexDirection:'row',alignItems:'center',justifyContent:'center'},foodButton:{width:70,alignSelf:'center',margin:5,justifyContent:'center',backgroundColor:'#b5e9e9'},thumbnailImage:{height:130,width:130,borderRadius:65},subHeading:{width:'99%',paddingHorizontal:'4%',flexDirection:'row',alignItems:'center',justifyContent:'space-between',zIndex:2},mealButtons:{width:'99%',marginVertical:15,flexDirection:'row',alignItems:'center',justifyContent:'center'},mealButtonText:{fontSize:30,textAlign:'center'},buttonText:{color:'grey',textAlign:'center'}});var mapStatesToProps=function mapStatesToProps(state){return{class:state.classInfo,appetite:state.appetite};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return _objectSpread({},bindActionCreators({rateAppetite:rateAppetite,clearRatings:clearRatings,setAllRatingsToGreat:setAllRatingsToGreat,fetchClassAppetiteData:fetchClassAppetiteData,onSendAppetiteSuccess:onSendAppetiteSuccess,alertErrMessage:alertErrMessage,markWaterDrank:markWaterDrank,editFruitName:editFruitName,clearAppetiteErrorMessage:clearAppetiteErrorMessage,addStudentIdForUpdate:addStudentIdForUpdate},dispatch));};export default connect(mapStatesToProps,mapDispatchToProps)(TeacherAppetiteLog);","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/teacher/logs/appetitelog.js"],"names":["React","Container","Content","Card","CardItem","Body","Button","Toast","connect","Header","bindActionCreators","rateAppetite","clearRatings","setAllRatingsToGreat","fetchClassAppetiteData","onSendAppetiteSuccess","alertErrMessage","markWaterDrank","editFruitName","clearAppetiteErrorMessage","addStudentIdForUpdate","formatDate","fetchClassData","TeacherAppetiteLog","props","state","isLoading","mealType","selectedForCustomize","Set","editingFruitType","students_with_records","handleRateFoodWellness","bind","handleSend","handleClearAll","handleSetAll","updatedStudents","appetite","isConnected","class","size","setState","show","text","buttonText","position","type","duration","date","Date","start_date","setDate","getDate","end_date","class_id","appetiteData","data","undefined","fruit_name","ratings","Object","keys","length","student_id","rating","teacher_id","route","params","delete","customized_text","data_objs","appetite_log","navigation","goBack","forEach","b_rating","Breakfast","f_rating","Fruit","l_rating","Lunch","s_rating","Snack","push","request_body","obj","fetch","method","headers","Accept","body","JSON","stringify","then","res","json","resJson","statusCode","message","catch","err","err_message","Alert","alert","onPress","flex","backgroundColor","styles","subHeading","fontSize","getFullYear","getMonth","padding","color","alignItems","mealButtons","width","height","justifyContent","marginHorizontal","mealButtonText","paddingLeft","alignSelf","textAlign","borderWidth","fruitNameEditorOnBlur","students","map","meal_rating","slice","water_drank","childThumbnail","profile_picture","require","uri","thumbnailImage","flexDirection","name","borderColor","has","cardBody","margin","isRatingCustomized","onClickOther","onCustomizeRating","customizedRatingOnBlur","Component","StyleSheet","create","foodButton","borderRadius","paddingHorizontal","zIndex","marginVertical","mapStatesToProps","classInfo","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { StyleSheet, Image, TouchableHighlight, TextInput, Text, View, KeyboardAvoidingView, Alert, Keyboard } from 'react-native'\nimport { Container, Content, Card, CardItem, Body, Button, Toast } from 'native-base'\nimport { connect } from 'react-redux';\nimport Header from '../../header'\nimport { bindActionCreators } from 'redux';\nimport {\n    rateAppetite,\n    clearRatings,\n    setAllRatingsToGreat,\n    fetchClassAppetiteData,\n    onSendAppetiteSuccess,\n    alertErrMessage,\n    markWaterDrank,\n    editFruitName,\n    clearAppetiteErrorMessage,\n    addStudentIdForUpdate\n} from '../../../redux/school/actions/index'\nimport { formatDate, fetchClassData } from '../../util'\n\nclass TeacherAppetiteLog extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            isLoading: true,\n            mealType: '',\n            selectedForCustomize: new Set(),\n            editingFruitType: false,\n            students_with_records: [],\n        }\n        this.handleRateFoodWellness = this.handleRateFoodWellness.bind(this)\n        this.handleSend = this.handleSend.bind(this)\n        this.handleClearAll = this.handleClearAll.bind(this)\n        this.handleSetAll = this.handleSetAll.bind(this)\n    }\n\n    componentDidMount() {\n        const { updatedStudents } = this.props.appetite\n        const { isConnected } = this.props.class\n        if (updatedStudents.size > 0 || !isConnected) {\n            this.setState({\n                isLoading: false\n            })\n        } else {\n            this.fetchClassData()\n        }\n\n        if (!isConnected) {\n            Toast.show({\n                text: '拍謝 網路連不到! 等一下再試試看',\n                buttonText: 'Okay',\n                position: \"top\",\n                type: \"warning\",\n                duration: 2000\n            })\n        }\n        // this.keyboardDidHideListener = Keyboard.addListener('keyboardDidHide', console.log('keyboard hid'))\n    }\n\n    async fetchClassData() {\n        const date = new Date()\n        const start_date = formatDate(date)\n        date.setDate(date.getDate() + 1)\n        const end_date = formatDate(date)\n        const appetiteData = await fetchClassData('appetite', this.props.class.class_id, start_date, end_date)\n        if (appetiteData.data[start_date] === undefined) {\n            return \n        }\n        const { fruit_name, ratings } = appetiteData.data[start_date]\n        this.props.fetchClassAppetiteData(fruit_name, ratings)\n        this.setState({\n            isLoading: false,\n            students_with_records: Object.keys(ratings)\n        })\n    }\n\n    editFruitName(fruit_name) {\n        this.props.editFruitName(fruit_name)\n    }\n\n    fruitNameEditorOnBlur() {\n        const { students_with_records } = this.state\n        this.setState({ editingFruitType: false })\n        if (this.props.appetite.fruit_name === '') {\n            this.props.editFruitName('水果')\n        }\n\n        if (students_with_records.length > 1) {\n            this.props.addStudentIdForUpdate(students_with_records)\n        }\n    }\n\n    handleRateFoodWellness(student_id, rating) {\n        if (this.state.mealType === '') {\n            Toast.show({\n                text: '請選擇餐時',\n                buttonText: 'Okay',\n                position: 'top',\n                duration: 3000\n            })\n        } else {\n            const { selectedForCustomize } = this.state\n            const {teacher_id } = this.props.route.params\n            selectedForCustomize.delete(student_id)\n            this.setState({\n                selectedForCustomize\n            })\n            this.props.rateAppetite(student_id, this.state.mealType, rating, teacher_id)\n        }\n    }\n\n    onClickOther(student_id) {\n        const { mealType, selectedForCustomize } = this.state\n        const {teacher_id } = this.props.route.params\n        if (mealType === '') {\n            Toast.show({\n                text: '請選擇餐時',\n                buttonText: 'Okay',\n                position: 'top',\n                duration: 3000\n            })\n        } else {\n            this.setState({\n                selectedForCustomize: new Set([...selectedForCustomize, student_id])\n            })\n            this.props.rateAppetite(student_id, this.state.mealType, '', teacher_id)\n        }\n    }\n\n    isRatingCustomized(rating) {\n        const { mealType } = this.state\n        if (mealType === '') {\n            return false\n        } else if (rating === 'Awesome' || rating === 'Good' || rating === 'Ok' || rating === '') {\n            return false\n        }\n        return true\n    }\n\n    onCustomizeRating(student_id, customized_text) {\n        const {teacher_id } = this.props.route.params\n        this.props.rateAppetite(student_id, this.state.mealType, customized_text, teacher_id)\n    }\n\n    customizedRatingOnBlur(student_id) {\n        const { selectedForCustomize } = this.state\n        selectedForCustomize.delete(student_id)\n        this.setState({\n            selectedForCustomize\n        })\n    }\n\n    markWaterDrank(student_id) {\n        const {teacher_id } = this.props.route.params\n        if (this.state.mealType === '') {\n            Toast.show({\n                text: '請選擇餐時',\n                buttonText: 'Okay',\n                position: 'top',\n                duration: 3000\n            })\n        } else {\n            this.props.markWaterDrank(student_id, this.state.mealType, teacher_id)\n        }\n    }\n\n    handleSetAll() {\n        const {teacher_id } = this.props.route.params\n        if (this.state.mealType === '') {\n            Toast.show({\n                text: '請選擇餐時',\n                buttonText: 'Okay',\n                position: 'top',\n                duration: 3000\n            })\n        } else {\n            this.props.setAllRatingsToGreat(this.state.mealType, teacher_id)\n        }\n    }\n\n    handleClearAll() {\n        if (this.state.mealType === '') {\n            Toast.show({\n                text: '請選擇餐時',\n                buttonText: 'Okay',\n                position: 'top',\n                duration: 3000\n            })\n        } else {\n            this.props.clearRatings(this.state.mealType)\n        }\n    }\n\n    handleSend() {\n        const { isConnected } = this.props.class\n        const {updatedStudents, fruit_name} = this.props.appetite\n        var data_objs = [],\n            appetite_log = this.props.appetite.ratings\n        \n        if (updatedStudents.size === 0) {\n            this.props.navigation.goBack()\n        }\n\n        if (!isConnected) {\n            Toast.show({\n                text: '拍謝 網路連不到! 等一下再試試看',\n                buttonText: 'Okay',\n                position: \"top\",\n                type: \"warning\",\n                duration: 2000\n            })\n            return\n        }\n\n        updatedStudents.forEach(student_id => {\n            const ratings = appetite_log[student_id] // get ratings obj for student\n            const data = { // create query data and append to data_objs\n                student_id,\n                b_rating: ratings.Breakfast,\n                f_rating: ratings.Fruit,\n                l_rating: ratings.Lunch,\n                s_rating: ratings.Snack,\n                teacher_id: ratings.teacher_id\n            }\n            data_objs.push(data)\n        })\n        \n        const request_body = {\n            date: formatDate(new Date()),\n            fruit_name,\n            obj: data_objs\n        }\n\n        fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/appetite', {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(request_body)\n        }).then(res => res.json())\n            .then(resJson => {\n                // console.log(resJson)\n                const { statusCode, message } = resJson\n                if (statusCode > 200 || message === 'Internal Server Error') {\n                    this.props.alertErrMessage(message)\n                } else {\n                    this.props.onSendAppetiteSuccess()\n                    this.props.navigation.goBack()\n                }\n            })\n            .catch(err => {\n                this.props.alertErrMessage(err)\n            })\n    }\n\n    // keyboardDidHide = () => {\n    //     Keyboard.dismiss();\n    // }\n\n    componentWillUnmount() {\n        // this.keyboardDidHideListener.remove()\n    }\n\n    render() {\n        if (this.props.appetite.err_message !== ''){\n            Alert.alert(\n                'Error!',\n                this.props.appetite.err_message,\n                [{text: 'OK', onPress: () => this.props.clearAppetiteErrorMessage()}]\n            )\n        }\n        const { mealType, selectedForCustomize, editingFruitType } = this.state\n        var date = new Date()\n        // console.log(this.props.appetite)\n        return (\n            <KeyboardAvoidingView\n                style={{\n                    flex: 1,\n                    backgroundColor: mealType === 'Breakfast' ? '#ffe1d0'\n                                    : mealType === 'Fruit' ? '#ffddb7'\n                                    : mealType === 'Lunch' ? '#fff1b5'\n                                        : mealType === 'Snack' ? '#dcf3d0'\n                                    : 'transparent'\n                }}\n                // behavior='padding'\n                // keyboardVerticalOffset={120}\n                enabled\n            >\n                <View style={styles.subHeading}>\n                    <Text style={{ fontSize: 40 }}>{date.getFullYear() + '.' + (date.getMonth()+1) + '.' + date.getDate()}</Text>\n                    <TouchableHighlight\n                        style={{ backgroundColor: '#b5e9e9', padding: 10 }}\n                        onPress={this.handleSetAll}>\n                        <Text style={{ color: 'grey', fontSize: 40 }}>全讚</Text>\n                    </TouchableHighlight>\n                    <TouchableHighlight\n                        style={{ backgroundColor: '#ffe1d0', padding: 10  }}\n                        onPress={this.handleClearAll}>\n                        <Text style={{ color: 'grey', fontSize: 40 }}>全部清除</Text>\n                    </TouchableHighlight>\n                    <TouchableHighlight\n                        style={{ backgroundColor: '#dcf3d0', padding: 10  }}\n                        onPress={this.handleSend}>\n                        <Text style={{ color: 'grey', fontSize: 40 }}>送出</Text>\n                    </TouchableHighlight>\n                </View>\n                <Content contentContainerStyle={{ alignItems: 'center' }}>\n                    <View style={styles.mealButtons}>\n                        <TouchableHighlight\n                            style={{\n                                backgroundColor: mealType === 'Breakfast' ? '#fa625f' : '#ffe1d0',\n                                width: '23%',\n                                height: 60,\n                                justifyContent: 'center',\n                                marginHorizontal: '1%',\n                                padding: 10\n                            }}\n                            underlayColor='#fa625f'\n                            onPress={() => this.setState({ mealType: 'Breakfast', editingFruitType: false })}\n                        >\n                            <Text style={styles.mealButtonText}>早餐</Text>\n                        </TouchableHighlight>\n                        <TouchableHighlight\n                            style={{\n                                backgroundColor: mealType === 'Fruit' ? '#ff8944' : '#ffddb7',\n                                width: '23%',\n                                height: 60,\n                                justifyContent: 'center',\n                                marginHorizontal: '1%',\n                                // padding: 10\n                            }}\n                            underlayColor='#ff8944'\n                            onPress={() => this.setState({ mealType: 'Fruit' })}\n                            onLongPress={() => this.setState({ mealType: 'Fruit', editingFruitType: true })}\n                        >\n                            {editingFruitType ?\n                                <View style={{ flex: 1 }}>\n                                    <Text style={{ paddingLeft: 5 }}>水果:</Text>\n                                    <TextInput\n                                        autoFocus={true}\n                                        selectTextOnFocus={true}\n                                        style={{ width: '95%', alignSelf: 'center', fontSize: 25, textAlign: 'center', color: 'grey', borderWidth: 1 }}\n                                        onChangeText={fruit_name => this.editFruitName(fruit_name)}\n                                        value={this.props.appetite.fruit_name}\n                                        onBlur={() => this.fruitNameEditorOnBlur()}\n                                    />\n                                </View>\n                            :   <Text style={styles.mealButtonText}>{this.props.appetite.fruit_name}</Text>\n                            }\n                        </TouchableHighlight>\n                        <TouchableHighlight\n                            style={{\n                                backgroundColor: mealType === 'Lunch' ? '#f4d41f' : '#fff1b5',\n                                width: '23%',\n                                height: 60,\n                                justifyContent: 'center',\n                                marginHorizontal: '1%',\n                                padding: 10\n                            }}\n                            underlayColor='#f4d41f'\n                            onPress={() => this.setState({ mealType: 'Lunch', editingFruitType: false })}\n                        >\n                            <Text style={styles.mealButtonText}>午餐</Text>\n                        </TouchableHighlight>\n                        <TouchableHighlight\n                            style={{\n                                backgroundColor: mealType === 'Snack' ? '#00c07f' : '#dcf3d0',\n                                width: '23%',\n                                height: 60,\n                                justifyContent: 'center',\n                                marginHorizontal: '1%',\n                                padding: 10\n                            }}\n                            underlayColor='#00c07f'\n                            onPress={() => this.setState({ mealType: 'Snack', editingFruitType: false })}\n                        >\n                            <Text style={styles.mealButtonText}>點心</Text>\n                        </TouchableHighlight>\n                    </View>\n                    \n                    {Object.keys(this.props.class.students).map((student_id) => {\n                        const meal_rating = mealType === '' ? '' : this.props.appetite.ratings[student_id][mealType].slice(0,-1)\n                        const water_drank = mealType === '' ? false : this.props.appetite.ratings[student_id][mealType].slice(-1) === '1'\n                        return (\n                            <View\n                                key={student_id}\n                                style={{ width: '98%' }}\n                            >\n                                <Card>\n                                    <CardItem>\n                                        <View style={styles.childThumbnail}>\n                                            <Image\n                                                source={\n                                                    this.props.class.students[student_id].profile_picture === '' ?\n                                                        require('../../../assets/icon-thumbnail.png')\n                                                        : {uri: this.props.class.students[student_id].profile_picture}\n                                                }\n                                                style={styles.thumbnailImage}/>\n                                        </View>\n                                        <View style={{ width: '75%' }}>\n                                            <View style={{ flex: 1 }}>\n                                                <View style={{ flex: 1, flexDirection: 'row' }}>\n                                                    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n                                                        <Text style={{ fontSize: 30, paddingLeft: 18, alignSelf: 'center' }}>\n                                                            {this.props.class.students[student_id].name}\n                                                        </Text>\n                                                    </View>\n                                                    <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n                                                        <TouchableHighlight\n                                                            style={{\n                                                                width: '80%',\n                                                                borderWidth: 2,\n                                                                borderColor: '#368cbf',\n                                                                padding: 10,\n                                                                justifyContent: 'center',\n                                                                backgroundColor: water_drank ? '#368cbf': 'white'\n                                                            }}\n                                                            onPress={() => this.markWaterDrank(student_id)}\n                                                        >\n                                                            <Text style={{\n                                                                textAlign: 'center',\n                                                                color: water_drank ? '#D3D3D3': 'grey',\n                                                                fontSize: 17\n                                                            }}>有喝水</Text>\n                                                        </TouchableHighlight>\n                                                    </View>\n                                                    <View style={{ flex: 2, alignItems: 'flex-end'}}>\n                                                        {this.props.appetite.updatedStudents.has(student_id) ?\n                                                            <Text style={{ color: 'red', fontSize: 15 }}>未送出</Text>\n                                                            : null\n                                                        }\n                                                    </View>\n                                                </View>\n                                                <View style={styles.cardBody}>\n                                                    <TouchableHighlight\n                                                        style={{\n                                                            width: '22%',\n                                                            height: '100%',\n                                                            margin: 5,\n                                                            justifyContent: 'center',\n                                                            backgroundColor: meal_rating === 'Awesome' ? '#368cbf' : '#b5e9e9',\n                                                            padding: 10\n                                                        }}\n                                                        onPress={() => this.handleRateFoodWellness(student_id, 'Awesome')}\n                                                    >\n                                                        <Text\n                                                            style={{\n                                                                textAlign: 'center',\n                                                                color: meal_rating === 'Awesome' ? '#D3D3D3' : 'grey',\n                                                                fontSize: 20\n                                                            }}\n                                                        >\n                                                            非常好\n                                                        </Text>\n                                                    </TouchableHighlight>\n                                                    <TouchableHighlight\n                                                        style={{\n                                                            width: '22%',\n                                                            height: '100%',\n                                                            margin: 5,\n                                                            justifyContent: 'center',\n                                                            backgroundColor: meal_rating === 'Good' ? '#368cbf' : '#b5e9e9',\n                                                            padding: 10\n                                                        }}\n                                                        onPress={() => this.handleRateFoodWellness(student_id, 'Good')}\n                                                    >\n                                                        <Text\n                                                            style={{\n                                                                textAlign: 'center',\n                                                                color: meal_rating === 'Good' ? '#D3D3D3' : 'grey',\n                                                                fontSize: 20\n                                                            }}\n                                                        >\n                                                            還不錯\n                                                        </Text>\n                                                    </TouchableHighlight>\n                                                    <TouchableHighlight\n                                                        style={{\n                                                            width: '22%',\n                                                            height: '100%',\n                                                            margin: 5,\n                                                            justifyContent: 'center',\n                                                            backgroundColor: meal_rating === 'Ok' ? '#368cbf' : '#b5e9e9',\n                                                            padding: 10\n                                                        }}\n                                                        onPress={() => this.handleRateFoodWellness(student_id, 'Ok')}\n                                                    >\n                                                        <Text\n                                                            style={{\n                                                                textAlign: 'center',\n                                                                color: meal_rating === 'Ok' ? '#D3D3D3' : 'grey',\n                                                                fontSize: 20\n                                                            }}\n                                                        >\n                                                            吃不多\n                                                        </Text>\n                                                    </TouchableHighlight>\n                                                    <TouchableHighlight\n                                                        style={{\n                                                            width: '22%',\n                                                            height: '100%',\n                                                            margin: 5,\n                                                            justifyContent: 'center',\n                                                            backgroundColor:\n                                                                this.isRatingCustomized(meal_rating) || selectedForCustomize.has(student_id) ?\n                                                                    '#368cbf'\n                                                                    : '#b5e9e9',\n                                                            padding: 10\n                                                        }}\n                                                        onPress={() => this.onClickOther(student_id)}\n                                                    >\n                                                        {this.isRatingCustomized(meal_rating) || selectedForCustomize.has(student_id) ?\n                                                            <TextInput\n                                                                style={{\n                                                                    textAlign: 'center',\n                                                                    color: '#D3D3D3',\n                                                                    fontSize: 20\n                                                                }}\n                                                                autoFocus={meal_rating === '' ? true : false}\n                                                                onChangeText={customized_text => this.onCustomizeRating(student_id, customized_text)}\n                                                                value={meal_rating}\n                                                                onBlur={() => this.customizedRatingOnBlur(student_id)}\n                                                            />\n                                                            : <Text\n                                                                style={{\n                                                                    textAlign: 'center',\n                                                                    color: this.isRatingCustomized(meal_rating) || selectedForCustomize.has(student_id) ? '#D3D3D3' : 'grey',\n                                                                    fontSize: 20\n                                                                }}\n                                                            >\n                                                                Other\n                                                            </Text>\n                                                        }\n                                                    </TouchableHighlight>\n                                                </View>\n                                            </View>\n                                        </View>\n                                    </CardItem>\n                                </Card>\n                            </View>\n                        )\n                    })}\n                </Content>\n            </KeyboardAvoidingView>\n        )\n    }\n}\n\nconst styles = StyleSheet.create({\n    childThumbnail: {\n        width: '25%',\n        // width: 100,\n        // height: '100%',\n        justifyContent: 'center',\n        alignItems: 'center'\n        // marginLeft: -7,\n    },\n    cardBody: {\n        flex: 1,\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n    },\n    foodButton: {\n        width: 70,\n        alignSelf: 'center',\n        margin: 5,\n        justifyContent: 'center',\n        backgroundColor: '#b5e9e9'\n    },\n    thumbnailImage: {\n        height: 130,\n        width: 130,\n        borderRadius: 65\n    },\n    subHeading: {\n        width: '99%',\n        // height: 45,\n        paddingHorizontal: '4%',\n        // marginTop: 10,\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        // backgroundColor: '#ccd2dd',\n        zIndex: 2\n    },\n    mealButtons: {\n        width: '99%',\n        // height: 45,\n        marginVertical: 15,\n        // marginTop: 10,\n        flexDirection: 'row',\n        alignItems: 'center',\n        justifyContent: 'center',\n        // zIndex: 1,\n        // position: 'absolute'\n    },\n    mealButtonText: {\n        fontSize: 30,\n        textAlign: 'center'\n    },\n    buttonText: {\n        color: 'grey',\n        textAlign: 'center'\n    }\n})\n\nconst mapStatesToProps = (state) => {\n    return {\n        class: state.classInfo,\n        appetite: state.appetite\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n    return {\n        ...bindActionCreators({\n            rateAppetite,\n            clearRatings,\n            setAllRatingsToGreat,\n            fetchClassAppetiteData,\n            onSendAppetiteSuccess,\n            alertErrMessage,\n            markWaterDrank,\n            editFruitName,\n            clearAppetiteErrorMessage,\n            addStudentIdForUpdate\n        }, dispatch)\n    }\n}\n\nexport default connect(mapStatesToProps, mapDispatchToProps) (TeacherAppetiteLog)"]},"metadata":{},"sourceType":"module"}