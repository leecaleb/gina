{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import Image from\"react-native-web/dist/exports/Image\";import Alert from\"react-native-web/dist/exports/Alert\";import TextInput from\"react-native-web/dist/exports/TextInput\";import PushNotificationIOS from\"react-native-web/dist/exports/PushNotificationIOS\";import{get,put}from\"../../util\";import PickerComponent from\"../../picker\";import Reloading from\"../../reloading\";var EditStudentProfile=function(_React$Component){_inherits(EditStudentProfile,_React$Component);var _super=_createSuper(EditStudentProfile);function EditStudentProfile(props){var _this;_classCallCheck(this,EditStudentProfile);_this=_super.call(this,props);_this.state={parents:[],student:null,isLoading:true};return _this;}_createClass(EditStudentProfile,[{key:\"componentDidMount\",value:function componentDidMount(){var _this$props,student_id,student,response,success,statusCode,message,data;return _regeneratorRuntime.async(function componentDidMount$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props=this.props,student_id=_this$props.student_id,student=_this$props.student;_context.next=3;return _regeneratorRuntime.awrap(get(\"/student/\"+student_id+\"/family\"));case 3:response=_context.sent;success=response.success,statusCode=response.statusCode,message=response.message,data=response.data;if(success){_context.next=8;break;}alert('Sorry 取得家庭資料時電腦出狀況了！請截圖和與工程師聯繫\\n\\n'+message);return _context.abrupt(\"return\");case 8:this.setState({parents:response.data,student:student,isLoading:false});case 9:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"addParent\",value:function addParent(){var parents=this.state.parents;if(parents.length===3){alert('Sorry 一個寶貝只能註冊三位家長！');return;}this.props.addParent({id:'',name:'',role:'',username:'',password:'',mobile:'',work_phone:'',address:''});}},{key:\"editStudentData\",value:function editStudentData(){var student_id,student,name,class_id,response,success,statusCode,message,data,old_class_id;return _regeneratorRuntime.async(function editStudentData$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:student_id=this.props.student_id;student=this.state.student;name=student.name,class_id=student.class_id;_context2.next=5;return _regeneratorRuntime.awrap(put(\"/student/\"+student_id,{name:name,class_id:class_id}));case 5:response=_context2.sent;success=response.success,statusCode=response.statusCode,message=response.message,data=response.data;if(success){_context2.next=10;break;}alert('Sorry 編輯學生資料時電腦出狀況了！請截圖和與工程師聯繫\\n\\n'+message);return _context2.abrupt(\"return\");case 10:this.props.hideModal();old_class_id=this.props.student.class_id;this.props.editStudentSuccess(student_id,name,old_class_id,class_id);case 13:case\"end\":return _context2.stop();}}},null,this,null,Promise);}},{key:\"getClassNames\",value:function getClassNames(){var classes=this.props.classes;return Object.keys(classes).map(function(class_id){return classes[class_id].name;});}},{key:\"handleSelectClass\",value:function handleSelectClass(class_name){var classes=this.props.classes;var class_id_found='';Object.keys(classes).forEach(function(class_id){if(classes[class_id].name===class_name){class_id_found=class_id;}});this.setState({student:_objectSpread(_objectSpread({},this.state.student),{},{class_id:class_id_found})});}},{key:\"render\",value:function render(){var _this2=this;var classes=this.props.classes;var _this$state=this.state,student=_this$state.student,parents=_this$state.parents,isLoading=_this$state.isLoading;if(isLoading){return React.createElement(Reloading,null);}return React.createElement(View,{style:{flex:1,padding:30}},React.createElement(View,{style:{flex:3,flexDirection:'row',alignItems:'center',backgroundColor:'#DCDCDC'}},React.createElement(View,{style:{flex:1,alignItems:'center'}},React.createElement(TouchableHighlight,{style:{}},React.createElement(Image,{source:student.profile_picture===''?require(\"../../../assets/icon-thumbnail.png\"):{uri:student.profile_picture},style:{width:200,height:200,borderRadius:100}}))),React.createElement(View,{style:{flex:1,justifyContent:'center'}},React.createElement(TextInput,{style:{fontSize:50},value:student.name,onChangeText:function onChangeText(name){return _this2.setState({student:_objectSpread(_objectSpread({},_this2.state.student),{},{name:name})});}}),React.createElement(TouchableHighlight,{style:{backgroundColor:'rgba(255,255,255, 0.5)',alignItems:'center',padding:5,width:'90%',marginTop:5}},React.createElement(Text,{style:{fontSize:50}},classes[student.class_id].name)))),React.createElement(View,{style:{flex:5,backgroundColor:'#F5F5F5'}},React.createElement(View,{style:{flex:1,alignItems:'center'}},parents.map(function(parent){return React.createElement(View,{key:parent.id,style:{width:'100%',height:'33%',padding:'1%'}},React.createElement(TouchableHighlight,{style:{flex:1,padding:10,backgroundColor:'#b5e9e9',justifyContent:'center'},onPress:function onPress(){return _this2.props.addParent(parent);}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{paddingRight:10}},React.createElement(Text,{style:{fontSize:20}},parent.role)),React.createElement(View,null,React.createElement(View,{style:{width:'100%',flexDirection:'row'}},React.createElement(Text,{style:{fontSize:20}},\"\\u59D3\\u540D: \",parent.name,\"         \"),React.createElement(Text,{style:{fontSize:20}},\"\\u5E33\\u865F: \",parent.username,\"         \")),React.createElement(Text,{style:{fontSize:20}},\"\\u624B\\u6A5F: \",parent.mobile),React.createElement(Text,{style:{fontSize:18}},\"\\u5DE5\\u4F5C/\\u5BB6\\u7528\\u96FB\\u8A71: \",parent.work_phone),React.createElement(Text,{style:{fontSize:18}},\"\\u5730\\u5740: \",parent.address)))));}),parents.length<3?React.createElement(View,{style:{width:'100%',height:'33%',padding:'1%'}},React.createElement(TouchableHighlight,{style:{flex:1,padding:10,backgroundColor:'white',justifyContent:'center',borderWidth:5,borderRadius:1,borderStyle:'dashed'},onPress:function onPress(){return _this2.addParent();}},React.createElement(View,{style:{flex:1,justifyContent:'center',alignItems:'center'}},React.createElement(Text,{style:{fontSize:30,alignSelf:'center'}},\"\\u65B0\\u589E\\u5BB6\\u9577\")))):null)),React.createElement(View,{style:{flex:1,flexDirection:'row',backgroundColor:'#DCDCDC'}},React.createElement(View,{style:{flex:1,padding:10}},React.createElement(TouchableHighlight,{style:{flex:1,padding:5,backgroundColor:'#fa625f',justifyContent:'center'},onPress:function onPress(){return _this2.props.hideModal();}},React.createElement(Text,{style:{fontSize:30,alignSelf:'center'}},\"\\u8FD4\\u56DE\"))),React.createElement(View,{style:{flex:1,padding:10}},React.createElement(TouchableHighlight,{style:{flex:1,padding:5,backgroundColor:'#00c07f',justifyContent:'center'},onPress:function onPress(){return _this2.editStudentData();}},React.createElement(Text,{style:{fontSize:30,alignSelf:'center'}},\"\\u9001\\u51FA\")))));}}]);return EditStudentProfile;}(React.Component);export{EditStudentProfile as default};","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/teacher/admin/editstudentprofile.js"],"names":["React","get","put","PickerComponent","Reloading","EditStudentProfile","props","state","parents","student","isLoading","student_id","response","success","statusCode","message","data","alert","setState","length","addParent","id","name","role","username","password","mobile","work_phone","address","class_id","hideModal","old_class_id","editStudentSuccess","classes","Object","keys","map","class_name","class_id_found","forEach","flex","padding","flexDirection","alignItems","backgroundColor","profile_picture","require","uri","width","height","borderRadius","justifyContent","fontSize","marginTop","parent","paddingRight","borderWidth","borderStyle","alignSelf","editStudentData","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { View, Text, TouchableHighlight, Image, Alert, TextInput, PushNotificationIOS } from 'react-native'\nimport { get, put } from '../../util'\nimport PickerComponent from '../../picker'\nimport Reloading from '../../reloading'\n\nexport default class EditStudentProfile extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state={\n            parents: [],\n            student: null,\n            isLoading: true\n        }\n    }\n\n    async componentDidMount() {\n        const { student_id, student } = this.props\n        const response = await get(`/student/${student_id}/family`)\n        const { success, statusCode, message, data } = response\n        if (!success) {\n            alert('Sorry 取得家庭資料時電腦出狀況了！請截圖和與工程師聯繫\\n\\n' + message)\n            return \n        }\n        this.setState({\n            parents: response.data,\n            student,\n            isLoading: false\n        })\n    }\n\n    addParent() {\n        const { parents } = this.state\n        if (parents.length === 3) {\n            alert('Sorry 一個寶貝只能註冊三位家長！')\n            return \n        }\n        this.props.addParent({\n            id: '',\n            name: '',\n            role: '',\n            username: '',\n            password: '',\n            mobile: '',\n            work_phone: '',\n            address: ''\n        })\n    }\n\n    async editStudentData() {\n        const { student_id } = this.props\n        const { student } = this.state\n        const { name, class_id } = student\n        const response = await put(`/student/${student_id}`, {\n            name,\n            class_id\n        })\n        const { success, statusCode, message, data } = response\n        if (!success) {\n            alert('Sorry 編輯學生資料時電腦出狀況了！請截圖和與工程師聯繫\\n\\n' + message)\n            return \n        }\n        this.props.hideModal()\n        const old_class_id = this.props.student.class_id\n        this.props.editStudentSuccess(student_id, name, old_class_id, class_id)\n    }\n\n    // getClassByStudentId() {\n    //     const { student_id, classes } = this.props\n    //     Object.keys(classes).forEach(class_id => {\n    //         const {students} = classes[class_id]\n    //         for(var i = 0; i < students.length; i++) {\n    //             if (student_id === students[i]) {\n    //                 return classes[class_id].name\n    //             }\n    //         }\n    //     })\n    //     return ''\n    // }\n\n    getClassNames() {\n        const { classes } = this.props\n        return Object.keys(classes).map(class_id => {\n            return classes[class_id].name\n        })\n    }\n    \n    handleSelectClass(class_name) {\n        const { classes } = this.props\n        let class_id_found = ''\n        Object.keys(classes).forEach(class_id => {\n            if (classes[class_id].name === class_name) {\n                class_id_found = class_id\n            }\n        })\n        this.setState({\n            student: {\n                ...this.state.student,\n                class_id: class_id_found\n            }\n        })\n    }\n\n    render() {\n        const { classes } = this.props\n        const { student, parents, isLoading } = this.state\n        // console.log('student: ', student)\n        if (isLoading) {\n            return (\n                <Reloading />\n            )\n        }\n        return (\n            <View style={{ flex: 1, padding: 30 }}>\n                <View style={{ flex: 3, flexDirection: 'row', alignItems: 'center', backgroundColor: '#DCDCDC' }}>\n                    <View style={{ flex: 1, alignItems: 'center' }}>\n                        <TouchableHighlight\n                            style={{  }}\n                            // onPress={() => }\n                        >\n                            <Image\n                                source={\n                                    student.profile_picture === '' ?\n                                        require('../../../assets/icon-thumbnail.png')\n                                        : {uri: student.profile_picture}\n                                }\n                                style={{\n                                    width: 200,\n                                    height: 200,\n                                    borderRadius: 100\n                                }}\n                            />\n                        </TouchableHighlight>\n                    </View>\n                    \n                    <View style={{ flex: 1, justifyContent: 'center' }}>\n                        <TextInput \n                            style={{ fontSize: 50 }}\n                            value={student.name}\n                            onChangeText={name => this.setState({\n                                student: {\n                                    ...this.state.student,\n                                    name\n                                }\n                            })}\n                        />\n                        {/* <Text style={{ fontSize: 50 }}>{classes[student.class_id].name}</Text> */}\n                        {/* <PickerComponent\n                            style={{ \n                                backgroundColor: 'rgba(255,255,255, 0.5)',\n                                alignItems: 'center',\n                                padding: 5,\n                                width: '90%',\n                                marginTop: 5\n                            }}\n                            textStyle={{fontSize: 50}}\n                            selectedValue={classes[student.class_id].name}\n                            options={Object.keys(classes).map(class_id => classes[class_id].name)}\n                            handleOnClick={() => { }}\n                            handleSelectValue={(class_name) => this.handleSelectClass(class_name)}\n                        /> */}\n                        <TouchableHighlight\n                            style={{ \n                                backgroundColor: 'rgba(255,255,255, 0.5)',\n                                alignItems: 'center',\n                                padding: 5,\n                                width: '90%',\n                                marginTop: 5\n                            }}\n                        >\n                            <Text style={{fontSize: 50}}>{classes[student.class_id].name}</Text>\n                        </TouchableHighlight>\n                    </View>\n                </View>\n\n                <View style={{ flex: 5, backgroundColor: '#F5F5F5' }}>\n\n                    <View style={{ flex: 1, alignItems: 'center' }}>\n                        {parents.map(parent => {\n                            return (\n                                <View key={parent.id} style={{ width: '100%', height: '33%', padding: '1%' }}>\n                                    <TouchableHighlight\n                                        style={{ flex: 1, padding : 10, backgroundColor: '#b5e9e9', justifyContent: 'center' }}\n                                        onPress={() => this.props.addParent(parent)}\n                                    >\n                                        <View style={{ flex: 1, flexDirection: 'row' }}>\n                                            {/* <Text style={{ fontSize: 30, alignSelf: 'center' }}>{parent.role}</Text> */}\n                                            <View style={{ paddingRight: 10 }}>\n                                                <Text style={{ fontSize: 20 }}>{parent.role}</Text>\n                                            </View>\n                                            <View>\n                                                <View style={{ width: '100%', flexDirection:'row'}}>\n                                                    <Text style={{ fontSize: 20 }}>姓名: {parent.name}         </Text>\n                                                    <Text style={{ fontSize: 20 }}>帳號: {parent.username}         </Text>\n                                                </View>\n                                                <Text style={{ fontSize: 20 }}>手機: {parent.mobile}</Text>\n                                                <Text style={{ fontSize: 18 }}>工作/家用電話: {parent.work_phone}</Text>\n                                                <Text style={{ fontSize: 18 }}>地址: {parent.address}</Text>\n                                            </View>\n                                        </View>\n                                    </TouchableHighlight>\n                                </View>\n                            )\n                        })}\n                        {parents.length < 3 ?\n                            <View style={{ width: '100%', height: '33%', padding: '1%' }}>\n                                <TouchableHighlight\n                                    style={{\n                                        flex: 1,\n                                        padding : 10,\n                                        backgroundColor: 'white',\n                                        justifyContent: 'center',\n                                        borderWidth: 5,\n                                        borderRadius: 1,\n                                        borderStyle: 'dashed'\n                                    }}\n                                    onPress={() => this.addParent()}\n                                >\n                                    <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n                                        <Text style={{ fontSize: 30, alignSelf: 'center' }}>新增家長</Text>\n                                    </View>\n                                </TouchableHighlight>\n                            </View>\n                        : null\n                        }\n                    </View>\n                </View>\n\n                <View style={{ flex: 1, flexDirection: 'row', backgroundColor: '#DCDCDC' }}>\n                    <View style={{ flex: 1, padding: 10 }}>\n                        <TouchableHighlight\n                            style={{ flex:1, padding: 5, backgroundColor: '#fa625f', justifyContent: 'center' }}\n                            onPress={() => this.props.hideModal()}\n                        >\n                            <Text style={{ fontSize: 30, alignSelf: 'center' }}>返回</Text>\n                        </TouchableHighlight>\n                    </View>\n                    <View style={{ flex: 1, padding: 10 }}>\n                        <TouchableHighlight\n                            style={{ flex: 1, padding: 5, backgroundColor: '#00c07f',justifyContent: 'center' }}\n                            onPress={() => this.editStudentData()}\n                        >\n                            <Text style={{ fontSize: 30, alignSelf: 'center' }}>送出</Text>\n                        </TouchableHighlight>\n                    </View>\n                </View>\n            </View>\n        )\n    }\n}"]},"metadata":{},"sourceType":"module"}