{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import TextInput from\"react-native-web/dist/exports/TextInput\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import Alert from\"react-native-web/dist/exports/Alert\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import Platform from\"react-native-web/dist/exports/Platform\";import{formatDate,formatTime,beautifyDate,beautifyTime}from\"../util\";import MedicinePowderForm from\"./medicinepowderform\";import MedicineSyrupForm from\"./medicinesyrupform\";import MedicineCreamForm from\"./medicinecreamform\";import ENV from\"../../variables\";var MedicationRequestMain=function(_React$Component){_inherits(MedicationRequestMain,_React$Component);var _super=_createSuper(MedicationRequestMain);function MedicationRequestMain(props){var _this;_classCallCheck(this,MedicationRequestMain);_this=_super.call(this,props);_this.state={optionButtonWidth:0,optionButtonHeight:0,show_date_picker:false,show_time_picker:false,date:new Date(),time:new Date(),show_editor:'',藥粉:null,need_refrigeration:false,藥水:null,藥膏:null,note:'',access_mode:'create'};return _this;}_createClass(MedicationRequestMain,[{key:\"componentDidMount\",value:function componentDidMount(){}},{key:\"getHeader\",value:function getHeader(){var _this$state=this.state,access_mode=_this$state.access_mode,date=_this$state.date;if(access_mode==='read'){if(formatDate(date)===formatDate(new Date())){return'今天托藥單';}var days_of_week=['天','一','二','三','四','五','六'];var day=days_of_week[date.getDay()];return\"\\u661F\\u671F\"+day;}else if(access_mode==='create'){return'新增托藥單';}else if(access_mode==='edit'){return'編輯中...';}}},{key:\"fetchAccessMode\",value:function fetchAccessMode(){return this.state.access_mode;}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(prevProps.request!==this.props.request){var request=this.props.request;if(!request){this.setState({date:new Date(),time:new Date(),藥粉:null,need_refrigeration:false,藥水:null,藥膏:null,note:'',access_mode:'create'});return;}var timestamp=request.timestamp,medication=request.medication,note=request.note;var 藥粉=medication.藥粉,need_refrigeration=medication.need_refrigeration,藥水=medication.藥水,藥膏=medication.藥膏;this.setState({date:timestamp,time:timestamp,藥粉:藥粉,need_refrigeration:need_refrigeration,藥水:藥水,藥膏:藥膏,note:note,access_mode:'read'});}}},{key:\"setDate\",value:function setDate(date){if(Platform.OS==='ios'){this.iosSetDate(date);}else{this.androidSetDate(date);}}},{key:\"iosSetDate\",value:function iosSetDate(date){if(this.state.access_mode==='read')return;this.setState({date:date,time:date});}},{key:\"androidSetDate\",value:function androidSetDate(date){if(date!==undefined){this.setState({date:date,time:date,show_date_picker:false});}else{this.setState({show_date_picker:false});}}},{key:\"setTime\",value:function setTime(time){if(Platform.OS==='ios'){this.iosSetTime(time);}else{this.androidSetTime(time);}}},{key:\"iosSetTime\",value:function iosSetTime(time){if(this.state.access_mode==='read')return;this.setState({time:time});}},{key:\"androidSetTime\",value:function androidSetTime(time){if(time!==undefined){this.setState({time:time,show_time_picker:false});}else{this.setState({show_time_picker:false});}}},{key:\"onFinishEdit\",value:function onFinishEdit(medicine_type,medicine_data){this.setState(_defineProperty({show_editor:''},medicine_type,medicine_data));}},{key:\"onCancelSelect\",value:function onCancelSelect(medicine_type){this.setState(_defineProperty({show_editor:''},medicine_type,null));}},{key:\"handleClickConfirmButton\",value:function handleClickConfirmButton(){var access_mode=this.state.access_mode;if(access_mode==='read'){this.setState({access_mode:'edit'});}else if(access_mode==='create'){this.sendRequest(null);}else if(access_mode==='edit'){var id=this.props.request.id;this.sendRequest(id);}}},{key:\"sendRequest\",value:function sendRequest(request_id){var _this2=this;var _this$state2=this.state,date=_this$state2.date,time=_this$state2.time,藥粉=_this$state2.藥粉,need_refrigeration=_this$state2.need_refrigeration,藥水=_this$state2.藥水,藥膏=_this$state2.藥膏,note=_this$state2.note;var _this$props=this.props,student_id=_this$props.student_id,class_id=_this$props.class_id;var request_body={request_id:request_id,timestamp:formatDate(date)+\" \"+formatTime(time),class_id:class_id,藥粉:藥粉,need_refrigeration:need_refrigeration,藥水:藥水,藥膏:藥膏,note:note};fetch(\"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/\"+ENV+\"/medicationrequest/student/\"+student_id,{method:'POST',headers:{Accept:'application/json','Content-Type':'application/json'},body:JSON.stringify(request_body)}).then(function(res){return res.json();}).then(function(resJson){var statusCode=resJson.statusCode,message=resJson.message,data=resJson.data;if(statusCode>200||message==='Internal server error'){alert('Sorry 電腦出狀況了！請截圖和與工程師聯繫'+message);return;}_this2.props.onCreateRequestSuccess(data.id);}).catch(function(err){alert('Sorry 電腦出狀況了！請截圖和與工程師聯繫: error occurred when sending medication request');});}},{key:\"deleteRequestConfirm\",value:function deleteRequestConfirm(){var confirmed=confirm('確定要刪除？');if(confirmed){this.deleteRequest();}}},{key:\"deleteRequest\",value:function deleteRequest(){var _this3=this;var _this$props2=this.props,request=_this$props2.request,class_id=_this$props2.class_id;fetch(\"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/\"+ENV+\"/medicationrequest/\"+request.id,{method:'DELETE',headers:{Accept:'application/json','Content-Type':'application/json'},body:JSON.stringify({class_id:class_id})}).then(function(res){return res.json();}).then(function(resJson){var statusCode=resJson.statusCode,message=resJson.message,data=resJson.data;if(statusCode>200||message==='Internal Server Error'){alert('Sorry 電腦出狀況了！請截圖和與工程師聯繫'+message);return;}_this3.props.onDeleteRequestSuccess(data.id);}).catch(function(err){alert('Sorry 電腦出狀況了！請截圖和與工程師聯繫: error occurred when deleting medication request');});}},{key:\"render\",value:function render(){var _this4=this;var _this$state3=this.state,show_date_picker=_this$state3.show_date_picker,show_time_picker=_this$state3.show_time_picker,date=_this$state3.date,time=_this$state3.time,藥粉=_this$state3.藥粉,藥水=_this$state3.藥水,藥膏=_this$state3.藥膏,note=_this$state3.note,optionButtonWidth=_this$state3.optionButtonWidth,optionButtonHeight=_this$state3.optionButtonHeight,show_editor=_this$state3.show_editor,access_mode=_this$state3.access_mode;if(show_date_picker){return React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{flex:3,justifyContent:'center'}}),React.createElement(View,{style:{flex:1}},React.createElement(TouchableHighlight,{style:{width:'50%',padding:10,backgroundColor:'rgba(255,255,255,0.4)',alignSelf:'flex-end'},onPress:function onPress(){return _this4.setState({show_date_picker:false});}},React.createElement(Text,{style:{fontSize:30,textAlign:'center'}},\"OK\"))));}if(show_time_picker){return React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{flex:3,justifyContent:'center'}}),React.createElement(View,{style:{flex:1}},React.createElement(TouchableHighlight,{style:{width:'50%',padding:10,backgroundColor:'rgba(255,255,255,0.4)',alignSelf:'flex-end'},onPress:function onPress(){return _this4.setState({show_time_picker:false});}},React.createElement(Text,{style:{fontSize:30,textAlign:'center'}},\"OK\"))));}return React.createElement(KeyboardAvoidingView,{style:{flex:1},behavior:\"padding\",enabled:true},React.createElement(View,{style:{flex:1,justifyContent:'center',alignItems:'center'}},React.createElement(Text,{style:{fontSize:30,textAlign:'center'}},this.getHeader())),React.createElement(View,{style:{flex:7}},React.createElement(View,{style:{flex:1,flexDirection:'row',justifyContent:'space-between',paddingVertical:10}},React.createElement(TouchableHighlight,{disabled:access_mode==='read'||show_editor!=='',style:{backgroundColor:'rgba(255,255,255,0.4)',justifyContent:'center',padding:10,height:'100%'},onPress:function onPress(){return _this4.setState({show_date_picker:!show_date_picker});}},React.createElement(Text,{style:{fontSize:25,textAlign:'center'}},beautifyDate(date))),React.createElement(TouchableHighlight,{disabled:access_mode==='read'||show_editor!=='',style:{backgroundColor:'rgba(255,255,255,0.4)',justifyContent:'center',padding:10,height:'100%'},onPress:function onPress(){return _this4.setState({show_time_picker:!show_time_picker});}},React.createElement(Text,{style:{fontSize:25,textAlign:'center'}},beautifyTime(time)))),show_editor==='藥粉'?React.createElement(MedicinePowderForm,{藥粉:藥粉,width:optionButtonWidth,height:optionButtonHeight,onFinishEdit:function onFinishEdit(powder_amount){return _this4.onFinishEdit('藥粉',powder_amount);},onCancelSelect:function onCancelSelect(){return _this4.onCancelSelect('藥粉');}}):show_editor==='藥水'?React.createElement(MedicineSyrupForm,{藥水:藥水,width:optionButtonWidth,height:optionButtonHeight,onFinishEdit:function onFinishEdit(syrup_amount){return _this4.onFinishEdit('藥水',syrup_amount);},onCancelSelect:function onCancelSelect(){return _this4.onCancelSelect('藥水');}}):show_editor==='藥膏'?React.createElement(MedicineCreamForm,{藥膏:藥膏,width:optionButtonWidth,height:optionButtonHeight,onFinishEdit:function onFinishEdit(cream_area){return _this4.onFinishEdit('藥膏',cream_area);},onCancelSelect:function onCancelSelect(){return _this4.onCancelSelect('藥膏');}}):React.createElement(View,{style:{flex:4}},React.createElement(View,{style:{flex:3,backgroundColor:'rgba(255,255,255,0.4)'}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(TouchableHighlight,{disabled:access_mode==='read',style:{flex:1,backgroundColor:藥粉?'#ff8944':'#ffddb7',justifyContent:'center',marginLeft:14,marginTop:14,marginRight:7,marginBottom:7},onLayout:function onLayout(event){var _event$nativeEvent$la=event.nativeEvent.layout,width=_event$nativeEvent$la.width,height=_event$nativeEvent$la.height;_this4.setState({optionButtonWidth:width,optionButtonHeight:height});},underlayColor:\"#ff8944\",onPress:function onPress(){return _this4.setState({show_editor:'藥粉',藥粉:藥粉||1});}},藥粉?React.createElement(Text,{style:{fontSize:25,textAlign:'center'}},\"\\u85E5\\u7C89: \",藥粉,\" \\u5305\"):React.createElement(Text,{style:{fontSize:25,textAlign:'center'}},\"\\u85E5\\u7C89\")),React.createElement(TouchableHighlight,{disabled:access_mode==='read',style:{flex:1,backgroundColor:this.state.need_refrigeration?'#ff8944':'#ffddb7',justifyContent:'center',marginLeft:7,marginTop:14,marginRight:14,marginBottom:7},underlayColor:\"#ff8944\",onPress:function onPress(){return _this4.setState({need_refrigeration:!_this4.state.need_refrigeration});}},React.createElement(Text,{style:{fontSize:25,textAlign:'center'}},\"\\u85E5\\u54C1\\u9700\\u51B7\\u85CF\"))),React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(TouchableHighlight,{disabled:access_mode==='read',style:{flex:1,backgroundColor:藥水?'#ff8944':'#ffddb7',justifyContent:'center',marginLeft:14,marginTop:7,marginRight:7,marginBottom:14},onPress:function onPress(){return _this4.setState({show_editor:'藥水',藥水:藥水||0});}},藥水?React.createElement(Text,{style:{fontSize:20,textAlign:'center'}},\"\\u85E5\\u6C34: \",藥水,\" c.c.\"):React.createElement(Text,{style:{fontSize:25,textAlign:'center'}},\"\\u85E5\\u6C34\")),React.createElement(TouchableHighlight,{disabled:access_mode==='read',style:{flex:1,backgroundColor:藥膏?'#ff8944':'#ffddb7',justifyContent:'center',marginLeft:7,marginTop:7,marginRight:14,marginBottom:14},onPress:function onPress(){return _this4.setState({show_editor:'藥膏'});}},藥膏?React.createElement(Text,{style:{fontSize:20,textAlign:'center'}},\"\\u85E5\\u818F\\u90E8\\u4F4D: \",藥膏):React.createElement(Text,{style:{fontSize:25,textAlign:'center'}},\"\\u85E5\\u818F\")))),React.createElement(View,{style:{backgroundColor:'#b5e9e9'}},React.createElement(TextInput,{editable:access_mode!=='read',placeholder:\"\\u5099\\u8A3B\",placeholderTextColor:\"grey\",value:note,style:{backgroundColor:'#eaf8f8',borderRadius:3,fontSize:20,padding:20},onChangeText:function onChangeText(note){return _this4.setState({note:note});}}))),this.props.request!==undefined&&this.props.request.administered?React.createElement(View,{style:{flex:1,flexDirection:'row',paddingVertical:10,justifyContent:'center',alignItems:'center'}},React.createElement(Text,{style:{fontSize:30}},\"\\u5582\\u85E5\\u8001\\u5E2B: \",this.props.request.teacher_name)):React.createElement(View,{style:{flex:1,flexDirection:'row',paddingVertical:10}},React.createElement(View,{style:{flex:1,marginHorizontal:7}},access_mode==='edit'?React.createElement(TouchableHighlight,{disabled:show_editor!=='',style:{height:'100%',padding:10,justifyContent:'center',backgroundColor:'rgba(255,255,255,0.4)'},onPress:function onPress(){return _this4.deleteRequestConfirm();}},React.createElement(Text,{style:{fontSize:17,textAlign:'center'}},\"\\u522A\\u9664\")):null),React.createElement(View,{style:{flex:1,marginHorizontal:7}},access_mode==='edit'?React.createElement(TouchableHighlight,{disabled:show_editor!=='',style:{height:'100%',padding:10,justifyContent:'center',backgroundColor:'rgba(255,255,255,0.4)'},onPress:function onPress(){return _this4.setState({access_mode:'read'});}},React.createElement(Text,{style:{fontSize:17,textAlign:'center'}},\"\\u53D6\\u6D88\\u7DE8\\u8F2F\")):null),React.createElement(View,{style:{flex:1,marginHorizontal:7}},React.createElement(TouchableHighlight,{disabled:show_editor!=='',style:{height:'100%',padding:10,justifyContent:'center',backgroundColor:'rgba(255,255,255,0.4)'},onPress:function onPress(){return _this4.handleClickConfirmButton();}},React.createElement(Text,{style:{fontSize:25,textAlign:'center'}},access_mode==='read'?'編輯':access_mode==='create'?'新增':access_mode==='edit'?'送出':null))))));}}]);return MedicationRequestMain;}(React.Component);export{MedicationRequestMain as default};","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/parent/medicationrequestmain.js"],"names":["React","formatDate","formatTime","beautifyDate","beautifyTime","MedicinePowderForm","MedicineSyrupForm","MedicineCreamForm","ENV","MedicationRequestMain","props","state","optionButtonWidth","optionButtonHeight","show_date_picker","show_time_picker","date","Date","time","show_editor","藥粉","need_refrigeration","藥水","藥膏","note","access_mode","days_of_week","day","getDay","prevProps","request","setState","timestamp","medication","Platform","OS","iosSetDate","androidSetDate","undefined","iosSetTime","androidSetTime","medicine_type","medicine_data","sendRequest","id","request_id","student_id","class_id","request_body","fetch","method","headers","Accept","body","JSON","stringify","then","res","json","resJson","statusCode","message","data","alert","onCreateRequestSuccess","catch","err","confirmed","confirm","deleteRequest","onDeleteRequestSuccess","flex","justifyContent","width","padding","backgroundColor","alignSelf","fontSize","textAlign","alignItems","getHeader","flexDirection","paddingVertical","height","powder_amount","onFinishEdit","onCancelSelect","syrup_amount","cream_area","marginLeft","marginTop","marginRight","marginBottom","event","nativeEvent","layout","borderRadius","administered","teacher_name","marginHorizontal","deleteRequestConfirm","handleClickConfirmButton","Component"],"mappings":"8iCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,C,ogBAGA,OAASC,UAAT,CAAqBC,UAArB,CAAiCC,YAAjC,CAA+CC,YAA/C,eACA,MAAOC,CAAAA,kBAAP,4BACA,MAAOC,CAAAA,iBAAP,2BACA,MAAOC,CAAAA,iBAAP,2BACA,MAAOC,CAAAA,GAAP,uB,GAEqBC,CAAAA,qB,6HACnB,+BAAYC,KAAZ,CAAmB,uDACjB,uBAAMA,KAAN,EACA,MAAKC,KAAL,CAAa,CACXC,iBAAiB,CAAE,CADR,CAEXC,kBAAkB,CAAE,CAFT,CAGXC,gBAAgB,CAAE,KAHP,CAIXC,gBAAgB,CAAE,KAJP,CAKXC,IAAI,CAAE,GAAIC,CAAAA,IAAJ,EALK,CAMXC,IAAI,CAAE,GAAID,CAAAA,IAAJ,EANK,CAOXE,WAAW,CAAE,EAPF,CAQXC,EAAE,CAAE,IARO,CASXC,kBAAkB,CAAE,KATT,CAUXC,EAAE,CAAE,IAVO,CAWXC,EAAE,CAAE,IAXO,CAYXC,IAAI,CAAE,EAZK,CAaXC,WAAW,CAAE,QAbF,CAAb,CAFiB,aAiBlB,C,+FAEmB,CACnB,C,6CAEW,iBACqB,KAAKd,KAD1B,CACFc,WADE,aACFA,WADE,CACWT,IADX,aACWA,IADX,CAEV,GAAIS,WAAW,GAAK,MAApB,CAA4B,CAC1B,GAAIxB,UAAU,CAACe,IAAD,CAAV,GAAqBf,UAAU,CAAC,GAAIgB,CAAAA,IAAJ,EAAD,CAAnC,CAA+C,CAC7C,MAAO,OAAP,CACD,CACD,GAAMS,CAAAA,YAAY,CAAG,CAAC,GAAD,CAAM,GAAN,CAAW,GAAX,CAAgB,GAAhB,CAAqB,GAArB,CAA0B,GAA1B,CAA+B,GAA/B,CAArB,CACA,GAAMC,CAAAA,GAAG,CAAGD,YAAY,CAACV,IAAI,CAACY,MAAL,EAAD,CAAxB,CACA,qBAAYD,GAAZ,CACD,CAPD,IAOO,IAAIF,WAAW,GAAK,QAApB,CAA8B,CACnC,MAAO,OAAP,CACD,CAFM,IAEA,IAAIA,WAAW,GAAK,MAApB,CAA4B,CACjC,MAAO,QAAP,CACD,CACF,C,yDAEiB,CAChB,MAAO,MAAKd,KAAL,CAAWc,WAAlB,CACD,C,8DAEkBI,S,CAAW,CAC5B,GAAIA,SAAS,CAACC,OAAV,GAAsB,KAAKpB,KAAL,CAAWoB,OAArC,CAA8C,IACpCA,CAAAA,OADoC,CACxB,KAAKpB,KADmB,CACpCoB,OADoC,CAE5C,GAAI,CAACA,OAAL,CAAc,CACZ,KAAKC,QAAL,CAAc,CACZf,IAAI,CAAE,GAAIC,CAAAA,IAAJ,EADM,CAEZC,IAAI,CAAE,GAAID,CAAAA,IAAJ,EAFM,CAGZG,EAAE,CAAE,IAHQ,CAIZC,kBAAkB,CAAE,KAJR,CAKZC,EAAE,CAAE,IALQ,CAMZC,EAAE,CAAE,IANQ,CAOZC,IAAI,CAAE,EAPM,CAQZC,WAAW,CAAE,QARD,CAAd,EAUA,OACD,CAd2C,GAgBpCO,CAAAA,SAhBoC,CAgBJF,OAhBI,CAgBpCE,SAhBoC,CAgBzBC,UAhByB,CAgBJH,OAhBI,CAgBzBG,UAhByB,CAgBbT,IAhBa,CAgBJM,OAhBI,CAgBbN,IAhBa,IAiBpCJ,CAAAA,EAjBoC,CAiBDa,UAjBC,CAiBpCb,EAjBoC,CAiBhCC,kBAjBgC,CAiBDY,UAjBC,CAiBhCZ,kBAjBgC,CAiBZC,EAjBY,CAiBDW,UAjBC,CAiBZX,EAjBY,CAiBRC,EAjBQ,CAiBDU,UAjBC,CAiBRV,EAjBQ,CAkB5C,KAAKQ,QAAL,CAAc,CACZf,IAAI,CAAEgB,SADM,CAEZd,IAAI,CAAEc,SAFM,CAGZZ,EAAE,CAAFA,EAHY,CAIZC,kBAAkB,CAAlBA,kBAJY,CAKZC,EAAE,CAAFA,EALY,CAMZC,EAAE,CAAFA,EANY,CAOZC,IAAI,CAAJA,IAPY,CAQZC,WAAW,CAAE,MARD,CAAd,EAUD,CACF,C,wCAEOT,I,CAAM,CACZ,GAAIkB,QAAQ,CAACC,EAAT,GAAgB,KAApB,CAA2B,CACzB,KAAKC,UAAL,CAAgBpB,IAAhB,EACD,CAFD,IAEO,CACL,KAAKqB,cAAL,CAAoBrB,IAApB,EACD,CACF,C,8CAEUA,I,CAAM,CACf,GAAI,KAAKL,KAAL,CAAWc,WAAX,GAA2B,MAA/B,CAAuC,OACvC,KAAKM,QAAL,CAAc,CACZf,IAAI,CAAJA,IADY,CAEZE,IAAI,CAAEF,IAFM,CAAd,EAID,C,sDAEcA,I,CAAM,CACnB,GAAIA,IAAI,GAAKsB,SAAb,CAAwB,CACtB,KAAKP,QAAL,CAAc,CACZf,IAAI,CAAJA,IADY,CAEZE,IAAI,CAAEF,IAFM,CAGZF,gBAAgB,CAAE,KAHN,CAAd,EAKD,CAND,IAMO,CACL,KAAKiB,QAAL,CAAc,CAAEjB,gBAAgB,CAAE,KAApB,CAAd,EACD,CACF,C,wCAEOI,I,CAAM,CACZ,GAAIgB,QAAQ,CAACC,EAAT,GAAgB,KAApB,CAA2B,CACzB,KAAKI,UAAL,CAAgBrB,IAAhB,EACD,CAFD,IAEO,CACL,KAAKsB,cAAL,CAAoBtB,IAApB,EACD,CACF,C,8CAEUA,I,CAAM,CACf,GAAI,KAAKP,KAAL,CAAWc,WAAX,GAA2B,MAA/B,CAAuC,OACvC,KAAKM,QAAL,CAAc,CACZb,IAAI,CAAJA,IADY,CAAd,EAGD,C,sDAEcA,I,CAAM,CACnB,GAAIA,IAAI,GAAKoB,SAAb,CAAwB,CACtB,KAAKP,QAAL,CAAc,CACZb,IAAI,CAAJA,IADY,CAEZH,gBAAgB,CAAE,KAFN,CAAd,EAID,CALD,IAKO,CACL,KAAKgB,QAAL,CAAc,CAAEhB,gBAAgB,CAAE,KAApB,CAAd,EACD,CACF,C,kDAEY0B,a,CAAeC,a,CAAe,CACzC,KAAKX,QAAL,kBACEZ,WAAW,CAAE,EADf,EAEGsB,aAFH,CAEmBC,aAFnB,GAID,C,sDAEcD,a,CAAe,CAC5B,KAAKV,QAAL,kBACEZ,WAAW,CAAE,EADf,EAEGsB,aAFH,CAEmB,IAFnB,GAID,C,2EAE0B,IACjBhB,CAAAA,WADiB,CACD,KAAKd,KADJ,CACjBc,WADiB,CAEzB,GAAIA,WAAW,GAAK,MAApB,CAA4B,CAC1B,KAAKM,QAAL,CAAc,CACZN,WAAW,CAAE,MADD,CAAd,EAGD,CAJD,IAIO,IAAIA,WAAW,GAAK,QAApB,CAA8B,CACnC,KAAKkB,WAAL,CAAiB,IAAjB,EACD,CAFM,IAEA,IAAIlB,WAAW,GAAK,MAApB,CAA4B,IACzBmB,CAAAA,EADyB,CAClB,KAAKlC,KAAL,CAAWoB,OADO,CACzBc,EADyB,CAEjC,KAAKD,WAAL,CAAiBC,EAAjB,EACD,CACF,C,gDAEWC,U,CAAY,kCACwC,KAAKlC,KAD7C,CACdK,IADc,cACdA,IADc,CACRE,IADQ,cACRA,IADQ,CACFE,EADE,cACFA,EADE,CACEC,kBADF,cACEA,kBADF,CACsBC,EADtB,cACsBA,EADtB,CAC0BC,EAD1B,cAC0BA,EAD1B,CAC8BC,IAD9B,cAC8BA,IAD9B,iBAES,KAAKd,KAFd,CAEfoC,UAFe,aAEfA,UAFe,CAEHC,QAFG,aAEHA,QAFG,CAGtB,GAAMC,CAAAA,YAAY,CAAG,CACnBH,UAAU,CAAVA,UADmB,CAEnBb,SAAS,CAAK/B,UAAU,CAACe,IAAD,CAAf,KAAyBd,UAAU,CAACgB,IAAD,CAFzB,CAGnB6B,QAAQ,CAARA,QAHmB,CAInB3B,EAAE,CAAFA,EAJmB,CAKnBC,kBAAkB,CAAlBA,kBALmB,CAMnBC,EAAE,CAAFA,EANmB,CAOnBC,EAAE,CAAFA,EAPmB,CAQnBC,IAAI,CAAJA,IARmB,CAArB,CAWAyB,KAAK,2DAA2DzC,GAA3D,+BAA4FsC,UAA5F,CAA0G,CAC3GI,MAAM,CAAE,MADmG,CAE3GC,OAAO,CAAE,CACLC,MAAM,CAAE,kBADH,CAEL,eAAgB,kBAFX,CAFkG,CAM3GC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeP,YAAf,CANqG,CAA1G,CAAL,CAQGQ,IARH,CAQQ,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EARR,EASGF,IATH,CASQ,SAACG,OAAD,CAAa,IACTC,CAAAA,UADS,CACqBD,OADrB,CACTC,UADS,CACGC,OADH,CACqBF,OADrB,CACGE,OADH,CACYC,IADZ,CACqBH,OADrB,CACYG,IADZ,CAEjB,GAAIF,UAAU,CAAG,GAAb,EAAoBC,OAAO,GAAK,uBAApC,CAA6D,CAC3DE,KAAK,CAAC,0BAA4BF,OAA7B,CAAL,CACA,OACD,CACD,MAAI,CAACnD,KAAL,CAAWsD,sBAAX,CAAkCF,IAAI,CAAClB,EAAvC,EACD,CAhBH,EAiBGqB,KAjBH,CAiBS,SAAAC,GAAG,CAAI,CACZH,KAAK,CAAC,yEAAD,CAAL,CACD,CAnBH,EAoBD,C,mEAEsB,CACrB,GAAMI,CAAAA,SAAS,CAAGC,OAAO,CAAC,QAAD,CAAzB,CACA,GAAID,SAAJ,CAAe,CACb,KAAKE,aAAL,GACD,CACF,C,qDAEe,kCACgB,KAAK3D,KADrB,CACNoB,OADM,cACNA,OADM,CACGiB,QADH,cACGA,QADH,CAEdE,KAAK,2DAA2DzC,GAA3D,uBAAoFsB,OAAO,CAACc,EAA5F,CAAkG,CACrGM,MAAM,CAAE,QAD6F,CAErGC,OAAO,CAAE,CACPC,MAAM,CAAE,kBADD,CAEP,eAAgB,kBAFT,CAF4F,CAMrGC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,CACnBR,QAAQ,CAARA,QADmB,CAAf,CAN+F,CAAlG,CAAL,CAUGS,IAVH,CAUQ,SAACC,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EAVR,EAWGF,IAXH,CAWQ,SAACG,OAAD,CAAa,IACTC,CAAAA,UADS,CACqBD,OADrB,CACTC,UADS,CACGC,OADH,CACqBF,OADrB,CACGE,OADH,CACYC,IADZ,CACqBH,OADrB,CACYG,IADZ,CAEjB,GAAIF,UAAU,CAAG,GAAb,EAAoBC,OAAO,GAAK,uBAApC,CAA6D,CAC3DE,KAAK,CAAC,0BAA4BF,OAA7B,CAAL,CACA,OACD,CACD,MAAI,CAACnD,KAAL,CAAW4D,sBAAX,CAAkCR,IAAI,CAAClB,EAAvC,EACD,CAlBH,EAmBGqB,KAnBH,CAmBS,SAAAC,GAAG,CAAI,CACZH,KAAK,CAAC,0EAAD,CAAL,CACD,CArBH,EAsBD,C,uCAEQ,kCAcH,KAAKpD,KAdF,CAELG,gBAFK,cAELA,gBAFK,CAGLC,gBAHK,cAGLA,gBAHK,CAILC,IAJK,cAILA,IAJK,CAKLE,IALK,cAKLA,IALK,CAMLE,EANK,cAMLA,EANK,CAOLE,EAPK,cAOLA,EAPK,CAQLC,EARK,cAQLA,EARK,CASLC,IATK,cASLA,IATK,CAULZ,iBAVK,cAULA,iBAVK,CAWLC,kBAXK,cAWLA,kBAXK,CAYLM,WAZK,cAYLA,WAZK,CAaLM,WAbK,cAaLA,WAbK,CAkBP,GAAIX,gBAAJ,CAAsB,CACpB,MACE,qBAAC,IAAD,EAAM,KAAK,CAAE,CAAEyD,IAAI,CAAE,CAAR,CAAb,EACE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEA,IAAI,CAAE,CAAR,CAAWC,cAAc,CAAE,QAA3B,CAAb,EADF,CAUE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAED,IAAI,CAAE,CAAR,CAAb,EACE,oBAAC,kBAAD,EACE,KAAK,CAAE,CAAEE,KAAK,CAAE,KAAT,CAAgBC,OAAO,CAAE,EAAzB,CAA6BC,eAAe,CAAE,uBAA9C,CAAuEC,SAAS,CAAE,UAAlF,CADT,CAEE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAC7C,QAAL,CAAc,CAAEjB,gBAAgB,CAAE,KAApB,CAAd,CAAN,EAFX,EAIE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAE+D,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,OAJF,CADF,CAVF,CADF,CAqBD,CACD,GAAI/D,gBAAJ,CAAsB,CACpB,MACE,qBAAC,IAAD,EAAM,KAAK,CAAE,CAAEwD,IAAI,CAAE,CAAR,CAAb,EACE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEA,IAAI,CAAE,CAAR,CAAWC,cAAc,CAAE,QAA3B,CAAb,EADF,CAUE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAED,IAAI,CAAE,CAAR,CAAb,EACE,oBAAC,kBAAD,EACE,KAAK,CAAE,CAAEE,KAAK,CAAE,KAAT,CAAgBC,OAAO,CAAE,EAAzB,CAA6BC,eAAe,CAAE,uBAA9C,CAAuEC,SAAS,CAAE,UAAlF,CADT,CAEE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAC7C,QAAL,CAAc,CAAEhB,gBAAgB,CAAE,KAApB,CAAd,CAAN,EAFX,EAIE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAE8D,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,OAJF,CADF,CAVF,CADF,CAqBD,CACD,MACE,qBAAC,oBAAD,EACE,KAAK,CAAE,CAAEP,IAAI,CAAE,CAAR,CADT,CAEE,QAAQ,CAAC,SAFX,CAGE,OAAO,KAHT,EAKE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEA,IAAI,CAAE,CAAR,CAAWC,cAAc,CAAE,QAA3B,CAAqCO,UAAU,CAAE,QAAjD,CAAb,EACE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEF,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,EAAqD,KAAKE,SAAL,EAArD,CADF,CALF,CAQE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAET,IAAI,CAAE,CAAR,CAAb,EAGE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEA,IAAI,CAAE,CAAR,CAAWU,aAAa,CAAE,KAA1B,CAAiCT,cAAc,CAAE,eAAjD,CAAkEU,eAAe,CAAE,EAAnF,CAAb,EACE,oBAAC,kBAAD,EACE,QAAQ,CAAEzD,WAAW,GAAK,MAAhB,EAA0BN,WAAW,GAAK,EADtD,CAEE,KAAK,CAAE,CACLwD,eAAe,CAAE,uBADZ,CAELH,cAAc,CAAE,QAFX,CAGLE,OAAO,CAAE,EAHJ,CAILS,MAAM,CAAE,MAJH,CAFT,CAQE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACpD,QAAL,CAAc,CAACjB,gBAAgB,CAAE,CAACA,gBAApB,CAAd,CAAN,EARX,EAUE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAE+D,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,EAAqD3E,YAAY,CAACa,IAAD,CAAjE,CAVF,CADF,CAaE,oBAAC,kBAAD,EACE,QAAQ,CAAES,WAAW,GAAK,MAAhB,EAA0BN,WAAW,GAAK,EADtD,CAEE,KAAK,CAAE,CACLwD,eAAe,CAAE,uBADZ,CAELH,cAAc,CAAE,QAFX,CAGLE,OAAO,CAAE,EAHJ,CAILS,MAAM,CAAE,MAJH,CAFT,CAQE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACpD,QAAL,CAAc,CAAChB,gBAAgB,CAAE,CAACA,gBAApB,CAAd,CAAN,EARX,EAUE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAE8D,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,EAAqD1E,YAAY,CAACc,IAAD,CAAjE,CAVF,CAbF,CAHF,CA8BGC,WAAW,GAAK,IAAhB,CACC,oBAAC,kBAAD,EACE,EAAE,CAAEC,EADN,CAEE,KAAK,CAAER,iBAFT,CAGE,MAAM,CAAEC,kBAHV,CAIE,YAAY,CAAE,sBAACuE,aAAD,QAAmB,CAAA,MAAI,CAACC,YAAL,CAAkB,IAAlB,CAAwBD,aAAxB,CAAnB,EAJhB,CAKE,cAAc,CAAE,gCAAM,CAAA,MAAI,CAACE,cAAL,CAAoB,IAApB,CAAN,EALlB,EADD,CAQGnE,WAAW,GAAK,IAAhB,CACA,oBAAC,iBAAD,EACE,EAAE,CAAEG,EADN,CAEE,KAAK,CAAEV,iBAFT,CAGE,MAAM,CAAEC,kBAHV,CAIE,YAAY,CAAE,sBAAC0E,YAAD,QAAkB,CAAA,MAAI,CAACF,YAAL,CAAkB,IAAlB,CAAwBE,YAAxB,CAAlB,EAJhB,CAKE,cAAc,CAAE,gCAAM,CAAA,MAAI,CAACD,cAAL,CAAoB,IAApB,CAAN,EALlB,EADA,CAQEnE,WAAW,GAAK,IAAhB,CACA,oBAAC,iBAAD,EACE,EAAE,CAAEI,EADN,CAEE,KAAK,CAAEX,iBAFT,CAGE,MAAM,CAAEC,kBAHV,CAIE,YAAY,CAAE,sBAAC2E,UAAD,QAAgB,CAAA,MAAI,CAACH,YAAL,CAAkB,IAAlB,CAAwBG,UAAxB,CAAhB,EAJhB,CAKE,cAAc,CAAE,gCAAM,CAAA,MAAI,CAACF,cAAL,CAAoB,IAApB,CAAN,EALlB,EADA,CASA,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEf,IAAI,CAAE,CAAR,CAAb,EACE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEA,IAAI,CAAE,CAAR,CAAWI,eAAe,CAAE,uBAA5B,CAAb,EACE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEJ,IAAI,CAAE,CAAR,CAAWU,aAAa,CAAE,KAA1B,CAAb,EAEE,oBAAC,kBAAD,EACE,QAAQ,CAAExD,WAAW,GAAK,MAD5B,CAEE,KAAK,CAAE,CACL8C,IAAI,CAAE,CADD,CAELI,eAAe,CAAEvD,EAAE,CAAG,SAAH,CAAe,SAF7B,CAGLoD,cAAc,CAAE,QAHX,CAILiB,UAAU,CAAE,EAJP,CAKLC,SAAS,CAAE,EALN,CAMLC,WAAW,CAAE,CANR,CAOLC,YAAY,CAAE,CAPT,CAFT,CAWE,QAAQ,CAAE,kBAACC,KAAD,CAAW,2BACOA,KAAK,CAACC,WAAN,CAAkBC,MADzB,CACXtB,KADW,uBACXA,KADW,CACJU,MADI,uBACJA,MADI,CAEnB,MAAI,CAACpD,QAAL,CAAc,CACZnB,iBAAiB,CAAE6D,KADP,CAEZ5D,kBAAkB,CAAEsE,MAFR,CAAd,EAID,CAjBH,CAkBE,aAAa,CAAC,SAlBhB,CAmBE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACpD,QAAL,CAAc,CAAEZ,WAAW,CAAE,IAAf,CAAqBC,EAAE,CAAEA,EAAE,EAAI,CAA/B,CAAd,CAAN,EAnBX,EAqBGA,EAAE,CACD,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEyD,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,mBAAyD1D,EAAzD,WADC,CAEC,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEyD,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,iBAvBN,CAFF,CA8BE,oBAAC,kBAAD,EACE,QAAQ,CAAErD,WAAW,GAAK,MAD5B,CAEE,KAAK,CAAE,CACL8C,IAAI,CAAE,CADD,CAELI,eAAe,CAAE,KAAKhE,KAAL,CAAWU,kBAAX,CAAgC,SAAhC,CAA4C,SAFxD,CAGLmD,cAAc,CAAE,QAHX,CAILiB,UAAU,CAAE,CAJP,CAKLC,SAAS,CAAE,EALN,CAMLC,WAAW,CAAE,EANR,CAOLC,YAAY,CAAE,CAPT,CAFT,CAWE,aAAa,CAAC,SAXhB,CAYE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAC7D,QAAL,CAAc,CAAEV,kBAAkB,CAAE,CAAC,MAAI,CAACV,KAAL,CAAWU,kBAAlC,CAAd,CAAN,EAZX,EAcE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEwD,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,mCAdF,CA9BF,CADF,CAiDE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEP,IAAI,CAAE,CAAR,CAAWU,aAAa,CAAE,KAA1B,CAAb,EAEE,oBAAC,kBAAD,EACE,QAAQ,CAAExD,WAAW,GAAK,MAD5B,CAEE,KAAK,CAAE,CACL8C,IAAI,CAAE,CADD,CAELI,eAAe,CAAErD,EAAE,CAAG,SAAH,CAAe,SAF7B,CAGLkD,cAAc,CAAE,QAHX,CAILiB,UAAU,CAAE,EAJP,CAKLC,SAAS,CAAE,CALN,CAMLC,WAAW,CAAE,CANR,CAOLC,YAAY,CAAE,EAPT,CAFT,CAWE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAC7D,QAAL,CAAc,CAAEZ,WAAW,CAAE,IAAf,CAAqBG,EAAE,CAAEA,EAAE,EAAI,CAA/B,CAAd,CAAN,EAXX,EAaGA,EAAE,CACD,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEuD,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,mBAAyDxD,EAAzD,SADC,CAEC,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEuD,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,iBAfN,CAFF,CAsBE,oBAAC,kBAAD,EACE,QAAQ,CAAErD,WAAW,GAAK,MAD5B,CAEE,KAAK,CAAE,CACL8C,IAAI,CAAE,CADD,CAELI,eAAe,CAAEpD,EAAE,CAAG,SAAH,CAAe,SAF7B,CAGLiD,cAAc,CAAE,QAHX,CAILiB,UAAU,CAAE,CAJP,CAKLC,SAAS,CAAE,CALN,CAMLC,WAAW,CAAE,EANR,CAOLC,YAAY,CAAE,EAPT,CAFT,CAWE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAC7D,QAAL,CAAc,CAAEZ,WAAW,CAAE,IAAf,CAAd,CAAN,EAXX,EAaGI,EAAE,CACD,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEsD,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,+BAA2DvD,EAA3D,CADC,CAEC,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEsD,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,iBAfN,CAtBF,CAjDF,CADF,CA+FE,oBAAC,IAAD,EACE,KAAK,CAAE,CAAEH,eAAe,CAAE,SAAnB,CADT,EAGE,oBAAC,SAAD,EACE,QAAQ,CAAElD,WAAW,GAAK,MAD5B,CAEE,WAAW,CAAC,cAFd,CAGE,oBAAoB,CAAC,MAHvB,CAIE,KAAK,CAAED,IAJT,CAKE,KAAK,CAAE,CAELmD,eAAe,CAAE,SAFZ,CAGLqB,YAAY,CAAE,CAHT,CAILnB,QAAQ,CAAE,EAJL,CAKLH,OAAO,CAAE,EALJ,CALT,CAYE,YAAY,CAAE,sBAAAlD,IAAI,QAAI,CAAA,MAAI,CAACO,QAAL,CAAc,CAAEP,IAAI,CAAJA,IAAF,CAAd,CAAJ,EAZpB,EAHF,CA/FF,CAvDR,CA6KG,KAAKd,KAAL,CAAWoB,OAAX,GAAuBQ,SAAvB,EAAoC,KAAK5B,KAAL,CAAWoB,OAAX,CAAmBmE,YAAvD,CACC,oBAAC,IAAD,EACE,KAAK,CAAE,CAAE1B,IAAI,CAAE,CAAR,CAAWU,aAAa,CAAE,KAA1B,CAAiCC,eAAe,CAAE,EAAlD,CAAsDV,cAAc,CAAE,QAAtE,CAAgFO,UAAU,CAAE,QAA5F,CADT,EAGE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEF,QAAQ,CAAE,EAAZ,CAAb,+BAAsC,KAAKnE,KAAL,CAAWoB,OAAX,CAAmBoE,YAAzD,CAHF,CADD,CAOD,oBAAC,IAAD,EACE,KAAK,CAAE,CAAE3B,IAAI,CAAE,CAAR,CAAWU,aAAa,CAAE,KAA1B,CAAiCC,eAAe,CAAE,EAAlD,CADT,EAGE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEX,IAAI,CAAE,CAAR,CAAW4B,gBAAgB,CAAE,CAA7B,CAAb,EACG1E,WAAW,GAAK,MAAhB,CACC,oBAAC,kBAAD,EACE,QAAQ,CAAEN,WAAW,GAAK,EAD5B,CAEE,KAAK,CAAE,CACLgE,MAAM,CAAE,MADH,CAELT,OAAO,CAAE,EAFJ,CAILF,cAAc,CAAE,QAJX,CAKLG,eAAe,CAAE,uBALZ,CAFT,CASE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAACyB,oBAAL,EAAN,EATX,EAWE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEvB,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,iBAXF,CADD,CAcG,IAfN,CAHF,CAqBE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEP,IAAI,CAAE,CAAR,CAAW4B,gBAAgB,CAAE,CAA7B,CAAb,EACG1E,WAAW,GAAK,MAAhB,CACC,oBAAC,kBAAD,EACE,QAAQ,CAAEN,WAAW,GAAK,EAD5B,CAEE,KAAK,CAAE,CACLgE,MAAM,CAAE,MADH,CAELT,OAAO,CAAE,EAFJ,CAGLF,cAAc,CAAE,QAHX,CAILG,eAAe,CAAE,uBAJZ,CAFT,CAQE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAC5C,QAAL,CAAc,CAAEN,WAAW,CAAE,MAAf,CAAd,CAAN,EARX,EAUE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEoD,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,6BAVF,CADD,CAaG,IAdN,CArBF,CAsCE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAEP,IAAI,CAAE,CAAR,CAAW4B,gBAAgB,CAAE,CAA7B,CAAb,EACE,oBAAC,kBAAD,EACE,QAAQ,CAAEhF,WAAW,GAAK,EAD5B,CAEE,KAAK,CAAE,CACLgE,MAAM,CAAE,MADH,CAELT,OAAO,CAAE,EAFJ,CAGLF,cAAc,CAAE,QAHX,CAILG,eAAe,CAAE,uBAJZ,CAFT,CAQE,OAAO,CAAE,yBAAM,CAAA,MAAI,CAAC0B,wBAAL,EAAN,EARX,EAUE,oBAAC,IAAD,EAAM,KAAK,CAAE,CAAExB,QAAQ,CAAE,EAAZ,CAAgBC,SAAS,CAAE,QAA3B,CAAb,EACGrD,WAAW,GAAK,MAAhB,CACC,IADD,CAEGA,WAAW,GAAK,QAAhB,CACA,IADA,CAEEA,WAAW,GAAK,MAAhB,CACA,IADA,CAEE,IAPV,CAVF,CADF,CAtCF,CApLF,CARF,CADF,CA+PD,C,mCAjiBgDzB,KAAK,CAACsG,S,SAApC7F,qB","sourcesContent":["import React from 'react'\nimport { View, Text, TouchableHighlight, TextInput, KeyboardAvoidingView, Alert, ScrollView, Platform } from 'react-native'\n// import DateTimePicker from '@react-native-community/datetimepicker'\nimport { formatDate, formatTime, beautifyDate, beautifyTime }  from '../util'\nimport MedicinePowderForm from './medicinepowderform'\nimport MedicineSyrupForm from './medicinesyrupform'\nimport MedicineCreamForm from './medicinecreamform'\nimport ENV from '../../variables'\n\nexport default class MedicationRequestMain extends React.Component{\n  constructor(props) {\n    super(props) \n    this.state = {\n      optionButtonWidth: 0,\n      optionButtonHeight: 0,\n      show_date_picker: false,\n      show_time_picker: false,\n      date: new Date(),\n      time: new Date(),\n      show_editor: '',\n      藥粉: null,\n      need_refrigeration: false,\n      藥水: null,\n      藥膏: null,\n      note: '',\n      access_mode: 'create'\n    }\n  }\n\n  componentDidMount() {\n  }\n\n  getHeader() {\n    const { access_mode, date, } = this.state\n    if (access_mode === 'read') {\n      if (formatDate(date) === formatDate(new Date)) {\n        return '今天托藥單'\n      }\n      const days_of_week = ['天', '一', '二', '三', '四', '五', '六']\n      const day = days_of_week[date.getDay()]\n      return `星期${day}`\n    } else if (access_mode === 'create') {\n      return '新增托藥單'\n    } else if (access_mode === 'edit') {\n      return '編輯中...'\n    }\n  }\n\n  fetchAccessMode() {\n    return this.state.access_mode\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.request !== this.props.request) {\n      const { request } = this.props\n      if (!request) {\n        this.setState({\n          date: new Date(),\n          time: new Date(),\n          藥粉: null,\n          need_refrigeration: false,\n          藥水: null,\n          藥膏: null,\n          note: '',\n          access_mode: 'create'\n        })\n        return\n      }\n\n      const { timestamp, medication, note } = request\n      const { 藥粉, need_refrigeration, 藥水, 藥膏 } = medication\n      this.setState({\n        date: timestamp,\n        time: timestamp,\n        藥粉,\n        need_refrigeration,\n        藥水,\n        藥膏,\n        note,\n        access_mode: 'read'\n      })\n    }\n  }\n\n  setDate(date) {\n    if (Platform.OS === 'ios') {\n      this.iosSetDate(date)\n    } else { // android\n      this.androidSetDate(date)\n    }\n  }\n\n  iosSetDate(date) {\n    if (this.state.access_mode === 'read') return;\n    this.setState({\n      date,\n      time: date\n    })\n  }\n\n  androidSetDate(date) {\n    if (date !== undefined) {\n      this.setState({\n        date,\n        time: date,\n        show_date_picker: false\n      })\n    } else {\n      this.setState({ show_date_picker: false })\n    }\n  }\n\n  setTime(time) {\n    if (Platform.OS === 'ios') {\n      this.iosSetTime(time)\n    } else { // android\n      this.androidSetTime(time)\n    }\n  }\n\n  iosSetTime(time) {\n    if (this.state.access_mode === 'read') return;\n    this.setState({\n      time\n    })\n  }\n\n  androidSetTime(time) {\n    if (time !== undefined) {\n      this.setState({\n        time,\n        show_time_picker: false\n      })\n    } else {\n      this.setState({ show_time_picker: false })\n    }\n  }\n\n  onFinishEdit(medicine_type, medicine_data) {\n    this.setState({\n      show_editor: '',\n      [medicine_type]: medicine_data\n    })\n  }\n\n  onCancelSelect(medicine_type) {\n    this.setState({\n      show_editor: '',\n      [medicine_type]: null\n    })\n  }\n\n  handleClickConfirmButton() {\n    const { access_mode } = this.state\n    if (access_mode === 'read') {\n      this.setState({\n        access_mode: 'edit'\n      })\n    } else if (access_mode === 'create') {\n      this.sendRequest(null)\n    } else if (access_mode === 'edit') {\n      const { id } = this.props.request\n      this.sendRequest(id)\n    }\n  }\n\n  sendRequest(request_id) {\n    const { date, time, 藥粉, need_refrigeration, 藥水, 藥膏, note  } = this.state\n    const {student_id, class_id} = this.props\n    const request_body = {\n      request_id,\n      timestamp: `${formatDate(date)} ${formatTime(time)}`,\n      class_id,\n      藥粉,\n      need_refrigeration,\n      藥水,\n      藥膏,\n      note\n    }\n\n    fetch(`https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/${ENV}/medicationrequest/student/${student_id}`, {\n        method: 'POST',\n        headers: {\n            Accept: 'application/json',\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(request_body)\n    })\n      .then((res) => res.json())\n      .then((resJson) => {\n        const { statusCode, message, data } = resJson\n        if (statusCode > 200 || message === 'Internal server error') {\n          alert('Sorry 電腦出狀況了！請截圖和與工程師聯繫' + message)\n          return\n        }\n        this.props.onCreateRequestSuccess(data.id)\n      })\n      .catch(err => {\n        alert('Sorry 電腦出狀況了！請截圖和與工程師聯繫: error occurred when sending medication request')\n      })\n  }\n\n  deleteRequestConfirm() {\n    const confirmed = confirm('確定要刪除？')\n    if (confirmed) {\n      this.deleteRequest()\n    }\n  }\n\n  deleteRequest() {\n    const { request, class_id } = this.props\n    fetch(`https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/${ENV}/medicationrequest/${request.id}`, {\n      method: 'DELETE',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        class_id\n      })\n    })\n      .then((res) => res.json())\n      .then((resJson) => {\n        const { statusCode, message, data } = resJson\n        if (statusCode > 200 || message === 'Internal Server Error') {\n          alert('Sorry 電腦出狀況了！請截圖和與工程師聯繫' + message)\n          return\n        }\n        this.props.onDeleteRequestSuccess(data.id)\n      })\n      .catch(err => {\n        alert('Sorry 電腦出狀況了！請截圖和與工程師聯繫: error occurred when deleting medication request')\n      })\n  }\n\n  render() {\n    const {\n      show_date_picker,\n      show_time_picker,\n      date,\n      time,\n      藥粉,\n      藥水,\n      藥膏,\n      note,\n      optionButtonWidth,\n      optionButtonHeight,\n      show_editor,\n      access_mode\n    } = this.state\n\n    // console.log(this.props.request)\n\n    if (show_date_picker) {\n      return (\n        <View style={{ flex: 1 }}>\n          <View style={{ flex: 3, justifyContent: 'center' }}>\n            {/* <DateTimePicker\n              style={{ width: '100%'}}\n              mode={'date'}\n              value={date}\n              onChange={(event, date) => this.setDate(date)}\n              minimumDate={new Date()}\n            /> */}\n          </View>\n          <View style={{ flex: 1 }}>\n            <TouchableHighlight\n              style={{ width: '50%', padding: 10, backgroundColor: 'rgba(255,255,255,0.4)', alignSelf: 'flex-end',  }}\n              onPress={() => this.setState({ show_date_picker: false })}\n            >\n              <Text style={{ fontSize: 30, textAlign: 'center' }}>OK</Text>\n            </TouchableHighlight>\n          </View>\n        </View>\n      )\n    }\n    if (show_time_picker) {\n      return (\n        <View style={{ flex: 1 }}>\n          <View style={{ flex: 3, justifyContent: 'center' }}>\n            {/* <DateTimePicker\n              style={{ width: '100%'}}\n              mode={'time'}\n              value={time}\n              onChange={(event, time) => this.setTime(time)}\n              minimumDate={new Date()}\n            /> */}\n          </View>\n          <View style={{ flex: 1 }}>\n            <TouchableHighlight\n              style={{ width: '50%', padding: 10, backgroundColor: 'rgba(255,255,255,0.4)', alignSelf: 'flex-end',  }}\n              onPress={() => this.setState({ show_time_picker: false })}\n            >\n              <Text style={{ fontSize: 30, textAlign: 'center' }}>OK</Text>\n            </TouchableHighlight>\n          </View>\n        </View>\n      )\n    }\n    return (\n      <KeyboardAvoidingView\n        style={{ flex: 1 }}\n        behavior='padding'\n        enabled\n      >\n        <View style={{ flex: 1, justifyContent: 'center', alignItems: 'center' }}>\n          <Text style={{ fontSize: 30, textAlign: 'center' }}>{this.getHeader()}</Text>\n        </View>\n        <View style={{ flex: 7 }}>\n\n          {/* DATE and TIME */}\n          <View style={{ flex: 1, flexDirection: 'row', justifyContent: 'space-between', paddingVertical: 10 }}>\n            <TouchableHighlight\n              disabled={access_mode === 'read' || show_editor !== ''}\n              style={{\n                backgroundColor: 'rgba(255,255,255,0.4)',\n                justifyContent: 'center',\n                padding: 10,\n                height: '100%'\n              }}\n              onPress={() => this.setState({show_date_picker: !show_date_picker})}\n            >\n              <Text style={{ fontSize: 25, textAlign: 'center' }}>{beautifyDate(date)}</Text>\n            </TouchableHighlight>\n            <TouchableHighlight\n              disabled={access_mode === 'read' || show_editor !== ''}\n              style={{\n                backgroundColor: 'rgba(255,255,255,0.4)',\n                justifyContent: 'center',\n                padding: 10,\n                height: '100%'\n              }}\n              onPress={() => this.setState({show_time_picker: !show_time_picker})}\n            >\n              <Text style={{ fontSize: 25, textAlign: 'center' }}>{beautifyTime(time)}</Text>\n            </TouchableHighlight>\n          </View>\n\n          {show_editor === '藥粉' ? \n            <MedicinePowderForm\n              藥粉={藥粉}\n              width={optionButtonWidth}\n              height={optionButtonHeight}\n              onFinishEdit={(powder_amount) => this.onFinishEdit('藥粉', powder_amount)}\n              onCancelSelect={() => this.onCancelSelect('藥粉')}\n            />\n            : show_editor === '藥水' ?\n              <MedicineSyrupForm\n                藥水={藥水}\n                width={optionButtonWidth}\n                height={optionButtonHeight}\n                onFinishEdit={(syrup_amount) => this.onFinishEdit('藥水', syrup_amount)}\n                onCancelSelect={() => this.onCancelSelect('藥水')}\n              />\n              : show_editor === '藥膏' ?\n                <MedicineCreamForm\n                  藥膏={藥膏}\n                  width={optionButtonWidth}\n                  height={optionButtonHeight}\n                  onFinishEdit={(cream_area) => this.onFinishEdit('藥膏', cream_area)}\n                  onCancelSelect={() => this.onCancelSelect('藥膏')}\n                />\n                :\n                <View style={{ flex: 4 }}>\n                  <View style={{ flex: 3, backgroundColor: 'rgba(255,255,255,0.4)' }}>\n                    <View style={{ flex: 1, flexDirection: 'row' }}>\n                      {/* POWDER */}\n                      <TouchableHighlight\n                        disabled={access_mode === 'read'}\n                        style={{\n                          flex: 1,\n                          backgroundColor: 藥粉 ? '#ff8944' : '#ffddb7',\n                          justifyContent: 'center',\n                          marginLeft: 14,\n                          marginTop: 14,\n                          marginRight: 7,\n                          marginBottom: 7\n                        }}\n                        onLayout={(event) => {\n                          const { width, height } = event.nativeEvent.layout\n                          this.setState({\n                            optionButtonWidth: width,\n                            optionButtonHeight: height\n                          })\n                        }}\n                        underlayColor='#ff8944'\n                        onPress={() => this.setState({ show_editor: '藥粉', 藥粉: 藥粉 || 1 })}\n                      >\n                        {藥粉 ? \n                          <Text style={{ fontSize: 25, textAlign: 'center' }}>藥粉: {藥粉} 包</Text>\n                          : <Text style={{ fontSize: 25, textAlign: 'center' }}>藥粉</Text>\n                        }\n                      </TouchableHighlight>\n\n                      {/* REFRIGERATED */}\n                      <TouchableHighlight\n                        disabled={access_mode === 'read'}\n                        style={{\n                          flex: 1,\n                          backgroundColor: this.state.need_refrigeration ? '#ff8944' : '#ffddb7',\n                          justifyContent: 'center',\n                          marginLeft: 7,\n                          marginTop: 14,\n                          marginRight: 14,\n                          marginBottom: 7\n                        }}\n                        underlayColor='#ff8944'\n                        onPress={() => this.setState({ need_refrigeration: !this.state.need_refrigeration})}\n                      >\n                        <Text style={{ fontSize: 25, textAlign: 'center' }}>藥品需冷藏</Text>\n                      </TouchableHighlight>\n                    </View>\n\n                    <View style={{ flex: 1, flexDirection: 'row' }}>\n                      {/* SYRUP */}\n                      <TouchableHighlight\n                        disabled={access_mode === 'read'}\n                        style={{\n                          flex: 1,\n                          backgroundColor: 藥水 ? '#ff8944' : '#ffddb7',\n                          justifyContent: 'center',\n                          marginLeft: 14,\n                          marginTop: 7,\n                          marginRight: 7,\n                          marginBottom: 14\n                        }}\n                        onPress={() => this.setState({ show_editor: '藥水', 藥水: 藥水 || 0 })}\n                      >\n                        {藥水 ?\n                          <Text style={{ fontSize: 20, textAlign: 'center' }}>藥水: {藥水} c.c.</Text>\n                          : <Text style={{ fontSize: 25, textAlign: 'center' }}>藥水</Text>\n                        }\n                      </TouchableHighlight>\n\n                      {/* CREAM */}\n                      <TouchableHighlight\n                        disabled={access_mode === 'read'}\n                        style={{\n                          flex: 1,\n                          backgroundColor: 藥膏 ? '#ff8944' : '#ffddb7',\n                          justifyContent: 'center',\n                          marginLeft: 7,\n                          marginTop: 7,\n                          marginRight: 14,\n                          marginBottom: 14,\n                        }}\n                        onPress={() => this.setState({ show_editor: '藥膏' })}\n                      >\n                        {藥膏 ? \n                          <Text style={{ fontSize: 20, textAlign: 'center' }}>藥膏部位: {藥膏}</Text>\n                          : <Text style={{ fontSize: 25, textAlign: 'center' }}>藥膏</Text>\n                        }\n                        \n                      </TouchableHighlight>\n                    </View>\n                  </View>\n\n              {/* NOTE */}\n                  <View\n                    style={{ backgroundColor: '#b5e9e9' }}\n                  >\n                    <TextInput\n                      editable={access_mode !== 'read'}\n                      placeholder='備註'\n                      placeholderTextColor='grey'\n                      value={note}\n                      style={{\n                        // height: '100%',\n                        backgroundColor: '#eaf8f8',\n                        borderRadius: 3,\n                        fontSize: 20,\n                        padding: 20,\n                      }}\n                      onChangeText={note => this.setState({ note })}\n                    />\n                  </View>\n                </View>\n\n          }\n\n          {/* Add Button */}\n          {this.props.request !== undefined && this.props.request.administered ?\n            <View\n              style={{ flex: 1, flexDirection: 'row', paddingVertical: 10, justifyContent: 'center', alignItems: 'center' }}\n            >\n              <Text style={{ fontSize: 30 }}>喂藥老師: {this.props.request.teacher_name}</Text>\n            </View>\n            :\n          <View\n            style={{ flex: 1, flexDirection: 'row', paddingVertical: 10 }}\n          >\n            <View style={{ flex: 1, marginHorizontal: 7 }}>\n              {access_mode === 'edit' ?\n                <TouchableHighlight\n                  disabled={show_editor !== ''}\n                  style={{\n                    height: '100%',\n                    padding: 10,\n                    // alignSelf: 'flex-start',\n                    justifyContent: 'center',\n                    backgroundColor: 'rgba(255,255,255,0.4)'\n                  }}\n                  onPress={() => this.deleteRequestConfirm()}\n                >\n                  <Text style={{ fontSize: 17, textAlign: 'center' }}>刪除</Text>\n                </TouchableHighlight>\n                : null\n              }              \n            </View>\n            <View style={{ flex: 1, marginHorizontal: 7 }}>\n              {access_mode === 'edit' ?\n                <TouchableHighlight\n                  disabled={show_editor !== ''}\n                  style={{\n                    height: '100%',\n                    padding: 10,\n                    justifyContent: 'center',\n                    backgroundColor: 'rgba(255,255,255,0.4)'\n                  }}\n                  onPress={() => this.setState({ access_mode: 'read'})}\n                >\n                  <Text style={{ fontSize: 17, textAlign: 'center' }}>取消編輯</Text>\n                </TouchableHighlight>\n                : null\n              }\n            </View>\n            <View style={{ flex: 1, marginHorizontal: 7 }}>\n              <TouchableHighlight\n                disabled={show_editor !== ''}\n                style={{\n                  height: '100%',\n                  padding: 10,\n                  justifyContent: 'center',\n                  backgroundColor: 'rgba(255,255,255,0.4)'\n                }}\n                onPress={() => this.handleClickConfirmButton()}\n              >\n                <Text style={{ fontSize: 25, textAlign: 'center' }}>\n                  {access_mode === 'read' ?\n                    '編輯'\n                    : access_mode === 'create' ?\n                      '新增'\n                      : access_mode === 'edit' ?\n                        '送出'\n                        : null\n                  }\n                </Text>\n              </TouchableHighlight>\n            </View>\n          </View>\n          }\n        </View>\n      </KeyboardAvoidingView>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}