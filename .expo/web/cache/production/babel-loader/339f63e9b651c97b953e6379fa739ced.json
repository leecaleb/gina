{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import TextInput from\"react-native-web/dist/exports/TextInput\";import Image from\"react-native-web/dist/exports/Image\";import{Card,CardItem,Button}from'native-base';import{formatDate,fetchData as _fetchData,beautifyDate}from\"../util\";import Reloading from\"../reloading\";var AppetiteCard=function(_React$Component){_inherits(AppetiteCard,_React$Component);var _super=_createSuper(AppetiteCard);function AppetiteCard(props){var _this;_classCallCheck(this,AppetiteCard);_this=_super.call(this,props);_this.state={child_id:_this.props.child_id,fruit_name:null,isLoading:true,breakfast:null,fruit:null,lunch:null,snack:null};_this.fetchData=_this.fetchData.bind(_assertThisInitialized(_this));return _this;}_createClass(AppetiteCard,[{key:\"componentDidMount\",value:function componentDidMount(){var date=this.props.date;this.fetchData(this.state.child_id,new Date(date.getTime()));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(this.props.date!==prevProps.date){this.setState({isLoading:true});this.fetchData(this.props.child_id,new Date(this.props.date.getTime()));}else if(this.props.child_id!==prevProps.child_id){this.setState({isLoading:true});this.fetchData(this.props.child_id,new Date(this.props.date.getTime()));}}},{key:\"fetchData\",value:function fetchData(child_id,date){var start_date,end_date,appetiteData;return _regeneratorRuntime.async(function fetchData$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(date.getHours()<17)){_context.next=3;break;}this.setState({isLoading:false});return _context.abrupt(\"return\");case 3:start_date=formatDate(date);date.setDate(date.getDate()+1);end_date=formatDate(date);_context.next=8;return _regeneratorRuntime.awrap(_fetchData('appetite',child_id,start_date,end_date));case 8:appetiteData=_context.sent;this.denormalizeAppetiteData(appetiteData.data,date);case 10:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"denormalizeAppetiteData\",value:function denormalizeAppetiteData(appetiteData){var date=this.props.date;var today=formatDate(date);if(appetiteData&&appetiteData[today]){var _appetiteData$today=appetiteData[today],fruit_name=_appetiteData$today.fruit_name,breakfast_rating=_appetiteData$today.breakfast_rating,fruit_rating=_appetiteData$today.fruit_rating,lunch_rating=_appetiteData$today.lunch_rating,snack_rating=_appetiteData$today.snack_rating;var breakfast=this.parseData(breakfast_rating);var fruit=this.parseData(fruit_rating);var lunch=this.parseData(lunch_rating);var snack=this.parseData(snack_rating);this.setState({fruit_name:fruit_name,breakfast:breakfast,fruit:fruit,lunch:lunch,snack:snack,appetiteData:appetiteData,isLoading:false});}else{this.setState({appetiteData:appetiteData,isLoading:false});}}},{key:\"parseData\",value:function parseData(data_string){var rating=data_string.slice(0,-1);var water_drunk=parseInt(data_string.slice(-1));return{rating:rating,water_drunk:water_drunk};}},{key:\"getEmoji\",value:function getEmoji(){}},{key:\"getWaterDrinkingStatus\",value:function getWaterDrinkingStatus(){}},{key:\"render\",value:function render(){var _this$state=this.state,appetiteData=_this$state.appetiteData,isLoading=_this$state.isLoading,breakfast=_this$state.breakfast,fruit=_this$state.fruit,lunch=_this$state.lunch,snack=_this$state.snack,rating=_this$state.rating,fruit_name=_this$state.fruit_name;var today=formatDate(this.props.date);return React.createElement(Card,{style:{width:'93%'}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{width:56,height:56,justifyContent:'center',alignItems:'center'}},React.createElement(Image,{source:require(\"../../assets/icon-appetite.png\"),style:{width:48,height:48}})),React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{paddingTop:8}},React.createElement(Text,{style:{fontSize:20}},\"\\u98F2\\u98DF\")),isLoading?React.createElement(Reloading,null):appetiteData&&appetiteData[today]?React.createElement(View,null,React.createElement(View,{style:{flex:1,flexDirection:'row',paddingVertical:8}},breakfast?React.createElement(View,{style:{width:'45%',justifyContent:'center',backgroundColor:'#F5F5F5',marginRight:'5%'}},React.createElement(View,{style:{padding:5}},React.createElement(Text,{style:{fontSize:17,color:'rgba(0,0,0,0.8)'}},\"\\u65E9\\u9910\")),React.createElement(View,{style:{justifyContent:'center',alignItems:'center',padding:8}},React.createElement(Text,{style:{fontSize:20}},breakfast.rating||' ')),React.createElement(View,{style:{padding:5,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:17,textAlign:'center'}},breakfast.water_drunk?'有喝水':' '))):null,fruit?React.createElement(View,{style:{width:'45%',justifyContent:'center',backgroundColor:'#F5F5F5',marginRight:'5%'}},React.createElement(View,{style:{padding:5}},React.createElement(Text,{style:{fontSize:17,color:'rgba(0,0,0,0.8)'}},fruit_name!=='水果'&&\"\\u6C34\\u679C\\u9910: \"+fruit_name||'水果')),React.createElement(View,{style:{justifyContent:'center',alignItems:'center',padding:8}},React.createElement(Text,{style:{fontSize:20}},fruit.rating||' ')),React.createElement(View,{style:{padding:5,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:17,textAlign:'center'}},fruit.water_drunk?'有喝水':' '))):null),React.createElement(View,{style:{flex:1,flexDirection:'row',paddingVertical:8}},lunch?React.createElement(View,{style:{width:'45%',justifyContent:'center',backgroundColor:'#F5F5F5',marginRight:'5%'}},React.createElement(View,{style:{padding:5}},React.createElement(Text,{style:{fontSize:17,color:'rgba(0,0,0,0.8)'}},\"\\u5348\\u9910\")),React.createElement(View,{style:{justifyContent:'center',alignItems:'center',padding:8}},React.createElement(Text,{style:{fontSize:20}},lunch.rating||' ')),React.createElement(View,{style:{padding:5,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:17,textAlign:'center'}},lunch.water_drunk?'有喝水':' '))):null,snack?React.createElement(View,{style:{width:'45%',justifyContent:'center',backgroundColor:'#F5F5F5',marginRight:'5%'}},React.createElement(View,{style:{padding:5}},React.createElement(Text,{style:{fontSize:17,color:'rgba(0,0,0,0.8)'}},\"\\u9EDE\\u5FC3\")),React.createElement(View,{style:{justifyContent:'center',alignItems:'center',padding:8}},React.createElement(Text,{style:{fontSize:20}},snack.rating||' ')),React.createElement(View,{style:{padding:5,justifyContent:'center'}},React.createElement(Text,{style:{fontSize:17,textAlign:'center'}},snack.water_drunk?'有喝水':' '))):null)):React.createElement(View,{style:{flex:1,paddingVertical:8}},React.createElement(Text,{style:{fontSize:17}},\"\\u6C92\\u6709\\u65B0\\u7D00\\u9304\")))));}}]);return AppetiteCard;}(React.Component);export{AppetiteCard as default};","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/parent/appetitecard.js"],"names":["React","Card","CardItem","Button","formatDate","fetchData","beautifyDate","Reloading","AppetiteCard","props","state","child_id","fruit_name","isLoading","breakfast","fruit","lunch","snack","bind","date","Date","getTime","prevProps","setState","getHours","start_date","setDate","getDate","end_date","appetiteData","denormalizeAppetiteData","data","today","breakfast_rating","fruit_rating","lunch_rating","snack_rating","parseData","data_string","rating","slice","water_drunk","parseInt","width","flex","flexDirection","height","justifyContent","alignItems","require","paddingTop","fontSize","paddingVertical","backgroundColor","marginRight","padding","color","textAlign","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { View, Text, TextInput, Image } from 'react-native'\nimport { Card, CardItem, Button } from 'native-base'\nimport { formatDate, fetchData, beautifyDate } from '../util'\nimport Reloading from '../reloading'\n\nexport default class AppetiteCard extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      child_id: this.props.child_id,\n      // rankings: ['Ok', 'Good', 'Awesome!'],\n      fruit_name: null,\n      isLoading: true,\n      breakfast: null,\n      fruit: null,\n      lunch: null,\n      snack: null,\n      // rating: {\n      //   'Awesome': '滿滿一碗',\n      //   'Good': '７/8分滿',\n      //   'Ok': '半碗',\n      //   'Poor': '胃口不佳'\n      // }\n    }\n    this.fetchData = this.fetchData.bind(this)\n  }\n\n  componentDidMount() {\n    const { date } = this.props\n    this.fetchData(this.state.child_id, new Date(date.getTime()))\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.date !== prevProps.date) {\n      this.setState({ isLoading: true })\n      this.fetchData(this.props.child_id, new Date(this.props.date.getTime()));\n    } else if (this.props.child_id !== prevProps.child_id) {\n      this.setState({ isLoading: true })\n      this.fetchData(this.props.child_id, new Date(this.props.date.getTime()));\n    }\n  }\n\n  async fetchData(child_id, date) {\n    if (date.getHours() < 17) {\n      this.setState({\n        isLoading: false\n      })\n      return\n    }\n    const start_date = formatDate(date)\n    date.setDate(date.getDate() + 1)\n    const end_date = formatDate(date)\n    const appetiteData = await fetchData('appetite', child_id, start_date, end_date)\n    this.denormalizeAppetiteData(appetiteData.data, date)\n  }\n\n  denormalizeAppetiteData(appetiteData) {\n    const { date } = this.props\n    const today = formatDate(date)\n    if (appetiteData && appetiteData[today]){\n      const { fruit_name, breakfast_rating, fruit_rating, lunch_rating, snack_rating } = appetiteData[today]\n      // console.log('fruit_name: ', fruit_name)\n      const breakfast = this.parseData(breakfast_rating)\n      const fruit = this.parseData(fruit_rating)\n      const lunch = this.parseData(lunch_rating)\n      const snack = this.parseData(snack_rating)\n\n      this.setState({\n        fruit_name,\n        breakfast,\n        fruit,\n        lunch,\n        snack,\n        appetiteData,\n        isLoading: false\n      })\n    } else {\n      this.setState({\n      appetiteData,\n      isLoading: false\n    })\n    }\n  }\n\n  parseData(data_string) {\n    const rating = data_string.slice(0, -1)\n    const water_drunk = parseInt(data_string.slice(-1))\n    // const rating_icons = {\n    //   'Awesome': require('../../assets/icon-appetite-awesome.png'),\n    //   'Good': require('../../assets/icon-appetite-good.png'),\n    //   'Ok': require('../../assets/icon-appetite-ok.png')\n    // }\n    return {\n      // rating_icon: rating_icons[rating],\n      rating,\n      water_drunk\n    }\n  }\n\n  getEmoji() {\n\n  }\n\n  getWaterDrinkingStatus() {\n    \n  }\n\n  render() {\n    const { appetiteData, isLoading, breakfast, fruit, lunch, snack, rating, fruit_name } = this.state\n    const today = formatDate(this.props.date)\n    return (\n      <Card style={{ width: '93%' }}>\n        <View style={{ flex: 1, flexDirection: 'row' }}>\n          <View style={{ width: 56, height: 56, justifyContent: 'center', alignItems: 'center'}}>\n            <Image\n              source={require('../../assets/icon-appetite.png')}\n              style={{\n                  width: 48,\n                  height: 48\n              }}\n            />\n          </View>\n          <View style={{ flex: 1 }}>\n            <View style={{ paddingTop: 8 }}>\n              <Text style={{ fontSize: 20 }}>飲食</Text>\n            </View>\n            {isLoading ? \n              <Reloading />\n              : appetiteData && appetiteData[today] ? \n                <View>\n                  <View style={{ flex: 1, flexDirection: 'row', paddingVertical: 8 }}>\n                  {breakfast ?\n                    <View style={{ width: '45%', justifyContent: 'center', backgroundColor: '#F5F5F5', marginRight: '5%' }}>\n                      <View style={{ padding: 5 }}>\n                        <Text style={{ fontSize: 17, color: 'rgba(0,0,0,0.8)'}}>早餐</Text>\n                      </View>\n                      <View\n                        style={{\n                          justifyContent: 'center',\n                          alignItems: 'center',\n                          padding: 8\n                        }}\n                      >\n                        <Text style={{ fontSize: 20 }}>{breakfast.rating || ' '}</Text>\n                      </View>\n\n                      <View style={{ padding: 5, justifyContent: 'center' }}>\n                        <Text style={{ fontSize: 17, textAlign: 'center' }}>\n                          {breakfast.water_drunk ?\n                            '有喝水' : ' '\n                          }\n                        </Text>\n                      </View>\n                    </View>\n                    : null\n                  }\n\n                  {fruit ?\n                    <View style={{ width: '45%', justifyContent: 'center', backgroundColor: '#F5F5F5', marginRight: '5%' }}>\n                      <View style={{ padding: 5 }}>\n                        <Text style={{ fontSize: 17, color: 'rgba(0,0,0,0.8)'}}>{(fruit_name !== '水果' && `水果餐: ${fruit_name}`) || '水果'}</Text>\n                      </View>\n                      <View\n                        style={{\n                          justifyContent: 'center',\n                          alignItems: 'center',\n                          padding: 8\n                        }}\n                      >\n                        <Text style={{ fontSize: 20 }}>{fruit.rating || ' '}</Text>\n                      </View>\n\n                      <View style={{ padding: 5, justifyContent: 'center' }}>\n                        <Text style={{ fontSize: 17, textAlign: 'center' }}>\n                          {fruit.water_drunk ?\n                            '有喝水' : ' '\n                          }\n                        </Text>\n                      </View>\n                    </View>\n                    : null\n                  }\n                  </View>\n                  <View style={{ flex: 1, flexDirection: 'row', paddingVertical: 8 }}>\n                  {lunch ?\n                    <View style={{ width: '45%', justifyContent: 'center', backgroundColor: '#F5F5F5', marginRight: '5%' }}>\n                      <View style={{ padding: 5 }}>\n                        <Text style={{ fontSize: 17, color: 'rgba(0,0,0,0.8)'}}>午餐</Text>\n                      </View>\n\n                      <View\n                        style={{\n                          justifyContent: 'center',\n                          alignItems: 'center',\n                          padding: 8\n                        }}\n                      >\n                        <Text style={{ fontSize: 20 }}>{lunch.rating || ' '}</Text>\n                      </View>\n\n                      <View style={{ padding: 5, justifyContent: 'center' }}>\n                        <Text style={{ fontSize: 17, textAlign: 'center' }}>\n                          {lunch.water_drunk ?\n                            '有喝水' : ' '\n                          }\n                        </Text>\n                      </View>\n\n                    </View>\n                    : null\n                  }\n\n                  {snack ?\n                    <View style={{ width: '45%', justifyContent: 'center', backgroundColor: '#F5F5F5', marginRight: '5%' }}>\n                      <View style={{ padding: 5 }}>\n                        <Text style={{ fontSize: 17, color: 'rgba(0,0,0,0.8)'}}>點心</Text>\n                      </View>\n\n                      <View\n                        style={{\n                          justifyContent: 'center',\n                          alignItems: 'center',\n                          padding: 8\n                        }}\n                      >\n                        <Text style={{ fontSize: 20 }}>{snack.rating || ' '}</Text>\n                      </View>\n\n                      <View style={{ padding: 5, justifyContent: 'center' }}>\n                        <Text style={{ fontSize: 17, textAlign: 'center' }}>\n                          {snack.water_drunk ?\n                            '有喝水' : ' '\n                          }\n                        </Text>\n                      </View>\n                    </View>\n                    : null\n                  }\n\n                </View>\n                </View>\n            : <View style={{ flex: 1, paddingVertical: 8 }}>\n                <Text style={{ fontSize: 17 }}>沒有新紀錄</Text>\n              </View>\n            }\n          </View>\n        </View>\n      </Card>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}