(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{1257:function(e,t,n){e.exports=n.p+"static/media/app-splash.0a3ec935.gif"},269:function(e,t){},297:function(e,t,n){e.exports=n.p+"static/media/icon-teacher-thumbnail.0693cca6.png"},302:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAB4UlEQVRo3u2YvUvDQBiHf++dGYuLoKJDB4sfuCnEDmprrX+0iikiqOAoOOioUKxLzeAHvTsXBZHY3CXvRcX7jcnl8jzJm+TNASEhISEhIZZJO/HKsBs3fM0/bDUX0k684nKMsB34uLe2RDCHUpvjdHdjmR2+GzekVD2CSdK99VXb48gWXih5BGD2fVPfkNipHZ5dscFrkwCYe990b6Tu1PYvLksLZMCDUyIDHi4SuSUUvUbPAF4yds2Q0UdlymkMPABo6AnFUkJPrY26kjoBUM/YXehO5MBbz0m2J+SU4IJ3EuCS4IR3FigrwQ1fSKCohA/4wgKuEr7gSwnYSmgyI1/wpQVyJQgDGGgA0z7gWQQs7gR8wbMJOEqw9lFsAh8SI6lPKLveYYAHkNjigndqp23yGplIGMhKrha3wMer0hBmxgybKtsAerkoOe95r8+B8ApvMADQ99GKswjkfmGF2FZKbgK49SVB3uA/txKt5oKUKgEw/ytaiSK9jS8JqgLepwRVBf9FosfV3Ikq4QFgsnd6owS1AdxxPNhUJfyP/NT7/BnhmDu3hGikxDfjSn9NJw/Or8eUk4AYSZ6lxfb6ohAi+ZNLixkSxAmfIRHZwjvH+/J6N264Lq+HhISEhPzvvAH4usfGrPqHIQAAAABJRU5ErkJggg=="},436:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsSAAALEgHS3X78AAACQUlEQVR42u1bbW7CMAx9TIhb7CKM/R87yI4y2BF2HWgvsgLHoPuTSihLGtv5aNP5SREsJHbixvZzYIBCoVAoFC5sAHwBuAHoK21XAEezFzaOFW/cbgeJAa5m8rbiU7x7OAlsDNarHaP7ePrvgU4NIJjzDqAjBJ4OwP5hXusY03g+bxLoy+Y7lMUM7cchz24Dzg99pwT6omOZbyJVoD0u9HdsMBatV2NAAhk+3+WejJ4oh6sveQwIbcA37sxkb7H6SC6wChjANcbu7z0y+4AOrnypvtF1pHCBxnrKuVFMX+os0FqL57pYlvWuCwbcreNJzrrWyEWExqK6K7jNjgjtjSLKYt4sfz2N6Ok9TFCqL5sBiparWg7PkAlKmVjI12PliJihxAB3z3tuFoAwn4/pfJnSN0P1PlVeK3yyxahwaDyE1JgqJ5a6Zw+CK4bRSsiZTRBcTBYIBUFuOcstb32xYnKCwq33OY3KIPsE+8jG0HLfAeqd4NRBkJq/Y+4AJbGiWBC8B8Y2Qga3Zcahaqo0btbQanAuMSD2uzpq/uZ+f9CmJmapr8So+ZvLEaLSYPLqSjBfGgOSGGC9IHdOfstMtWjLrP+lLpCbWUYfYeqRPAe4fujz6g2Q+oRSmWc2A/h+2TGFAWadBVx5OqavujTompeyr1g5fGHc7HQT1BIsSHjAB4BvAM+BcZ0ZO5anY/t2S6gGJz0hWg2qAfy4mdddxft7Na+in8sfsJx/mPiUGGBjjHCteOMXs/kNFAqFQqH4g1+9qDy6b2x6HAAAAABJRU5ErkJggg=="},452:function(e,t,n){e.exports=n.p+"static/media/app_logo.fee19d58.png"},540:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ho}));var r=n(5),a=n.n(r),s=n(7),i=n.n(s),o=n(8),c=n.n(o),l=n(10),u=n.n(l),d=n(11),f=n.n(d),p=n(4),h=n.n(p),m=n(0),y=n.n(m),g=n(16),_=n.n(g),E=n(1),b=n(3),v=n(150),S=n(169),w=n(56),C=n(9),D=n(27),k=n(29),x=n(6),O=n.n(x);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R={class_id:"",passcodeTeacherId:{},teachers:{},students:{},isConnected:!1,errMessage:""};var P=n(23),T=n.n(P);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L={initialized:!1,present:new Set,absent:new Set,unmarked:new Set,attendance:{}};function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N={loaded:!1,fruit_name:"\u6c34\u679c",ratings:{},updatedStudents:new Set,err_message:""};function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K={by_student_id:{},records:{by_id:{},all_id:new Set},errorMessage:"",newDataForCreate:new Set,oldDataForEdit:new Set,records_with_error:new Set};function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J={by_student_id:{},records:{},record_id_for_update:new Set,errMessage:"",records_with_error:new Set};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X={loaded:!1,by_student_id:{},records:{by_id:{},all_id:new Set},newDataForCreate:new Set,oldDataForEdit:new Set,dataForRemoval:new Set,errMessage:""};function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te={by_student_id:{},records:{by_id:{},all_id:[]},all_dispatched:!0,students_pending_amount_update:new Set,data_to_update:[],new_data_for_create:new Set,old_data_for_edit:new Set,err_message:""};function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae={message_by_student_id:{},student_id_for_update:new Set};function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe={isConnected:!0,classes:{},pick_up_request:[],admin_passcode:"",viewing_status:"",passcodeAdminId:{},passcodeTeacherId:{},teacherOnDuty:"",teachers:{},students:{},attendance:{},student_present:new Set,student_absent:new Set,student_unmarked:new Set,teacher_present:new Set,teacher_absent:new Set,teacher_unmarked:new Set};var ce=Object(k.b)({classInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0,n=j({},e);switch(t.type){case"SET_CONNECT_STATE":var r=t.isConnected;return j(j({},e),{},{isConnected:r});case"INITIALIZE_CLASS":var a={},s={};return t.teacher_objs.forEach((function(t){a[t[0]]={name:t[1],passcode:t[2],logged_in:!1,in_time:"",out_time:""},e.passcodeTeacherId[t[2]]=t[0]})),t.students.forEach((function(e){var t=e.id,n=e.name,r=e.profile_picture,a=e.blood_type,i=e.address,o=e.home_phone,c=e.father_phone,l=e.mother_phone,u=e.conversation_id;s[t]={name:n,profile_picture:r,blood_type:a,address:i,home_phone:o,father_phone:c,mother_phone:l,conversation_id:u}})),j(j({},e),{},{passcodeTeacherId:e.passcodeTeacherId,teachers:a,students:s});case"SET_CLASS_ID":return j(j({},e),{},{class_id:t.class_id});case"FETCH_ATTENDANCE_SUCCESS":var i=t.data;return i.forEach((function(t){var r=t.attendance_id,a=t.teacher_id,s=t.in_time;n.teachers[a]=j(j({},e.teachers[a]),{},{logged_in:!0,attendance_id:r,in_time:s})})),n;case"MARK_TEACHER_LOGGED_IN":var o=t.teacher_id,c=t.time,l=t.attendance_id;return n.teachers[o]=j(j({},e.teachers[o]),{},{logged_in:!0,in_time:c,attendance_id:l}),n;case"MARK_TEACHER_LOGGED_OUT":var u=t.teacher_id,d=t.time;return n.teachers[u]=j(j({},e.teachers[u]),{},{logged_in:!1,out_time:d,attendance_id:""}),n;case"MARK_STAFF_ATTENDANCE_FAIL":var f=t.errMessage;return{errMessage:f};case"CLEAR_STATE":return{class_id:"",passcodeTeacherId:{},teachers:{},students:{},isConnected:!1,errMessage:""};default:return e}},attendance:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAKR_DISMISS":return z(z({},e),{},{attendance:z(z({},e.attendance),{},O()({},t.student_id,z(z({},e.attendance[t.student_id]),{},{present:!1,out_time:t.out_time})))});case"MARK_ABSENT":return e.unmarked.delete(t.student_id),z(z({},e),{},{absent:new Set([].concat(T()(e.absent),[t.student_id])),unmarked:e.unmarked,attendance:z(z({},e.attendance),{},O()({},t.student_id,z(z({},e.attendance[t.student_id]),{},{excuse_type:t.excuse_type})))});case"CLEAR_STATE":return{initialized:!1,present:new Set,absent:new Set,unmarked:new Set,attendance:{}};default:return e}},medicationrequests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{requests:{},unfinished:[],finished:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_REQUESTS":var n=t.requests,r=t.finished,a=t.unfinished;return M(M({},e),{},{requests:n,finished:r,unfinished:a});case"FILL_MED_REQUEST":var s=M({},e),i=e.unfinished,o=[];s.requests[t.request_id].administered=!0,s.finished=[].concat(T()(e.finished),[t.request_id]);for(var c=0;c<i.length;c++)i[c]!==t.request_id&&o.push(i[c]);return s.unfinished=o,s;case"CLEAR_STATE":return{requests:{},unfinished:[],finished:[]};default:return e}},appetite:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]={Breakfast:"0",Fruit:"0",Lunch:"0",Snack:"0",teacher_id:""}})),q(q({},e),{},{ratings:n});case"FETCH_CLASS_APPETITE_DATA":var r=t.fruit_name,a=t.ratings;return q(q({},e),{},{fruit_name:r,ratings:q(q({},e.ratings),a)});case"EDIT_FRUIT_NAME":var s=t.fruit_name;return q(q({},e),{},{fruit_name:s});case"RATE_APPETITE":var i,o=t.student_id,c=t.mealType,l=t.rating,u=t.teacher_id,d=e.updatedStudents,f=e.ratings[o][c].slice(-1);return""!==l&&(d=new Set([].concat(T()(e.updatedStudents),[o]))),q(q({},e),{},{ratings:q(q({},e.ratings),{},O()({},o,q(q({},e.ratings[o]),{},(i={},O()(i,c,l+f),O()(i,"teacher_id",u),i)))),updatedStudents:d});case"CLEAR_RATINGS":for(var p=t.meal_type,h=q({},e),m=Object.keys(e.ratings),y=new Set,g=0;g<m.length;g++){var _=m[g];"0"!==e.ratings[_][p]&&y.add(_),h.ratings[_]=q(q({},e.ratings[_]),{},O()({},p,"0"))}return h.updatedStudents=y,h;case"SET_ALL_RATINGS_TO_GREAT":var E={},b=[];return Object.keys(e.ratings).map((function(n){var r;b.push(n);var a="1"===e.ratings[n][t.mealType].slice(-1);E[n]=q(q({},e.ratings[n]),{},(r={},O()(r,t.mealType,a?"Awesome1":"Awesome0"),O()(r,"teacher_id",t.teacher_id),r))})),q(q({},e),{},{ratings:E,updatedStudents:new Set(b)});case"MARK_WATER_DRANK":var v,S=t.student_id,w=t.meal_type,C=t.teacher_id,D=new Set([].concat(T()(e.updatedStudents),[S])),k=e.ratings[S][w],x="1"===k.slice(-1);return q(q({},e),{},{ratings:q(q({},e.ratings),{},O()({},S,q(q({},e.ratings[S]),{},(v={},O()(v,w,x?k.slice(0,-1)+"0":k.slice(0,-1)+"1"),O()(v,"teacher_id",C),v)))),updatedStudents:D});case"CLEAR_UPDATED_STUDENTS":case"ON_SEND_APPETITE_SUCCESS":return q(q({},e),{},{updatedStudents:new Set});case"ALERT_ERR_MESSAGE":var A=t.err_message;return q(q({},e),{},{err_message:A});case"CLEAR_ERR_MESSAGE":return q(q({},e),{},{err_message:""});case"ADD_STUDENT_ID_FOR_UPDATE":var j=t.student_id_array;return q(q({},e),{},{updatedStudents:new Set([].concat(T()(e.updatedStudents),T()(j)))});case"CLEAR_STATE":return{loaded:!1,fruit_name:"\u6c34\u679c",ratings:{},updatedStudents:new Set,err_message:""};default:return e}},water:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{byId:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){n[e[0]]=[]})),{byId:n};case"ADD_WATER_RECORD":return e.byId[t.student_id].includes(t.time)||e.byId[t.student_id].push(t.time),H({},e);default:return e}},sleep:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":return by_student_id={},t.students.forEach((function(e){var t=e.id;by_student_id[t]=[]})),V(V({},e),{},{by_student_id:by_student_id});case"FETCH_CLASS_SLEEP_DATA":var n=t.sleepData,r=n.by_student_id,a=n.records;return V(V({},e),{},{by_student_id:V(V({},e.by_student_id),r),records:{by_id:V(V({},e.records.by_id),a.by_id),all_id:new Set([].concat(T()(e.records.all_id),T()(a.all_id)))}});case"SET_SLEEP_TIME":var s=V({},e),i=t.student_id,o=t.index,c=t.sleep_time,l=t.teacher_id,u=s.by_student_id[i],d=u[o],f=s.records.by_id;if(c.setSeconds(0,0),null!==o){if(o>0&&c<=f[u[o-1]].sleep_time){for(var p=s.by_student_id[i],h=p.splice(o,1),m=0,y=0;y<p.length-1;y++)if(f[p[y]].sleep_time>c){m=y;break}p.splice(m,0,h[0]),s.by_student_id[i]=p}s.records.by_id[d].sleep_time=c,s.records.by_id[d].teacher_id=l,s.newDataForCreate.has(d)||s.oldDataForEdit.add(d)}else{var g=s.records.all_id.size;s.by_student_id[i].push(g),s.records.by_id[g]={student_id:i,sleep_time:c,wake_time:null,teacher_id:l},s.records.all_id.add(g),s.errorMessage="",s.newDataForCreate.add(g)}return s;case"SET_WAKE_TIME":var _=V({},e),E=t.student_id,b=t.index,v=t.wake_time,S=t.teacher_id,w=_.by_student_id[E][b];return v.setSeconds(0,0),_.records.by_id[w].wake_time=v,_.records.by_id[w].teacher_id=S,_.errorMessage="",_.newDataForCreate.has(w)||_.oldDataForEdit.add(w),_;case"REMOVE_WAKE_TIME":var C=t.record_id,D=t.teacher_id,k=V({},e),x=new Set(T()(e.records_with_error));return x.delete(C),k.records_with_error=x,k.records.by_id[C].wake_time=null,k.records.by_id[C].teacher_id=D,k.newDataForCreate.has(C)||k.oldDataForEdit.add(C),k;case"CREATE_SLEEP_RECORD_SUCCESS":return V(V({},e),{},{newDataForCreate:new Set});case"CREATE_SLEEP_RECORD_FAIL":return V(V({},e),{},{errorMessage:t.errMessage});case"EDIT_SLEEP_RECORD_SUCCESS":return V(V({},e),{},{oldDataForEdit:new Set});case"EDIT_SLEEP_RECORD_FAIL":return V(V({},e),{},{errorMessage:t.errMessage});case"REMOVE_RECORD_SUCCESS":var A=t.record_id,j=t.student_id,R=e.by_student_id[j],P=R.findIndex((function(e){return e===A})),I=new Set(T()(e.newDataForCreate));I.delete(A);var z=new Set(T()(e.oldDataForEdit));return z.delete(A),V(V({},e),{},{by_student_id:V(V({},e.by_student_id),{},O()({},j,[].concat(T()(R.slice(0,P)),T()(R.slice(P+1))))),newDataForCreate:I,oldDataForEdit:z});case"REMOVE_RECORD_FAIL":return V(V({},e),{},{errorMessage:t.errorMessage});case"MARK_RECORD_ERROR":var L=t.record_id_array;return V(V({},e),{},{records_with_error:new Set([].concat(T()(e.records_with_error),T()(L)))});case"MARK_RECORD_CORRECT":var F=t.record_id,M=new Set(T()(e.records_with_error));return M.delete(F),V(V({},e),{},{records_with_error:M});case"ALERT_SLEEPLOG_ERROR_MESSAGE":var B=t.err_message;return V(V({},e),{},{errorMessage:B});case"CLEAR_SLEEPLOG_ERROR_MESSAGE":return V(V({},e),{},{errorMessage:""});case"CLEAR_STATE":return{by_student_id:{},records:{by_id:{},all_id:new Set},errorMessage:"",newDataForCreate:new Set,oldDataForEdit:new Set,records_with_error:new Set};default:return e}},healthstatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_STUDENT_WELLNESS":var n={},r={},a=0;return t.students.forEach((function(e){n[e]=[a,a+1],r[a]={temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""},r[a+1]={temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""},a+=2})),Q(Q({},e),{},{by_student_id:n,records:r});case"FETCH_CLASS_WELLNESS_DATA":for(var s=t.wellnessData,i=s.by_student_id,o=s.records,c=Object.keys(i),l=0;l<c.length;l++){var u=c[l],d=i[u];1===d.length&&(d.push(e.by_student_id[u][1]),i[u]=d)}return Q(Q({},e),{},{by_student_id:Q(Q({},e.by_student_id),i),records:Q(Q({},e.records),o)});case"ADD_RECORD":var f=e.by_student_id,p=e.records,h=t.student_id,m=Object.keys(e.records).length;return Q(Q({},e),{},{by_student_id:Q(Q({},f),{},O()({},h,[].concat(T()(f[h]),[m]))),records:Q(Q({},p),{},O()({},m,{temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""}))});case"ADD_HEALTH_STATUS":var y=t.student_id,g=t.record_id,_=t.status,E=t.teacher_id,b=new Set([].concat(T()(e.record_id_for_update),[g])),v=Q(Q({},e.records),{},O()({},g,Q(Q({},e.records[g]),{},{student_id:y,status:_,time:new Date,teacher_id:E})));return Q(Q({},e),{},{records:v,record_id_for_update:b});case"ADD_TEMPERATURE":var S=t.student_id,w=t.record_id,C=t.temperature,D=t.teacher_id,k=new Set([].concat(T()(e.record_id_for_update),[w])),x=Q(Q({},e.records),{},O()({},w,Q(Q({},e.records[w]),{},{student_id:S,temperature:C,time:new Date,teacher_id:D})));return Q(Q({},e),{},{records:x,record_id_for_update:k});case"INVALIDATE_WELLNESS_DATA":var A=t.record_id;t.errMessage;return Q(Q({},e),{},{records_with_error:new Set([].concat(T()(e.records_with_error),[A]))});case"SEND_WELLNESS_DATA_SUCCESS":return Q(Q({},e),{},{record_id_for_update:new Set});case"SEND_DATA_FAIL":return Q(Q({},e),{},{errMessage:t.errMessage});case"CLEAR_STATE":return{by_student_id:{},records:{},record_id_for_update:new Set,errMessage:"",records_with_error:new Set};default:return e}},milk:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]=[]})),Z(Z({},e),{},{by_student_id:n});case"FETCH_CLASS_MILK_DATA":var r=t.milkData,a=r.by_student_id,s=r.records;return Z(Z({},e),{},{by_student_id:Z(Z({},e.by_student_id),a),records:{by_id:Z(Z({},e.records.by_id),s.by_id),all_id:new Set([].concat(T()(e.records.all_id),T()(s.all_id)))}});case"FETCH_CLASS_MILK_DATA_SUCCESS":case"ADD_MILK_RECORD":var i=Z({},e),o=t.student_id,c=e.newDataForCreate.size;return i.records.by_id[c]={student_id:o,time:new Date,amount:"",teacher_id:""},i.by_student_id[o].push(c),i.newDataForCreate.add(c),i;case"EDIT_MILK_AMOUNT":var l=Z({},e),u=t.record_id,d=t.milk_amount,f=t.teacher_id;return l.records.by_id[u].amount=d,l.records.by_id[u].teacher_id=f,l.newDataForCreate.has(u)||l.oldDataForEdit.add(u),l;case"EDIT_MILK_TIME":var p=Z({},e),h=t.record_id,m=t.date_time,y=t.teacher_id;return p.records.by_id[h].time=m,p.records.by_id[h].teacher_id=y,p.newDataForCreate.has(h)||p.oldDataForEdit.add(h),p;case"CREATE_DATA_SUCCESS":return Z(Z({},e),{},{newDataForCreate:new Set});case"CREATE_DATA_FAIL":return Z(Z({},e),{},{errMessage:t.errMessage});case"EDIT_DATA_SUCCESS":return Z(Z({},e),{},{oldDataForEdit:new Set});case"EDIT_DATA_FAIL":return Z(Z({},e),{},{errMessage:t.errMessage});case"REMOVE_RECORD":var g=t.student_id,_=t.record_id,E=Z({},e),b=e.by_student_id[g].indexOf(_);return b>-1&&E.by_student_id[g].splice(b,1),E.oldDataForEdit.has(_)&&E.oldDataForEdit.delete(_),E.newDataForCreate.has(_)?E.newDataForCreate.delete(_):E.dataForRemoval.add(_),E;case"REMOVE_MILK_RECORD_SUCCESS":return Z(Z({},e),{},{dataForRemoval:new Set});case"REMOVE_MILK_RECORD_FAIL":return Z(Z({},e),{},{errMessage:"Error occured while removing milk record, please try again"});case"CLEAR_STATE":return{loaded:!1,by_student_id:{},records:{by_id:{},all_id:new Set},newDataForCreate:new Set,oldDataForEdit:new Set,dataForRemoval:new Set,errMessage:""};default:return e}},diaper:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":return by_student_id={},t.students.forEach((function(e){var t=e.id;by_student_id[t]={amount:"",records:[]}})),ee(ee({},e),{},{by_student_id:by_student_id});case"FETCH_CLASS_DIAPER_DATA":return ee(ee({},e),t.diaperData);case"ADD_DIAPER_RECORD":var n=t.student_id,r=t.time,a=t.cloth_diaper,s=t.teacher_id,i=ee({},e),o=i.records.all_id.length;return i.by_student_id[n].records.push(o),a||(i.by_student_id[n].amount-=1,i.students_pending_amount_update.add(n)),i.records.by_id[o]={student_id:n,time:r,cloth_diaper:a,pee_or_poo:"\u5c0f\u4fbf",poo_condition:"\u6b63\u5e38",teacher_id:s},i.records.all_id.push(o),i.all_dispatched=!1,i.new_data_for_create.add(o),i;case"EDIT_DIAPER_TIME":var c=t.record_id,l=t.time,u=t.teacher_id,d=e.new_data_for_create,f=ee({},e);return f.records.by_id[c].time=l,f.records.by_id[c].teacher_id=u,d.has(c)||f.old_data_for_edit.add(c),f;case"SWITCH_PEE_OR_POO":var p=t.record_id,h=t.teacher_id,m=e.new_data_for_create,y=ee({},e),g=y.records.by_id[p].pee_or_poo;return y.records.by_id[p].pee_or_poo="\u5c0f\u4fbf"===g?"\u5927\u4fbf":"\u5c0f\u4fbf",y.records.by_id[p].teacher_id=h,"\u5c0f\u4fbf"===g&&(y.records.by_id[p].poo_condition="\u6b63\u5e38"),m.has(p)||y.old_data_for_edit.add(p),y;case"EDIT_POO_CONDITION":var _=t.record_id,E=t.condition,b=t.teacher_id,v=e.new_data_for_create,S=ee({},e);return console.log("EDIT_POO_CONDITION: ",_,E,b),S.records.by_id[_].poo_condition=E,S.records.by_id[_].teacher_id=b,v.has(_)||S.old_data_for_edit.add(_),S;case"REMOVE_DIAPER_RECORD_SUCCESS":var w=t.student_id,C=t.record_id,D=ee({},e),k=[],x=e.by_student_id[w].records;e.records.by_id[C].cloth_diaper||(D.by_student_id[w].amount+=1);for(var A=0;A<x.length;A++)x[A]!==C&&k.push(x[A]);D.by_student_id[w].records=k;var j=new Set(T()(e.new_data_for_create));j.delete(C),D.new_data_for_create=j;var R=new Set(T()(e.old_data_for_edit));return R.delete(C),D.old_data_for_edit=R,D;case"REMOVE_DIAPER_RECORD_FAIL":var P=t.err_message;return ee(ee({},e),{},{err_message:P});case"UPDATE_DIAPER_AMOUNT":var I=t.student_id,z=t.amount,L=new Set([].concat(T()(e.students_pending_amount_update),[I]));return ee(ee({},e),{},{by_student_id:ee(ee({},e.by_student_id),{},O()({},I,ee(ee({},e.by_student_id[I]),{},{amount:z}))),students_pending_amount_update:L});case"CREATE_DIAPER_RECORD_SUCCESS":return ee(ee({},e),{},{new_data_for_create:new Set,old_data_for_edit:new Set});case"CREATE_DIAPER_RECORD_FAIL":var F=t.err_message;return ee(ee({},e),{},{err_message:F});case"EDIT_DIAPER_RECORD_SUCCESS":return ee(ee({},e),{},{old_data_for_edit:new Set});case"EDIT_DIAPER_RECORD_FAIL":var M=t.err_message;return ee(ee({},e),{},{err_message:M});case"EDIT_DIAPER_AMOUNT_SUCCESS":return ee(ee({},e),{},{students_pending_amount_update:new Set});case"EDIT_DIAPER_AMOUNT_FAIL":var B=t.err_message;return ee(ee({},e),{},{err_message:B});case"CLEAR_ERR_MESSAGE":return ee(ee({},e),{},{err_message:""});case"CLEAR_STATE":return{by_student_id:{},records:{by_id:{},all_id:[]},all_dispatched:!0,students_pending_amount_update:new Set,data_to_update:[],new_data_for_create:new Set,old_data_for_edit:new Set,err_message:""};default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]={text:"",things_to_bring:[0,0,0,0,0],other_item:"\u5176\u5b83",activities:[0,0,0,0,0,0,0,0,0],other_activity:"\u5176\u5b83",teacher_id:""}})),re(re({},e),{},{message_by_student_id:n});case"FETCH_CLASS_MESSAGE_DATA":var r=t.message_data;return re(re({},e),{},{message_by_student_id:re(re({},e.message_by_student_id),r)});case"WRITE_TO_ALL":var a=t.text,s=t.teacher_id,i=re({},e.message_by_student_id);return Object.keys(i).forEach((function(e){i[e].text=a,i[e].teacher_id=s})),re(re(re({},e),i),{},{student_id_for_update:new Set(Object.keys(i))});case"WRITE_TO_ONE":var o=t.text,c=t.student_id,l=t.teacher_id,u=new Set([].concat(T()(e.student_id_for_update),[c]));return re(re({},e),{},{message_by_student_id:re(re({},e.message_by_student_id),{},O()({},c,re(re({},e.message_by_student_id[c]),{},{text:o,teacher_id:l}))),student_id_for_update:u});case"REMIND_ITEMS_TO_BRING_TO_ALL":var d=t.items_to_bring_bool,f=t.teacher_id,p=re({},e.message_by_student_id);return Object.keys(p).forEach((function(e){p[e].things_to_bring=d,p[e].teacher_id=f})),re(re({},e),{},{message_by_student_id:p,student_id_for_update:new Set(Object.keys(p))});case"REMIND_ITEMS_TO_BRING_TO_ONE":var h=t.student_id,m=t.things_to_bring,y=t.teacher_id,g=re({},e.message_by_student_id);return g[h].things_to_bring=m,g[h].teacher_id=y,re(re({},e),{},{message_by_student_id:g,student_id_for_update:new Set([].concat(T()(e.student_id_for_update),[h]))});case"WRITE_ITEM_TO_BRING_TO_ALL":var _=t.item_to_bring,E=t.teacher_id,b=re({},e.message_by_student_id);return Object.keys(b).forEach((function(e){b[e].other_item=""===_?"\u5176\u5b83":_,b[e].teacher_id=E})),re(re({},e),{},{message_by_student_id:b,student_id_for_update:new Set(Object.keys(b))});case"WRITE_ITEM_TO_BRING_TO_ONE":var v=t.student_id,S=t.item_to_bring,w=t.teacher_id;return re(re({},e),{},{message_by_student_id:re(re({},e.message_by_student_id),{},O()({},v,re(re({},e.message_by_student_id[v]),{},{other_item:S,teacher_id:w}))),student_id_for_update:new Set([].concat(T()(e.student_id_for_update),[v]))});case"RECORD_ACTIVITIES_FOR_ALL":var C=t.new_acitivities_bool,D=t.teacher_id,k=re({},e.message_by_student_id);return Object.keys(k).forEach((function(e){k[e].activities=C,k[e].teacher_id=D})),re(re({},e),{},{message_by_student_id:k,student_id_for_update:new Set(Object.keys(k))});case"RECORD_ACTIVITIES_FOR_ONE":var x=t.student_id,A=t.activities,j=t.teacher_id,R=re({},e.message_by_student_id);return R[x].activities=A,R[x].teacher_id=j,re(re({},e),{},{message_by_student_id:R,student_id_for_update:new Set([].concat(T()(e.student_id_for_update),[x]))});case"WRITE_ACTIVITY_FOR_ALL":var P=t.activity,I=t.teacher_id,z=re({},e.message_by_student_id);return Object.keys(z).forEach((function(e){z[e].other_activity=""===P?"\u5176\u5b83":P,z[e].teacher_id=I})),re(re({},e),{},{message_by_student_id:z,student_id_for_update:new Set(Object.keys(z))});case"WRITE_ACTIVITY_FOR_ONE":var L=t.student_id,F=t.activity,M=t.teacher_id;return re(re({},e),{},{message_by_student_id:re(re({},e.message_by_student_id),{},O()({},L,re(re({},e.message_by_student_id[L]),{},{other_activity:F,teacher_id:M}))),student_id_for_update:new Set([].concat(T()(e.student_id_for_update),[L]))});case"SEND_MESSAGE_ON_SUCCESS":return re(re({},e),{},{student_id_for_update:new Set});case"CLEAR_STATE":return{message_by_student_id:{},student_id_for_update:new Set};default:return e}},school:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONNECT_STATE":var n=t.isConnected;return ie(ie({},e),{},{isConnected:n});case"FETCH_CLASSES_SUCCESS":var r=t.classes,a=t.admin_passcode;return ie(ie({},e),{},{classes:r,admin_passcode:a});case"FETCH_TEACHERS_SUCCESS":var s=t.admins,i=t.teachers,o=t.classes,c=ie({},e.classes),l=e.passcodeAdminId,u=e.passcodeTeacherId;return Object.keys(o).forEach((function(e){c[e].teachers=o[e].teachers})),Object.keys(s).forEach((function(e){l[s[e].passcode]=e})),Object.keys(i).forEach((function(e){u[i[e].passcode]=e})),ie(ie({},e),{},{passcodeAdminId:l,passcodeTeacherId:u,teachers:ie(ie({},i),s),classes:c,teacher_unmarked:new Set(Object.keys(i))});case"FETCH_STUDENTS_SUCCESS":var d=t.students,f=t.classes,p=ie({},e.classes);return Object.keys(f).forEach((function(e){p[e].students=f[e].students})),ie(ie({},e),{},{students:d,classes:p,student_unmarked:new Set(Object.keys(d))});case"FETCH_TEACHER_ATTENDANCE_SUCCESS":var h=t.attendance,m=t.teachers,y=ie({},e.teachers),g=new Set(Object.keys(e.teachers)),_=new Set,E=new Set;return Object.keys(m).forEach((function(e){y[e].attendance=m[e].attendance_array,y[e].present=m[e].present,y[e].total_minutes=m[e].total_minutes,m[e].present?_.add(e):E.add(e),g.delete(e)})),ie(ie({},e),{},{teachers:y,attendance:ie(ie({},e.attendance),h),teacher_present:_,teacher_absent:E,teacher_unmarked:g});case"FETCH_STUDENT_ATTENDANCE_SUCCESS":var b=t.attendance,v=t.students,S=t.present,w=t.absent,C=ie({},e.students),D=new Set(Object.keys(e.students));return Object.keys(v).forEach((function(e){C[e].attendance_id=v[e],(S.includes(e)||w.includes(e))&&D.delete(e)})),ie(ie({},e),{},{students:C,attendance:ie(ie({},e.attendance),b),student_present:new Set(T()(S)),student_absent:new Set(T()(w)),student_unmarked:D});case"EDIT_TEACHER_ON_DUTY":var k=t.teacher_id;return ie(ie({},e),{},{teacherOnDuty:k});case"ADD_PICKUP_REQUEST":var x=t.requests;return ie(ie({},e),{},{pick_up_request:x});case"UPDATE_VIEWING_STATUS":var O=t.status;return ie(ie({},e),{},{viewing_status:O});case"UPDATE_PROFILE_PICTURE":var A=t.student_id,j=t.uri,R=ie({},e.students);return R[A].profile_picture=j,ie(ie({},e),{},{students:R});case"EDIT_STUDENT_SUCCESS":var P=t.student_id,I=t.name,z=t.old_class_id,L=t.new_class_id,F=ie({},e.students),M=ie({},e.classes);F[P].name=I,F[P].class_id=L;for(var B=M[z].students,q=[],N=0;N<B.length;N++)B[N]!==P&&q.push(P);return M[z].students=q,(B=M[L].students).push(P),M[L].students=B,ie(ie({},e),{},{students:F,classes:M});case"UPDATE_TEACHER_PROFILE_PICTURE":var U=t.teacher_id,H=t.image_url,W=ie({},e.teachers);return W[U].profile_picture=H,ie(ie({},e),{},{teachers:W});case"CLEAR_STATE":return ie(ie({},e),{},{viewing_status:""});case"CLEAR_SCHOOL_STATE":return{isConnected:!1,classes:{},pick_up_request:[],passcodeAdminId:{},passcodeTeacherId:{},teacherOnDuty:"",teachers:{},students:{},attendance:{},student_present:new Set,student_absent:new Set,student_unmarked:new Set,teacher_present:new Set,teacher_absent:new Set,teacher_unmarked:new Set};default:return e}}}),le=n(13),ue=n(14),de=function(e,t){return{type:"INITIALIZE_CLASS",teacher_objs:e,students:t}},fe=function(e,t,n,r){return{type:"RATE_APPETITE",student_id:e,mealType:t,rating:n,teacher_id:r}},pe=function(e,t){return{type:"MARK_PRESENT",student_id:e,in_time:t}},he=function(e,t){return{type:"MARK_ABSENT",student_id:e,excuse_type:t}},me=function(e,t,n){return{type:"INITIALIZE_REQUESTS",requests:e,finished:t,unfinished:n}},ye=function(e){return{type:"FILL_MED_REQUEST",request_id:e}},ge=function(e){return{type:"FETCH_ATTENDANCE_SUCCESS",data:e}},_e=function(e,t,n){return{type:"MARK_TEACHER_LOGGED_IN",teacher_id:e,time:t,attendance_id:n}},Ee=function(e,t){return{type:"MARK_TEACHER_LOGGED_OUT",teacher_id:e,time:t}},be=function(e){return{type:"CLEAR_RATINGS",meal_type:e}},ve=function(e,t){return{type:"SET_ALL_RATINGS_TO_GREAT",mealType:e,teacher_id:t}},Se=function(e){return{type:"ADD_RECORD",student_id:e}},we=function(e,t,n,r){return{type:"ADD_HEALTH_STATUS",student_id:e,record_id:t,status:n,teacher_id:r}},Ce=function(e,t,n,r){return{type:"ADD_TEMPERATURE",student_id:e,record_id:t,temperature:n,teacher_id:r}},De=function(){return{type:"SEND_WELLNESS_DATA_SUCCESS"}},ke=function(e){return{type:"SEND_DATA_FAIL",errMessage:e}},xe=function(e,t){return{type:"INVALIDATE_WELLNESS_DATA",record_id:e,errMessage:t}},Oe=function(e,t,n,r){return{type:"SET_SLEEP_TIME",student_id:e,index:t,sleep_time:n,teacher_id:r}},Ae=function(e,t){return{type:"REMOVE_RECORD",record_id:e,student_id:t}},je=function(e,t){return{type:"REMOVE_RECORD_SUCCESS",record_id:e,student_id:t}},Re=function(e){return{type:"REMOVE_RECORD_FAIL",errorMessage:e}},Pe=function(e,t,n,r){return{type:"SET_WAKE_TIME",student_id:e,index:t,wake_time:n,teacher_id:r}},Te=function(e,t){return{type:"REMOVE_WAKE_TIME",record_id:e,teacher_id:t}},Ie=function(e,t,n){return{type:"EDIT_MILK_AMOUNT",record_id:e,milk_amount:t,teacher_id:n}},ze=function(e,t,n){return{type:"EDIT_MILK_TIME",record_id:e,date_time:t,teacher_id:n}},Le=function(e,t){return{type:"UPDATE_DIAPER_AMOUNT",student_id:e,amount:t}},Fe=function(e,t,n,r){return{type:"ADD_DIAPER_RECORD",student_id:e,time:t,cloth_diaper:n,teacher_id:r}},Me=function(e,t,n){return{type:"EDIT_DIAPER_TIME",record_id:e,time:t,teacher_id:n}},Be=function(e,t){return{type:"SWITCH_PEE_OR_POO",record_id:e,teacher_id:t}},qe=function(e,t,n){return{type:"EDIT_POO_CONDITION",record_id:e,condition:t,teacher_id:n}},Ne=function(e,t){return{type:"REMOVE_DIAPER_RECORD_SUCCESS",student_id:e,record_id:t}},Ue=function(e){return{type:"REMOVE_DIAPER_RECORD_FAIL",err_message:e}},He=function(){return{type:"CLEAR_ERR_MESSAGE"}},We=function(e){return{type:"ADD_MILK_RECORD",student_id:e}},Ve=function(e,t){return{type:"FETCH_CLASS_APPETITE_DATA",fruit_name:e,ratings:t}},Ke=function(e){return{type:"FETCH_CLASS_WELLNESS_DATA",wellnessData:e}},Ge=function(e){return{type:"FETCH_CLASS_SLEEP_DATA",sleepData:e}},Qe=function(){return{type:"CLEAR_PENDNING_SLEEP_UPDATE"}},Je=function(e){return{type:"FETCH_CLASS_MILK_DATA",milkData:e}},Ye=function(){return{type:"CREATE_DATA_SUCCESS"}},Ze=function(e){return{type:"CREATE_DATA_FAIL",errMessage:e}},Xe=function(){return{type:"EDIT_DATA_SUCCESS"}},$e=function(e){return{type:"EDIT_DATA_FAIL",errMessage:e}},et=function(){return{type:"REMOVE_MILK_RECORD_SUCCESS"}},tt=function(){return{type:"REMOVE_MILK_RECORD_FAIL"}},nt=function(){return{type:"CREATE_SLEEP_RECORD_SUCCESS"}},rt=function(e){return{type:"CREATE_SLEEP_RECORD_FAIL",errMessage:e}},at=function(){return{type:"EDIT_SLEEP_RECORD_SUCCESS"}},st=function(e){return{type:"EDIT_SLEEP_RECORD_FAIL",errMessage:e}},it=function(e){return{type:"FETCH_CLASS_DIAPER_DATA",diaperData:e}},ot=function(){return{type:"CREATE_DIAPER_RECORD_SUCCESS"}},ct=function(e){return{type:"CREATE_DIAPER_RECORD_FAIL",errMessage:e}},lt=function(){return{type:"EDIT_DIAPER_RECORD_SUCCESS"}},ut=function(e){return{type:"EDIT_DIAPER_RECORD_FAIL",errMessage:e}},dt=function(){return{type:"EDIT_DIAPER_AMOUNT_SUCCESS"}},ft=function(e){return{type:"EDIT_DIAPER_AMOUNT_FAIL",errMessage:e}},pt=function(e,t,n){return{type:"REMOVE_RECORD",student_id:e,record_id:t,index:n}},ht=function(){return{type:"CLEAR_STATE"}},mt=function(e){return{type:"SET_CLASS_ID",class_id:e}},yt=function(){return{type:"ON_SEND_APPETITE_SUCCESS"}},gt=function(e){return{type:"ALERT_ERR_MESSAGE",err_message:e}},_t=function(){return{type:"CLEAR_ERR_MESSAGE"}},Et=function(e){return{type:"ADD_STUDENT_ID_FOR_UPDATE",student_id_array:e}},bt=function(e,t,n){return{type:"MARK_WATER_DRANK",student_id:e,meal_type:t,teacher_id:n}},vt=function(e){return{type:"MARK_STAFF_ATTENDANCE_FAIL",errMessage:e}},St=function(e,t){return{type:"WRITE_TO_ALL",text:e,teacher_id:t}},wt=function(e,t,n){return{type:"WRITE_TO_ONE",text:e,student_id:t,teacher_id:n}},Ct=function(e,t){return{type:"REMIND_ITEMS_TO_BRING_TO_ALL",items_to_bring_bool:e,teacher_id:t}},Dt=function(e,t,n){return{type:"REMIND_ITEMS_TO_BRING_TO_ONE",student_id:e,things_to_bring:t,teacher_id:n}},kt=function(e,t){return{type:"RECORD_ACTIVITIES_FOR_ALL",new_acitivities_bool:e,teacher_id:t}},xt=function(e,t,n){return{type:"RECORD_ACTIVITIES_FOR_ONE",student_id:e,activities:t,teacher_id:n}},Ot=function(e,t){return{type:"WRITE_ITEM_TO_BRING_TO_ALL",item_to_bring:e,teacher_id:t}},At=function(e,t,n){return{type:"WRITE_ITEM_TO_BRING_TO_ONE",student_id:e,item_to_bring:t,teacher_id:n}},jt=function(e,t){return{type:"WRITE_ACTIVITY_FOR_ALL",activity:e,teacher_id:t}},Rt=function(e,t,n){return{type:"WRITE_ACTIVITY_FOR_ONE",student_id:e,activity:t,teacher_id:n}},Pt=function(e){return{type:"FETCH_CLASS_MESSAGE_DATA",message_data:e}},Tt=function(e){return{type:"ALERT_SLEEPLOG_ERROR_MESSAGE",err_message:e}},It=function(){return{type:"CLEAR_SLEEPLOG_ERROR_MESSAGE"}},zt=function(e){return{type:"EDIT_FRUIT_NAME",fruit_name:e}},Lt=function(e,t){return{type:"FETCH_CLASSES_SUCCESS",classes:e,admin_passcode:t}},Ft=function(e,t,n){return{type:"FETCH_TEACHERS_SUCCESS",admins:e,teachers:t,classes:n}},Mt=function(e,t){return{type:"FETCH_STUDENTS_SUCCESS",students:e,classes:t}},Bt=function(e){return{type:"INITIALIZE_STUDENT_WELLNESS",students:e}},qt=function(){return{type:"SEND_MESSAGE_ON_SUCCESS"}},Nt=function(e){return{type:"SET_CONNECT_STATE",isConnected:e}},Ut=function(){return{type:"CLEAR_SCHOOL_STATE"}},Ht=function(e,t){return{type:"FETCH_TEACHER_ATTENDANCE_SUCCESS",attendance:e,teachers:t}},Wt=function(e,t,n,r){return{type:"FETCH_STUDENT_ATTENDANCE_SUCCESS",attendance:e,students:t,present:n,absent:r}},Vt=function(e){return{type:"EDIT_TEACHER_ON_DUTY",teacher_id:e}},Kt=function(e){return{type:"ADD_PICKUP_REQUEST",requests:e}},Gt=function(e){return{type:"UPDATE_VIEWING_STATUS",status:e}},Qt=function(e,t){return{type:"UPDATE_PROFILE_PICTURE",student_id:e,uri:t}},Jt=function(e,t,n,r){return{type:"EDIT_STUDENT_SUCCESS",student_id:e,name:t,old_class_id:n,new_class_id:r}},Yt=function(e,t){return{type:"UPDATE_TEACHER_PROFILE_PICTURE",teacher_id:e,image_url:t}},Zt=function(e){return{type:"MARK_RECORD_ERROR",record_id_array:e}},Xt=function(e){return{type:"MARK_RECORD_CORRECT",record_id:e}};function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function en(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var tn=function(e){u()(n,e);var t=en(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={passcode:"",err_message:"",number_array:[1,2,3,4,5,6,7,8,9]},r.handlePasscode=r.handlePasscode.bind(_()(r)),r}return c()(n,[{key:"handlePasscode",value:function(e){this.setState({passcode:this.state.passcode+e})}},{key:"handleEnterPasscode",value:function(){this.props.handleEnterPasscode(this.state.passcode),this.setState({passcode:""})}},{key:"render",value:function(){var e=this,t=this.state,n=t.passcode,r=t.number_array;return y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.5)",width:"100%",height:"100%",flex:1,justifyContent:"center",alignItems:"center",zIndex:2,position:"absolute"},underlayColor:"transparent",onPress:this.props.hideLoginPad},y.a.createElement(C.a,{style:{width:350,height:560,borderRadius:25,zIndex:3,position:"absolute",backgroundColor:"white"},underlayColor:"white",onPress:function(){}},y.a.createElement(le.View,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(le.View,{style:{flex:1,flexDirection:"row",width:310,height:100,margin:5,borderRadius:50,backgroundColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(le.Text,{style:{width:210,fontSize:40,fontWeight:"bold",paddingHorizontal:20,alignSelf:"center"}},n),y.a.createElement(C.a,{style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#ffe1d0",justifyContent:"center",alignItems:"center"},underlayColor:"#fa625f",onPress:function(){return e.setState({passcode:""})}},y.a.createElement(le.Text,{style:{fontSize:30}},"Clear"))),y.a.createElement(le.View,{style:{flex:3,flexDirection:"row",flexWrap:"wrap",justifyContent:"center"}},r.map((function(t){return y.a.createElement(C.a,{key:t,style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#fff1b5",justifyContent:"center",alignItems:"center"},underlayColor:"#f4d41f",onPress:function(){return e.handlePasscode(t)}},y.a.createElement(le.Text,{style:{fontSize:30}},t))}))),y.a.createElement(le.View,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#fff1b5",justifyContent:"center",alignItems:"center"},underlayColor:"#f4d41f",onPress:function(){return e.handlePasscode(0)}},y.a.createElement(le.Text,{style:{fontSize:30}},"0")),y.a.createElement(C.a,{style:{width:210,height:100,margin:5,borderRadius:50,backgroundColor:"#dcf3d0",justifyContent:"center",alignItems:"center"},underlayColor:"#00c07f",onPress:function(){return e.handleEnterPasscode()}},y.a.createElement(le.Text,{style:{fontSize:30}},"Enter"))))))}}]),n}(y.a.Component),nn=(ue.a.create({button:{minWidth:"22%",aspectRatio:1,margin:5,justifyContent:"center"}}),Object(D.b)((function(e){return{class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markTeacherLoggedIn:_e,markTeacherLoggedOut:Ee},e))}))(tn)),rn=n(24);n(523);var an=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return null===e||void 0===e||""===e||-1!==e.indexOf("dev")?"prod":-1!==e.indexOf("staging")?"staging":-1!==e.indexOf("prod")?"prod":void 0}(n(91).a.manifest.releaseChannel);function sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var cn=function(e){return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)},ln=function(e){return e.getFullYear()+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+("0"+e.getDate()).slice(-2)},un=function(e){return("0"+(e.getMonth()+1)).slice(-2)+"/"+("0"+e.getDate()).slice(-2)},dn=function(e){return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},fn=function(e){return e.getHours()+":"+e.getMinutes()},pn=function(e){return e.getHours()+":"+e.getMinutes()},hn=function(e){var t,n;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=!0,r.next=3,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message,a=e.data;if(n>200)t=!1;else if(void 0===n)return{success:!1,statusCode:500,message:r,data:{}};return{success:t,statusCode:n,message:r,data:a}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return n=r.sent,r.abrupt("return",n);case 5:case"end":return r.stop()}}),null,null,null,Promise)},mn=function(e,t){var n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=!0,s.next=3,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,r=e.message,a=e.data;if(t>200)n=!1;else if(void 0===t)return{success:!1,statusCode:500,message:r,data:{}};return{success:n,statusCode:t,message:r,data:a}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return r=s.sent,s.abrupt("return",r);case 5:case"end":return s.stop()}}),null,null,null,Promise)},yn=function(e,t){var n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=!0,s.next=3,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+e,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,r=e.message,a=e.data;if(t>200)n=!1;else if(void 0===t)return{success:!1,statusCode:500,message:r,data:{}};return{success:n,statusCode:t,message:r,data:a}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return r=s.sent,s.abrupt("return",r);case 5:case"end":return s.stop()}}),null,null,null,Promise)},gn=function(e){var t,n;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=!0,r.next=3,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message,a=e.data;if(n>200)t=!1;else if(void 0===n)return{success:!1,statusCode:500,message:r,data:{}};return{success:t,statusCode:n,message:r,data:a}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return n=r.sent,r.abrupt("return",n);case 5:case"end":return r.stop()}}),null,null,null,Promise)},_n=function(e,t,n,r){var s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return s="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/"+e+"/"+t+"?start_date="+n+"&end_date="+r,o.next=3,a.a.awrap(fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.log(e)})));case 3:return i=o.sent,o.abrupt("return",i);case 5:case"end":return o.stop()}}),null,null,null,Promise)},En=function(e,t,n,r){var s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return s="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/"+e+"/class/"+t+"?start_date="+n+"&end_date="+r,o.next=3,a.a.awrap(fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.log(e)})));case 3:return i=o.sent,o.abrupt("return",i);case 5:case"end":return o.stop()}}),null,null,null,Promise)},bn=function(e,t,n){var r,s,i,o,c;return a.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(r=e.record_id_for_update,s=[],0!==r.size){l.next=4;break}return l.abrupt("return",{success:!0,data:[]});case 4:return r.forEach((function(t){s.push(on({record_id:t},e.records[t]))})),vn(s),i={date:n,class_id:t,data_objs:s},o="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/wellness/",l.next=10,a.a.awrap(fetch(o,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message,r=e.data;return t>200||void 0===t?{success:!1,statusCode:t,message:n}:{success:!0,statusCode:t,message:n,data:r}})).catch((function(e){return{success:!1,message:e}})));case 10:return c=l.sent,l.abrupt("return",c);case 12:case"end":return l.stop()}}),null,null,null,Promise)};function vn(e){for(var t=0;t<e.length;t++)e[t].time=dn(e[t].time)}function Sn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Cn=function(e){u()(r,e);var t=wn(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={selected_student_ids:[]},n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"onSelectAttendanceType",value:function(e){var t=this.props.attendance;switch(e){case"present":return void this.setState({selected_student_ids:T()(t.present)});case"absent":return void this.setState({selected_student_ids:T()(t.absent)});case"unmarked":return void this.setState({selected_student_ids:T()(t.unmarked)})}}},{key:"fetchData",value:function(){var e=this,t="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance?date="+cn(new Date)+"&class_id="+this.props.class.class_id;fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){for(var n in t)null!==t[n][0]?e.props.markPresent(n,t[n][0]):null!==t[n][2]&&e.props.markAbsent(n,t[n][2]);e.setState({selected_student_ids:T()(e.props.attendance.unmarked)})})).catch((function(e){return console.log("err: ",e)}))}},{key:"handleOnClick",value:function(e){this.props.showModal(e)}},{key:"render",value:function(){var e=this;return y.a.createElement(le.Card,{style:{flex:1,alignItems:"center",justifyContent:"center"}},y.a.createElement(le.CardItem,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u51fa\u5e2d\u72c0\u6cc1")),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingLeft:5,paddingTop:5}},y.a.createElement(b.a,null,"\u51fa\u5e2d")),y.a.createElement(C.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#dcf3d0"},underlayColor:"#00c07f",onPress:function(){return e.onSelectAttendanceType("present")}},y.a.createElement(b.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0},this.props.attendance.present.size))),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingLeft:5,paddingTop:5}},y.a.createElement(b.a,null,"\u7f3a\u5e2d")),y.a.createElement(C.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#ffe1d0"},underlayColor:"#fa625f",onPress:function(){return e.onSelectAttendanceType("absent")}},y.a.createElement(b.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0},this.props.attendance.absent.size))),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingLeft:5,paddingTop:5}},y.a.createElement(b.a,null,"\u672a\u77e5")),y.a.createElement(C.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#fff1b5"},underlayColor:"#f4d41f",onPress:function(){return e.onSelectAttendanceType("unmarked")}},y.a.createElement(b.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0},this.props.attendance.unmarked.size)))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",flexWrap:"wrap"}},this.state.selected_student_ids.map((function(t){var r=e.props.attendance,a=r.present,s=r.unmarked;r.absent;return y.a.createElement(C.a,{key:t,style:{width:"31%",margin:"1%"},underlayColor:"transparent",onPress:function(){return e.handleOnClick(t)}},y.a.createElement(E.a,{style:Dn.cardContainer},y.a.createElement(le.Card,null,y.a.createElement(le.CardItem,{style:{justifyContent:"center"}},y.a.createElement(rn.a,{source:""===e.props.class.students[t].profile_picture?n(70):{uri:e.props.class.students[t].profile_picture},style:{height:200,width:200,borderRadius:100,borderWidth:10,borderColor:a.has(t)?"#dcf3d0":s.has(t)?"#fff1b5":"#ffe1d0"}})),y.a.createElement(le.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5}},y.a.createElement(b.a,{style:{marginTop:-10}},e.props.class.students[t].name)))))}))))}}]),r}(y.a.Component),Dn=ue.a.create({cardContainer:{paddingVertical:5},thumbnailImage:{height:80,width:80,borderRadius:40}}),kn=(Object(D.b)((function(e){return{attendance:e.attendance,class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sn(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markAbsent:he,markPresent:pe},e))}),null,{forwardRef:!0})(Cn),n(34));function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function On(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var An=function(e){u()(r,e);var t=On(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={timerId:null},n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=new Date,n=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate();fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/medicationrequest?date="+n+"&class_id="+this.props.class_id,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message,a=t.data,s=a.requests,i=a.finished,o=a.unfinished;n>200||"Internal server error"===r?alert("\u6258\u85e5\u55ae\u53d6\u4e0d\u5b8c\u6574\uff0c\u8acb\u548c\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):e.props.initializeRequests(s,i,o)})).catch((function(e){alert("Error, please try again \u6258\u85e5\u55ae\u53d6\u4e0d\u5b8c\u6574\uff0c\u8acb\u548c\u5de5\u7a0b\u5e2b\u806f\u7e6b\uff1a"+e.message)}))}},{key:"render",value:function(){var e=this,t=this.props.students,r=this.props.medication_requests,a=r.requests,s=r.unfinished;return y.a.createElement(le.Card,{style:{flex:1,width:"90%"}},y.a.createElement(E.a,{style:{height:80,justifyContent:"center",marginTop:5}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center",position:"absolute"}},"\u6258\u85e5\u55ae"),y.a.createElement(C.a,{style:{width:"25%",alignSelf:"flex-end",position:"absolute",padding:5,backgroundColor:"#b5e9e9"},onPress:function(){e.props.navigation.push("TeacherMedicineLog",{request_id:null})}},y.a.createElement(b.a,{style:jn.button_text},"\u67e5\u770b"))),y.a.createElement(E.a,{style:{}},y.a.createElement(kn.a,{horizontal:!0},s.map((function(r){var s=a[r],i=s.student_id,o=s.timestamp,c=(s.medication,s.note,s.administered,s.teacher_id,pn(new Date(o)));return y.a.createElement(C.a,{key:r,style:{flex:1,margin:3},onPress:function(){e.props.navigation.push("TeacherMedicineLog",{request_id:r})}},y.a.createElement(le.Card,{style:{flex:1,alignItems:"center",paddingHorizontal:15}},y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:35}},c)),y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(rn.a,{source:""===t[i].profile_picture?n(70):{uri:t[i].profile_picture},style:jn.thumbnailImage})),y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},t[i].name))))})))))}}]),r}(y.a.Component),jn=ue.a.create({card:{width:"90%",flex:1},button:{width:"30%",backgroundColor:"#b5e9e9"},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}}),Rn=Object(D.b)(null,(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({initializeRequests:me},e))}),null,{forwardRef:!0})(An);function Pn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Tn=function(e){u()(n,e);var t=Pn(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){return y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,null,"Loading..."),y.a.createElement(v.a,{size:"large"}))}}]),n}(y.a.Component),In=n(33);function zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ln(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Fn=function(e){u()(n,e);var t=Ln(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).timer=function(){return setTimeout((function(){r.setState({color:"#ffe1d0"===r.state.color?"#fa625f":"#ffe1d0"}),r.timeoutId=r.timer()}),2e3)},r.state={color:"#ffe1d0",requestQueue:[],isLoading:!0},r.onConfirm=r.onConfirm.bind(_()(r)),r}return c()(n,[{key:"componentDidMount",value:function(){this.timeoutId=this.timer()}},{key:"onConfirm",value:function(e,t){var n=this,r=T()(this.props.pick_up_request);fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance/pickup-request?request_id="+e,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var a=e.statusCode,s=e.message;200===a?(r.splice(t,1),n.props.addPickupRequest(r),0===r.length&&n.props.navigation.goBack()):In.a.alert("Sorry \u53d6\u5f97\u63a5\u56de\u901a\u77e5\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+s,[{text:"Ok"}])})).catch((function(e){console.log("err: ",e)}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.pick_up_request,r=t.students;return y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center",flexWrap:"wrap"}},n.map((function(t,n){var a=t.id,s=t.student_id,i=t.arrival_time,o=r[s];return y.a.createElement(E.a,{key:n,style:{width:"45%",height:"45%",marginTop:"5%",backgroundColor:e.state.color}},y.a.createElement(E.a,{style:{flex:2,alignItems:"center",justifyContent:"center"}},y.a.createElement(rn.a,{source:{uri:o.profile_picture},style:{width:"80%",aspectRatio:1}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:80,textAlign:"center"}},i)),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(C.a,{style:{backgroundColor:"grey",padding:15,alignSelf:"flex-end",justifyContent:"center",marginRight:15},onPress:function(){return e.onConfirm(a,n)}},y.a.createElement(b.a,{style:{fontSize:35,textAlign:"center",color:"lightgrey"}},"\u78ba\u8a8d")))))})))}}]),n}(y.a.Component),Mn=Object(D.b)((function(e){return{students:e.school.students,pick_up_request:e.school.pick_up_request}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zn(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({addPickupRequest:Kt},e))}),null,{forwardRef:!0})(Fn),Bn=n(50),qn=n(22),Nn=n(21),Un=n(222);function Hn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Wn=function(e){u()(n,e);var t=Hn(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={selectedIndex:0},r}return c()(n,[{key:"isIOS",value:function(){return"ios"===Nn.a.OS}},{key:"showActionSheet",value:function(){}},{key:"iosShowActionSheet",value:function(){var e=this,t=this.props.options;Un.a.showActionSheetWithOptions({options:t,cancelButtonIndex:t.length-1},(function(n){e.setState({selectedIndex:n}),e.props.handleSelectValue(t[n])}))}},{key:"androidShowActionSheet",value:function(){var e=this,t=this.props.options;le.ActionSheet.show({options:t,cancelButtonIndex:t.length-1},(function(n){e.setState({selectedIndex:n}),e.props.handleSelectValue(t[n])}))}},{key:"isOtherSelected",value:function(){var e=this.props,t=e.selectedValue;return e.options.indexOf(t)<0}},{key:"render",value:function(){var e=this,t=this.props,n=t.selectedValue,r=t.style,a=t.textStyle,s=t.disabled;return y.a.createElement(C.a,{disabled:s,style:r,onPress:function(){return e.props.showSelect()}},y.a.createElement(b.a,{style:a},n))}}]),n}(y.a.Component);function Vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Gn=function(e){u()(n,e);var t=Kn(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={other_option:""},r}return c()(n,[{key:"handleSelectStatus",value:function(e,t,n){"Cancel"!==n&&("\u5176\u4ed6"===n?this.setState({other_option:"\u5176\u4ed6"}):this.props.addHealthStatus(e,t,n,this.props.teacher_id))}},{key:"handleTempInput",value:function(e,t,n){var r="."===n.slice(-1)?n.slice(0,2):3===n.length?n.slice(0,2)+"."+n.slice(-1):n;this.props.addTemperature(e,t,r,this.props.teacher_id)}},{key:"render",value:function(){var e=this,t=this.props,n=t.student_id,r=t.record_id,a=t.records,s=t.records_with_error,i=t.autoFocus,o=a[r];return y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",borderWidth:2,borderColor:s.has(r)?"red":"transparent"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"rgba(255,255,255, 0.5)",marginRight:"10%",justifyContent:"center",padding:5}},y.a.createElement(qn.a,{style:{fontSize:40},autoFocus:i,keyboardType:"decimal-pad",placeholder:"\u9ad4\u6eab",value:""+o.temperature,onChangeText:function(t){e.handleTempInput(n,r,t)}}),""===o.temperature?null:y.a.createElement(b.a,{style:{fontSize:30}},"\xb0")),y.a.createElement(E.a,{style:{flex:2}},""===this.state.other_option?y.a.createElement(Wn,{style:{backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:5},textStyle:{fontSize:40},selectedValue:o.status,options:["\u5065\u5eb7\u5bf6\u5bf6","\u767c\u71d2","\u5589\u56a8\u504f\u7d05","\u54b3\u55fd","\u6d41\u2fd0\u6d95","\u982d\u75db","\u6d3b\u52d5\u2f12\u4e0d\u4f73","\u5614\u5410","\u7cde\u4fbf\u5e36\u6709\u2f8e\u7d72","\u62c9\u809a\u5b50","\u5176\u4ed6","Cancel"],handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectStatus(n,r,t)}}):y.a.createElement(qn.a,{style:{fontSize:40,backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:2},keyboardType:"default",autoFocus:""!==this.state.other_option,selectTextOnFocus:!0,value:o.status,onChangeText:function(t){e.handleSelectStatus(n,r,t)},onBlur:function(){return e.setState({other_option:""})}})))}}]),n}(y.a.Component),Qn=Object(D.b)((function(e){return{records:e.healthstatus.records,records_with_error:e.healthstatus.records_with_error}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vn(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({addHealthStatus:we,addTemperature:Ce},e))}))(Gn);function Jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Zn=function(e){u()(r,e);var t=Yn(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={class_id:""},n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props,t=e.class_id,n=e.student_id;"all"===t?this.getClassIdByStudentId(n):this.setState({class_id:t})}},{key:"getClassIdByStudentId",value:function(e){for(var t=this.props.classes,n=Object.keys(t),r="",a=0;a<n.length;a++)for(var s=t[n[a]].students,i=0;i<s.length;i++)s[i]===e&&(r=n[a]);this.setState({class_id:r})}},{key:"handleSend",value:function(e){var t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=this.props,n=t.wellness,r=t.isConnected,s=this.state.class_id,i=n.records,""!==i[e].temperature){c.next=7;break}return In.a.alert("\u672a\u586b\u5beb!","",[{text:"OK"}]),c.abrupt("return");case 7:return r||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),c.next=10,a.a.awrap(bn(n,s,cn(new Date)));case 10:(o=c.sent).success?(this.props.fetchStudentAttendance(),this.props.sendWellnessDataSuccess(),this.props.hideModal()):this.props.sendWellnessDataFail(o.message);case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"markAbsent",value:function(){var e,t,n,r,s,i,o,c;return a.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props,t=e.student_id,n=e.school_id,r=this.state.class_id,s={student_id:t,class_id:r,school_id:n,startDate:cn(new Date),endDate:cn(new Date),excuse_type:"none-medical",note:"\u6821\u65b9\u586b\u5beb"},l.next=5,a.a.awrap(mn("/absence-excuse",s));case 5:if(i=l.sent,o=i.success,i.statusCode,c=i.message,i.data,o){l.next=10;break}return In.a.alert("Sorry \u6a19\u8a18\u5b78\u751f\u7f3a\u5e2d\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+c,[{text:"Ok"}]),l.abrupt("return");case 10:this.props.fetchStudentAttendance(),this.props.hideModal();case 12:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props,r=(t.show,t.student_id),a=(t.teacher_id,t.students),s=t.student_unmarked,i=t.student_absent,o=t.teacherOnDuty,c=a[r],l=this.props.wellness.by_student_id[r][0];return y.a.createElement(E.a,{style:{flex:1,width:"80%",height:"70%",backgroundColor:i.has(r)?"#ffe1d0":s.has(r)?"#fff1b5":"#dcf3d0",zIndex:3,position:"absolute"}},y.a.createElement(E.a,{style:{flex:2,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(rn.a,{source:""===c.profile_picture?n(70):{uri:c.profile_picture},style:Xn.thumbnailImage})),y.a.createElement(E.a,{style:{flex:1,alignItems:"flex-start"}},y.a.createElement(b.a,{style:{fontSize:60}},c.name),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"lightgrey",justifyContent:"center"},onPress:function(){return e.markAbsent()}},y.a.createElement(b.a,{style:{fontSize:40}},"\u7f3a\u5e2d")))),y.a.createElement(E.a,{style:{flex:2}},y.a.createElement(E.a,{style:{flex:3,alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:20}},"\u8840\u578b: ",c.blood_type," "),y.a.createElement(b.a,{style:{fontSize:20}},"\u5730\u5740: ",c.address),y.a.createElement(b.a,{style:{fontSize:20}},"\u5bb6\u88e1\u96fb\u8a71: ",c.home_phone),y.a.createElement(b.a,{style:{fontSize:20}},"\uff08\u7236\uff09\u624b\u6a5f: ",c.father_phone),y.a.createElement(b.a,{style:{fontSize:20}},"\uff08\u6bcd\uff09\u624b\u6a5f: ",c.mother_phone)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingHorizontal:30}},s.has(r)?y.a.createElement(Qn,{student_id:r,teacher_id:o,record_id:l,autoFocus:!0}):null)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},s.has(r)?y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{style:{backgroundColor:"red",flex:1,height:60,justifyContent:"center",alignItems:"center",margin:8},onPress:this.props.hideModal},y.a.createElement(b.a,{style:{fontSize:30}},"\u53d6\u6d88")),y.a.createElement(C.a,{style:{backgroundColor:"grey",flex:1,height:60,justifyContent:"center",alignItems:"center",margin:8},onPress:function(){return e.handleSend(l)}},y.a.createElement(b.a,{style:{fontSize:30}},"\u9001\u51fa"))):null))}}]),r}(y.a.Component),Xn=ue.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),$n=Object(D.b)((function(e){return{classes:e.school.classes,student_absent:e.school.student_absent,student_unmarked:e.school.student_unmarked,students:e.school.students,wellness:e.healthstatus,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jn(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({sendWellnessDataFail:ke,sendWellnessDataSuccess:De},e))}))(Zn);function er(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function tr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var nr=function(e){u()(r,e);var t=tr(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={temperature:""},n}return c()(r,[{key:"editTemperature",value:function(e){var t="."===e.slice(-1)?e.slice(0,2):3===e.length?e.slice(0,2)+"."+e.slice(-1):e;this.setState({temperature:t})}},{key:"clock",value:function(){var e=this.props,t=e.isConnected,n=e.teacher_id,r=e.teachers[n];if(t)if(r.present){var a=r.attendance[r.attendance.length-1];this.clockout(a)}else this.clockin();else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"clockout",value:function(e){var t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,a.a.awrap(yn("/staff-attendance/"+e,{out_time:cn(new Date)+" "+dn(new Date)}));case 2:t=s.sent,n=t.success,t.statusCode,r=t.message,t.data,n||In.a.alert("Sorry \u6253\u5361\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r,[{text:"Ok"}]),this.props.fetchTeacherAttendance(),this.props.hideModal();case 7:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"clockin",value:function(){var e,t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props,t=e.isConnected,n=e.teacher_id,r=this.state.temperature,t||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),c.next=5,a.a.awrap(mn("/staff-attendance",{teacher_id:n,in_time:cn(new Date)+" "+dn(new Date),temperature:r||0}));case 5:if(s=c.sent,i=s.success,s.statusCode,o=s.message,s.data,i){c.next=10;break}return In.a.alert("Sorry \u6253\u5361\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o,[{text:"Ok"}]),c.abrupt("return");case 10:this.props.fetchTeacherAttendance(),this.props.hideModal();case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"editTeacherOnDuty",value:function(e){var t=this.props,n=t.teacherOnDuty,r=t.teachers,a="\u672a\u767b\u5165";n===e?this.props.editTeacherOnDuty(""):(this.props.editTeacherOnDuty(e),a=r[e].name),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{paddingRight:20}},y.a.createElement(b.a,{style:{fontSize:30}},"\u503c\u73ed\u8001\u5e2b\uff1a"+a))}})}},{key:"render",value:function(){var e=this,t=this.props,r=(t.show,t.student_id,t.teacher_id),a=t.teachers,s=t.unmarked,i=t.absent,o=t.teacherOnDuty,c=t.attendance,l=this.state.temperature,u=a[r];return y.a.createElement(E.a,{style:{flex:1,width:"80%",height:"70%",backgroundColor:i.has(r)?"#ffe1d0":s.has(r)?"#fff1b5":"#dcf3d0",zIndex:3,position:"absolute"}},y.a.createElement(E.a,{style:{flex:3,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(rn.a,{source:""===u.profile_picture?n(297):{uri:u.profile_picture},style:rr.thumbnailImage}),y.a.createElement(qn.a,{style:{fontSize:60},keyboardType:"decimal-pad",placeholder:"\u9ad4\u6eab",value:""+l,onChangeText:function(t){return e.editTemperature(t)}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:60}},u.name),y.a.createElement(C.a,{onPress:function(){return e.editTeacherOnDuty(r)},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(rn.a,{source:n(o===r?817:818),style:{width:80,aspectRatio:1}}),y.a.createElement(b.a,{style:{fontSize:40}},"\u503c\u73ed\u8001\u5e2b"))))),y.a.createElement(E.a,{style:{flex:2,paddingHorizontal:30,justifyContent:"space-evenly",alignItems:"center"}},u.attendance&&u.attendance.map((function(e){var t=c[e];return y.a.createElement(E.a,{key:e,style:{flex:1,flexDirection:"row",width:"60%",justifyContent:"space-around"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:50}},t.in_time)),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:50}},t.out_time)))})),y.a.createElement(E.a,{style:{flexDirection:"row",alignSelf:"flex-end",backgroundColor:"white",padding:10}},y.a.createElement(b.a,{style:{fontSize:25}},"\u4eca\u65e5\u7e3d\u8a08: ",Math.round(100*u.total_minutes)/100))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{style:{backgroundColor:"red",flex:1,height:80,justifyContent:"center",alignItems:"center",margin:8},onPress:this.props.hideModal},y.a.createElement(b.a,{style:{fontSize:40}},"\u53d6\u6d88")),y.a.createElement(C.a,{style:{backgroundColor:"grey",flex:1,height:80,justifyContent:"center",alignItems:"center",margin:8},onPress:function(){return e.clock()}},y.a.createElement(b.a,{style:{fontSize:40}},"\u6253\u5361")))))}}]),r}(y.a.Component),rr=ue.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),ar=Object(D.b)((function(e){return{attendance:e.school.attendance,teachers:e.school.teachers,teacherOnDuty:e.school.teacherOnDuty,unmarked:e.school.teacher_unmarked,absent:e.school.teacher_absent,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?er(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markPresent:pe,sendWellnessDataFail:ke,editTeacherOnDuty:Vt},e))}))(nr);function sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ir(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var or=function(e){u()(n,e);var t=ir(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.show,r=t.student_id,a=t.teacher_id,s=t.students,i=(t.unmarked,t.absent,t.teacherOnDuty),o=t.class_id,c=t.school_id;if(!n)return null;s[r];return y.a.createElement(Bn.a,{style:{backgroundColor:"transparent",justifyContent:"center",alignItems:"center",zIndex:2,position:"absolute",width:"100%",height:"100%"},behavior:"height",enabled:!0},y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.8)",width:"100%",height:"100%"},onPress:this.props.hideModal},y.a.createElement(E.a,null)),""!==r?y.a.createElement($n,{student_id:r,teacherOnDuty:i,class_id:o,school_id:c,fetchStudentAttendance:function(){return e.props.fetchStudentAttendance()},hideModal:this.props.hideModal}):y.a.createElement(ar,{teacher_id:a,teacherOnDuty:i,navigation:this.props.navigation,fetchTeacherAttendance:function(){return e.props.fetchTeacherAttendance()},hideModal:this.props.hideModal}))}}]),n}(y.a.Component),cr=(ue.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),Object(D.b)((function(e){return{students:e.school.students,isConnected:e.classInfo.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sr(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markPresent:pe,sendWellnessDataFail:ke},e))}))(or)),lr=n(177);function ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var fr=function(e){u()(r,e);var t=dr(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={messages:[]},n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e,t,n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.class_id,t=new Date,o.next=4,a.a.awrap(hn("/message/class/"+e+"/unread?date="+cn(t)));case 4:if(n=o.sent,r=n.success,n.statusCode,s=n.message,i=n.data,r){o.next=9;break}return alert("Sorry \u53d6\u5f97\u5bb6\u9577\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),o.abrupt("return");case 9:this.setState({messages:i});case 10:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.students,r=this.state.messages;return y.a.createElement(le.Card,{style:{flex:1,width:"90%"}},y.a.createElement(E.a,{style:{height:80,justifyContent:"center",marginTop:5}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center",position:"absolute"}},"\u8a0a\u606f")),y.a.createElement(E.a,{style:{}},y.a.createElement(kn.a,{horizontal:!0},r.map((function(a,s){a.activities,a.items_to_bring,a.message_for_teacher,a.other_activity,a.other_item;var i=a.student_id;a.teacher_id,a.text;return y.a.createElement(C.a,{key:s,style:{flex:1,margin:3},onPress:function(){e.props.navigation.push("Inbox",{messages:r,students:t})}},y.a.createElement(le.Card,{style:{flex:1,alignItems:"center",padding:15}},y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(rn.a,{source:""===t[i].profile_picture?n(70):{uri:t[i].profile_picture},style:pr.thumbnailImage})),y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},t[i].name))))})))))}}]),r}(y.a.Component),pr=ue.a.create({card:{width:"90%",flex:1},button:{width:"30%",backgroundColor:"#b5e9e9"},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}}),hr=Object(D.b)(null,(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ur(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ur(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({},e))}),null,{forwardRef:!0})(fr);function mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var gr=function(e){u()(n,e);var t=yr(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).timer=function(e){return setTimeout((function(){r.poll(e)}),1e4)},r.state={isLoading:!0,showLoginNumberPad:!1,pageClicked:"",alertForPickup:!1,pickupQueue:[],showModal:!1,modalStudentId:"",modalTeacherId:"",isAdmin:!1,admin_id:""},r.initializeClass=r.initializeClass.bind(_()(r)),r.handleEnterPasscode=r.handleEnterPasscode.bind(_()(r)),r.hideLoginPad=r.hideLoginPad.bind(_()(r)),r.onConfirmPickup=r.onConfirmPickup.bind(_()(r)),r.showModal=r.showModal.bind(_()(r)),r.hideModal=r.hideModal.bind(_()(r)),r}return c()(n,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=lr.a.addEventListener((function(t){var n=t.isConnected;e.props.setConnectState(n)}));var t=this.props.route.params,n=t.class_id,r=t.class_name,a=t.isAdmin,s=t.admin_id;this.setState({isAdmin:a,admin_id:s}),this.props.setClassId(n),this.initializeClass(n),this.timeoutId=this.timer(n),this.props.navigation.setOptions({title:r})}},{key:"poll",value:function(e){var t,n=this;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/class/"+e+"/updates",r.next=3,a.a.awrap(fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.data.forEach((function(e){n.refs[e].fetchData()}))})).catch((function(e){console.log("err: ",e)})));case 3:this.timeoutId=this.timer(e);case 4:case"end":return r.stop()}}),null,this,null,Promise)}},{key:"initializeClass",value:function(e){var t=this;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/class/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){t.props.initializeClass(e.teachers,e.students),t.setState({isLoading:!1})})).catch((function(e){console.log("err: ",e)}))}},{key:"handleEnterPasscode",value:function(e){var t=this.props.class.passcodeTeacherId[e];void 0===t?le.Toast.show({text:"Wrong password!",buttonText:"Okay",position:"top",type:"warning",duration:3e3}):"attendance_modal"===this.state.pageClicked?this.setState({showModal:!0,showLoginNumberPad:!1,modalTeacherId:t}):(this.props.navigation.navigate(this.state.pageClicked,{teacher_id:t,class:this.props.class}),this.setState({showLoginNumberPad:!1}))}},{key:"pageClicked",value:function(e){var t=this.state,n=t.isAdmin,r=t.admin_id;n?this.props.navigation.push(e,{class:this.props.class,teacher_id:r}):this.setState({showLoginNumberPad:!0,pageClicked:e})}},{key:"hideLoginPad",value:function(){this.setState({showLoginNumberPad:!1})}},{key:"onConfirmPickup",value:function(){var e=this.state.pickupQueue.slice(1,this.state.pickupQueue.length);this.setState({alertForPickup:0!==e.length,pickupQueue:e})}},{key:"showModal",value:function(e){this.setState({showLoginNumberPad:!0,pageClicked:"attendance_modal",modalStudentId:e})}},{key:"hideModal",value:function(){this.setState({showModal:!1})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId),this.props.clearState(),this.unsubscribe()}},{key:"render",value:function(){var e=this,t=this.props.route.params.class_id;return this.state.isLoading?y.a.createElement(Tn,null):y.a.createElement(le.Container,{style:{flex:1}},this.state.showLoginNumberPad?y.a.createElement(nn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:this.hideLoginPad}):null,y.a.createElement(cr,{show:this.state.showModal,student_id:this.state.modalStudentId,teacher_id:this.state.modalTeacherId,class_id:t,hideModal:this.hideModal}),y.a.createElement(le.Content,{contentContainerStyle:{marginTop:30,paddingBottom:50,alignItems:"center",justifyContent:"center"}},y.a.createElement(hr,{ref:"messages",class_id:t,students:this.props.class.students,navigation:this.props.navigation}),y.a.createElement(Rn,{ref:"med_request",class_id:t,students:this.props.class.students,medication_requests:this.props.medication_requests,navigation:this.props.navigation}),y.a.createElement(E.a,{style:_r.button_row},y.a.createElement(le.Button,{style:_r.record_button,onPress:function(){return e.pageClicked("WellnessLog")}},y.a.createElement(le.Text,{style:_r.button_text},"\u5065\u5eb7")),y.a.createElement(le.Button,{style:_r.record_button,onPress:function(){return e.pageClicked("MessageForParents")}},y.a.createElement(le.Text,{style:_r.button_text},"\u8001\u5e2b","\n","\uf9cd\u2f94")),y.a.createElement(le.Button,{style:_r.record_button,onPress:function(){return e.pageClicked("TeacherAppetiteLog")}},y.a.createElement(le.Text,{style:_r.button_text},"\u98f2\u98df"))),y.a.createElement(E.a,{style:_r.button_row},y.a.createElement(le.Button,{style:_r.record_button,onPress:function(){return e.pageClicked("TeacherSleepLog")}},y.a.createElement(le.Text,{style:_r.button_text},"\u7761\u7720")),y.a.createElement(le.Button,{style:_r.record_button,onPress:function(){return e.pageClicked("TeacherMilkLog")}},y.a.createElement(le.Text,{style:_r.button_text},"\u9935\u5976")),y.a.createElement(le.Button,{style:_r.record_button,onPress:function(){return e.pageClicked("DiaperLog")}},y.a.createElement(le.Text,{style:_r.button_text},"\u63db\u5c3f\u5e03"))),y.a.createElement(le.Button,{style:_r.button,onPress:function(){return e.props.navigation.goBack()}},y.a.createElement(le.Text,{style:_r.button_text},"\u8fd4\u56de"))))}}]),n}(y.a.Component),_r=ue.a.create({card:{width:"90%"},button_row:{width:"90%",height:100,justifyContent:"space-between",flexDirection:"row",marginVertical:7,paddingHorizontal:3},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:40},record_button:{width:"30%",height:"100%",backgroundColor:"#b5e9e9"},button:{width:"30%",backgroundColor:"#b5e9e9"}}),Er=Object(D.b)((function(e){return{class:e.classInfo,medication_requests:e.medicationrequests,attendance:e.attendance,teachers:e.school.teachers}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mr(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({setConnectState:Nt,initializeClass:de,setClassId:mt,clearState:ht},e))}))(gr),br=n(472),vr=n(1290);function Sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Cr=function(e){u()(n,e);var t=wr(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={classes:[],err_message:"",showLoginNumberPad:!1,pageClicked:"",class_id:"",admin_id:""},r.handleSignOut=r.handleSignOut.bind(_()(r)),r}return c()(n,[{key:"componentDidMount",value:function(){var e,t=this;return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return window.addEventListener("offline",(function(e){t.props.setConnectState(!1)})),window.addEventListener("online",(function(){t.props.setConnectState(!0)})),e=this.props.route.params.school_id,n.next=5,a.a.awrap(this.fetchClassIdAndName());case 5:this.fetchTeacherData(e),this.fetchStudentData(e);case 7:case"end":return n.stop()}}),null,this,null,Promise)}},{key:"fetchClassIdAndName",value:function(){var e,t=this;return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.props.route.params.school_id,n.next=3,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/school/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message,a=e.data;if(n>200||"Internal server error"===r)alert("Sorry \u53d6\u5f97\u6559\u5ba4\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+r);else{t.setState({classes:a.classes});var s={};a.classes.forEach((function(e){var t=e.id,n=e.name;s[t]={teachers:[],students:[],name:n}})),t.props.fetchClassesSuccess(s,a.admin_passcode)}})).catch((function(e){alert("Sorry \u53d6\u5f97\u6559\u5ba4\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b")})));case 3:case"end":return n.stop()}}),null,this,null,Promise)}},{key:"fetchTeacherData",value:function(e){var t,n,r,s,i,o,c;return a.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,a.a.awrap(hn("/school/"+e+"/teacher"));case 2:if(t=l.sent,n=t.success,t.statusCode,r=t.message,s=t.data,n){l.next=7;break}return alert("Sorry \u53d6\u5f97\u6559\u5e2b\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),l.abrupt("return");case 7:i=s.admins,o=s.teachers,c=s.classes,this.props.fetchTeachersSuccess(i,o,c),this.getAdminId(o);case 10:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"getAdminId",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)if("\u7ba1\u7406\u54e1"===e[t[n]].name)return void this.setState({admin_id:t[n]})}},{key:"fetchStudentData",value:function(e){var t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,a.a.awrap(hn("/school/"+e+"/student"));case 2:if(t=c.sent,n=t.success,t.statusCode,r=t.message,s=t.data,n){c.next=7;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),c.abrupt("return");case 7:i=s.students,o=s.classes,this.props.fetchStudentsSuccess(i,o),this.props.initializeStudentWellness(Object.keys(i));case 10:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"fetchPickupRequest",value:function(e){var t=this;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance/pickup-request?school_id="+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.data.length>0&&(t.props.addPickupRequest(e.data),t.props.navigation.navigate("PickupAlert",{}))})).catch((function(e){alert("Sorry \u53d6\u5f97\u63a5\u56de\u544a\u77e5\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b")}))}},{key:"fetchStudentAttendance",value:function(){var e,t,n,r,s,i,o,c,l,u;return a.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e=this.props.route.params.school_id,t=cn(new Date),d.next=4,a.a.awrap(hn("/attendance?school_id="+e+"&date="+t));case 4:if(n=d.sent,r=n.success,n.statusCode,s=n.message,i=n.data,r){d.next=9;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u51fa\u5e2d\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),d.abrupt("return");case 9:o=i.attendance,c=i.students,l=i.present,u=i.absent,this.props.fetchStudentAttendanceSuccess(o,c,l,u);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"handleEnterPasscode",value:function(e){console.log(e);var t=this.props.route.params,n=t.school_name,r=t.school_id,a=this.props,s=a.passcodeAdminId,i=a.passcodeTeacherId,o=a.classes,c=a.teachers,l=this.state,u=l.pageClicked,d=l.class_id,f=i[e],p=s[e];console.log(p),void 0===f&&void 0===p?alert("\u5bc6\u78bc\u4e0d\u6b63\u78ba\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"):void 0!==p?(this.setState({showLoginNumberPad:!1}),this.props.navigation.navigate(u,{school_name:n,school_id:r,class_id:d,class_name:"\u7ba1\u7406\u54e1\uff1a"+c[p].name,isAdmin:!0,admin_id:p})):""!==d&&!o[d].teachers.includes(f)||"AdminHome"===u?alert("Sorry \u6b0a\u9650\u4e0d\u5408\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"):(this.setState({showLoginNumberPad:!1}),this.props.updateViewingStatus("teacher"),this.props.navigation.navigate("TeacherHome",{class_id:d,class_name:o[d].name,isAdmin:!1}))}},{key:"hideLoginPad",value:function(){this.setState({showLoginNumberPad:!1})}},{key:"handleSignOut",value:function(){var e=this.props.route.params.loadAuth;w.a.signOut().then((function(){e()})).catch((function(e){return console.log(e)}))}},{key:"componentWillUnmount",value:function(){var e=this;window.removeEventListener("offline",(function(t){e.props.setConnectState(!1)})),window.removeEventListener("online",(function(t){e.props.setConnectState(!1)})),this.props.clearSchoolState()}},{key:"render",value:function(){var e=this,t=this.state,n=t.classes,r=t.showLoginNumberPad,a=this.props.route.params.school_id;return y.a.createElement(E.a,{style:{flex:1,flexDirection:"column"}},r?y.a.createElement(nn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:function(){return e.hideLoginPad()}}):null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{key:"admin",style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){return e.setState({showLoginNumberPad:!0,pageClicked:"AdminHome"})}},y.a.createElement(b.a,{style:{fontSize:50,textAlign:"center"}},"\u884c\u653f\u7ba1\u7406"))),y.a.createElement(C.a,{key:"attendance_page",style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){e.props.navigation.push("AttendancePage",{school_id:a})}},y.a.createElement(b.a,{style:{fontSize:80,textAlign:"center"}},"\u51fa\u5e2d/\u6253\u5361")),y.a.createElement(E.a,{style:{flex:3}},n.map((function(t){return"\u7ba1\u7406\u54e1"===t.name?null:y.a.createElement(C.a,{key:t.id,style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){return e.setState({showLoginNumberPad:!0,pageClicked:"TeacherHome",class_id:t.id})}},y.a.createElement(b.a,{style:{fontSize:80,textAlign:"center"}},t.name))}))))}}]),n}(y.a.Component),Dr=Object(D.b)((function(e){return{pick_up_request:e.school.pick_up_request,passcodeAdminId:e.school.passcodeAdminId,passcodeTeacherId:e.school.passcodeTeacherId,classes:e.school.classes,teachers:e.school.teachers,viewing_status:e.school.viewing_status,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sr(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({setConnectState:Nt,fetchClassesSuccess:Lt,fetchTeachersSuccess:Ft,fetchStudentsSuccess:Mt,initializeStudentWellness:Bt,addPickupRequest:Kt,clearSchoolState:Ut,updateViewingStatus:Gt,fetchStudentAttendanceSuccess:Wt},e))}))(Cr);function kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Or=function(e){u()(n,e);var t=xr(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={logging_in:!1,teacher_id:""},r.handleEnterPasscode=r.handleEnterPasscode.bind(_()(r)),r.hideLoginPad=r.hideLoginPad.bind(_()(r)),r}return c()(n,[{key:"componentDidMount",value:function(){this.fetchStaffAttendanceByClassId()}},{key:"fetchStaffAttendanceByClassId",value:function(){var e=this,t=this.props.class,n=t.class_id;t.isConnected?fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance?class_id="+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.props.fetchAttendanceSuccess(t.data)})).catch((function(e){console.log("err: ",e)})):le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"handleEnterPasscode",value:function(e){var t=this.props.class.passcodeTeacherId[e];if(void 0===t||t!==this.state.teacher_id)le.Toast.show({text:"Wrong password!",buttonText:"Okay",position:"top",type:"warning",duration:3e3});else{var n=this.props.class.teachers[t],r=new Date;n.logged_in?this.clockOut(t,r):this.clockIn(t,r),this.setState({logging_in:!1})}}},{key:"clockIn",value:function(e,t){var n=this;if(this.props.class.isConnected){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({staff_id:e})}).then((function(e){return e.json()})).then((function(r){var a=r.statusCode,s=r.message,i=r.data;a>200||"Internal server error"===r.message?n.props.markStaffAttendanceFail(s):n.props.markTeacherLoggedIn(e,t,i.attendance_id)})).catch((function(e){console.log("err: ",e)}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"clockOut",value:function(e,t){var n=this;if(this.props.class.isConnected){var r=this.props.class.teachers[e].attendance_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance/"+r,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(r){var a=r.statusCode,s=r.message;a>200||"Internal server error"===s?n.props.markStaffAttendanceFail(s):n.props.markTeacherLoggedOut(e,t)})).catch((function(e){console.log("err: ",e)}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"hideLoginPad",value:function(){this.setState({logging_in:!1})}},{key:"render",value:function(){var e=this,t=this.props.class.errMessage;return y.a.createElement(le.Container,null,""!==t?y.a.createElement(le.Text,{style:{fontSize:20,color:"red"}},t):null,this.state.logging_in?y.a.createElement(nn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:this.hideLoginPad}):null,y.a.createElement(le.Content,{contentContainerStyle:{marginTop:30,paddingBottom:30,alignSelf:"center",flexDirection:"row"}},Object.keys(this.props.class.teachers).map((function(t){return y.a.createElement(C.a,{key:t,style:{margin:20},underlayColor:"transparent",onPress:function(){return e.setState({logging_in:!0,teacher_id:t})}},y.a.createElement(le.View,{style:Ar.cardContainer},y.a.createElement(le.Card,null,y.a.createElement(le.CardItem,{style:{justifyContent:"center"}},y.a.createElement(rn.a,{style:Ar.thumbnailImage})),y.a.createElement(le.CardItem,{footer:!0,style:{justifyContent:"center",backgroundColor:e.props.class.teachers[t].logged_in?"#dcf3d0":"#ffe1d0"}},y.a.createElement(le.Text,null,e.props.class.teachers[t].name)))))}))))}}]),n}(y.a.Component),Ar=ue.a.create({cardContainer:{width:119,height:150,margin:2,marginBottom:-2},thumbnailImage:{height:80,width:80,borderRadius:40}}),jr=Object(D.b)((function(e){return{class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kr(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({markTeacherLoggedIn:_e,markTeacherLoggedOut:Ee,markStaffAttendanceFail:vt,fetchAttendanceSuccess:ge},e))}))(Or),Rr=n(113),Pr=n(42),Tr=n(332),Ir=n.n(Tr);n(819);function zr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}Pr.a.get("window").width;var Lr=function(e){u()(n,e);var t=zr(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).onChange=function(e){console.log(e)},r.isWeekday=function(e){var t=new Date("June 20, 2020"),n=e.getDay();return 0!==n&&6!==n||e.toDateString()===t.toDateString()},r.state={datetime:new Date,isLoading:!0},r}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.start_date;this.setState({datetime:e,isLoading:!1})}},{key:"isIOS",value:function(){return"ios"===Nn.a.OS}},{key:"setDate",value:function(e){this.isIOS()?this.iosSetDate(e):this.androidSetDate(e)}},{key:"iosSetDate",value:function(e){this.setState({datetime:e})}},{key:"androidSetDate",value:function(e){void 0!==e?this.props.selectDatetimeConfirm(e):this.props.hideModal()}},{key:"selectDatetimeConfirm",value:function(e){this.props.selectDatetimeConfirm(e),this.props.hideModal()}},{key:"render",value:function(){var e=this,t=this.props,n=t.datetime_type,r=t.minDatetime,a=t.maxDatetime,s=this.state,i=s.datetime;return s.isLoading?null:y.a.createElement(C.a,{style:{width:"100%",height:"100%",zIndex:2,position:"absolute",paddingVertical:100,alignItems:"center",backgroundColor:"rgba(0,0,0,0.7)"}},y.a.createElement(E.a,{style:{}},"date"===n&&y.a.createElement(Ir.a,{onChange:function(t){return e.selectDatetimeConfirm(t)},inline:!0,selected:i,minDate:new Date(r),maxDate:new Date(a),onClickOutside:function(){return e.props.hideModal()},filterDate:this.isWeekday}),"time"===n&&y.a.createElement(Ir.a,{onChange:function(t){return e.selectDatetimeConfirm(t)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:30,timeCaption:"Time",dateFormat:"h:mm aa",selected:i,minTime:new Date(r).setHours(7,0,0),maxTime:new Date(a).setHours(20,0,0),onClickOutside:function(){return e.props.hideModal()}})))}}]),n}(y.a.Component);function Fr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Mr=function(e){u()(r,e);var t=Fr(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={medicated_time:new Date,showTimePicker:!1},n}return c()(r,[{key:"selectDatetimeConfirm",value:function(e){this.setState({medicated_time:e,showTimePicker:!1})}},{key:"render",value:function(){var e=this,t=this.props,r=t.thumbnail,a=t.student_name,s=t.request,i=this.state,o=i.medicated_time,c=i.showTimePicker,l=s.administered,u=s.fever_entry,d=s.medication,f=s.note,p=(s.student_id,s.teacher_id,s.timestamp),h=d.before_meal,m=d.gel,g=d.other_type,_=d.powder,v=d.powder_refrigerated,S=d.syrup,w=pn(new Date(p));return y.a.createElement(le.Card,{style:{flex:1,alignSelf:"center",width:"100%"}},c?y.a.createElement(Lr,{start_date:o,datetime_type:"time",hideModal:function(){return e.setState({showTimePicker:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:null}):null,y.a.createElement(E.a,{style:{flex:.35,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center",justifyContent:"center"}},y.a.createElement(rn.a,{source:""===r?n(70):{uri:r},style:Br.thumbnailImage})),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"flex-start"}},y.a.createElement(b.a,{style:{fontSize:70,fontWeight:"bold"}},a),y.a.createElement(b.a,{style:{fontSize:70,fontWeight:"bold"}},w," ",null===h?null:h?"\u9910\u524d":"\u9910\u5f8c"))),y.a.createElement(E.a,{style:{flex:.65,paddingBottom:20}},y.a.createElement(E.a,{style:{width:"100%",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-evenly"}},_&&y.a.createElement(E.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",flexDirection:"row",marginBottom:15,marginHorizontal:7}},y.a.createElement(rn.a,{source:n(882)}),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u85e5\u7c89"),v&&y.a.createElement(b.a,{style:{fontSize:30}},"\u9700\u51b7\u85cf"))),0!==S.length&&y.a.createElement(E.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7}},y.a.createElement(rn.a,{source:n(883)}),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u85e5\u6c34"),S.map((function(e,t){return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(b.a,{style:{fontSize:20}},e.amount," c.c."),e.need_refrigerated&&y.a.createElement(b.a,{style:{fontSize:20,marginLeft:20}},"\u9700\u51b7\u85cf"))})))),m&&y.a.createElement(E.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7}},y.a.createElement(rn.a,{source:n(884)}),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u85e5\u818f"),y.a.createElement(b.a,{style:{fontSize:30}},m))),g&&y.a.createElement(E.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7}},y.a.createElement(rn.a,{source:n(885)}),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u5176\u4ed6"),y.a.createElement(b.a,{style:{fontSize:30}},g)))),y.a.createElement(E.a,{style:{width:"97%",marginHorizontal:10,flexDirection:"row",justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"32%",aspectRatio:1,backgroundColor:"#fff1b5"}},y.a.createElement(E.a,{style:{padding:10}},y.a.createElement(b.a,{style:{fontSize:30}},"\u5099\u8a3b")),y.a.createElement(E.a,{style:{padding:10}},y.a.createElement(b.a,{style:{fontSize:25}},f))),y.a.createElement(E.a,{style:{width:"40%",backgroundColor:"#fa625f"}},y.a.createElement(E.a,{style:{padding:10}},y.a.createElement(b.a,{style:{fontSize:30,color:"white"}},"\u767c\u71d2\u8d85\u904e ",u.temperature,"\xb0C")),y.a.createElement(E.a,{style:{padding:10}},u.powder&&y.a.createElement(b.a,{style:{fontSize:25,color:"white"}},"\u85e5\u7c89 ",u.powder_refrigerated&&"\u9700\u51b7\u85cf"),0!==u.syrup.length&&y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(b.a,{style:{fontSize:25,color:"white"}},"\u85e5\u6c34    "),u.syrup.map((function(e,t){return y.a.createElement(b.a,{key:t,style:{fontSize:25,color:"white"}},e.amount," c.c. ",e.need_refrigerated&&"\u9700\u51b7\u85cf")}))),u.other_type&&y.a.createElement(b.a,{style:{fontSize:25,color:"white"}},"\u5176\u4ed6    ",u.other_type))),y.a.createElement(E.a,{style:{width:"25%",justifyContent:"space-between"}},y.a.createElement(C.a,{style:{padding:15,backgroundColor:"rgba(0,0,0,0.2)",justifyContent:"center",alignItems:"center"},onPress:function(){return e.setState({showTimePicker:!0})}},y.a.createElement(b.a,{style:{fontSize:40}},fn(o))),y.a.createElement(C.a,{style:{padding:15,width:"100%",backgroundColor:l?"#dcf3d0":"#ffe1d0",alignItems:"center"},onPress:function(){return e.props.showLoginNumberPad()}},y.a.createElement(b.a,{style:{fontSize:40}},"\u5b8c\u6210"))))))}}]),r}(y.a.Component),Br=ue.a.create({thumbnailImage:{height:180,width:180,borderRadius:90}});function qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ur=function(e){u()(r,e);var t=Nr(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,refreshing:!1,selected_request_id:"",showLoginNumberPad:!1},n.handleShowRequest=n.handleShowRequest.bind(_()(n)),n.handleFulfillRequest=n.handleFulfillRequest.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.route.params.request_id;null!==e?this.handleShowRequest(e):this.setState({isLoading:!1})}},{key:"handleShowRequest",value:function(e){this.setState({selected_request_id:e,isLoading:!1})}},{key:"handleEnterPasscode",value:function(e){var t=this.props.class.passcodeTeacherId[e];void 0===t?In.a.alert("Wrong password","Please try again",[{text:"OK"}]):(this.setState({showLoginNumberPad:!1}),this.handleFulfillRequest(t))}},{key:"hideLoginPad",value:function(){this.setState({showLoginNumberPad:!1})}},{key:"handleFulfillRequest",value:function(e){var t=this,n=this.state.selected_request_id,r=this.props.requests.requests[n].student_id;this.props.class.isConnected?fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/medicationrequest",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:n,teacher_id:e,student_id:r})}).then((function(e){return e.json()})).then((function(e){var r=e.statusCode,a=e.message;e.data;r>200||"Internal server error"===a?In.a.alert("Error, please try again",a,[{text:"OK"}]):(t.props.fillMedRequest(n),t.props.navigation.goBack())})).catch((function(e){In.a.alert("Error, please try again",e.message,[{text:"OK"}])})):le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"render",value:function(){var e=this,t=this.state,r=t.selected_request_id,a=t.isLoading,s=t.showLoginNumberPad;if(a)return y.a.createElement(Tn,null);var i=this.props.requests.requests,o=this.props.class.students,c=i[r];return y.a.createElement(E.a,{style:{flex:1}},s?y.a.createElement(nn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:this.hideLoginPad}):null,y.a.createElement(kn.a,{contentContainerStyle:{flex:1,padding:10},refreshControl:y.a.createElement(Rr.a,{style:{backgroundColor:"#E0FFFF"},refreshing:this.state.refreshing,onRefresh:this.fetchFromDB,tintColor:"#ff0000",title:"Loading...",titleColor:"#00ff00",colors:["#ff0000","#00ff00","#0000ff"],progressBackgroundColor:"#ffff00"})},y.a.createElement(E.a,{style:{flex:3}},""===r?null:y.a.createElement(Mr,{thumbnail:o[c.student_id].profile_picture,student_name:o[c.student_id].name,request:c,showLoginNumberPad:function(){return e.setState({showLoginNumberPad:!0})}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(kn.a,{horizontal:!0},Object.keys(i).map((function(t){var r=i[t].student_id,a=i[t],s=a.timestamp,c=a.administered,l=pn(new Date(s));return y.a.createElement(C.a,{key:t,style:Hr.cardContainer,underlayColor:"transparent",onPress:function(){return e.handleShowRequest(t)}},y.a.createElement(le.Card,{style:{flex:1,backgroundColor:c?"#dcf3d0":"#ffe1d0"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},l)),y.a.createElement(E.a,{style:{flex:2,justifyContent:"center",alignItems:"center"}},y.a.createElement(rn.a,{source:""===e.props.class.students[r].profile_picture?n(70):{uri:o[r].profile_picture},style:Hr.thumbnailImage})),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},o[r].name))))}))))))}}]),r}(y.a.Component),Hr=ue.a.create({cardContainer:{width:170,paddingRight:5},thumbnailImage:{height:110,width:110,borderRadius:55}}),Wr=Object(D.b)((function(e){return{class:e.classInfo,requests:e.medicationrequests}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qr(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({initializeRequests:me,fillMedRequest:ye},e))}))(Ur);function Vr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Gr=function(e){u()(r,e);var t=Kr(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,date:new Date,show_record:!1},n.handleSend=n.handleSend.bind(_()(n)),n.addRecord=n.addRecord.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.wellness.record_id_for_update,t=this.props.class.isConnected;0===e.size&&t?this.fetchClassData():this.setState({isLoading:!1}),t||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"fetchClassData",value:function(){var e,t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=new Date,t=cn(e),e.setDate(e.getDate()+1),n=cn(e),s.next=6,a.a.awrap(En("wellness",this.props.class.class_id,t,n));case 6:r=s.sent,this.denormalize(r),this.props.fetchClassWellnessData(r.data),this.setState({isLoading:!1});case 10:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(Object.keys(e.data.records).length){var t=e.data.records;for(var n in t)e.data.records[n].time=new Date(t[n].time)}}},{key:"hasUnsentRecord",value:function(e){for(var t=this.props.wellness.record_id_for_update,n=!1,r=0;r<e.length;r++)if(t.has(e[r])){n=!0;break}return n}},{key:"addRecord",value:function(e){2!==this.props.wellness.by_student_id[e].length?this.props.addWellnessRecord(e):In.a.alert("\u4eca\u5929\u5df2\u7d93\u91cf\u4e86\u5169\u6b21\u9ad4\u6eab\u4e86","",[{text:"OK"}])}},{key:"handleSend",value:function(){var e,t,n=this;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.wellnessDataValidated()){r.next=2;break}return r.abrupt("return");case 2:if(e=this.props.wellness,this.props.class.isConnected){r.next=7;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),r.abrupt("return");case 7:return r.next=9,a.a.awrap(bn(e,this.props.class.class_id,cn(new Date)));case 9:(t=r.sent).success?(t.data.forEach((function(e){n.props.markPresent(e,new Date)})),this.props.sendWellnessDataSuccess(),this.props.navigation.goBack()):this.props.sendWellnessDataFail(t.message);case 11:case"end":return r.stop()}}),null,this,null,Promise)}},{key:"wellnessDataValidated",value:function(){var e=this,t=this.props.wellness,n=t.records,r=t.record_id_for_update,a=!0;return r.forEach((function(t){""===n[t].temperature?(e.props.invalidateWellnessData(t,"Temperature is not filled out"),a=!1):""===n[t].status&&(e.props.invalidateWellnessData(t,"Health status is not filled out"),a=!1)})),a}},{key:"render",value:function(){var e=this,t=this.props.wellness,r=t.by_student_id,a=(t.records,this.props.route.params.teacher_id),s=this.state.date;return console.log("wellness: ",this.props.wellness),y.a.createElement(Bn.a,{style:{flex:1},enabled:!0},y.a.createElement(le.View,{style:{flexDirection:"row",width:"90%",justifyContent:"space-between",alignSelf:"center",alignItems:"center"}},y.a.createElement(le.Text,{style:{fontSize:40}},cn(s)),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend},y.a.createElement(le.Text,{style:{fontSize:40}},"\u9001\u51fa"))),y.a.createElement(kn.a,{contentContainerStyle:{alignItems:"center",marginBottom:20}},Object.keys(this.props.class.students).map((function(t){var s=r[t];return y.a.createElement(le.View,{key:t,style:{width:"98%"}},y.a.createElement(le.Card,null,y.a.createElement(le.CardItem,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{style:Qr.childThumbnail},y.a.createElement(rn.a,{source:""===e.props.class.students[t].profile_picture?n(70):{uri:e.props.class.students[t].profile_picture},style:Qr.thumbnailImage})),y.a.createElement(le.View,{style:{flex:3}},y.a.createElement(le.View,{style:{flex:1,flexDirection:"row",paddingVertical:10}},y.a.createElement(le.View,{style:{flex:1}},y.a.createElement(le.Text,{style:{fontSize:25}},e.props.class.students[t].name)),y.a.createElement(le.View,{style:{flex:1,alignItems:"flex-end"}},e.hasUnsentRecord(s)?y.a.createElement(le.Text,{style:{color:"red",fontSize:15}},"\u672a\u9001\u51fa"):null)),s.map((function(e,n){return y.a.createElement(le.View,{style:{flex:1},key:e},0===n?y.a.createElement(le.Text,null,"\u65e9\u4e0a"):y.a.createElement(le.Text,null,"\u4e0b\u5348"),y.a.createElement(Qn,{student_id:t,record_id:e,teacher_id:a}))}))))))}))))}}]),r}(y.a.Component),Qr=ue.a.create({childThumbnail:{flex:1,backgroundColor:"white",marginLeft:-7},thumbnailImage:{width:140,height:140,borderRadius:70},subHeading:{width:355,height:45,marginTop:10,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),Jr=Object(D.b)((function(e){return{class:e.classInfo,wellness:e.healthstatus,unmarked:e.attendance.unmarked}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vr(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({fetchClassWellnessData:Ke,markPresent:pe,sendWellnessDataSuccess:De,sendWellnessDataFail:ke,addWellnessRecord:Se,invalidateWellnessData:xe},e))}))(Gr);function Yr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Zr=function(e){u()(n,e);var t=Yr(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"render",value:function(){return y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(b.a,{style:{fontSize:30}},this.props.title))}}]),n}(y.a.Component);function Xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $r(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var ea=function(e){u()(r,e);var t=$r(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,mealType:"",selectedForCustomize:new Set,editingFruitType:!1,students_with_records:[]},n.handleRateFoodWellness=n.handleRateFoodWellness.bind(_()(n)),n.handleSend=n.handleSend.bind(_()(n)),n.handleClearAll=n.handleClearAll.bind(_()(n)),n.handleSetAll=n.handleSetAll.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.appetite.updatedStudents,t=this.props.class.isConnected;e.size>0||!t?this.setState({isLoading:!1}):this.fetchClassData(),t||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"fetchClassData",value:function(){var e,t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=new Date,t=cn(e),e.setDate(e.getDate()+1),n=cn(e),c.next=6,a.a.awrap(En("appetite",this.props.class.class_id,t,n));case 6:if(void 0!==(r=c.sent).data[t]){c.next=9;break}return c.abrupt("return");case 9:s=r.data[t],i=s.fruit_name,o=s.ratings,this.props.fetchClassAppetiteData(i,o),this.setState({isLoading:!1,students_with_records:Object.keys(o)});case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"editFruitName",value:function(e){this.props.editFruitName(e)}},{key:"fruitNameEditorOnBlur",value:function(){var e=this.state.students_with_records;this.setState({editingFruitType:!1}),""===this.props.appetite.fruit_name&&this.props.editFruitName("\u6c34\u679c"),e.length>1&&this.props.addStudentIdForUpdate(e)}},{key:"handleRateFoodWellness",value:function(e,t){if(""===this.state.mealType)le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3});else{var n=this.state.selectedForCustomize,r=this.props.route.params.teacher_id;n.delete(e),this.setState({selectedForCustomize:n}),this.props.rateAppetite(e,this.state.mealType,t,r)}}},{key:"onClickOther",value:function(e){var t=this.state,n=t.mealType,r=t.selectedForCustomize,a=this.props.route.params.teacher_id;""===n?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):(this.setState({selectedForCustomize:new Set([].concat(T()(r),[e]))}),this.props.rateAppetite(e,this.state.mealType,"",a))}},{key:"isRatingCustomized",value:function(e){return""!==this.state.mealType&&("Awesome"!==e&&"Good"!==e&&"Ok"!==e&&""!==e)}},{key:"onCustomizeRating",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.rateAppetite(e,this.state.mealType,t,n)}},{key:"customizedRatingOnBlur",value:function(e){var t=this.state.selectedForCustomize;t.delete(e),this.setState({selectedForCustomize:t})}},{key:"markWaterDrank",value:function(e){var t=this.props.route.params.teacher_id;""===this.state.mealType?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):this.props.markWaterDrank(e,this.state.mealType,t)}},{key:"handleSetAll",value:function(){var e=this.props.route.params.teacher_id;""===this.state.mealType?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):this.props.setAllRatingsToGreat(this.state.mealType,e)}},{key:"handleClearAll",value:function(){""===this.state.mealType?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):this.props.clearRatings(this.state.mealType)}},{key:"handleSend",value:function(){var e=this,t=this.props.class.isConnected,n=this.props.appetite,r=n.updatedStudents,a=n.fruit_name,s=[],i=this.props.appetite.ratings;if(0===r.size&&this.props.navigation.goBack(),t){r.forEach((function(e){var t=i[e],n={student_id:e,b_rating:t.Breakfast,f_rating:t.Fruit,l_rating:t.Lunch,s_rating:t.Snack,teacher_id:t.teacher_id};s.push(n)}));var o={date:cn(new Date),fruit_name:a,obj:s};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/appetite",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message;n>200||"Internal Server Error"===r?e.props.alertErrMessage(r):(e.props.onSendAppetiteSuccess(),e.props.navigation.goBack())})).catch((function(t){e.props.alertErrMessage(t)}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;""!==this.props.appetite.err_message&&In.a.alert("Error!",this.props.appetite.err_message,[{text:"OK",onPress:function(){return e.props.clearAppetiteErrorMessage()}}]);var t=this.state,r=t.mealType,a=t.selectedForCustomize,s=t.editingFruitType,i=new Date;return y.a.createElement(Bn.a,{style:{flex:1,backgroundColor:"Breakfast"===r?"#ffe1d0":"Fruit"===r?"#ffddb7":"Lunch"===r?"#fff1b5":"Snack"===r?"#dcf3d0":"transparent"},enabled:!0},y.a.createElement(E.a,{style:ta.subHeading},y.a.createElement(b.a,{style:{fontSize:40}},i.getFullYear()+"."+(i.getMonth()+1)+"."+i.getDate()),y.a.createElement(C.a,{style:{backgroundColor:"#b5e9e9",padding:10},onPress:this.handleSetAll},y.a.createElement(b.a,{style:{color:"grey",fontSize:40}},"\u5168\u8b9a")),y.a.createElement(C.a,{style:{backgroundColor:"#ffe1d0",padding:10},onPress:this.handleClearAll},y.a.createElement(b.a,{style:{color:"grey",fontSize:40}},"\u5168\u90e8\u6e05\u9664")),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend},y.a.createElement(b.a,{style:{color:"grey",fontSize:40}},"\u9001\u51fa"))),y.a.createElement(le.Content,{contentContainerStyle:{alignItems:"center"}},y.a.createElement(E.a,{style:ta.mealButtons},y.a.createElement(C.a,{style:{backgroundColor:"Breakfast"===r?"#fa625f":"#ffe1d0",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#fa625f",onPress:function(){return e.setState({mealType:"Breakfast",editingFruitType:!1})}},y.a.createElement(b.a,{style:ta.mealButtonText},"\u65e9\u9910")),y.a.createElement(C.a,{style:{backgroundColor:"Fruit"===r?"#ff8944":"#ffddb7",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%"},underlayColor:"#ff8944",onPress:function(){return e.setState({mealType:"Fruit"})},onLongPress:function(){return e.setState({mealType:"Fruit",editingFruitType:!0})}},s?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{paddingLeft:5}},"\u6c34\u679c:"),y.a.createElement(qn.a,{autoFocus:!0,selectTextOnFocus:!0,style:{width:"95%",alignSelf:"center",fontSize:25,textAlign:"center",color:"grey",borderWidth:1},onChangeText:function(t){return e.editFruitName(t)},value:this.props.appetite.fruit_name,onBlur:function(){return e.fruitNameEditorOnBlur()}})):y.a.createElement(b.a,{style:ta.mealButtonText},this.props.appetite.fruit_name)),y.a.createElement(C.a,{style:{backgroundColor:"Lunch"===r?"#f4d41f":"#fff1b5",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#f4d41f",onPress:function(){return e.setState({mealType:"Lunch",editingFruitType:!1})}},y.a.createElement(b.a,{style:ta.mealButtonText},"\u5348\u9910")),y.a.createElement(C.a,{style:{backgroundColor:"Snack"===r?"#00c07f":"#dcf3d0",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#00c07f",onPress:function(){return e.setState({mealType:"Snack",editingFruitType:!1})}},y.a.createElement(b.a,{style:ta.mealButtonText},"\u9ede\u5fc3"))),Object.keys(this.props.class.students).map((function(t){var s=""===r?"":e.props.appetite.ratings[t][r].slice(0,-1),i=""!==r&&"1"===e.props.appetite.ratings[t][r].slice(-1);return y.a.createElement(E.a,{key:t,style:{width:"98%"}},y.a.createElement(le.Card,null,y.a.createElement(le.CardItem,null,y.a.createElement(E.a,{style:ta.childThumbnail},y.a.createElement(rn.a,{source:""===e.props.class.students[t].profile_picture?n(70):{uri:e.props.class.students[t].profile_picture},style:ta.thumbnailImage})),y.a.createElement(E.a,{style:{width:"75%"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:30,paddingLeft:18,alignSelf:"center"}},e.props.class.students[t].name)),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{width:"80%",borderWidth:2,borderColor:"#368cbf",padding:10,justifyContent:"center",backgroundColor:i?"#368cbf":"white"},onPress:function(){return e.markWaterDrank(t)}},y.a.createElement(b.a,{style:{textAlign:"center",color:i?"#D3D3D3":"grey",fontSize:17}},"\u6709\u559d\u6c34"))),y.a.createElement(E.a,{style:{flex:2,alignItems:"flex-end"}},e.props.appetite.updatedStudents.has(t)?y.a.createElement(b.a,{style:{color:"red",fontSize:15}},"\u672a\u9001\u51fa"):null)),y.a.createElement(E.a,{style:ta.cardBody},y.a.createElement(C.a,{style:{width:"22%",height:"100%",margin:5,justifyContent:"center",backgroundColor:"Awesome"===s?"#368cbf":"#b5e9e9",padding:10},onPress:function(){return e.handleRateFoodWellness(t,"Awesome")}},y.a.createElement(b.a,{style:{textAlign:"center",color:"Awesome"===s?"#D3D3D3":"grey",fontSize:20}},"\u975e\u5e38\u597d")),y.a.createElement(C.a,{style:{width:"22%",height:"100%",margin:5,justifyContent:"center",backgroundColor:"Good"===s?"#368cbf":"#b5e9e9",padding:10},onPress:function(){return e.handleRateFoodWellness(t,"Good")}},y.a.createElement(b.a,{style:{textAlign:"center",color:"Good"===s?"#D3D3D3":"grey",fontSize:20}},"\u9084\u4e0d\u932f")),y.a.createElement(C.a,{style:{width:"22%",height:"100%",margin:5,justifyContent:"center",backgroundColor:"Ok"===s?"#368cbf":"#b5e9e9",padding:10},onPress:function(){return e.handleRateFoodWellness(t,"Ok")}},y.a.createElement(b.a,{style:{textAlign:"center",color:"Ok"===s?"#D3D3D3":"grey",fontSize:20}},"\u5403\u4e0d\u591a")),y.a.createElement(C.a,{style:{width:"22%",height:"100%",margin:5,justifyContent:"center",backgroundColor:e.isRatingCustomized(s)||a.has(t)?"#368cbf":"#b5e9e9",padding:10},onPress:function(){return e.onClickOther(t)}},e.isRatingCustomized(s)||a.has(t)?y.a.createElement(qn.a,{style:{textAlign:"center",color:"#D3D3D3",fontSize:20},autoFocus:""===s,onChangeText:function(n){return e.onCustomizeRating(t,n)},value:s,onBlur:function(){return e.customizedRatingOnBlur(t)}}):y.a.createElement(b.a,{style:{textAlign:"center",color:e.isRatingCustomized(s)||a.has(t)?"#D3D3D3":"grey",fontSize:20}},"Other"))))))))}))))}}]),r}(y.a.Component),ta=ue.a.create({childThumbnail:{width:"25%",justifyContent:"center",alignItems:"center"},cardBody:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center"},foodButton:{width:70,alignSelf:"center",margin:5,justifyContent:"center",backgroundColor:"#b5e9e9"},thumbnailImage:{height:130,width:130,borderRadius:65},subHeading:{width:"99%",paddingHorizontal:"4%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",zIndex:2},mealButtons:{width:"99%",marginVertical:15,flexDirection:"row",alignItems:"center",justifyContent:"center"},mealButtonText:{fontSize:30,textAlign:"center"},buttonText:{color:"grey",textAlign:"center"}}),na=Object(D.b)((function(e){return{class:e.classInfo,appetite:e.appetite}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xr(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({rateAppetite:fe,clearRatings:be,setAllRatingsToGreat:ve,fetchClassAppetiteData:Ve,onSendAppetiteSuccess:yt,alertErrMessage:gt,markWaterDrank:bt,editFruitName:zt,clearAppetiteErrorMessage:_t,addStudentIdForUpdate:Et},e))}))(ea);function ra(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function aa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ra(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ra(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var ia=function(e){u()(r,e);var t=sa(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,date:new Date,showIOSDatePicker:!1,student_id:"",index:-1,recordType:"",teacher_id:"",confirmDelete:!1,showDateTimeModal:!1},n.handleOnClick=n.handleOnClick.bind(_()(n)),n.handleSend=n.handleSend.bind(_()(n)),n.updateReducerTime=n.updateReducerTime.bind(_()(n)),n.setTime=n.setTime.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.sleep,t=e.newDataForCreate,n=e.oldDataForEdit,r=this.props.class.isConnected,a=this.props.route.params.teacher_id;this.setState({teacher_id:a}),t.size+n.size===0&&r?this.fetchClassData():this.setState({isLoading:!1}),r||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"fetchClassData",value:function(){var e,t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=new Date,t=cn(e),e.setDate(e.getDate()+1),n=cn(e),s.next=6,a.a.awrap(En("sleep",this.props.class.class_id,t,n));case 6:r=s.sent,this.denormalize(r),this.props.fetchClassSleepData(r.data),this.setState({isLoading:!1});case 10:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].sleep_time=new Date(t[n].sleep_time),t[n].wake_time=null===t[n].wake_time?null:new Date(t[n].wake_time);e.data.records.by_id=t}}},{key:"hasUnsentRecord",value:function(e){var t=this.props.sleep,n=t.newDataForCreate,r=t.oldDataForEdit,a=t.by_student_id;record_id_array=a[e];for(var s=!1,i=0;i<record_id_array.length;i++)if(n.has(record_id_array[i])||r.has(record_id_array[i])){s=!0;break}return s}},{key:"handleOnClick",value:function(e){var t=this.props.sleep.by_student_id[e],n=this.props.sleep.records.by_id,r=t.length>0?n[t[t.length-1]]:null,a=r?r.wake_time:null;!t.length||a?this.props.setSleepTime(e,null,new Date,this.state.teacher_id):this.props.setWakeTime(e,t.length-1,new Date,this.state.teacher_id),this.checkLastRecord(e,n,t)}},{key:"checkLastRecord",value:function(e,t,n){var r=n.length,a=n[n.length-1],s=t[a];if(null!==s.wake_time&&s.sleep_time.getTime()>=s.wake_time.getTime()&&this.props.markRecordError([a]),r>1){var i=t[n[n.length-2]];s.sleep_time>=i.sleep_time&&s.sleep_time<=i.wake_time&&this.props.markRecordError([a])}}},{key:"setTime",value:function(e,t,n,r){this.setState({student_id:t,index:n,recordType:e,showDateTimeModal:!0,start_time:r||new Date})}},{key:"updateReducerTime",value:function(e,t){this.setState({showDateTimeModal:!1}),"sleep"===this.state.recordType?this.props.setSleepTime(this.state.student_id,e,t,this.state.teacher_id):this.props.setWakeTime(this.state.student_id,e,t,this.state.teacher_id),this.checkRecord(this.state.student_id,e)}},{key:"checkRecord",value:function(e,t){var n=this.props.sleep.by_student_id[e],r=this.props.sleep.records.by_id,a=n[t],s=r[a],i=this.props.sleep.records_with_error,o=null,c=null;if(!(t<0||t>n.length-1))if(null!==s.wake_time&&s.sleep_time.getTime()>=s.wake_time.getTime())this.props.markRecordError([a]);else{if(t>0){var l=r[o=n[t-1]];if(null!==l.wake_time&&s.sleep_time.getTime()<=l.wake_time.getTime())return void this.props.markRecordError([a])}if(t<n.length-1){var u=r[c=n[t+1]];if(s.wake_time>=u.sleep_time)return void this.props.markRecordError([a])}this.props.markRecordCorrect(a),null!==o&&i.has(o)&&this.checkRecord(e,t-1),null!==c&&i.has(c)&&this.checkRecord(e,t+1)}}},{key:"confirmToRemoveWakeTime",value:function(e,t,n){var r=this;t===this.props.sleep.by_student_id[n].length-1?In.a.alert("\u78ba\u5b9a\u8981\u522a\u9664?","",[{text:"Yes",onPress:function(){return r.props.removeWakeTime(e,r.state.teacher_id)}},{text:"Cancel",style:"cancel"}]):this.props.alertSleeplogErrorMessage("\u9019\u500b\u7761\u7720\u8a18\u9304\u4e26\u4e0d\u80fd\u522a\u9664\uff0c\u53ea\u80fd\u6539\u9078")}},{key:"handleSend",value:function(){var e,t,n;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.props.class.isConnected){r.next=4;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),r.abrupt("return");case 4:if(this.setState({isLoading:!0}),e=this.props.sleep,t=e.newDataForCreate,n=e.oldDataForEdit,!t.size){r.next=16;break}return r.next=9,a.a.awrap(this.createRecord());case 9:if(!r.sent.success){r.next=14;break}this.props.createSleepRecordSuccess(),r.next=16;break;case 14:return this.props.createSleepRecordFail(),r.abrupt("return");case 16:if(!n.size){r.next=26;break}return r.next=19,a.a.awrap(this.editRecord());case 19:if(!r.sent.success){r.next=24;break}this.props.editSleepRecordSuccess(),r.next=26;break;case 24:return this.props.editSleepRecordFail(),r.abrupt("return");case 26:this.props.navigation.goBack();case 27:case"end":return r.stop()}}),null,this,null,Promise)}},{key:"createRecord",value:function(){var e,t,n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.sleep,t=e.newDataForCreate,n=e.records,r=[],t.forEach((function(e){r.push(aa({},n.by_id[e]))})),this.normalize(r),s={date:cn(this.state.date),data_objs:r},o.next=7,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){return e.statusCode>200?{success:!1,status_code:e.statusCode,data:e.message}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=o.sent,o.abrupt("return",i);case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"editRecord",value:function(){var e,t,n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.sleep,t=e.oldDataForEdit,n=e.records,r=[],t.forEach((function(e){r.push(aa({record_id:e},n.by_id[e]))})),this.normalize(r),s={date:cn(new Date),data_objs:r},o.next=7,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){return e.statusCode>200?{success:!1,status_code:e.statusCode,data:e.message}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=o.sent,o.abrupt("return",i);case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"confirmToRemoveRecord",value:function(e,t){var n=this;In.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"Yes",onPress:function(){return n.removeRecord(e,t)}},{text:"Cancel",style:"cancel"}])}},{key:"removeRecord",value:function(e,t){var n=this,r=this.props.sleep.newDataForCreate,a=this.props.class.isConnected;if(r.has(e))this.props.removeSleepRecordSuccess(e,t);else if(a){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({record_id:e})}).then((function(e){return e.json()})).then((function(r){var a=r.statusCode,s=r.message;return a>200||"Internal Server Error"===s?(n.props.removeSleepRecordFail(s),{success:!1,statusCode:a,message:s}):(n.props.removeSleepRecordSuccess(e,t),{success:!0,statusCode:a,message:s})})).catch((function(e){return n.props.removeSleepRecordFail(e),{success:!1,message:e}}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"normalize",value:function(e){for(var t=0;t<e.length;t++)e[t].sleep_time=dn(e[t].sleep_time),e[t].wake_time=null===e[t].wake_time?null:dn(e[t].wake_time)}},{key:"render",value:function(){var e=this;""!==this.props.sleep.errorMessage&&In.a.alert("Add new record fail",this.props.sleep.errorMessage,[{text:"OK",onPress:function(){return e.props.clearSleeplogErrorMessage()}}]);var t=this.props.sleep.records_with_error,r=this.state,a=r.showDateTimeModal,s=r.start_time,i=r.date;return this.state.isLoading?y.a.createElement(Tn,null):y.a.createElement(le.Container,null,a?y.a.createElement(Lr,{start_date:s,datetime_type:"time",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.updateReducerTime(e.state.index,t)},minDatetime:null,maxDatetime:null}):null,y.a.createElement(le.View,{style:oa.subHeading},y.a.createElement(le.View,{style:{flex:1,alignItems:"center"}},y.a.createElement(le.Text,{style:{fontSize:40}},i.getFullYear()+"."+(i.getMonth()+1)+"."+i.getDate())),y.a.createElement(le.View,{style:{flex:1,justifyContent:"center"}},y.a.createElement(C.a,{style:{alignSelf:"flex-end",backgroundColor:"#dcf3d0",padding:10,marginRight:50},onPress:this.handleSend,underlayColor:"#00c07f"},y.a.createElement(le.Text,{style:{fontSize:40,color:"grey"}},"\u9001\u51fa")))),y.a.createElement(le.Content,{contentContainerStyle:{alignItems:"center"}},Object.keys(this.props.class.students).map((function(r){var a=e.props.sleep.by_student_id[r],s=e.props.sleep.records.by_id,i=a.length>0?s[a[a.length-1]]:null,o=i?i.sleep_time:null,c=i?i.wake_time:null;return y.a.createElement(le.View,{key:r,style:{width:"98%"}},y.a.createElement(le.Card,{style:{flex:1,paddingVertical:15}},y.a.createElement(le.View,{style:{flex:1,flexDirection:"row"}},y.a.createElement(le.View,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{key:r,style:oa.thumbnail,onPress:function(){return e.handleOnClick(r)}},y.a.createElement(rn.a,{source:""===e.props.class.students[r].profile_picture?n(70):{uri:e.props.class.students[r].profile_picture},style:{width:140,height:140,borderRadius:70,borderWidth:8,borderColor:null!==o&&null===c?"#ffe1d0":"#dcf3d0"}}))),y.a.createElement(le.View,{style:{flex:3}},y.a.createElement(le.View,{style:{flex:1,flexDirection:"row",padding:10}},y.a.createElement(le.View,{style:{flex:1}},y.a.createElement(le.Text,{style:{fontSize:30}},e.props.class.students[r].name)),y.a.createElement(le.View,{style:{flex:1,alignItems:"flex-end"}},e.hasUnsentRecord(r)?y.a.createElement(le.Text,{style:{color:"red",fontSize:15}},"\u672a\u9001\u51fa"):null)),y.a.createElement(le.View,{style:oa.cardBody},y.a.createElement(le.View,{style:{width:"40%",height:"100%",paddingLeft:5}},y.a.createElement(le.Text,{style:{fontSize:20}},"\u5f9e")),y.a.createElement(le.View,{style:{width:"40%",height:"100%",paddingLeft:5}},y.a.createElement(le.Text,{style:{fontSize:20}},"\u5230"))),a.map((function(n,a){var i=s[n],o=i.sleep_time,c=i.wake_time;return y.a.createElement(le.View,{key:n,style:aa(aa({},oa.cardBody),{},{borderWidth:2,borderColor:t.has(n)?"red":"white"})},y.a.createElement(le.View,{style:{width:"35%",marginRight:"3%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setTime("sleep",r,a,o)}},null===o?y.a.createElement(le.Text,{style:{fontSize:30,textAlign:"center"}},"\u9078\u64c7\u6642\u9593"):y.a.createElement(le.Text,{style:{fontSize:35,textAlign:"center"}},o.getHours()+":"+o.getMinutes()))),y.a.createElement(le.View,{style:{width:"35%",marginRight:"3%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setTime("wake",r,a,c)},onLongPress:function(){return e.confirmToRemoveWakeTime(n,a,r)}},null===c?y.a.createElement(le.Text,{style:{fontSize:30,textAlign:"center"}},"\u9078\u64c7\u6642\u9593"):y.a.createElement(le.Text,{style:{fontSize:35,textAlign:"center"}},c.getHours()+":"+c.getMinutes()))),y.a.createElement(le.View,{style:{width:"20%",marginRight:"4%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return e.confirmToRemoveRecord(n,r)}},y.a.createElement(le.Text,{style:{fontSize:30,textAlign:"center"}},"\u79fb\u9664"))))}))))))}))))}}]),r}(y.a.Component),oa=ue.a.create({thumbnail:{},subHeading:{flexDirection:"row",alignItems:"center"},cardBody:{flex:1,flexDirection:"row",marginVertical:6}}),ca=Object(D.b)((function(e){return{class:e.classInfo,sleep:e.sleep}}),(function(e){return aa({},Object(k.a)({setSleepTime:Oe,setWakeTime:Pe,fetchClassSleepData:Ge,clearPendingSleepUpdate:Qe,createSleepRecordSuccess:nt,createSleepRecordFail:rt,editSleepRecordSuccess:at,editSleepRecordFail:st,removeSleepRecord:Ae,removeSleepRecordSuccess:je,removeSleepRecordFail:Re,alertSleeplogErrorMessage:Tt,clearSleeplogErrorMessage:It,removeWakeTime:Te,markRecordError:Zt,markRecordCorrect:Xt},e))}))(ia);function la(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ua(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?la(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):la(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function da(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var fa=function(e){u()(r,e);var t=da(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,date:new Date,showDateTimeModal:!1,record_id:""},n.handleSend=n.handleSend.bind(_()(n)),n.handleOnAddRecord=n.handleOnAddRecord.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.class.isConnected;!this.props.milk.loaded&&e?this.fetchClassData():this.setState({isLoading:!1}),e||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"checkUnsent",value:function(e){for(var t=this.props.milk,n=t.newDataForCreate,r=t.oldDataForEdit,a=(t.dataForRemoval,t.by_student_id[e]),s=!1,i=0;i<a.length;i++){var o=a[i];if(n.has(o)||r.has(o)){s=!0;break}}return s}},{key:"fetchClassData",value:function(){var e,t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(this.props.class.isConnected){s.next=4;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),s.abrupt("return");case 4:return e=new Date,t=cn(e),e.setDate(e.getDate()+1),n=cn(e),s.next=10,a.a.awrap(En("milkintake",this.props.class.class_id,t,n));case 10:r=s.sent,this.denormalize(r),this.props.fetchClassMilkData(r.data),this.setState({isLoading:!1});case 14:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].time=new Date(t[n].time)}}},{key:"handleEditMilkAmout",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.editMilkAmount(e,t,n)}},{key:"handleOnAddRecord",value:function(e){this.props.addMilkRecord(e)}},{key:"confirmToRemoveRecord",value:function(e,t,n){var r=this;In.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"Yes",onPress:function(){return r.handleRemoveRecord(e,t,n)}},{text:"Cancel",style:"cancel"}])}},{key:"handleRemoveRecord",value:function(e,t,n){this.props.class.isConnected?(this.props.removeRecord(e,t,n),this.handleRemove(t,e)):le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"handleSend",value:function(){var e,t,n,r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e=this.props.milk,t=e.newDataForCreate,n=e.oldDataForEdit,e.dataForRemoval,this.props.class.isConnected){i.next=5;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),i.abrupt("return");case 5:if(!t.size){i.next=15;break}return i.next=8,a.a.awrap(this.handleCreate());case 8:if(!(r=i.sent).success){i.next=13;break}this.props.createDataSuccess(),i.next=15;break;case 13:return this.props.createDataFail(r.data),i.abrupt("return");case 15:if(!n.size){i.next=25;break}return i.next=18,a.a.awrap(this.handleEdit());case 18:if(!(s=i.sent).success){i.next=23;break}this.props.editDataSuccess(),i.next=25;break;case 23:return this.props.editDataFail(s.data),i.abrupt("return");case 25:this.props.navigation.goBack();case 26:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"handleCreate",value:function(){var e,t,n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.milk,t=e.newDataForCreate,n=e.records,r=[],t.forEach((function(e){r.push(ua({},n.by_id[e]))})),this.normalize(r),s={date:cn(new Date),data_objs:r},o.next=7,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.errMessage,r=e.message;return t>200?{success:!1,status_code:t,data:n||r}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=o.sent,o.abrupt("return",i);case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"handleEdit",value:function(){var e,t,n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.milk,t=e.oldDataForEdit,n=e.records,r=[],t.forEach((function(e){r.push(ua({record_id:e},n.by_id[e]))})),this.normalize(r),s={date:cn(new Date),data_objs:r},o.next=7,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message;return t>200?{success:!1,status_code:t,data:n}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=o.sent,o.abrupt("return",i);case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"handleRemove",value:function(e,t){var n;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.props.milk.dataForRemoval.has(e)){r.next=3;break}return r.abrupt("return");case 3:return n={record_id_array:e,student_id:t},"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",r.next=7,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message;return t>200?{success:!1,status_code:t,data:n}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:r.sent.success?this.props.removeMilkRecordSuccess():this.props.removeMilkRecordFail();case 9:case"end":return r.stop()}}),null,this,null,Promise)}},{key:"normalize",value:function(e){for(var t=0;t<e.length;t++)e[t].time=dn(e[t].time)}},{key:"selectDatetimeConfirm",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.record_id;this.setState({record_id:"",showDateTimeModal:!1}),this.props.editMilkTime(n,e,t)}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return y.a.createElement(Tn,null);var t=this.state,r=t.date,a=t.showDateTimeModal;return y.a.createElement(le.Container,null,a?y.a.createElement(Lr,{start_date:r,datetime_type:"time",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:null}):null,y.a.createElement(E.a,{style:pa.subHeading},y.a.createElement(b.a,{style:{fontSize:40}},r.getFullYear()+"."+(r.getMonth()+1)+"."+r.getDate()),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend},y.a.createElement(b.a,{style:{fontSize:40,color:"grey"}},"\u9001\u51fa"))),y.a.createElement(le.Content,{contentContainerStyle:{alignItems:"center"}},Object.keys(this.props.class.students).map((function(t){var r=e.props.milk.by_student_id[t],a=e.props.milk.records.by_id;return y.a.createElement(E.a,{key:t,style:{width:"98%"}},y.a.createElement(le.Card,{style:{flex:1,paddingVertical:15}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:pa.childThumbnail,onPress:function(){return e.handleOnAddRecord(t)},underlayColor:"transparent"},y.a.createElement(rn.a,{source:""===e.props.class.students[t].profile_picture?n(70):{uri:e.props.class.students[t].profile_picture},style:pa.thumbnailImage}))),y.a.createElement(E.a,{style:{flex:3}},y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:30,paddingLeft:18}},e.props.class.students[t].name)),y.a.createElement(E.a,{style:{flex:1,paddingRight:15}},e.checkUnsent(t)?y.a.createElement(b.a,{style:{fontSize:15,paddingLeft:18,alignSelf:"flex-end",color:"red"}},"\u672a\u9001\u51fa"):null)),r.map((function(n,r){var s=a[n];return y.a.createElement(E.a,{key:n,style:pa.cardBody},y.a.createElement(E.a,{style:{width:"35%",marginRight:"3%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setState({showDateTimeModal:!0,record_id:n})}},y.a.createElement(b.a,{style:{fontSize:35,textAlign:"center"}},s.time.getHours()+":"+s.time.getMinutes()))),y.a.createElement(E.a,{style:{flexDirection:"row",width:"35%",marginRight:"3%",alignItems:"center",justifyContent:"center",backgroundColor:"#fef6dd",height:"100%",borderRadius:10}},y.a.createElement(qn.a,{style:{flex:2,fontSize:35,textAlign:"center"},keyboardType:"decimal-pad",placeholder:"\u2f64\u91cf",value:""+s.amount,onChangeText:function(t){e.handleEditMilkAmout(n,t)}}),y.a.createElement(b.a,{style:{flex:1,fontSize:30,textAlign:"center"}},"c.c.")),y.a.createElement(E.a,{style:{width:"20%",marginRight:"4%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return e.confirmToRemoveRecord(t,n,r)}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"\u79fb\u9664"))))}))))))}))))}}]),r}(y.a.Component),pa=ue.a.create({childThumbnail:{},thumbnailImage:{width:140,height:140,borderRadius:70},subHeading:{width:"90%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",alignSelf:"center"},cardBody:{flexDirection:"row",marginVertical:6}}),ha=Object(D.b)((function(e){return{class:e.classInfo,milk:e.milk}}),(function(e){return ua({},Object(k.a)({editMilkAmount:Ie,addMilkRecord:We,fetchClassMilkData:Je,createDataSuccess:Ye,createDataFail:Ze,editDataSuccess:Xe,editDataFail:$e,removeRecord:pt,removeMilkRecordSuccess:et,removeMilkRecordFail:tt,editMilkTime:ze},e))}))(fa),ma=n(323);function ya(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}!function(e){u()(n,e);var t=ya(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={other_option:"\u5176\u4ed6"},r}c()(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({other_option:"\u5176\u4ed6"},(function(){console.log("mounted",e.refs.textRef.isFocused())}))}},{key:"onBlur",value:function(e){console.log("onBlur"),this.setState({other_option:""}),this.props.editPooCondition(e)}},{key:"render",value:function(){var e=this,t=this.state.other_option;return console.log("other_option ===: ","\u5176\u4ed6"===t),y.a.createElement(qn.a,{ref:"textRef",autoFocus:"\u5176\u4ed6"===t,selectTextOnFocus:!0,style:{fontSize:30,textAlign:"center"},value:t,onChangeText:function(t){return e.setState({other_option:t})},onEndEditing:function(){return e.props.editPooCondition(t)},onBlur:function(){return e.onBlur(t)}})}}])}(y.a.Component);function ga(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _a(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ea=function(e){u()(n,e);var t=_a(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={selected_other:!1,other_option:""},r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"editPooCondition",value:function(e,t){var n=this.props.teacher_id;"\u53d6\u6d88\u7de8\u8f2f"!==t&&("\u5176\u4ed6"===t?this.setState({selected_other:!0,other_option:" "}):(console.log("editPooCondition: ",e,t,n),this.setState({selected_other:!1,other_option:t}),this.props.editPooCondition(e,t,n)))}},{key:"render",value:function(){var e=this,t=this.props,n=t.record_id,r=t.record,a=this.state,s=a.selected_other,i=a.other_option;return y.a.createElement(E.a,{style:{width:"23%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10}},s?y.a.createElement(qn.a,{style:{fontSize:30,textAlign:"center"},keyboardType:"default",autoFocus:s,selectTextOnFocus:!0,value:i,onChangeText:function(t){return e.setState({other_option:t})},onBlur:function(){return e.editPooCondition(n,i)}}):y.a.createElement(Wn,{style:{alignItems:"center",padding:5},selectedValue:i||r.poo_condition,options:["\u6b63\u5e38","\u786c","\u8edf\u7cca","\u7a00\u6c34","\u5176\u4ed6","\u53d6\u6d88\u7de8\u8f2f"],textStyle:{fontSize:30},handleOnClick:function(){},handleSelectValue:function(t){return e.editPooCondition(n,t)}}))}}]),n}(y.a.Component),ba=Object(D.b)((function(e){return{diaper_records:e.diaper,class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ga(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ga(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({editPooCondition:qe},e))}))(Ea);function va(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Sa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?va(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):va(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ca=function(e){u()(r,e);var t=wa(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,date:new Date,other_option:"",show_time_picker:!1,record_id_for_edit:"",cloth_diaper:!1,record_id:""},n.handleSend=n.handleSend.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.diaper_records,t=e.new_data_for_create,n=e.old_data_for_edit,r=this.props.class.isConnected;t.size+n.size===0&&r?this.fetchClassData():this.setState({isLoading:!1}),r||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"checkUnsent",value:function(e){var t=this.props.diaper_records,n=t.new_data_for_create,r=t.old_data_for_edit,a=t.by_student_id,s=t.students_pending_amount_update,i=a[e].records,o=!1;if(s.has(e))return!0;for(var c=0;c<i.length;c++)if(n.has(i[c])||r.has(i[c])){o=!0;break}return o}},{key:"fetchClassData",value:function(){var e,t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(this.props.class.isConnected){s.next=4;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),s.abrupt("return");case 4:return e=new Date,t=cn(e),e.setDate(e.getDate()+1),n=cn(e),s.next=10,a.a.awrap(En("diaper",this.props.class.class_id,t,n));case 10:r=s.sent,this.denormalize(r),this.props.fetchClassDiaperData(r.data),this.setState({isLoading:!1});case 14:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].time=new Date(t[n].time)}}},{key:"handleUpdateDiaperAmount",value:function(e,t){this.props.updateDiaperAmount(e,t)}},{key:"addDiaperRecord",value:function(e){var t=this.props.route.params.teacher_id;this.props.addDiaperRecord(e,new Date,this.state.cloth_diaper,t)}},{key:"setTime",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.record_id_for_edit;void 0!==e?(this.setState({show_time_picker:!1,record_id_for_edit:""}),this.props.editDiaperTime(n,e,t)):this.setState({show_time_picker:!1,record_id_for_edit:""})}},{key:"switchPeeOrPoo",value:function(e){var t=this.props.route.params.teacher_id;this.props.switchPeeOrPoo(e,t)}},{key:"editPooCondition",value:function(e,t){var n=this.props.route.params.teacher_id;"\u53d6\u6d88\u7de8\u8f2f"!==t&&("\u5176\u4ed6"===t?this.setState({record_id:e,other_option:"Please Fill Out"}):(this.setState({other_option:""}),this.props.editPooCondition(e,t,n)))}},{key:"confirmRemove",value:function(e,t){var n=this;In.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"OK",onPress:function(){return n.removeDiaperRecord(e,t)}},{text:"Cancel",style:"cancel"}])}},{key:"removeDiaperRecord",value:function(e,t){var n=this,r=this.props.diaper_records.new_data_for_create,a=this.props.class.isConnected;if(r.has(t))this.props.removeDiaperRecordSuccess(e,t);else if(a){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({record_id:t})}).then((function(e){return e.json()})).then((function(r){var a=r.statusCode,s=r.message;(a>200||"Internal Server Error"===s)&&n.props.removeDiaperRecordFail(s),n.props.removeDiaperRecordSuccess(e,t)})).catch((function(e){n.props.removeDiaperRecordFail(e)}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"handleSend",value:function(){var e,t,n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(e=this.props.diaper_records,t=e.new_data_for_create,n=e.old_data_for_edit,r=e.students_pending_amount_update,this.props.class.isConnected){o.next=5;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),o.abrupt("return");case 5:if(!t.size&&!n.size){o.next=15;break}return o.next=8,a.a.awrap(this.createRecords());case 8:if(!(s=o.sent).success){o.next=13;break}this.props.createDiaperRecordSuccess(),o.next=15;break;case 13:return this.props.createDiaperRecordFail(s.data),o.abrupt("return");case 15:if(!r.size){o.next=25;break}return o.next=18,a.a.awrap(this.sendDiaperAmountData());case 18:if(!(i=o.sent).success){o.next=23;break}this.props.editDiaperAmountSuccess(),o.next=25;break;case 23:return this.props.editDiaperAmountFail(i.err_message),o.abrupt("return");case 25:this.props.navigation.goBack();case 26:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"sendDiaperAmountData",value:function(){var e,t=this;return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.props.class.isConnected){n.next=4;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),n.abrupt("return");case 4:return"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",n.next=7,a.a.awrap(Promise.all(Array.from(this.props.diaper_records.students_pending_amount_update).map((function(e){return fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/"+e,{method:"PUT",body:JSON.stringify({amount:t.props.diaper_records.by_student_id[e].amount}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){throw e}))}))).then((function(e){return{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,err_message:"error occured while sending diaper amount data: "+e}})));case 7:return e=n.sent,n.abrupt("return",e);case 9:case"end":return n.stop()}}),null,this,null,Promise)}},{key:"createRecords",value:function(){var e,t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.diaper_records,t=e.new_data_for_create,n=e.old_data_for_edit,r=e.records,s=[],[].concat(T()(t),T()(n)).forEach((function(e){s.push(Sa({},r.by_id[e]))})),this.normalize(s),i={date:cn(new Date),data_objs:s},"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",c.next=9,a.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){return 200===e.statusCode?{success:!0,status_code:200,data:e}:{success:!1,status_code:500,data:e.message}})).catch((function(e){return{success:!1,status_code:500,err_message:e}})));case 9:return o=c.sent,c.abrupt("return",o);case 11:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"editDiaperRecords",value:function(){return a.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),null,null,null,Promise)}},{key:"normalize",value:function(e){for(var t=0;t<e.length;t++)e[t].time=dn(e[t].time)}},{key:"render",value:function(){var e=this;""!==this.props.diaper_records.err_message&&In.a.alert("Error!",this.props.diaper_records.err_message,[{text:"OK",onPress:function(){return e.props.clearDiaperlogErrorMessage()}}]);var t=this.props.route.params.teacher_id,r=this.state,a=r.show_time_picker,s=r.cloth_diaper,i=this.props.diaper_records,o=i.by_student_id,c=i.records,l=this.props.class.students,u=this.state.date;return y.a.createElement(Bn.a,{style:{flex:1,paddingBottom:15},enabled:!0},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-evenly"}},y.a.createElement(b.a,{style:{fontSize:40}},ln(u)),y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(C.a,{style:{backgroundColor:s?"rgba(255,255,255,0.2)":"#ffe1d0",padding:10,marginRight:20},onPress:function(){return e.setState({cloth_diaper:!1})}},y.a.createElement(b.a,{style:{fontSize:40}},"\u5c3f\u5e03")),y.a.createElement(C.a,{style:{backgroundColor:s?"#ffe1d0":"rgba(255,255,255,0.2)",padding:10,marginRight:20},onPress:function(){return e.setState({cloth_diaper:!0})}},y.a.createElement(b.a,{style:{fontSize:40}},"\u5b78\u7fd2\u8932")),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend},y.a.createElement(b.a,{style:{fontSize:40}},"\u9001\u51fa")))),y.a.createElement(kn.a,{contentContainerStyle:{alignItems:"center"},keyboardShouldPersistTaps:"handled"},Object.keys(l).map((function(r){if(null===o[r])return null;var i=o[r].records;return y.a.createElement(E.a,{key:r,style:{width:"98%"}},y.a.createElement(le.Card,{style:{flex:1,flexDirection:"row",paddingVertical:15}},y.a.createElement(E.a,{style:{width:"23%",alignItems:"center",justifyContent:"center"}},y.a.createElement(C.a,{onPress:function(){return e.addDiaperRecord(r)},underlayColor:"transparent"},y.a.createElement(rn.a,{source:""===l[r].profile_picture?n(70):{uri:l[r].profile_picture},style:Da.thumbnailImage}))),y.a.createElement(E.a,{style:{width:"77%"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:30}},l[r].name),e.checkUnsent(r)?y.a.createElement(b.a,{style:{fontSize:15,color:"red",marginLeft:15}},"\u672a\u9001\u51fa"):null),y.a.createElement(E.a,{style:{flex:1,alignItems:"flex-end",paddingRight:15}},s?null:y.a.createElement(E.a,{style:{width:"33%",aspectRatio:1,backgroundColor:"#b5e9e9",alignItems:"center",padding:5}},y.a.createElement(b.a,null,"\u5c3f\u5e03\u91cf"),y.a.createElement(qn.a,{style:{flex:1,fontSize:37},value:""+o[r].amount,onChangeText:function(t){return e.handleUpdateDiaperAmount(r,t)}})))),i.map((function(n){var a=c.by_id[n];return a.cloth_diaper!==s?null:y.a.createElement(E.a,{key:n,style:{flex:1,flexDirection:"row",marginVertical:6,justifyContent:"space-between",paddingRight:15}},y.a.createElement(C.a,{style:{width:"\u5927\u4fbf"===a.pee_or_poo?"23%":"35%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setState({record_id_for_edit:n,show_time_picker:!0})}},y.a.createElement(b.a,{style:{fontSize:35,textAlign:"center"}},a.time.getHours()+":"+a.time.getMinutes())),y.a.createElement(C.a,{style:{width:"\u5927\u4fbf"===a.pee_or_poo?"23%":"35%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.switchPeeOrPoo(n)}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},""+a.pee_or_poo)),"\u5927\u4fbf"===a.pee_or_poo?y.a.createElement(ba,{teacher_id:t,record_id:n,record:a}):null,y.a.createElement(C.a,{style:{width:"20%",height:"100%",justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return e.confirmRemove(r,n)}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"\u79fb\u9664")))})),a&&y.a.createElement(ma.a,{style:{width:"100%"},mode:"time",display:"spinner",value:new Date,onChange:function(t,n){return e.setTime(n)},minimumDate:new Date})))))}))))}}]),r}(y.a.Component),Da=ue.a.create({thumbnailImage:{width:140,height:140,borderRadius:70}}),ka=Object(D.b)((function(e){return{diaper_records:e.diaper,class:e.classInfo}}),(function(e){return Sa({},Object(k.a)({updateDiaperAmount:Le,addDiaperRecord:Fe,editDiaperTime:Me,switchPeeOrPoo:Be,editPooCondition:qe,removeDiaperRecordSuccess:Ne,removeDiaperRecordFail:Ue,fetchClassDiaperData:it,createDiaperRecordSuccess:ot,createDiaperRecordFail:ct,editDiaperRecordSuccess:lt,editDiaperRecordFail:ut,editDiaperAmountSuccess:dt,editDiaperAmountFail:ft,clearDiaperlogErrorMessage:He},e))}))(Ca);function xa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Oa=function(e){u()(n,e);var t=xa(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"handleNavigate",value:function(e){var t=this.props.route.params,n=t.school_name,r=t.school_id;this.props.navigation.navigate(e,{school_name:n,school_id:r})}},{key:"render",value:function(){var e=this;return y.a.createElement(kn.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center"}},y.a.createElement(C.a,{style:Aa.button,onPress:function(){return e.handleNavigate("Registration")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u65b0\u751f\u8a3b\u518a")),y.a.createElement(C.a,{style:Aa.button,onPress:function(){return e.handleNavigate("Students")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u5b78\u751f\u8cc7\u6599")),y.a.createElement(C.a,{style:Aa.button,onPress:function(){return e.handleNavigate("Teachers")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u6559\u5e2b\u8cc7\u6599")),y.a.createElement(C.a,{style:Aa.button,onPress:function(){return e.handleNavigate("DownloadPage")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u4e0b\u8f09")))}}]),n}(y.a.Component);Oa.navigationOptions=function(e){e.navigation;return{headerTitle:y.a.createElement(Zr,{title:"Admin Home"})}};var Aa=ue.a.create({button:{width:"80%",padding:50,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",marginVertical:20},button_text:{}});function ja(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ra=function(e){u()(n,e);var t=ja(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={studentDataArray:[{name:"",class_id:"",class_name:"",profile_picture:"",blood_type:""}]},r}return c()(n,[{key:"addStudent",value:function(){var e=this.state.studentDataArray;e.push({name:"",class_id:"",class_name:"",profile_picture:"",blood_type:""}),this.setState({studentDataArray:e})}},{key:"fillStudent",value:function(){var e=this.state.studentDataArray;e[0]={name:"John Smith",class_id:null,profile_picture:"",blood_type:"AB"},this.setState({studentDataArray:e})}},{key:"setName",value:function(e,t){var n=this.state.studentDataArray;n[t].name=e,this.setState({studentDataArray:n})}},{key:"setBloodType",value:function(e,t){var n=this.state.studentDataArray;n[t].blood_type=e,this.setState({studentDataArray:n})}},{key:"removeStudent",value:function(e){var t=this.state.studentDataArray;t.splice(e,1),this.setState({studentDataArray:t})}},{key:"handleSelectClass",value:function(e,t){for(var n=this.props.classes,r=this.state.studentDataArray,a="",s=0;s<Object.keys(n).length;s++){var i=Object.keys(n)[s];if(n[i].name===e){a=i;break}}r[t].class_id=a,r[t].class_name=e,this.setState({studentDataArray:r})}},{key:"getStudentDataArray",value:function(){return this.state.studentDataArray}},{key:"render",value:function(){var e=this,t=this.state.studentDataArray,n=this.props.classes,r=Object.keys(n).map((function(e){return n[e].name}));return y.a.createElement(E.a,{style:{width:"100%",padding:"5%",backgroundColor:"#368cbf"}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:5,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(b.a,{style:{fontSize:60}},"\u5b78\u751f\u8cc7\u6599"),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"#b5e9e9"},onPress:function(){return e.addStudent()}},y.a.createElement(b.a,{style:{fontSize:35}},"\u65b0\u589e\u5b78\u751f"))),t.map((function(n,a){var s=n.name,i=n.blood_type;return y.a.createElement(E.a,{key:a,style:{width:"100%",padding:"5%",backgroundColor:"#f4d41f"}},y.a.createElement(E.a,{style:{flexDirection:"row",padding:10,backgroundColor:"white",justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"50%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(qn.a,{placeholder:"\u5168\u540d",value:s,style:{fontSize:30},onChangeText:function(t){return e.setName(t,a)}})),y.a.createElement(E.a,{style:{width:"20%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(qn.a,{placeholder:"\u8840\u578b",value:i,style:{fontSize:30},onChangeText:function(t){return e.setBloodType(t,a)}})),y.a.createElement(C.a,{style:{width:"20%",padding:10,backgroundColor:"#fa625f",borderRadius:2,justifyContent:"center"},onPress:function(){return e.removeStudent(a)}},y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:30}},"\u79fb\u9664"))),y.a.createElement(E.a,{style:{padding:10,backgroundColor:"white"}},y.a.createElement(Wn,{style:{padding:10,backgroundColor:"#b5e9e9"},textStyle:{fontSize:30},selectedValue:t[a].class_name||"\u9078\u64c7\u5b78\u751f\u73ed\u7d1a",options:r,handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t,a)}})))})))}}]),n}(y.a.Component),Pa=n(140);function Ta(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ia=function(e){u()(n,e);var t=Ta(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={parentDataArray:[{name:"",email:"",username:"",password:"",role:"\u7236",mobile:"",address:"",work_phone:"",transportation:""}],parentSignUpStatus:[!1]},r}return c()(n,[{key:"addParent",value:function(){var e=this.state,t=e.parentDataArray,n=e.parentSignUpStatus;t.push({name:"",email:"",username:"",password:"",role:"\u7236",mobile:"",address:"",work_phone:"",transportation:""}),n.push(!1),this.setState({parentDataArray:t,parentSignUpStatus:n})}},{key:"fillParent",value:function(){var e=this.state.parentDataArray;e[0]={name:"Jane Smith",email:"caleb7947@gmail.com",username:"abc123",password:"password",role:"parent#mother",mobile:"061234567",address:"SOME ADDRESS",work_phone:"061234567",transportation:"car"},this.setState({parentDataArray:e})}},{key:"setName",value:function(e,t){var n=this.state.parentDataArray;n[t].name=e,this.setState({parentDataArray:n})}},{key:"setRole",value:function(e,t){var n=this.state.parentDataArray;n[t].role=e,this.setState({parentDataArray:n})}},{key:"setEmail",value:function(e,t){var n=this.state.parentDataArray;n[t].email=e,this.setState({parentDataArray:n})}},{key:"setUsername",value:function(e,t){var n=this.state.parentDataArray;n[t].username=e,this.setState({parentDataArray:n})}},{key:"toLowerCase",value:function(e,t){var n=e.nativeEvent.text,r=this.state.parentDataArray,a=n.toLowerCase();r[t].username=a,this.setState({parentDataArray:r})}},{key:"setPassword",value:function(e,t){var n=this.state.parentDataArray;n[t].password=e,this.setState({parentDataArray:n})}},{key:"removeParent",value:function(e){var t=this.state,n=t.parentDataArray,r=t.parentSignUpStatus;n.splice(e,1),r.splice(e,1),this.setState({parentDataArray:n,parentSignUpStatus:r})}},{key:"handleSignup",value:function(e){var t=this,n=this.state.parentDataArray[e],r=n.name,a=n.email,s=n.username,i=n.password;w.a.signUp({username:s,password:i,attributes:{name:r,email:a}}).then((function(n){var r=t.state.parentSignUpStatus;r[e]=!0,t.setState({parentSignUpStatus:r})})).catch((function(e){alert("\u8a3b\u518a\u6709\u554f\u984c!\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+e.message)}))}},{key:"getParentSignUpStatus",value:function(){return this.state.parentSignUpStatus}},{key:"getParentDataArray",value:function(){return this.state.parentDataArray}},{key:"render",value:function(){var e=this,t=this.state,n=t.parentDataArray,r=t.parentSignUpStatus;return y.a.createElement(E.a,{style:{width:"100%",padding:"5%",backgroundColor:"#f4d41f"}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:5,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(b.a,{style:{fontSize:60}},"\u5bb6\u9577\u8cc7\u6599"),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"#b5e9e9"},onPress:function(){return e.addParent()}},y.a.createElement(b.a,{style:{fontSize:35}},"\u65b0\u589e\u5bb6\u9577"))),n.map((function(t,n){var a=t.name,s=t.email,i=t.username,o=t.password,c=t.role;t.mobile,t.address,t.work_phone,t.transportation;return y.a.createElement(E.a,{key:n,style:{padding:10,backgroundColor:"white",marginBottom:20}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"}},y.a.createElement(E.a,{style:{width:"50%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(qn.a,{placeholder:"\u5168\u540d",value:a,style:{fontSize:30},onChangeText:function(t){return e.setName(t,n)}})),y.a.createElement(E.a,{style:{width:"20%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(Pa.a,{selectedValue:c,style:{height:50},onValueChange:function(t,r){return e.setRole(t,n)}},y.a.createElement(Pa.a.Item,{label:"\u7236",value:"\u7236"}),y.a.createElement(Pa.a.Item,{label:"\u6bcd",value:"\u6bcd"}))),y.a.createElement(C.a,{style:{width:"20%",padding:10,backgroundColor:"#fa625f",borderRadius:2,justifyContent:"center"},onPress:function(){return e.removeParent(n)}},y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:30}},"\u79fb\u9664"))),y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"}},y.a.createElement(E.a,{style:{width:"100%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(qn.a,{placeholder:"Email",autoCapitalize:"none",keyboardType:"email-address",value:s,style:{fontSize:30},onChangeText:function(t){return e.setEmail(t,n)}}))),y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"}},y.a.createElement(E.a,{style:{width:"35%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(qn.a,{placeholder:"\u5e33\u865f",autoCapitalize:"none",value:i,style:{fontSize:30},onChangeText:function(t){return e.setUsername(t,n)},onEndEditing:function(t){return e.toLowerCase(t,n)}})),y.a.createElement(E.a,{style:{width:"35%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(qn.a,{secureTextEntry:!0,placeholder:"\u5bc6\u78bc",value:o,style:{fontSize:30},onChangeText:function(t){return e.setPassword(t,n)}})),y.a.createElement(C.a,{style:{width:"20%",padding:5,backgroundColor:r[n]?"#dcf3d0":"#ffe1d0",justifyContent:"center"},onPress:function(){return e.handleSignup(n)},disable:r[n]},r[n]?y.a.createElement(b.a,{style:{fontSize:20}},"SUCCESS"):y.a.createElement(b.a,{style:{fontSize:35,alignSelf:"center"}},"\u8a3b\u518a"))))})))}}]),n}(y.a.Component),za=n(542);function La(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ma=function(e){u()(n,e);var t=Fa(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={parentSignUpStatus:[!1],createFamilyProfileStatus:"not_created"},r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"createFamilyProfile",value:function(){var e=this,t=!0;if(this.refs.parent.getParentSignUpStatus().forEach((function(e){t&=e})),t){var n=this.refs.parent.getParentDataArray(),r=this.refs.student.getStudentDataArray();this.setState({createFamilyProfileStatus:"creating"}),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/family/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({parentDataArray:n,studentDataArray:r})}).then((function(e){return e.json()})).then((function(t){t.statusCode>200||"Internal server error"===t.message?alert("Error!"+t.message):(e.fetchStudentData(),In.a.alert("\u8a3b\u518a\u6210\u529f!","\u9ede\u9078OK\u4ee5\u96e2\u958b\u9801\u9762",[{text:"OK",onPress:function(){return e.props.navigation.goBack()}}]),e.setState({createFamilyProfileStatus:"created"}))})).catch((function(e){console.error(e)}))}else alert("Error! We cannot create family profile until all parents have been signed up")}},{key:"fetchStudentData",value:function(){var e,t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.route.params.school_id,c.next=3,a.a.awrap(hn("/school/"+e+"/student"));case 3:if(t=c.sent,n=t.success,t.statusCode,r=t.message,s=t.data,n){c.next=8;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),c.abrupt("return");case 8:i=s.students,o=s.classes,this.props.fetchStudentsSuccess(i,o);case 10:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state,n=(t.studentDataArray,t.parentDataArray,t.parentSignUpStatus,t.createFamilyProfileStatus);return y.a.createElement(Bn.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(za.a,{style:{width:"100%"}},y.a.createElement(Ra,{ref:"student",classes:this.props.classes}),y.a.createElement(Ia,{ref:"parent"}),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-around"}},y.a.createElement(C.a,{style:{flex:1,padding:20,backgroundColor:"not_created"===n||"creating"===n?"#b5e9e9":"#00c07f",justifyContent:"center"},onPress:function(){return e.createFamilyProfile()}},"not_created"===n?y.a.createElement(b.a,{style:{fontSize:50,textAlign:"center"}},"\u5b8c\u6210"):"creating"===n?y.a.createElement(Tn,null):y.a.createElement(b.a,{style:{fontSize:50}},"SUCCESS")),y.a.createElement(C.a,{style:{flex:1,padding:20,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.navigation.goBack()}},y.a.createElement(b.a,{style:{fontSize:50,textAlign:"center"}},"\u8fd4\u56de")))))}}]),n}(y.a.Component),Ba=Object(D.b)((function(e){return{classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?La(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):La(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({fetchStudentsSuccess:Mt},e))}))(Ma),qa=n(256),Na=n(115),Ua=n(99);function Ha(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Va=Pr.a.get("window"),Ka=Va.width,Ga=Va.height,Qa=function(e){u()(n,e);var t=Wa(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.show,r=t.component,a=t.modal_padding;return n?y.a.createElement(Bn.a,{style:{backgroundColor:"transparent",alignItems:"center",zIndex:2,position:"absolute",width:"100%",height:"100%"},behavior:"height",enabled:!0},y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.8)",width:"100%",height:"100%"},onPress:function(){return e.props.hideModal()}},y.a.createElement(E.a,null)),y.a.createElement(E.a,{style:{flex:1,marginTop:a,width:Ka/2,height:Ga,backgroundColor:"white",zIndex:3,position:"absolute"}},r)):null}}]),n}(y.a.Component),Ja=(ue.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),Object(D.b)((function(e){return{students:e.school.students,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ha(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ha(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({},e))}))(Qa));function Ya(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Za(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ya(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ya(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var $a=function(e){u()(r,e);var t=Xa(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={parents:[],student:null,isLoading:!0},n}return c()(r,[{key:"componentDidMount",value:function(){var e,t,n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.student_id,n=e.student,o.next=3,a.a.awrap(hn("/student/"+t+"/family"));case 3:if(r=o.sent,s=r.success,r.statusCode,i=r.message,r.data,s){o.next=8;break}return alert("Sorry \u53d6\u5f97\u5bb6\u5ead\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+i),o.abrupt("return");case 8:this.setState({parents:r.data,student:n,isLoading:!1});case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"addParent",value:function(){3!==this.state.parents.length?this.props.addParent({id:"",name:"",role:"",username:"",password:"",mobile:"",work_phone:"",address:""}):alert("Sorry \u4e00\u500b\u5bf6\u8c9d\u53ea\u80fd\u8a3b\u518a\u4e09\u4f4d\u5bb6\u9577\uff01")}},{key:"editStudentData",value:function(){var e,t,n,r,s,i,o,c;return a.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.student_id,t=this.state.student,n=t.name,r=t.class_id,l.next=5,a.a.awrap(yn("/student/"+e,{name:n,class_id:r}));case 5:if(s=l.sent,i=s.success,s.statusCode,o=s.message,s.data,i){l.next=10;break}return alert("Sorry \u7de8\u8f2f\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o),l.abrupt("return");case 10:this.props.hideModal(),c=this.props.student.class_id,this.props.editStudentSuccess(e,n,c,r);case 13:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"getClassNames",value:function(){var e=this.props.classes;return Object.keys(e).map((function(t){return e[t].name}))}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(r){t[r].name===e&&(n=r)})),this.setState({student:Za(Za({},this.state.student),{},{class_id:n})})}},{key:"render",value:function(){var e=this,t=this.props.classes,r=this.state,a=r.student,s=r.parents;return r.isLoading?y.a.createElement(Tn,null):y.a.createElement(E.a,{style:{flex:1,padding:30}},y.a.createElement(E.a,{style:{flex:3,flexDirection:"row",alignItems:"center",backgroundColor:"#DCDCDC"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(C.a,{style:{}},y.a.createElement(rn.a,{source:""===a.profile_picture?n(70):{uri:a.profile_picture},style:{width:200,height:200,borderRadius:100}}))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(qn.a,{style:{fontSize:50},value:a.name,onChangeText:function(t){return e.setState({student:Za(Za({},e.state.student),{},{name:t})})}}),y.a.createElement(C.a,{style:{backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:5,width:"90%",marginTop:5}},y.a.createElement(b.a,{style:{fontSize:50}},t[a.class_id].name)))),y.a.createElement(E.a,{style:{flex:5,backgroundColor:"#F5F5F5"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},s.map((function(t){return y.a.createElement(E.a,{key:t.id,style:{width:"100%",height:"33%",padding:"1%"}},y.a.createElement(C.a,{style:{flex:1,padding:10,backgroundColor:"#b5e9e9",justifyContent:"center"},onPress:function(){return e.props.addParent(t)}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{paddingRight:10}},y.a.createElement(b.a,{style:{fontSize:20}},t.role)),y.a.createElement(E.a,null,y.a.createElement(E.a,{style:{width:"100%",flexDirection:"row"}},y.a.createElement(b.a,{style:{fontSize:20}},"\u59d3\u540d: ",t.name,"         "),y.a.createElement(b.a,{style:{fontSize:20}},"\u5e33\u865f: ",t.username,"         ")),y.a.createElement(b.a,{style:{fontSize:20}},"\u624b\u6a5f: ",t.mobile),y.a.createElement(b.a,{style:{fontSize:18}},"\u5de5\u4f5c/\u5bb6\u7528\u96fb\u8a71: ",t.work_phone),y.a.createElement(b.a,{style:{fontSize:18}},"\u5730\u5740: ",t.address)))))})),s.length<3?y.a.createElement(E.a,{style:{width:"100%",height:"33%",padding:"1%"}},y.a.createElement(C.a,{style:{flex:1,padding:10,backgroundColor:"white",justifyContent:"center",borderWidth:5,borderRadius:1,borderStyle:"dashed"},onPress:function(){return e.addParent()}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u65b0\u589e\u5bb6\u9577")))):null)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC"}},y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.hideModal()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u8fd4\u56de"))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.editStudentData()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u9001\u51fa")))))}}]),r}(y.a.Component);function es(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ts(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?es(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):es(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ns(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var rs=function(e){u()(r,e);var t=ns(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={password:"",qr_data:"",name:""},n}return c()(r,[{key:"componentDidMount",value:function(){var e,t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(e=this.props,t=e.parent_data,n=e.isConnected,this.setState(ts(ts({},this.state),t)),n){c.next=5;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),c.abrupt("return");case 5:if(""==t.id){c.next=14;break}return c.next=8,a.a.awrap(hn("/user/"+t.id+"/qrcode"));case 8:if(r=c.sent,s=r.success,r.statusCode,i=r.message,o=r.data,s){c.next=13;break}return alert("Sorry \u53d6\u5f97\u5bb6\u9577QR Code\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+i),c.abrupt("return");case 13:this.setState({qr_data:o});case 14:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"postParent",value:function(){var e,t,n,r,s,i,o,c,l,u,d,f,p,h,m,y;return a.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:if(e=this.props,t=e.student_id,n=e.isConnected,r=this.state,s=r.id,i=r.name,o=r.role,c=r.email,l=r.username,u=r.mobile,d=r.work_phone,f=r.address,n||alert("\u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),""!==s){g.next=9;break}return g.next=6,a.a.awrap(this.signUpParent());case 6:if(g.sent.success){g.next=9;break}return g.abrupt("return");case 9:return p={student_id:t,parent_data:{id:s,name:i,role:o,email:c,username:l,mobile:u,work_phone:d,address:f}},g.next=12,a.a.awrap(mn("/student/"+t+"/family",p));case 12:if(h=g.sent,m=h.success,h.statusCode,y=h.message,h.data,m){g.next=17;break}return alert("Sorry \u65b0\u589e\u5bb6\u9577\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+y),g.abrupt("return");case 17:this.props.goBack();case 18:case"end":return g.stop()}}),null,this,null,Promise)}},{key:"signUpParent",value:function(){var e,t,n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.state,t=e.username,n=e.password,r=e.name,s=e.email,o.next=3,a.a.awrap(w.a.signUp({username:t,password:n,attributes:{name:r,email:s}}).then((function(e){return{success:!0}})).catch((function(e){return alert("\u5bb6\u9577\u8a3b\u518a\u6709\u554f\u984c!\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+e.message),{success:!1}})));case 3:return i=o.sent,o.abrupt("return",i);case 5:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state,r=t.id,a=t.name,s=t.username,i=t.password,o=t.mobile,c=t.work_phone,l=t.address,u=t.role,d=t.email;return y.a.createElement(E.a,{style:{flex:1,padding:30}},y.a.createElement(E.a,{style:{flex:1,backgroundColor:"#F5F5F5"}},y.a.createElement(kn.a,null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",padding:10,justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"66%",padding:10,backgroundColor:"#ffddb7"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u59d3\u540d"),y.a.createElement(qn.a,{style:{fontSize:35,textAlign:"center"},value:a,onChangeText:function(t){return e.setState({name:t})}})),y.a.createElement(E.a,{style:{width:"32%",padding:10,backgroundColor:"#ffddb7"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u89d2\u8272"),y.a.createElement(qn.a,{style:{fontSize:35,textAlign:"center"},value:u,onChangeText:function(t){return e.setState({role:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(E.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"}},y.a.createElement(b.a,{style:{fontSize:15}},"Email"),y.a.createElement(qn.a,{style:{fontSize:35},autoCapitalize:"none",keyboardType:"email-address",placeholder:"",value:d,onChangeText:function(t){return e.setState({email:t})}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",padding:10,justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"49%",padding:15,backgroundColor:"#ffddb7"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5e33\u865f"),y.a.createElement(qn.a,{editable:""===r,style:{fontSize:35,textAlign:"center"},autoCapitalize:"none",value:s,onChangeText:function(t){return e.setState({username:t})}})),""===r?y.a.createElement(E.a,{style:{width:"49%",padding:15,backgroundColor:"#ffddb7"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5bc6\u78bc"),y.a.createElement(qn.a,{secureTextEntry:!0,style:{fontSize:35,textAlign:"center"},value:i,onChangeText:function(t){return e.setState({password:t})}})):y.a.createElement(C.a,{style:{backgroundColor:"transparent",alignItems:"center",justifyContent:"center"},onPress:function(){return e.props.viewQRCode(e.state.qr_data)}},y.a.createElement(rn.a,{source:n(436),style:{width:120,height:120}}))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(E.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u624b\u6a5f"),y.a.createElement(qn.a,{style:{fontSize:35},keyboardType:"number-pad",placeholder:"",value:o,onChangeText:function(t){return e.setState({mobile:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(E.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5de5\u4f5c/\u5bb6\u7528\u96fb\u8a71"),y.a.createElement(qn.a,{style:{fontSize:35},keyboardType:"number-pad",placeholder:"",value:c,onChangeText:function(t){return e.setState({work_phone:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(E.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5730\u5740"),y.a.createElement(qn.a,{style:{fontSize:35},placeholder:"",value:l,onChangeText:function(t){return e.setState({address:t})}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC"}},y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u8fd4\u56de"))),""!==r?y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u79fb\u9664"))):null,y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postParent()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},""===r?"\u65b0\u589e":"\u9001\u51fa")))))))}}]),r}(y.a.Component),as=Object(D.b)((function(e){return{isConnected:e.school.isConnected}}),null)(rs),ss=n(253);function is(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var os=function(e){u()(n,e);var t=is(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={},r}return c()(n,[{key:"render",value:function(){var e=this,t=this.props.parent_data,n=(t.name,t.role),r="\u6bcd"===n?"\u5abd\u5abd":"\u7236"===n?"\u7238\u7238":n;return y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:3,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:65}},this.props.student_name," ",r),y.a.createElement(ss.a,{value:this.props.qr_data,size:400})),y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(C.a,{style:{padding:15,backgroundColor:"#b5e9e9"},onPress:function(){return e.props.goBack()}},y.a.createElement(b.a,{style:{fontSize:30}},"\u8fd4\u56de"))))}}]),n}(y.a.Component);function cs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ls(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var us=Pr.a.get("window"),ds=(us.width,us.height),fs=function(e){u()(r,e);var t=ls(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).getPermissionAsync=function(){var e;return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Nn.a.OS){t.next=6;break}return t.next=3,a.a.awrap(Ua.c(Ua.b));case 3:e=t.sent,"granted"!==e.status&&alert("Sorry, we need camera roll permissions to make this work!");case 6:case"end":return t.stop()}}),null,null,null,Promise)},n._pickImage=function(e,t){var r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,a.a.awrap(qa.a({mediaTypes:Na.a.All,allowsEditing:!0,aspect:[1,1],quality:.4,base64:!0}));case 3:(r=i.sent).cancelled||(s=r.base64,n.getProfilePictureURL(s,e,t)),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),console.log(i.t0);case 10:case"end":return i.stop()}}),null,null,[[0,7]],Promise)},n.state={showModal:!1,modal_type:"",student_id:"",parent_data:{},qr_data:"",modal_padding:0},n}return c()(r,[{key:"componentDidMount",value:function(){this.getPermissionAsync()}},{key:"getProfilePictureURL",value:function(e,t,n){var r,s,i,o,c,l,u;return a.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return r=this.props.route.params.school_name,s=this.props.students,i={image:e,url:n,path:r+"/profile_picture_"+t+"_"+(new Date).getMilliseconds()+".jpg"},d.next=5,a.a.awrap(mn("/student/"+t+"/profile-picture",i));case 5:if(o=d.sent,c=o.success,o.statusCode,l=o.message,u=o.data,c){d.next=10;break}return alert("Sorry "+s[t].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l),d.abrupt("return");case 10:this.props.updateProfilePicture(t,u.image_url);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"getModalContent",value:function(){var e=this,t=this.props,n=t.students,r=t.classes,a=this.state,s=a.showModal,i=a.modal_type,o=a.student_id,c=a.parent_data,l=a.qr_data;return s?"student"===i?y.a.createElement($a,{student_id:o,student:n[o],classes:r,addParent:function(t){return e.setState({modal_type:"add_parent",parent_data:t})},editStudentSuccess:function(t,n,r,a){return e.props.editStudentSuccess(t,n,r,a)},hideModal:function(){return e.hideModal()}}):"add_parent"===i?y.a.createElement(as,{student_id:o,parent_data:c,viewQRCode:function(t){return e.setState({modal_type:"qrpage",qr_data:t})},goBack:function(){return e.setState({modal_type:"student"})}}):y.a.createElement(os,{qr_data:l,student_name:n[o].name,parent_data:c,goBack:function(){return e.setState({modal_type:"add_parent"})}}):null}},{key:"hideModal",value:function(){this.setState({showModal:!1})}},{key:"confirmDeleteStudent",value:function(e){var t=this,n=this.props.students;In.a.alert(n[e].name+" \u522a\u9664\u78ba\u8a8d","\u522a\u9664\u9019\u500b\u5bf6\u8c9d\u6703\u5c07\u4e00\u5207\u6538\u95dc\u8cc7\u6599(\u5305\u8a87\u7236\u6bcd)\u522a\u9664",[{text:"\u53d6\u6d88",style:"cancel"},{text:"OK",onPress:function(){return t.deleteStudentById(e)}}])}},{key:"deleteStudentById",value:function(e){var t,n,r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=this.props.students,i.next=3,a.a.awrap(gn("/student/"+e+"/"));case 3:if(n=i.sent,r=n.success,n.statusCode,s=n.message,n.data,r){i.next=8;break}return alert("Sorry "+t[e].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),i.abrupt("return");case 8:this.fetchStudentData();case 9:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"fetchStudentData",value:function(){var e,t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.route.params.school_id,c.next=3,a.a.awrap(hn("/school/"+e+"/student"));case 3:if(t=c.sent,n=t.success,t.statusCode,r=t.message,s=t.data,n){c.next=8;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),c.abrupt("return");case 8:i=s.students,o=s.classes,this.props.fetchStudentsSuccess(i,o);case 10:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.students,r=this.state,a=r.showModal,s=r.modal_padding;return y.a.createElement(E.a,null,y.a.createElement(Ja,{modal_padding:s,show:a,component:this.getModalContent(),hideModal:function(){return e.hideModal()}}),y.a.createElement(kn.a,null,Object.keys(t).map((function(r,a){var s=t[r];return y.a.createElement(E.a,{key:r,style:{flex:1,backgroundColor:"lightgrey",flexDirection:"row",marginBottom:10,padding:15}},y.a.createElement(C.a,{style:{},onPress:function(){return e._pickImage(r,s.profile_picture)}},y.a.createElement(rn.a,{source:""===s.profile_picture?n(70):{uri:s.profile_picture},style:{width:200,height:200,borderRadius:100}})),y.a.createElement(E.a,{style:{flex:5,paddingLeft:15}},y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:50}},s.name)),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20}},"\u5730\u5740: ",s.address)),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20}},"\u624b\u6a5f(\u7236): ",s.father_phone)),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20}},"\u624b\u6a5f(\u6bcd): ",s.mother_phone))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"space-evenly"}},y.a.createElement(E.a,{style:{backgroundColor:"white"}},y.a.createElement(C.a,{style:{padding:15,justifyContent:"center"},onPress:function(t){return e.setState({showModal:!0,modal_type:"student",student_id:r,modal_padding:Math.max(0,t.nativeEvent.pageY-ds)})}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u7de8\u8f2f"))),y.a.createElement(E.a,{style:{backgroundColor:"#fa625f"}},y.a.createElement(C.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.confirmDeleteStudent(r)}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u522a\u9664")))))}))))}}]),r}(y.a.Component),ps=Object(D.b)((function(e){return{students:e.school.students,classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cs(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({updateProfilePicture:Qt,fetchStudentsSuccess:Mt,editStudentSuccess:Jt},e))}))(fs);function hs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var ms=function(e){u()(n,e);var t=hs(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={id:"",name:"",profile_picture:"",class_id:"",passcode:"",isAdmin:!1},r}return c()(n,[{key:"componentDidMount",value:function(){return a.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),null,null,null,Promise)}},{key:"postTeacher",value:function(){var e,t,n,r,s,i,o,c,l,u,d,f,p;return a.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return e=this.props,e.student_id,t=e.school_id,n=this.state,r=n.id,s=n.name,i=n.profile_picture,o=n.class_id,c=n.passcode,l=n.isAdmin,u={id:r,name:s,profile_picture:i,class_id:o,passcode:c,isAdmin:l},h.next=5,a.a.awrap(mn("/school/"+t+"/teacher",u));case 5:if(d=h.sent,f=d.success,d.statusCode,p=d.message,d.data,f){h.next=10;break}return In.a.alert("Sorry \u65b0\u589e\u6559\u5e2b\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+p,[{text:"Ok"}]),h.abrupt("return");case 10:this.props.goBack(),this.props.fetchTeacherData();case 12:case"end":return h.stop()}}),null,this,null,Promise)}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(r){t[r].name===e&&(n=r)})),this.setState({class_id:n,isAdmin:"\u7ba1\u7406\u54e1"===e})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,r=n.id,a=n.name,s=n.class_id,i=n.passcode;n.isAdmin;return y.a.createElement(E.a,{style:{flex:1,padding:30}},y.a.createElement(E.a,{style:{flex:1,backgroundColor:"#F5F5F5"}},y.a.createElement(kn.a,null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",padding:20,justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u59d3\u540d"),y.a.createElement(qn.a,{style:{fontSize:35,textAlign:"center"},value:a,onChangeText:function(t){return e.setState({name:t})}})),y.a.createElement(E.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5bc6\u78bc"),y.a.createElement(qn.a,{style:{fontSize:35,textAlign:"center"},value:i,keyboardType:"number-pad",onChangeText:function(t){return e.setState({passcode:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:20}},y.a.createElement(E.a,{style:{padding:10,backgroundColor:"#ffddb7",height:"100%",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u73ed\u7d1a"),y.a.createElement(Wn,{style:{backgroundColor:"rgba(255,255,255, 0)",alignItems:"center",padding:5},textStyle:{fontSize:30},selectedValue:""===s?"\u9078\u64c7\u73ed\u7d1a":t[s].name,options:Object.keys(t).map((function(e){return t[e].name})),handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t)}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC",marginTop:20}},y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u8fd4\u56de"))),y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postTeacher()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},""===r?"\u65b0\u589e":"\u9001\u51fa")))))))}}]),n}(y.a.Component);function ys(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var gs=function(e){u()(n,e);var t=ys(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={id:"",name:"",profile_picture:"",class_id:"",passcode:"",isAdmin:!1},r}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.teacher_id,n=e.teacher,r=e.classes,a=n.name,s=n.profile_picture,i=n.passcode,o=this.getClassIdByTeacherId(t,r);this.setState({id:t,name:a,profile_picture:s,passcode:i,class_id:o,isAdmin:""!==o&&"\u7ba1\u7406\u54e1"===r[o].name})}},{key:"getClassIdByTeacherId",value:function(e,t){for(var n=Object.keys(t),r=0;r<n.length;r++)for(var a=n[r],s=t[a].teachers,i=0;i<s.length;i++)if(e===s[i])return a;return""}},{key:"postTeacher",value:function(){var e,t,n,r,s,i,o,c,l,u,d,f,p;return a.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return e=this.props,e.student_id,t=e.school_id,n=this.state,r=n.id,s=n.name,i=n.profile_picture,o=n.class_id,c=n.passcode,l=n.isAdmin,u={id:r,name:s,profile_picture:i,class_id:o,passcode:c,isAdmin:l},h.next=5,a.a.awrap(mn("/school/"+t+"/teacher",u));case 5:if(d=h.sent,f=d.success,d.statusCode,p=d.message,d.data,f){h.next=10;break}return In.a.alert("Sorry \u66f4\u6539\u6559\u5e2b\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+p,[{text:"Ok"}]),h.abrupt("return");case 10:this.props.goBack(),this.props.fetchTeacherData();case 12:case"end":return h.stop()}}),null,this,null,Promise)}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(r){t[r].name===e&&(n=r)})),this.setState({class_id:n,isAdmin:"\u7ba1\u7406\u54e1"===e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,r=(t.teacher,this.state),a=r.id,s=r.name,i=r.class_id,o=r.passcode;return y.a.createElement(E.a,{style:{flex:1,padding:30}},y.a.createElement(E.a,{style:{flex:1,backgroundColor:"#F5F5F5"}},y.a.createElement(kn.a,null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",padding:20,justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u59d3\u540d"),y.a.createElement(qn.a,{style:{fontSize:35,textAlign:"center"},value:s,onChangeText:function(t){return e.setState({name:t})}})),y.a.createElement(E.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5bc6\u78bc"),y.a.createElement(qn.a,{style:{fontSize:35,textAlign:"center"},value:o,keyboardType:"number-pad",onChangeText:function(t){return e.setState({passcode:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:20}},y.a.createElement(E.a,{style:{padding:10,backgroundColor:"#ffddb7",height:"100%",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u73ed\u7d1a"),y.a.createElement(Wn,{style:{backgroundColor:"rgba(255,255,255, 0)",alignItems:"center",padding:5},textStyle:{fontSize:30},selectedValue:""===i?"\u9078\u64c7\u73ed\u7d1a":n[i].name,options:Object.keys(n).map((function(e){return n[e].name})),handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t)}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC",marginTop:20}},y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u8fd4\u56de"))),y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postTeacher()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},""===a?"\u65b0\u589e":"\u9001\u51fa")))))))}}]),n}(y.a.Component);function _s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Es(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var bs=function(e){u()(r,e);var t=Es(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).getPermissionAsync=function(){var e;return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Nn.a.OS){t.next=8;break}return t.next=3,a.a.awrap(Ua.c(Ua.b));case 3:if(e=t.sent,"granted"===e.status){t.next=8;break}return alert("Sorry, we need camera roll permissions to make this work!"),t.abrupt("return");case 8:case"end":return t.stop()}}),null,null,null,Promise)},n._pickImage=function(e,t){var r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,a.a.awrap(qa.a({mediaTypes:Na.a.All,allowsEditing:!0,aspect:[1,1],quality:.4,base64:!0}));case 3:(r=i.sent).cancelled||(s=r.base64,n.getProfilePictureURL(s,e,t)),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),console.log(i.t0);case 10:case"end":return i.stop()}}),null,null,[[0,7]],Promise)},n.state={showModal:!1,modal_type:"",selected_teacher_id:""},n}return c()(r,[{key:"componentDidMount",value:function(){this.getPermissionAsync()}},{key:"getProfilePictureURL",value:function(e,t,n){var r,s,i,o,c,l,u;return a.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return r=this.props.route.params.school_name,s=this.props.teachers,i={image:e,url:n,path:r+"/teacher/profile_picture_"+t+"_"+(new Date).getMilliseconds()+".jpg"},d.next=5,a.a.awrap(yn("/user/"+t+"/profile-picture",i));case 5:if(o=d.sent,c=o.success,o.statusCode,l=o.message,u=o.data,c){d.next=10;break}return alert("Sorry "+s[t].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l),d.abrupt("return");case 10:this.props.updateTeacherProfilePicture(t,u.image_url);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"fetchTeacherData",value:function(){var e,t,n,r,s,i,o,c;return a.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.route.params.school_id,l.next=3,a.a.awrap(hn("/school/"+e+"/teacher"));case 3:if(t=l.sent,n=t.success,t.statusCode,r=t.message,s=t.data,n){l.next=8;break}return alert("Sorry \u53d6\u5f97\u6559\u5e2b\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),l.abrupt("return");case 8:i=s.admins,o=s.teachers,c=s.classes,this.props.fetchTeachersSuccess(i,o,c);case 10:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"getModalContent",value:function(){var e=this,t=this.props.route.params.school_id,n=this.props,r=n.classes,a=n.teachers,s=this.state,i=s.modal_type,o=s.selected_teacher_id;return"add_teacher"===i?y.a.createElement(ms,{classes:r,school_id:t,fetchTeacherData:function(){return e.fetchTeacherData()},goBack:function(){return e.hideModal()}}):"edit_teacher"===i?y.a.createElement(gs,{classes:r,teacher_id:o,teacher:a[o],fetchTeacherData:function(){return e.fetchTeacherData()},goBack:function(){return e.hideModal()}}):void 0}},{key:"hideModal",value:function(){this.setState({showModal:!1})}},{key:"confirmDeleteTeacher",value:function(e){var t=this.props.teachers;confirm(t[e].name+" \u522a\u9664\u78ba\u8a8d")&&this.deleteTeacher(e)}},{key:"deleteTeacher",value:function(e){var t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,a.a.awrap(gn("/user/"+e));case 2:if(t=s.sent,n=t.success,t.statusCode,r=t.message,t.data,n){s.next=7;break}return alert("Sorry "+teachers[e].name+"\u522a\u9664\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+r),s.abrupt("return");case 7:this.fetchTeacherData();case 8:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.teachers,r=this.state.showModal;return y.a.createElement(E.a,null,y.a.createElement(Ja,{show:r,component:this.getModalContent(),hideModal:function(){return e.hideModal()}}),y.a.createElement(kn.a,null,y.a.createElement(E.a,{style:{padding:20}},y.a.createElement(C.a,{style:{padding:10,alignSelf:"flex-end",backgroundColor:"#ffddb7"},onPress:function(){return e.setState({showModal:!0,modal_type:"add_teacher"})}},y.a.createElement(b.a,{style:{fontSize:40}},"\u65b0\u589e\u6559\u5e2b"))),Object.keys(t).map((function(r,a){var s=t[r];return y.a.createElement(E.a,{key:r,style:{flex:1,backgroundColor:"lightgrey",flexDirection:"row",marginBottom:10,padding:15}},y.a.createElement(C.a,{style:{},onPress:function(){return e._pickImage(r,s.profile_picture)}},y.a.createElement(rn.a,{source:""===s.profile_picture?n(297):{uri:s.profile_picture},style:{width:200,height:200,borderRadius:100}})),y.a.createElement(E.a,{style:{flex:5,paddingLeft:15}},y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:50}},s.name))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"space-evenly"}},y.a.createElement(E.a,{style:{backgroundColor:"white"}},y.a.createElement(C.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.setState({showModal:!0,modal_type:"edit_teacher",selected_teacher_id:r})}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u7de8\u8f2f"))),y.a.createElement(E.a,{style:{backgroundColor:"#fa625f"}},y.a.createElement(C.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.confirmDeleteTeacher(r)}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u522a\u9664")))))}))))}}]),r}(y.a.Component),vs=Object(D.b)((function(e){return{teachers:e.school.teachers,classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_s(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({updateTeacherProfilePicture:Yt,fetchTeachersSuccess:Ft},e))}))(bs);function Ss(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ws(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ss(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ss(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ds=function(e){u()(r,e);var t=Cs(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,to_all_message:"",items_to_bring:["\u6bcd\u5976\u7c89","\u5c3f\u5e03","\u6c34\u58fa","\u8863\u7269"],other_item:"\u5176\u5b83",items_to_bring_bool:[0,0,0,0,0],activities_list:["\u5b30\u5152\u6309\u6469","\u97f3\u6a02\u5f8b\u52d5","\u6559\u5177\u64cd\u4f5c","\u7e6a\u672c\u6b23\u8cde","\u8a8d\u77e5\u5716\u7247","\u9ad4\u80fd\u6d3b\u52d5","\u85dd\u8853\u5275\u4f5c","\u591a\u5143\u8a9e\u8a00"],other_activity:"\u5176\u5b83",activities_bool:[0,0,0,0,0,0,0,0,0],message_by_student_id:{},editingOtherItemToBring:!1,editingOtherItemForStudent:"",editingOtherActivity:!1,editingOtherActivityForOne:""},n.recordActivitiesForAll=n.recordActivitiesForAll.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.message.student_id_for_update,t=this.props.class.isConnected;e.size>0||!t?this.setState({isLoading:!1}):this.fetchClassData(),t||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"fetchClassData",value:function(){var e,t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=new Date,t=cn(e),e.setDate(e.getDate()+1),n=cn(e),s.next=6,a.a.awrap(En("message",this.props.class.class_id,t,n));case 6:r=s.sent,this.props.fetchClassMessageData(r.data),this.setState({isLoading:!1});case 9:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"writeToAll",value:function(e){var t=this.props.route.params.teacher_id;this.setState({to_all_message:e}),this.props.writeToAll(e,t)}},{key:"writeToOne",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.writeToOne(e,t,n)}},{key:"remindItemsToBringToOne",value:function(e,t){var n=this.props.route.params.teacher_id,r=this.props.message.message_by_student_id,a=T()(r[e].things_to_bring),s=a[t]?0:1;a.splice(t,1,s),this.props.remindItemsToBringToOne(e,a,n)}},{key:"remindItemsToBringToAll",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.items_to_bring_bool,r=n[e]?0:1;n.splice(e,1,r),this.setState({items_to_bring_bool:n}),this.props.remindItemsToBringToAll(n,t)}},{key:"otherItemForAllEditorOnBlur",value:function(){var e=this.state.other_item;this.setState({editingOtherItemToBring:!1,other_item:""===e?"\u5176\u5b83":e})}},{key:"writeItemToBringToAll",value:function(e){var t=this.props.route.params.teacher_id;this.setState({other_item:e}),this.props.writeItemToBringToAll(e,t)}},{key:"writeItemToBringToOne",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.writeItemToBringToOne(e,t,n)}},{key:"editItemToBringToOneEditorOnBlur",value:function(e,t){this.setState({editingOtherItemForStudent:""}),""===t&&this.props.writeItemToBringToOne(e,"\u5176\u5b83")}},{key:"recordActivitiesForOne",value:function(e,t){var n=this.props.route.params.teacher_id,r=this.props.message.message_by_student_id,a=T()(r[e].activities),s=a[t]?0:1;a.splice(t,1,s),this.props.recordActivitiesForOne(e,a,n)}},{key:"recordActivitiesForAll",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.activities_bool,r=n[e]?0:1;n.splice(e,1,r),this.setState({activities_bool:n}),this.props.recordActivitiesForAll(n,t)}},{key:"writeActivityForAll",value:function(e){var t=this.props.route.params.teacher_id;this.setState({other_activity:e}),this.props.writeActivityForAll(e,t)}},{key:"otherActivityEditorOnBlur",value:function(){var e=this.state.other_activity;this.setState({editingOtherActivity:!1,other_activity:""===e?"\u5176\u5b83":e})}},{key:"writeActivityForOne",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.writeActivityForOne(e,t,n)}},{key:"activityForOneEditorOnBlur",value:function(e,t){this.setState({editingOtherActivityForOne:""}),""===t&&this.props.writeActivityForOne(e,"\u5176\u5b83")}},{key:"handleSend",value:function(){var e=this,t=this.props.message.message_by_student_id;if(this.props.class.isConnected){var n={date:cn(new Date),data:this.normalize(t)};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/message",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message;t.data;n>200||"Internal server error"===r?alert("Error"+r):(e.props.sendMessageOnSuccess(),e.props.navigation.goBack())})).catch((function(e){alert("Error"+e.message)}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"normalize",value:function(e){var t=this.props.message.student_id_for_update,n=[];return t.forEach((function(t){n.push(ws(ws({},e[t]),{},{student_id:t}))})),n}},{key:"render",value:function(){var e=this,t=this.props.message.student_id_for_update;if(this.state.isLoading)return y.a.createElement(Tn,null);var r=this.props.class.students,a=this.props.message.message_by_student_id,s=this.state,i=s.items_to_bring,o=s.items_to_bring_bool,c=s.activities_list,l=s.activities_bool,u=s.editingOtherItemToBring,d=s.editingOtherItemForStudent,f=s.editingOtherActivity,p=s.editingOtherActivityForOne,h=new Date;return y.a.createElement(Bn.a,{style:{flex:1},enabled:!0},y.a.createElement(E.a,{style:{padding:10,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},y.a.createElement(b.a,{style:{fontSize:40}},h.getFullYear()+"."+(h.getMonth()+1)+"."+h.getDate()),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0"},onPress:function(){return e.handleSend()}},y.a.createElement(b.a,{style:{fontSize:40,padding:5}},"\u9001\u51fa"))),y.a.createElement(kn.a,{contentContainerStyle:{alignItems:"center",marginBottom:20}},y.a.createElement(E.a,{style:{width:"95%"}},y.a.createElement(le.Card,{style:{padding:10}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",paddingVertical:10}},y.a.createElement(E.a,{style:{width:"29%",backgroundColor:"#fff1b5",borderRadius:10,marginRight:5}},y.a.createElement(b.a,{style:{fontSize:35,alignSelf:"center"}},"\u5bb6\u9577\u6e96\u5099"),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",flexWrap:"wrap"}},i.map((function(t,n){return y.a.createElement(C.a,{key:n,style:{backgroundColor:o[n]?"#f4d41f":"#fff7d6",borderRadius:3,padding:3,margin:5},onPress:function(){return e.remindItemsToBringToAll(n)}},y.a.createElement(b.a,{style:{fontSize:20}},t))})),y.a.createElement(C.a,{style:{backgroundColor:o[4]?"#f4d41f":"#fff7d6",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#f4d41f",onPress:function(){return e.remindItemsToBringToAll(4)},onLongPress:function(){return e.setState({editingOtherItemToBring:!0})}},u?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(qn.a,{autoFocus:!0,selectTextOnFocus:!0,value:this.state.other_item,style:{alignSelf:"center",fontSize:20,backgroundColor:o[4]?"#f4d41f":"#fff7d6"},onChangeText:function(t){return e.writeItemToBringToAll(t)},onBlur:function(){return e.otherItemForAllEditorOnBlur()}})):y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:20}},this.state.other_item)))),y.a.createElement(E.a,{style:{width:"69%",backgroundColor:"#b5e9e9",borderRadius:10,marginLeft:5}},y.a.createElement(b.a,{style:{fontSize:35,alignSelf:"center"}},"\u4eca\u65e5\u6d3b\u52d5"),y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-evenly",flexWrap:"wrap"}},c.map((function(t,n){return y.a.createElement(C.a,{key:n,style:{backgroundColor:l[n]?"#368cbf":"#eaf8f8",borderRadius:3,padding:3,margin:5},onPress:function(){return e.recordActivitiesForAll(n)}},y.a.createElement(b.a,{style:{fontSize:20}},t))})),y.a.createElement(C.a,{style:{backgroundColor:l[8]?"#368cbf":"#eaf8f8",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#368cbf",onPress:function(){return e.recordActivitiesForAll(8)},onLongPress:function(){return e.setState({editingOtherActivity:!0})}},f?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(qn.a,{autoFocus:!0,selectTextOnFocus:!0,value:this.state.other_activity,style:{alignSelf:"center",fontSize:20,backgroundColor:l[8]?"#368cbf":"#eaf8f8"},onChangeText:function(t){return e.writeActivityForAll(t)},onBlur:function(){return e.otherActivityEditorOnBlur()}})):y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:20}},this.state.other_activity))))),y.a.createElement(qn.a,{value:this.state.to_all_message,style:{alignSelf:"center",width:"100%",borderColor:"gray",borderWidth:2,borderRadius:10,fontSize:25,padding:20},multiline:!0,maxLength:100,onChangeText:function(t){return e.writeToAll(t)}})))),Object.keys(r).map((function(s){var o=a[s],l=o.text,u=o.things_to_bring,f=o.activities,h=o.other_item,m=o.other_activity;return y.a.createElement(E.a,{key:s,style:{width:"95%"}},y.a.createElement(le.Card,{style:{padding:10}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center",justifyContent:"center"}},y.a.createElement(rn.a,{source:""===r[s].profile_picture?n(70):{uri:r[s].profile_picture},style:{width:100,height:100,borderRadius:50}}),y.a.createElement(b.a,{style:{fontSize:25}},r[s].name)),y.a.createElement(E.a,{style:{flex:4}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingBottom:10}},y.a.createElement(E.a,{style:{width:"29%",backgroundColor:"#fff1b5",borderRadius:10,marginRight:3}},y.a.createElement(b.a,{style:{fontSize:28,alignSelf:"center"}},"\u5bb6\u9577\u6e96\u5099"),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",flexWrap:"wrap"}},i.map((function(t,n){return y.a.createElement(C.a,{key:n,style:{backgroundColor:u[n]?"#f4d41f":"#fff7d6",borderRadius:3,padding:4,margin:5},onPress:function(){return e.remindItemsToBringToOne(s,n)}},y.a.createElement(b.a,{style:{fontSize:20}},t))})),y.a.createElement(C.a,{style:{backgroundColor:u[4]?"#f4d41f":"#fff7d6",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#f4d41f",onPress:function(){return e.remindItemsToBringToOne(s,4)},onLongPress:function(){return e.setState({editingOtherItemForStudent:s})}},d===s?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(qn.a,{autoFocus:!0,selectTextOnFocus:!0,value:h,style:{alignSelf:"center",fontSize:20,backgroundColor:u[4]?"#f4d41f":"#fff7d6"},onChangeText:function(t){return e.writeItemToBringToOne(s,t)},onBlur:function(){return e.editItemToBringToOneEditorOnBlur(s,h)}})):y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:20}},h)))),y.a.createElement(E.a,{style:{width:"70%",borderRadius:10,marginLeft:3,backgroundColor:"#b5e9e9"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:2}},y.a.createElement(b.a,{style:{fontSize:28,alignSelf:"flex-end"}},"\u4eca\u65e5\u6d3b\u52d5")),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},t.has(s)?y.a.createElement(b.a,{style:{fontSize:15,alignSelf:"flex-end",paddingRight:10,color:"red"}},"\u672a\u9001\u51fa"):null)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}},c.map((function(t,n){return y.a.createElement(C.a,{key:n,style:{backgroundColor:f[n]?"#368cbf":"#d6f2f2",borderRadius:3,padding:4,margin:5},onPress:function(){return e.recordActivitiesForOne(s,n)}},y.a.createElement(b.a,{style:{fontSize:20}},t))})),y.a.createElement(C.a,{style:{backgroundColor:f[8]?"#368cbf":"#d6f2f2",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#368cbf",onPress:function(){return e.recordActivitiesForOne(s,8)},onLongPress:function(){return e.setState({editingOtherActivityForOne:s})}},p===s?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(qn.a,{autoFocus:!0,selectTextOnFocus:!0,value:m,style:{alignSelf:"center",fontSize:20,backgroundColor:f[8]?"#368cbf":"#d6f2f2"},onChangeText:function(t){return e.writeActivityForOne(s,t)},onBlur:function(){return e.activityForOneEditorOnBlur(s,m)}})):y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:20}},m))))),y.a.createElement(qn.a,{value:l,style:{borderColor:"gray",borderWidth:2,borderRadius:10,fontSize:25,padding:20},multiline:!0,maxLength:100,onChangeText:function(t){return e.writeToOne(t,s)}})))))}))))}}]),r}(y.a.Component),ks=(ue.a.create({cardContainer:{width:119,height:"100%",backgroundColor:"transparent"},thumbnailImage:{height:80,width:80,borderRadius:40}}),Object(D.b)((function(e){return{class:e.classInfo,message:e.message}}),(function(e){return ws({},Object(k.a)({writeToAll:St,writeToOne:wt,remindItemsToBringToAll:Ct,remindItemsToBringToOne:Dt,recordActivitiesForAll:kt,recordActivitiesForOne:xt,writeItemToBringToAll:Ot,writeItemToBringToOne:At,writeActivityForAll:jt,writeActivityForOne:Rt,fetchClassMessageData:Pt,sendMessageOnSuccess:qt},e))}))(Ds));function xs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Os(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var As=function(e){u()(r,e);var t=Os(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,display_list:[],students_or_teachers:"students",selected_class_id:"all",showLoginNumberPad:!1,showModal:!1,modalStudentId:"",teacherClicked:"",teacher_id:"",pageClicked:""},n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.school,t=e.students,n=e.teacherOnDuty,r=e.teachers,a=Object.keys(t);if(this.setState({display_list:a}),this.fetchTeacherAttendance(),this.fetchStudentAttendance(),""!==n){var s=r[n].name;this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{paddingRight:20}},y.a.createElement(b.a,{style:{fontSize:30}},"\u503c\u73ed\u8001\u5e2b\uff1a"+s))}})}}},{key:"selectPersonType",value:function(e){var t=this.props.school.classes,n=this.state.selected_class_id;"all"!==n?this.setState({display_list:t[n][e],students_or_teachers:e}):this.setState({display_list:Object.keys(this.props.school[e]),students_or_teachers:e})}},{key:"selectClass",value:function(e){var t=this.props.school.classes,n=this.state.students_or_teachers;this.setState({display_list:t[e][n],selected_class_id:e})}},{key:"selectAttendanceType",value:function(e){var t=this.props.school.classes,n=this.state,r=n.students_or_teachers,a=n.selected_class_id,s=[],i=[];i="all"===a?Object.keys(this.props.school[r]):t[a][r];for(var o=0;o<i.length;o++)(this.props.school["student_"+e].has(i[o])||this.props.school["teacher_"+e].has(i[o]))&&s.push(i[o]);this.setState({display_list:s})}},{key:"fetchTeacherAttendance",value:function(){var e,t,n,r,s,i,o,c;return a.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.route.params.school_id,t=cn(new Date),l.next=4,a.a.awrap(hn("/staff-attendance?school_id="+e+"&date="+t));case 4:if(n=l.sent,r=n.success,n.statusCode,s=n.message,i=n.data,r){l.next=9;break}return alert("Sorry \u53d6\u5f97\u6559\u5e2b\u51fa\u5e2d\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),l.abrupt("return");case 9:o=i.attendance,c=i.teachers,this.props.fetchTeacherAttendanceSuccess(o,c);case 11:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"fetchStudentAttendance",value:function(){var e,t,n,r,s,i,o,c,l,u;return a.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e=this.props.route.params.school_id,t=cn(new Date),d.next=4,a.a.awrap(hn("/attendance?school_id="+e+"&date="+t));case 4:if(n=d.sent,r=n.success,n.statusCode,s=n.message,i=n.data,r){d.next=9;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u51fa\u5e2d\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),d.abrupt("return");case 9:o=i.attendance,c=i.students,l=i.present,u=i.absent,this.props.fetchStudentAttendanceSuccess(o,c,l,u);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"handleOnClick",value:function(e){var t=this.props.teacherOnDuty;if("students"===this.state.students_or_teachers){if(""===t)return void this.setState({showLoginNumberPad:!0,pageClicked:"student_modal",modalStudentId:e});this.showModal(e)}else this.setState({showLoginNumberPad:!0,teacherClicked:e})}},{key:"showModal",value:function(e){this.setState({modalStudentId:e,showModal:!0})}},{key:"handleEnterPasscode",value:function(e){var t=this.props.school.passcodeTeacherId,n=this.props,r=n.passcodeAdminId,a=(n.teachers,this.state),s=a.pageClicked,i=a.teacherClicked,o=t[e],c=r[e];void 0!==c?this.setState({teacher_id:c,pageClicked:"",showModal:!0,showLoginNumberPad:!1}):"student_modal"===s&&void 0!==o?this.setState({teacher_id:o,pageClicked:"",showModal:!0,showLoginNumberPad:!1}):void 0===o||o!==i?le.Toast.show({text:"Wrong password!",buttonText:"Okay",position:"top",type:"warning",duration:3e3}):this.setState({showModal:!0,showLoginNumberPad:!1})}},{key:"hideLoginPad",value:function(){this.setState({showLoginNumberPad:!1,modalStudentId:""})}},{key:"hideModal",value:function(){this.setState({showModal:!1,modalStudentId:"",teacher_id:""})}},{key:"render",value:function(){var e=this,t=this.props.route.params.school_id,r=this.props,a=r.school,s=r.teacherOnDuty,i=a.student_present,o=a.student_unmarked,c=(a.student_absent,a.teacher_present),l=a.teacher_unmarked,u=(a.teacher_absent,this.state),d=u.display_list,f=u.students_or_teachers,p=u.selected_class_id,h=u.modalStudentId,m=u.teacherClicked,g=u.teacher_id,_=u.showLoginNumberPad;return y.a.createElement(E.a,{style:{flex:1}},_?y.a.createElement(nn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:function(){return e.hideLoginPad()}}):null,y.a.createElement(cr,{show:this.state.showModal,student_id:h,teacher_id:m,teacherOnDuty:s||g,class_id:p,school_id:t,navigation:this.props.navigation,fetchStudentAttendance:function(){return e.fetchStudentAttendance()},fetchTeacherAttendance:function(){return e.fetchTeacherAttendance()},hideModal:function(){return e.hideModal()}}),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"}},y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"students"===f?"lightgrey":"white",justifyContent:"center"},onPress:function(){return e.selectPersonType("students")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u5b78\u751f"))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"teachers"===f?"lightgrey":"white",justifyContent:"center"},onPress:function(){return e.selectPersonType("teachers")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u6559\u5e2b")))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"}},Object.keys(a.classes).map((function(t){return"all"===t?null:y.a.createElement(E.a,{key:t,style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:p===t?"lightgrey":"white",justifyContent:"center"},onPress:function(){return e.selectClass(t)}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},a.classes[t].name)))}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"}},y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"#ffe1d0",justifyContent:"center"},onPress:function(){return e.selectAttendanceType("absent")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u7f3a\u5e2d"))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"#fff1b5",justifyContent:"center"},onPress:function(){return e.selectAttendanceType("unmarked")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u672a\u77e5"))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"#dcf3d0",justifyContent:"center"},onPress:function(){return e.selectAttendanceType("present")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u51fa\u5e2d")))),y.a.createElement(E.a,{style:{flex:9,backgroundColor:"lightgrey"}},y.a.createElement(kn.a,{contentContainerStyle:{flexDirection:"row",flexWrap:"wrap",backgroundColor:"transparent"}},d.map((function(t){var r=a[f][t];return y.a.createElement(C.a,{key:t,style:{height:300,width:"33.3%",padding:5},onPress:function(){return e.handleOnClick(t)}},y.a.createElement(le.Card,{style:{flex:1,padding:10,backgroundColor:"white"}},y.a.createElement(le.CardItem,{style:{justifyContent:"center"}},y.a.createElement(rn.a,{source:""===r.profile_picture&&"students"===f?n(70):""===r.profile_picture&&"teachers"===f?n(297):{uri:r.profile_picture},style:{height:200,width:200,borderRadius:100,borderWidth:10,borderColor:i.has(t)||c.has(t)?"#dcf3d0":o.has(t)||l.has(t)?"#fff1b5":"#ffe1d0"}})),y.a.createElement(le.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5}},y.a.createElement(b.a,{style:{marginTop:-10}},r.name))))})))))}}]),r}(y.a.Component),js=Object(D.b)((function(e){return{school:e.school,teacherOnDuty:e.school.teacherOnDuty,teachers:e.school.teachers,passcodeAdminId:e.school.passcodeAdminId,attendance:e.attendance}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xs(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({fetchTeacherAttendanceSuccess:Ht,fetchStudentAttendanceSuccess:Wt},e))}))(As);function Rs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ps(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ts=function(e){u()(r,e);var t=Ps(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,refreshing:!1,selected_request_id:"",showLoginNumberPad:!1},n}return c()(r,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.route.params,t=e.messages,r=e.students;return y.a.createElement(E.a,{style:{flex:1,padding:40}},y.a.createElement(kn.a,null,t.map((function(e,t){e.activities,e.items_to_bring;var a=e.message_for_teacher,s=e.morning_reminder,i=(e.other_activity,e.other_item,e.student_id),o=(e.teacher_id,e.text);return y.a.createElement(E.a,{key:t,style:{flexDirection:"row",backgroundColor:"white",borderWidth:1,borderColor:"lightgrey",marginBottom:20,padding:20}},y.a.createElement(E.a,null,y.a.createElement(rn.a,{source:""===r[i].profile_picture?n(70):{uri:r[i].profile_picture},style:Is.thumbnailImage}),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",paddingTop:20}},y.a.createElement(b.a,{style:{fontSize:25}},r[i].name))),y.a.createElement(E.a,{style:{flex:1,backgroundColor:"",marginLeft:20}},y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:25,fontWeight:"bold"}},"\u8001\u5e2b\u7684\u8a71:"),y.a.createElement(b.a,{style:{fontSize:20}},o&&o+"\n")),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:25,fontWeight:"bold"}},"\u5bb6\u9577\u56de\u61c9:"),y.a.createElement(b.a,{style:{fontSize:20}},a&&a+"\n")),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:25,fontWeight:"bold"}},"\u65e9\u6668\u53ee\u5680:"),y.a.createElement(b.a,{style:{fontSize:20}},s&&s+"\n"))))}))))}}]),r}(y.a.Component),Is=ue.a.create({cardContainer:{width:170,paddingRight:5},thumbnailImage:{height:160,width:160,borderRadius:80}}),zs=Object(D.b)((function(e){return{class:e.classInfo,requests:e.medicationrequests}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rs(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({},e))}))(Ts);function Ls(e){var t=0;if("undefined"===typeof Symbol||null==e["function"===typeof Symbol?Symbol.iterator:"@@iterator"]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return Fs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fs(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e["function"===typeof Symbol?Symbol.iterator:"@@iterator"]()).next.bind(t)}function Fs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ms(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Bs=function(e){u()(n,e);var t=Ms(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={showModal:!1,modal_type:""},r}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"handleNavigate",value:function(e){var t=this.props.route.params,n=t.school_name,r=t.school_id;this.props.navigation.navigate(e,{school_name:n,school_id:r})}},{key:"forceSWupdate",value:function(){console.log("forceSWupdate 14:33: "),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(var t,n=Ls(e);!(t=n()).done;){var r=t.value;console.log("registration: ",r),r.update()}}))}},{key:"render",value:function(){var e=this;return y.a.createElement(kn.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center"}},y.a.createElement(C.a,{style:{width:"80%",padding:50,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",marginVertical:20},onPress:function(){return e.handleNavigate("DownloadTeacherAttendance")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u5b78\u751f\u51fa\u52e4")))}}]),n}(y.a.Component);function qs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ns=function(e){u()(n,e);var t=qs(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={showModal:!1,modal_type:""},r}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.school_name,n=e.school_id;console.log("school_name, school_id: ",t,n)}},{key:"render",value:function(){return y.a.createElement(kn.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center"}})}}]),n}(y.a.Component);function Us(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Hs=Object(k.c)(ce),Ws=Object(vr.a)(),Vs=function(e){u()(n,e);var t=Us(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e=this;return y.a.createElement(D.a,{store:Hs},y.a.createElement(br.a,null,y.a.createElement(Ws.Navigator,{initialRouteName:"SchoolHome",screenOptions:{gestureEnabled:!1,headerTitleStyle:{fontWeight:"bold",fontSize:30}}},y.a.createElement(Ws.Screen,{name:"SchoolHome",component:Dr,initialParams:{school_id:this.props.school_id,school_name:this.props.school_name,loadAuth:this.props.loadAuth},options:{title:"",headerRight:function(){return y.a.createElement(C.a,{style:{padding:10,marginRight:20},onPress:function(){return e.props.handleSignOut()}},y.a.createElement(b.a,{style:{fontSize:30}},"\u767b\u51fa"))}}}),y.a.createElement(Ws.Screen,{name:"AdminHome",component:Oa,options:{gestureEnabled:!0,title:""}}),y.a.createElement(Ws.Screen,{name:"Registration",component:Ba,options:{headerLeft:null,title:""}}),y.a.createElement(Ws.Screen,{name:"Students",component:ps,options:{gestureEnabled:!0,title:""}}),y.a.createElement(Ws.Screen,{name:"Teachers",component:vs,options:{gestureEnabled:!0,title:""}}),y.a.createElement(Ws.Screen,{name:"DownloadPage",component:Bs,options:{gestureEnabled:!0,title:"\u4e0b\u8f09"}}),y.a.createElement(Ws.Screen,{name:"DownloadTeacherAttendance",component:Ns,options:{gestureEnabled:!0,title:"\u5b78\u751f\u51fa\u52e4\u4e0b\u8f09"}}),y.a.createElement(Ws.Screen,{name:"AttendancePage",component:js,options:{title:"\u51fa\u5e2d/\u6253\u5361",headerRight:function(){return y.a.createElement(E.a,{style:{paddingRight:20}},y.a.createElement(b.a,{style:{fontSize:30}},"\u503c\u73ed\u8001\u5e2b\uff1a\u672a\u767b\u5165"))}}}),y.a.createElement(Ws.Screen,{name:"TeacherHome",component:Er,options:{headerLeft:null,title:""}}),y.a.createElement(Ws.Screen,{name:"Inbox",component:zs,options:{gestureEnabled:!0,title:""}}),y.a.createElement(Ws.Screen,{name:"PickupAlert",component:Mn}),y.a.createElement(Ws.Screen,{name:"TeacherClockInOut",component:jr,options:{gestureEnabled:!0,title:"\u6253\u5361"}}),y.a.createElement(Ws.Screen,{name:"TeacherMedicineLog",component:Wr,options:{gestureEnabled:!0,title:"\u6258\u85e5\u55ae"}}),y.a.createElement(Ws.Screen,{name:"WellnessLog",component:Jr,options:{gestureEnabled:!0,title:"\u5065\u5eb7",headerLeft:null}}),y.a.createElement(Ws.Screen,{name:"MessageForParents",component:ks,options:{gestureEnabled:!0,title:"\u8001\u5e2b\uf9cd\u2f94",headerLeft:null}}),y.a.createElement(Ws.Screen,{name:"TeacherAppetiteLog",component:na,options:{gestureEnabled:!0,title:"\u98f2\u98df",headerLeft:null}}),y.a.createElement(Ws.Screen,{name:"TeacherSleepLog",component:ca,options:{gestureEnabled:!0,title:"\u7761\u7720",headerLeft:null}}),y.a.createElement(Ws.Screen,{name:"TeacherMilkLog",component:ha,options:{gestureEnabled:!0,title:"\u9935\u5976",headerLeft:null}}),y.a.createElement(Ws.Screen,{name:"DiaperLog",component:ka,options:{gestureEnabled:!0,title:"\u5982\u5ec1",headerLeft:null}}))))}}]),n}(y.a.Component);function Ks(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Gs=function(e){u()(r,e);var t=Ks(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={username:"",password:"",errMessage:"",user_type:"",isLoading:!1},n}return c()(r,[{key:"componentDidMount",value:function(){}},{key:"handleSignIn",value:function(){var e=this;this.setState({isLoading:!0});var t=this.state,n=t.username,r=t.password;w.a.signIn(n,r).then((function(t){"NEW_PASSWORD_REQUIRED"!==t.challengeName?(e.setState({isLoading:!1}),e.props.loadAuth()):e.completeNewPassword(t)})).catch((function(t){"UserNotConfirmedException"===t.code?e.props.changeAuthState("ConfirmSignUpPage",n):(e.props.changeAuthState("signedout",n),e.setState({errMessage:t.message,isLoading:!1}))}))}},{key:"completeNewPassword",value:function(e){var t=this;w.a.completeNewPassword(e,"barRoco",{name:"barroco"}).then((function(e){t.setState({isLoading:!1}),t.props.loadAuth()})).catch((function(e){t.setState({errMessage:e.message,isLoading:!1})}))}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return y.a.createElement(Tn,null);var t="ios"===Nn.a.OS?60:0,r=this.state.errMessage?y.a.createElement(le.Text,{style:{color:"red"}},this.state.errMessage):null;return y.a.createElement(Bn.a,{style:Qs.container,behavior:"padding",keyboardVerticalOffset:t,enabled:!0},y.a.createElement(rn.a,{source:n(452),style:{width:200,height:200}}),y.a.createElement(le.Text,{style:{fontSize:40}},"\u8acb\u767b\u5165"),r,y.a.createElement(qn.a,{placeholder:"Email / \u5e33\u865f",keyboardType:"email-address",autoCapitalize:"none",style:Qs.textInput,onChangeText:function(t){return e.setState({username:t})},value:this.state.username}),y.a.createElement(qn.a,{secureTextEntry:!0,placeholder:"\u5bc6\u78bc",style:Qs.textInput,onChangeText:function(t){return e.setState({password:t})},value:this.state.password}),y.a.createElement(le.View,{style:{marginTop:20}},y.a.createElement(C.a,{style:{backgroundColor:"grey",padding:20},onPress:function(){return e.handleSignIn()}},y.a.createElement(le.Text,{style:{fontSize:30}},"\u767b\u5165"))))}}]),r}(y.a.Component),Qs=ue.a.create({container:{flex:1,justifyContent:"center",alignItems:"center"},textInput:{height:80,width:"90%",borderColor:"gray",borderWidth:1,marginTop:20,fontSize:30,padding:10}}),Js=Gs,Ys=n(255);function Zs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}!function(e){u()(n,e);var t=Zs(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={username:"",name:"",user_type:"",email:"",password:"",errMessage:""},r}c()(n,[{key:"handleSignup",value:function(){var e=this,t=this.state,n=t.username,r=t.password,a=t.name,s=t.email,i=t.user_type;this.state.user_type?w.a.signUp({username:n,password:r,attributes:{name:a,email:s}}).then((function(t){console.log(e.state.user_type),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/user/"+n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:a,email:s,role:i})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.props.changeAuthState("ConfirmSignUpPage")})).catch((function(e){console.error(e)}))})).catch((function(t){e.setState({errMessage:t.message})})):this.setState({errMessage:"Please select user role"})}},{key:"setUserRole",value:function(e){this.setState({user_type:e})}},{key:"render",value:function(){var e=this;return y.a.createElement(Bn.a,{style:Xs.container,behavior:"padding",enabled:!0},y.a.createElement(E.a,{style:{width:"45%",marginBottom:20,flexDirection:"row",justifyContent:"space-around"}},y.a.createElement(C.a,{style:{width:80,height:85},onPress:function(){e.setUserRole("teacher")}},y.a.createElement(Ys.default,{name:"food-apple",size:80,color:"#C93D1B"})),y.a.createElement(C.a,{style:{width:80,height:85},onPress:function(){e.setUserRole("parent")}},y.a.createElement(Ys.default,{name:"baby-buggy",size:80,color:"#f8c43a"}))),y.a.createElement(b.a,null,this.state.user_type," Sign Up"),""===this.state.errMessage?null:y.a.createElement(b.a,{style:{color:"red"}},this.state.errMessage),y.a.createElement(qn.a,{placeholder:"username",style:Xs.textInput,onChangeText:function(t){return e.setState({username:t})},value:this.state.username}),y.a.createElement(qn.a,{secureTextEntry:!0,placeholder:"password",style:Xs.textInput,onChangeText:function(t){return e.setState({password:t})},value:this.state.password}),y.a.createElement(qn.a,{placeholder:"Name",style:Xs.textInput,onChangeText:function(t){return e.setState({name:t})},value:this.state.name}),y.a.createElement(qn.a,{placeholder:"Email",style:Xs.textInput,onChangeText:function(t){return e.setState({email:t})},value:this.state.email}),y.a.createElement(E.a,{style:{width:"90%",margin:10,flexDirection:"row",justifyContent:"space-around"}},y.a.createElement(C.a,{style:{backgroundColor:"#35D0BA"},onPress:this.handleSignup.bind(this)},y.a.createElement(b.a,null,"Sign up")),y.a.createElement(C.a,{style:{backgroundColor:"#35D0BA"},onPress:function(){return e.props.changeAuthState("signedout")}},y.a.createElement(b.a,null," Already have an account? Sign in here"))))}}])}(y.a.Component);var Xs=ue.a.create({container:{flex:1,justifyContent:"center",alignItems:"center"},textInput:{height:40,width:"90%",borderColor:"gray",borderWidth:1,marginTop:8}});function $s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ei(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$s(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ti(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ti(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ri(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ai(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ri(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ri(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var si=Object(k.b)({parent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isConnected:!0,child_of_id:{},med_requests:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONNECT_STATE":var n=t.isConnected;return ei(ei({},e),{},{isConnected:n});case"INITIALIZE_CHILDREN":var r=t.data;return r.forEach((function(t){var n=t.id,r=t.name,a=t.class_id,s=t.profile_picture,i=t.school_id;e.child_of_id[n]={name:r,class_id:a,profile_picture:s,school_id:i}})),ei({},e);case"MARK_PRESENT":var a=t.student_id;return e.child_of_id[a].present=!0,ei({},e);case"GET_MED_REQUEST_SUCCESS":var s=t.med_requests;return ei(ei({},e),{},{med_requests:s});case"CLEAR_STATE":return{isConnected:!0,child_of_id:{},med_requests:[]};default:return e}},attendance:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{days:{1:[],2:[],3:[],4:[],5:[]},attendance:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_ATTENDANCE":return ni(ni({},e),{},{days:ni(ni({},e.days),{},O()({},t.day,[].concat(T()(e.days[t.day]),[t.attendance_id]))),attendance:ni(ni({},e.attendance),{},O()({},t.attendance_id,t.attendance_obj))});default:return e}},inbox:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{current_conversation_id:"",conversations_by_id:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE_DATA":var n=ai({},e),r=t.messages,a=t.most_recently_read_message_id,s=t.conversation_id;return n.conversations_by_id[s]={messages:r,most_recently_read_message_id:a},n.current_conversation_id=s,n;case"SET_CURRENT_CONVERSATION_ID":return ai(ai({},e),{},{current_conversation_id:t.conversation_id});case"CLEAR_CURRENT_CONVERSATION_ID":return ai(ai({},e),{},{current_conversation_id:""});default:return e}}}),ii=n(181),oi=function(e){return{type:"INITIALIZE_CHILDREN",data:e}},ci=function(){return{type:"CLEAR_STATE"}},li=function(e){return{type:"GET_MED_REQUEST_SUCCESS",med_requests:e}},ui=function(e){return{type:"MARK_PRESENT",student_id:e}},di=function(e){return{type:"SET_CONNECT_STATE",isConnected:e}};function fi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var pi=function(e){u()(r,e);var t=fi(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={child_id:n.props.child_id,isLoading:!0},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData(this.state.child_id,new Date)}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,this.props.date)):this.props.child_id!==e.child_id&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date))}},{key:"fetchData",value:function(e,t){var n,r,s,i;return a.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return n=new Date(t.getTime()),r=cn(n),n.setDate(n.getDate()+1),s=cn(n),o.next=6,a.a.awrap(_n("wellness",e,r,s));case 6:i=o.sent,this.setState({wellnessData:i,isLoading:!1}),i&&i[r]?this.props.updateTitleTemp(i[r][0][1]):this.props.updateTitleTemp("");case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.wellnessData,r=e.isLoading,a=cn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(rn.a,{source:n(915),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u5065\u5eb7")),r?y.a.createElement(Tn,null):t&&t[a]?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",paddingBottom:5}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u6642\u9593")),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u9ad4\u6eab")),y.a.createElement(E.a,{style:{flex:2,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u4eca\u65e5\u72c0\u6cc1"))),t[a].map((function(e,t){return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},e[0])),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},e[1],"\xb0")),y.a.createElement(E.a,{style:{flex:2,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},e[2])))}))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),r}(y.a.Component);function hi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var mi=function(e){u()(r,e);var t=hi(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={child_id:n.props.child_id,fruit_name:null,isLoading:!0,breakfast:null,fruit:null,lunch:null,snack:null},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData(this.state.child_id,new Date)}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1}),i.abrupt("return");case 3:return n=cn(t),t.setDate(t.getDate()+1),r=cn(t),i.next=8,a.a.awrap(_n("appetite",e,n,r));case 8:s=i.sent,this.denormalizeAppetiteData(s.data,t);case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"denormalizeAppetiteData",value:function(e){var t=this.props.date,n=cn(t);if(e&&e[n]){var r=e[n],a=r.fruit_name,s=r.breakfast_rating,i=r.fruit_rating,o=r.lunch_rating,c=r.snack_rating;console.log("fruit_name: ",a);var l=this.parseData(s),u=this.parseData(i),d=this.parseData(o),f=this.parseData(c);this.setState({fruit_name:a,breakfast:l,fruit:u,lunch:d,snack:f,appetiteData:e,isLoading:!1})}else this.setState({appetiteData:e,isLoading:!1})}},{key:"parseData",value:function(e){return{rating:e.slice(0,-1),water_drunk:parseInt(e.slice(-1))}}},{key:"getEmoji",value:function(){}},{key:"getWaterDrinkingStatus",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.appetiteData,r=e.isLoading,a=e.breakfast,s=e.fruit,i=e.lunch,o=e.snack,c=(e.rating,e.fruit_name),l=cn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(rn.a,{source:n(916),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u98f2\u98df")),r?y.a.createElement(Tn,null):t&&t[l]?y.a.createElement(E.a,null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:8}},a?y.a.createElement(E.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"}},"\u65e9\u9910")),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",padding:8}},y.a.createElement(b.a,{style:{fontSize:20}},a.rating||" ")),y.a.createElement(E.a,{style:{padding:5,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},a.water_drunk?"\u6709\u559d\u6c34":" "))):null,s?y.a.createElement(E.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"}},"\u6c34\u679c"!==c&&"\u6c34\u679c\u9910: "+c||"\u6c34\u679c")),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",padding:8}},y.a.createElement(b.a,{style:{fontSize:20}},s.rating)),y.a.createElement(E.a,{style:{padding:5,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},s.water_drunk?"\u6709\u559d\u6c34":" "))):null),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:8}},i?y.a.createElement(E.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"}},"\u5348\u9910")),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",padding:8}},y.a.createElement(b.a,{style:{fontSize:20}},i.rating||" ")),y.a.createElement(E.a,{style:{padding:5,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},i.water_drunk?"\u6709\u559d\u6c34":" "))):null,o?y.a.createElement(E.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"}},"\u9ede\u5fc3")),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",padding:8}},y.a.createElement(b.a,{style:{fontSize:20}},o.rating)),y.a.createElement(E.a,{style:{padding:5,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},o.water_drunk?"\u6709\u559d\u6c34":" "))):null)):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),r}(y.a.Component);function yi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var gi=function(e){u()(r,e);var t=yi(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData(this.props.child_id,new Date)}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1}),i.abrupt("return");case 3:return n=cn(t),t.setDate(t.getDate()+1),r=cn(t),i.next=8,a.a.awrap(_n("milkintake",e,n,r));case 8:s=i.sent,this.setState({milkIntakeData:s,isLoading:!1});case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.milkIntakeData,r=e.isLoading,a=cn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(rn.a,{source:n(917),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u559d\u5976")),r?y.a.createElement(Tn,null):t&&t[a]?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:5}},y.a.createElement(E.a,{style:{width:"25%",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u6642\u9593")),y.a.createElement(E.a,{style:{width:"28%",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u91cf")),y.a.createElement(E.a,{style:{width:"28%",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u4e73\u54c1")),y.a.createElement(E.a,{style:{width:"19%",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u8001\u5e2b"))),t[a].map((function(e,t){var n=e.time,r=e.amount,a=e.milk_type,s=e.teacher_name;return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{width:"25%"}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center",color:"#404040"}},n)),y.a.createElement(E.a,{style:{width:"28%"}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center",color:"#404040"}},r," c.c.")),y.a.createElement(E.a,{style:{width:"28%"}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center",color:"#404040"}},a)),y.a.createElement(E.a,{style:{width:"19%"}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center",color:"#404040"}},null!==s&&s.slice(1))))}))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),r}(y.a.Component);function _i(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ei=function(e){u()(r,e);var t=_i(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData(this.props.child_id,new Date)}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1}),i.abrupt("return");case 3:return n=cn(t),t.setDate(t.getDate()+1),r=cn(t),i.next=8,a.a.awrap(_n("sleep",e,n,r));case 8:s=i.sent,this.setState({sleepData:s,isLoading:!1});case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.sleepData,r=e.isLoading,a=cn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(rn.a,{source:n(918),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u7761\u7720")),r?y.a.createElement(Tn,null):t&&t[a]?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:5}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u5f9e")),y.a.createElement(E.a,{style:{flex:1}}),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u5230"))),t[a].map((function(e,t){var n=e.sleep_time,r=e.wake_time,a=e.hours,s=e.minutes;return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},n)),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#404040"}},a,"H ",s,"M")),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},r)))}))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),r}(y.a.Component);function bi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var vi=function(e){u()(r,e);var t=bi(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData(this.props.child_id,new Date)}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1}),i.abrupt("return");case 3:return n=cn(t),t.setDate(t.getDate()+1),r=cn(t),i.next=8,a.a.awrap(_n("diaper",e,n,r));case 8:s=i.sent,this.setState({isLoading:!1,diaperData:s});case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,r=e.diaperData,a=cn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(rn.a,{source:n(919),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u5982\u5ec1")),t?y.a.createElement(Tn,null):r&&r[a]?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:5}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u6642\u9593")),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u6392\u6cc4")),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u4f7f\u7528")),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u72c0\u6cc1"))),r[a].map((function(e,t){var n=e.time,r=e.cloth_diaper,a=e.pee_or_poo,s=e.condition;e.teacher_id;return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:23,textAlign:"center",color:"#404040"}},n)),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:23,textAlign:"center",color:"#404040"}},a)),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:23,textAlign:"center",color:"#404040"}},r?"\u5b78\u7fd2\u8932":"\u5c3f\u5e03")),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:23,textAlign:"center",color:"#404040"}},s)))}))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),r}(y.a.Component);function Si(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var wi=function(e){u()(r,e);var t=Si(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={child_id:n.props.child_id,isLoading:!0,data_available:!1,items_to_bring:[],activities:[],text:"",teacher_id:"",message_id:null,message_for_teacher:"",isConnected:!0,scrollHeight:"100%"},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData(this.state.child_id,new Date)}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0,message_for_teacher:"",scrollHeight:"100%"}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id?(this.setState({isLoading:!0,message_for_teacher:"",scrollHeight:"100%"}),this.fetchData(this.props.child_id,new Date)):this.props.isConnected!=e.isConnected&&this.setState({isConnected:this.props.isConnected})}},{key:"setScrollHeight",value:function(e){this.setState({scrollHeight:e})}},{key:"fetchData",value:function(e,t){var n,r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1,message_for_teacher:"",data_available:!1}),i.abrupt("return");case 3:return n=cn(t),t.setDate(t.getDate()+1),r=cn(t),i.next=8,a.a.awrap(_n("message",e,n,r));case 8:if(void 0!==(s=i.sent).data&&void 0!==s.data[n]){i.next=12;break}return this.setState({isLoading:!1,message_for_teacher:"",data_available:!1}),i.abrupt("return");case 12:this.denormalize(s.data[n]);case 13:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){for(var t=["\u6bcd\u5976\u7c89","\u5c3f\u5e03","\u6c34\u58fa","\u8863\u7269"],n=["\u5b30\u5152\u6309\u6469","\u97f3\u6a02\u5f8b\u52d5","\u6559\u5177\u64cd\u4f5c","\u7e6a\u672c\u6b23\u8cde","\u8a8d\u77e5\u5716\u7247","\u9ad4\u80fd\u6d3b\u52d5","\u85dd\u8853\u5275\u4f5c","\u591a\u5143\u8a9e\u8a00"],r=[],a=[],s=0;s<e.items_to_bring.length-1;s++)e.items_to_bring[s]&&r.push(t[s]);e.items_to_bring[e.items_to_bring.length-1]&&r.push(e.other_item);for(s=0;s<e.activities.length-1;s++)e.activities[s]&&a.push(n[s]);e.activities[e.activities.length-1]&&a.push(e.other_activity),this.setState({isLoading:!1,data_available:!0,message_id:e.message_id,items_to_bring:r,activities:a,text:e.text,teacher_id:e.teacher_id,message_for_teacher:e.message_for_teacher})}},{key:"sendMessage",value:function(){var e,t,n,r,s,i,o,c,l;return a.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:if(e=this.props.class_id,t=this.state,n=t.message_for_teacher,r=t.message_id,t.isConnected){u.next=5;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),u.abrupt("return");case 5:return s=new Date,i={student_id:this.props.child_id,message_id:r,message_for_teacher:n,timestamp:cn(s)+" "+dn(s)},u.next=9,a.a.awrap(mn("/message/class/"+e,i));case 9:if(o=u.sent,c=o.success,o.statusCode,l=o.message,o.data,c){u.next=14;break}return alert("Sorry \u50b3\u9001\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l),u.abrupt("return");case 14:alert("\u8a0a\u606f\u50b3\u9054\u6210\u529f\uff01");case 15:case"end":return u.stop()}}),null,this,null,Promise)}},{key:"editable",value:function(){var e=this.props.date,t=new Date;return t.setHours(17,0,0),e.getTime()>=t.getTime()}},{key:"showMessageForTeacher",value:function(){var e=this.props.date,t=new Date;return t.setHours(0,0,0,1),!(e.toDateString()!==t.toDateString()||!this.editable())||e<t}},{key:"render",value:function(){var e=this,t=this.state,r=t.items_to_bring,a=t.activities,s=t.text,i=(t.teacher_id,t.isLoading),o=t.data_available,c=t.message_for_teacher,l=t.scrollHeight;this.props.date;return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,alignItems:"center",justifyContent:"center"}},y.a.createElement(rn.a,{source:n(920),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u8a0a\u606f")),i?y.a.createElement(Tn,null):o?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8,paddingRight:8}},y.a.createElement(E.a,{style:{padding:5,marginBottom:6,backgroundColor:"#F5F5F5"}},y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15}},"\u611b\u7684\u5c0f\u8a9e"),y.a.createElement(b.a,{style:{fontSize:25,paddingVertical:7}},s)),y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,padding:5,backgroundColor:"#F5F5F5",marginRight:3}},y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15}},"\u5bb6\u9577\u6e96\u5099"),r.length?y.a.createElement(E.a,{style:{alignItems:"center",paddingVertical:7}},r.map((function(e,t){return y.a.createElement(b.a,{key:t,style:{padding:5,backgroundColor:"lightgrey",marginBottom:3,fontSize:25}},e)}))):null),y.a.createElement(E.a,{style:{flex:1,padding:5,backgroundColor:"#F5F5F5",marginLeft:3}},y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15}},"\u4eca\u65e5\u6d3b\u52d5"),a.length?y.a.createElement(E.a,{style:{alignItems:"center",paddingVertical:7}},a.map((function(e,t){return y.a.createElement(b.a,{key:t,style:{padding:5,backgroundColor:"lightgrey",marginBottom:3,fontSize:25}},e)}))):null)),y.a.createElement(E.a,{style:{backgroundColor:"#ffddb7",marginTop:5}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:15}},"\u7d66\u8001\u5e2b\u7684\u8a71")),y.a.createElement(qn.a,{editable:this.editable(),style:{height:l,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.7)",paddingTop:10,padding:10,fontSize:25},placeholder:this.editable()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":i?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",scrollEnabled:!1,multiline:!0,maxLength:200,value:c,onChangeText:function(t){return e.setState({message_for_teacher:t})},onChange:function(t){return e.setScrollHeight(t.target.scrollHeight)},onLayout:function(t){var n=t.nativeEvent.target.scrollHeight;e.setState({scrollHeight:n})}}),y.a.createElement(C.a,{disabled:!this.editable(),style:{padding:10,justifyContent:"center"},onPress:function(){return e.sendMessage()}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u9001\u51fa")))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8,paddingRight:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304"),this.showMessageForTeacher()&&y.a.createElement(E.a,{style:{backgroundColor:"#ffddb7",marginTop:5}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:15}},"\u7d66\u8001\u5e2b\u7684\u8a71")),y.a.createElement(qn.a,{editable:this.editable(),style:{height:l,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.7)",paddingTop:10,padding:10,fontSize:25},placeholder:this.editable()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":i?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",scrollEnabled:!1,multiline:!0,maxLength:200,value:c,onChangeText:function(t){return e.setState({message_for_teacher:t})},onChange:function(t){return e.setScrollHeight(t.target.scrollHeight)}}),y.a.createElement(C.a,{disabled:!this.editable(),style:{padding:10,justifyContent:"center"},onPress:function(){return e.sendMessage()}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u9001\u51fa")))))))}}]),r}(y.a.Component);function Ci(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Di=function(e){u()(r,e);var t=Ci(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={temperature:"",borderRadius:0},n}return c()(r,[{key:"componentDidUpdate",value:function(e){this.props.temperature!==e.temperature&&this.setState({temperature:this.props.temperature})}},{key:"render",value:function(){var e=this,t=this.state,r=t.temperature,a=(t.borderRadius,this.props),s=a.student,i=a.student_name;return y.a.createElement(E.a,{style:{width:"97%",marginLeft:"3%",alignSelf:"flex-start",flexDirection:"row"}},y.a.createElement(le.Card,{style:{flexDirection:"row",width:"85%",alignItems:"center",paddingVertical:15}},y.a.createElement(E.a,{style:{flex:1,width:"50%",alignItems:"center"},onLayout:function(t){var n=t.nativeEvent.layout.width;e.setState({borderRadius:n/2})}},y.a.createElement(rn.a,{source:""===s.profile_picture?n(70):{uri:s.profile_picture},style:""===s.profile_picture?{width:130,height:130}:{width:130,height:130,borderRadius:65}})),y.a.createElement(E.a,{style:{height:"90%",width:"50%",paddingLeft:10}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{height:"50%",alignItems:"flex-start",justifyContent:"flex-end"}},y.a.createElement(b.a,{style:{fontSize:40}},i)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingTop:5}},y.a.createElement(E.a,{style:{flex:1,height:"100%",backgroundColor:"#F5F5F5",justifyContent:"center"}},y.a.createElement(b.a,{style:{padding:5}},"\u65e9\u4e0a\u9ad4\u6eab"),y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},""===r?"\u672a\u91cf":r+"\xb0")),y.a.createElement(C.a,{style:{backgroundColor:"#F5F5F5",alignItems:"center",justifyContent:"center"},onPress:function(){return e.props.viewQRCode()}},y.a.createElement(rn.a,{source:n(436),style:{width:65,height:65}})))))),y.a.createElement(le.Card,{style:{width:"20%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",paddingLeft:5},underlayColor:"#F5F5F5",onPress:function(){return e.props.selectOtherChildProfile()}},y.a.createElement(rn.a,{source:n(921),style:{width:43,height:43,opacity:.6}}))))}}]),r}(y.a.Component),ki=n(20);function xi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Oi=function(e){u()(r,e);var t=xi(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={showSelector:!1,SlideInRight:new ki.a.Value(0)},n}return c()(r,[{key:"slideIn",value:function(){var e=this;this.setState({showSelector:!0},(function(){ki.a.timing(e.state.SlideInRight,{toValue:1,duration:200,useNativeDriver:!0}).start()}))}},{key:"onSelectStudent",value:function(e){this.props.onSelectStudent(e),ki.a.timing(this.state.SlideInRight,{toValue:0,duration:500,useNativeDriver:!0}).start(),this.setState({showSelector:!1})}},{key:"render",value:function(){var e=this,t=Pr.a.get("window").width,r=this.state,a=r.showSelector,s=r.SlideInRight,i=this.props.student_of_id;return a?y.a.createElement(ki.a.View,{style:{zIndex:2,width:"100%",height:"100%",position:"absolute",backgroundColor:"rgba(0,0,0,0.7)",transform:[{translateX:s.interpolate({inputRange:[0,1],outputRange:[t,0]})}],alignItems:"center"}},Object.keys(i).map((function(r){return y.a.createElement(C.a,{key:r,style:{marginTop:t/4},onPress:function(){return e.onSelectStudent(r)},underlayColor:"transparent"},y.a.createElement(rn.a,{source:""===i[r].profile_picture?n(70):{uri:i[r].profile_picture},style:{width:160,height:160,borderRadius:80,backgroundColor:"rgba(255,255,255,0.6)"}}))}))):null}}]),r}(y.a.Component);function Ai(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var ji=Pr.a.get("window"),Ri=(ji.width,ji.height),Pi=function(e){u()(n,e);var t=Ai(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={isLoading:!0,data:""},r}return c()(n,[{key:"componentDidMount",value:function(){var e,t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props,t=e.parent_id,n=e.isConnected,c.next=3,a.a.awrap(hn("/user/"+t+"/qrcode"));case 3:if(r=c.sent,s=r.success,r.statusCode,i=r.message,o=r.data,n){c.next=8;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),c.abrupt("return");case 8:if(s){c.next=11;break}return alert("Sorry \u53d6\u5f97\u5bb6\u9577QR Code\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+i),c.abrupt("return");case 11:this.setState({isLoading:!1,data:o});case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this;return y.a.createElement(E.a,{style:{height:Ri,zIndex:2,width:"100%",position:"absolute",backgroundColor:"white",justifyContent:"space-evenly",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:3,justifyContent:"center",alignItems:"center"}},this.state.isLoading?y.a.createElement(Tn,null):y.a.createElement(ss.a,{value:this.state.data,size:300})),y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(C.a,{style:{padding:15,backgroundColor:"#b5e9e9"},onPress:function(){return e.props.hideQRCode()}},y.a.createElement(b.a,{style:{fontSize:30}},"\u8fd4\u56de")))))}}]),n}(y.a.Component),Ti=Object(D.b)((function(e){return{isConnected:e.parent.isConnected}}))(Pi);function Ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Li=function(e){u()(r,e);var t=zi(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,med_requests:[]},n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData(this.props.child_id,new Date)}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date))}},{key:"afterFive",value:function(){return this.props.date.getHours()>=17}},{key:"fetchData",value:function(e,t){var n,r=this;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/medicationrequest/student/"+e+"?date="+cn(t),s.next=3,a.a.awrap(fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=e.data,n=r.get_todays_requests(t);r.setState({med_requests:n}),r.setState({isLoading:!1})})).catch((function(e){alert("Sorry \u53d6\u5f97\u4eca\u65e5\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when fetching medication request")})));case 3:case"end":return s.stop()}}),null,null,null,Promise)}},{key:"get_todays_requests",value:function(e){for(var t=this.props.date,n=[],r=0;r<e.length;r++){if(new Date(e[r].title).toDateString()===t.toDateString()){n=e[r].data;for(var a=0;a<n.length;a++)n[a].timestamp=new Date(n[a].timestamp);break}}return n}},{key:"render",value:function(){var e=this,t=this.state.med_requests,r=this.state.isLoading;return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(rn.a,{source:n(922),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u4eca\u65e5\u85e5\u55ae")),r?y.a.createElement(Tn,null):t.length?y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:8}},y.a.createElement(kn.a,{horizontal:!0,contentContainerStyle:{paddingBottom:10}},t.map((function(r,a){return y.a.createElement(C.a,{key:r.id,style:{padding:10,backgroundColor:"#F5F5F5",marginRight:15,justifyContent:"center"},underlayColor:"#ff8944",onPress:function(){return e.props.viewMedRequest(a,t)}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},e.afterFive()&&r.administered?y.a.createElement(rn.a,{source:n(923),style:{width:20,height:20}}):null,y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:25,color:"rgba(0,0,0,0.8)"}},fn(r.timestamp))))})))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),r}(y.a.Component),Fi=Object(D.b)((function(e){return{med_requests:e.parent.med_requests}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ii(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({getMedRequestSuccess:li},e))}),null,{forwardRef:!0})(Li);function Mi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Bi=function(e){u()(r,e);var t=Mi(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,morning_reminder_id:null,text:"",isConnected:!0,scrollHeight:"100%"},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){this.fetchData(this.props.child_id,new Date)}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0,text:"",scrollHeight:"100%"}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id?(this.setState({isLoading:!0,text:"",scrollHeight:"100%"}),this.fetchData(this.props.child_id,new Date)):this.props.isConnected!=e.isConnected&&this.setState({isConnected:this.props.isConnected})}},{key:"setScrollHeight",value:function(e){this.setState({scrollHeight:e})}},{key:"fetchData",value:function(e,t){var n,r,s;return a.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=cn(t),t.setDate(t.getDate()+1),r=cn(t),i.next=5,a.a.awrap(_n("morningreminder",e,n,r));case 5:if(void 0!==(s=i.sent).data&&void 0!==s.data[n]){i.next=9;break}return this.setState({isLoading:!1,morning_reminder_id:null,text:""}),i.abrupt("return");case 9:this.setState({isLoading:!1,morning_reminder_id:s.data[n].morning_reminder_id,text:s.data[n].text});case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"sendMessage",value:function(){var e,t,n,r,s,i,o,c,l,u;return a.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:if(e=this.props,t=e.class_id,n=e.date,r=this.state,s=r.text,i=r.morning_reminder_id,r.isConnected){d.next=5;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),d.abrupt("return");case 5:return o={morning_reminder_id:i,student_id:this.props.child_id,timestamp:cn(n)+" "+dn(n),text:s},d.next=8,a.a.awrap(mn("/morningreminder/class/"+t,o));case 8:if(c=d.sent,l=c.success,c.statusCode,u=c.message,c.data,l){d.next=13;break}return alert("Sorry \u50b3\u9001\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+u),d.abrupt("return");case 13:alert("\u8a0a\u606f\u50b3\u9054\u6210\u529f\uff01"),this.fetchData(this.props.child_id,new Date);case 15:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"editable",value:function(){var e=this.props.date,t=new Date;return t.setHours(10,0,0),e.toDateString()===(new Date).toDateString()&&new Date<t||e>new Date}},{key:"render",value:function(){var e=this,t=this.state,r=t.isLoading,a=t.text,s=t.scrollHeight,i=t.morning_reminder_id;return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(rn.a,{source:n(924),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u611b\u7684\u53ee\u5680")),y.a.createElement(E.a,{style:{flex:1,paddingVertical:8,paddingRight:8}},y.a.createElement(qn.a,{key:i,editable:this.editable(),style:{width:"100%",height:s,backgroundColor:"#dcf3d0",fontSize:25,paddingTop:10,padding:10},placeholder:this.editable()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":r?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",value:a,multiline:!0,scrollEnabled:!1,maxLength:200,onChangeText:function(t){return e.setState({text:t})},onChange:function(t){return e.setScrollHeight(t.target.scrollHeight)},onLayout:function(t){var n=t.nativeEvent.target.scrollHeight;e.setState({scrollHeight:n})}}),y.a.createElement(C.a,{disabled:!this.editable(),style:{backgroundColor:"#00c07f",padding:10,justifyContent:"center",alignItems:"center"},underlayColor:"transparent",onPress:function(){return e.sendMessage()}},y.a.createElement(b.a,{style:{fontSize:25}},"\u9001\u51fa"))))))}}]),r}(y.a.Component);function qi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ni(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ui=Pr.a.get("window").width,Hi=function(e){u()(r,e);var t=Ni(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).timer=function(){return setTimeout((function(){n.poll(n.state.child_id)}),1e4)},n._handleAppStateChange=function(e){n.state.appState.match(/inactive|background/)&&"active"===e&&n.state.date.toDateString()!==(new Date).toDateString()&&n.initializeChildren(),n.setState({appState:e})},n.state={date:new Date,child_id:"",student_id_array:[],message:"",refreshing:!1,showQR:!1,temperature:"",appState:"",showDateTimeModal:!1,present:!1},n.initializeChildren=n.initializeChildren.bind(_()(n)),n}return c()(r,[{key:"poll",value:function(e){var t,n=this;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/family/updates?student_id="+e,r.next=3,a.a.awrap(fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){t.data.forEach((function(t){n.refs[t].fetchData(e,new Date)}))})).catch((function(e){console.log("polling error: ",e)})));case 3:this.timeoutId=this.timer();case 4:case"end":return r.stop()}}),null,this,null,Promise)}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("offline",(function(t){e.props.setConnectState(!1)})),window.addEventListener("online",(function(t){e.props.setConnectState(!0)})),this.initializeChildren(),this.timeoutId=this.timer(),ii.a.addEventListener("change",this._handleAppStateChange)}},{key:"isIOS",value:function(){return"ios"===Nn.a.OS}},{key:"initializeChildren",value:function(){var e=this,t=this.props.route.params.parent_id;this.setState({child_id:"",date:new Date}),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/family/"+t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message,a=t.data;if(n>200||"Internal server error"===r)alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r);else{e.props.initializeChildren(a);var s=Object.keys(e.props.parent.child_of_id);e.setState({child_id:s[0],student_id_array:s})}})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when initializing student profiles")}))}},{key:"onSelectStudent",value:function(e){this.setState({child_id:e})}},{key:"markPresent",value:function(e){this.state.date;this.setState({temperature:e,present:""!==e})}},{key:"selectDatetimeConfirm",value:function(e){var t=new Date;t.setHours(0,0,0,0),e.getTime()<t.getTime()?e.setHours(18):e.toDateString()===(new Date).toDateString()?e.setTime(new Date):e.setHours(16,0,0),this.setState({date:e,showDateTimeModal:!1})}},{key:"getDayDifference",value:function(e,t){var n=new Date(e),r=new Date(t);n.setHours(0),r.setHours(0);return Math.round((r-n)/864e5)}},{key:"goBackADay",value:function(){var e=new Date(this.state.date.getTime());1===e.getDay()?e.setDate(e.getDate()-3):e.setDate(e.getDate()-1),this.selectDatetimeConfirm(e)}},{key:"goForwardADay",value:function(){var e=new Date(this.state.date.getTime());5===e.getDay()?e.setDate(e.getDate()+3):e.setDate(e.getDate()+1),this.selectDatetimeConfirm(e)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId),ii.a.removeEventListener("change",this._handleAppStateChange),this.props.clearState()}},{key:"render",value:function(){var e=this,t=this.props.route.params.parent_id,r=this.props.isConnected,a=this.state,s=a.date,i=a.child_id,o=a.showQR,c=a.temperature,l=a.showDateTimeModal,u=a.present;if(""===i)return y.a.createElement(Tn,null);var d=this.props.parent.child_of_id[i],f=this.getDayDifference(s,new Date);return y.a.createElement(Bn.a,{enabled:!0,behavior:"padding",keyboardVerticalOffset:100,style:{flex:1,zIndex:1}},y.a.createElement(Oi,{ref:"profile_selector",student_of_id:this.props.parent.child_of_id,onSelectStudent:function(t){return e.onSelectStudent(t)}}),o?y.a.createElement(Ti,{hideQRCode:function(){return e.setState({showQR:!1})},parent_id:t}):null,l?y.a.createElement(Lr,{start_date:s,datetime_type:"date",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:(new Date).setDate((new Date).getDate()-7),maxDatetime:(new Date).setDate((new Date).getDate()+1)}):null,y.a.createElement(kn.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center",paddingBottom:30},refreshControl:y.a.createElement(Rr.a,{style:{backgroundColor:"transparent"},refreshing:this.state.refreshing,onRefresh:this.initializeChildren,tintColor:"#ff8944",title:"Loading...",titleColor:"#368cbf",colors:["#ff8944","#368cbf","#0000ff"],progressBackgroundColor:"#ffff00"})},y.a.createElement(E.a,{style:{width:"100%",flexDirection:"row",backgroundColor:"white"}},y.a.createElement(E.a,{style:{width:"15%"}},f<7?y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return e.goBackADay()}},y.a.createElement(rn.a,{source:n(925),style:{width:40,height:40}})):null),y.a.createElement(C.a,{style:{width:"70%",justifyContent:"center"},onPress:function(){return e.setState({showDateTimeModal:!0})}},y.a.createElement(b.a,{style:{fontSize:.12*Ui,textAlign:"center"}},ln(s))),y.a.createElement(E.a,{style:{width:"15%"}},f>=0?y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return e.goForwardADay()}},y.a.createElement(rn.a,{source:n(926),style:{width:40,height:40}})):null)),y.a.createElement(Di,{student:d,students:this.props.parent.child_of_id,student_name:this.props.parent.child_of_id[i].name,selectOtherChildProfile:function(){return e.refs.profile_selector.slideIn()},viewQRCode:function(){return e.setState({showQR:!0})},temperature:c}),y.a.createElement(E.a,{style:{flex:1,width:"93%",flexDirection:"row",justifyContent:"space-between",marginVertical:5}},y.a.createElement(C.a,{style:{width:"30%",padding:10,backgroundColor:"#ffe1d0"},onPress:function(){return e.props.navigation.navigate("PickupRequest",{child_id:i,school_id:d.school_id})}},y.a.createElement(b.a,{style:{fontSize:.05*Ui,textAlign:"center"}},"\u63a5\u56de\u544a\u77e5")),y.a.createElement(C.a,{style:{width:"30%",padding:10,backgroundColor:"#fff1b5"},onPress:function(){return e.props.navigation.push("MedicationRequestPage",{onGoBack:function(){return e.refs.med_request.fetchData(i,new Date)},student_id:i,class_id:d.class_id})}},y.a.createElement(b.a,{style:{fontSize:.05*Ui,textAlign:"center"}},"\u6258\u85e5\u55ae")),y.a.createElement(C.a,{style:{width:"30%",padding:10,backgroundColor:"#b5e9e9"},onPress:function(){return e.props.navigation.navigate("AbsenceExcusePage",{student_id:i,class_id:null===d.class_id?"":d.class_id,school_id:d.school_id})}},y.a.createElement(b.a,{style:{fontSize:.05*Ui,textAlign:"center"}},"\u8acb\u5047\u55ae"))),y.a.createElement(Bi,{child_id:i,date:s,class_id:d.class_id,ref:"morningreminder",present:u,isConnected:r}),y.a.createElement(Fi,{child_id:i,date:s,ref:"med_request",viewMedRequest:function(t,n){return e.props.navigation.push("AddMedicationRequestPage",{onGoBack:function(){return e.refs.med_request.fetchData(i,new Date)},student_id:i,class_id:null===d.class_id?"":d.class_id,index:t,data:n})}}),y.a.createElement(pi,{child_id:i,date:s,ref:"wellness",updateTitleTemp:function(t){return e.markPresent(t)}}),y.a.createElement(wi,{child_id:i,date:s,class_id:d.class_id,ref:"messages"}),y.a.createElement(mi,{child_id:i,date:s,ref:"appetite"}),y.a.createElement(gi,{child_id:i,date:s,ref:"milkintake"}),y.a.createElement(Ei,{child_id:i,date:s,ref:"sleep"}),y.a.createElement(vi,{child_id:i,date:s,ref:"diaper"})))}}]),r}(y.a.Component),Wi=(ue.a.create({button_text:{fontSize:18,textAlign:"center"},button:{width:"30%",padding:20,justifyContent:"center"}}),Object(D.b)((function(e){return{parent:e.parent,isConnected:e.parent.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qi(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({setConnectState:di,initializeChildren:oi,markPresent:ui,clearState:ci},e))}))(Hi)),Vi=n(156);function Ki(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}Pr.a.get("window").width;var Gi=function(e){u()(n,e);var t=Ki(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={"\u85e5\u7c89":0},r}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u7c89;this.setState({"\u85e5\u7c89":parseInt(e)})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u7c89,n=this.props,r=n.width,a=n.height;return y.a.createElement(E.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(E.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"}},y.a.createElement(E.a,{style:{height:a,flexDirection:"row",flexDirection:"row"}},y.a.createElement(E.a,{style:{width:r,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},"\u85e5\u7c89"))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",height:.8*a,aspectRatio:1,justifyContent:"center",borderRadius:.4*a},onPress:function(){return e.setState({"\u85e5\u7c89":0===t?0:t-1})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"white"}},"-")),y.a.createElement(b.a,{style:{fontSize:40,paddingHorizontal:15}},t," \u5305"),y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",height:.8*a,aspectRatio:1,justifyContent:"center",borderRadius:.4*a},onPress:function(){return e.setState({"\u85e5\u7c89":t+1})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"white"}},"+"))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()}},y.a.createElement(b.a,{style:{fontSize:.12*r,textAlign:"center"}},"\u53d6\u6d88\u9078\u53d6"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"OK"))))))}}]),n}(y.a.Component);function Qi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Ji=function(e){u()(n,e);var t=Qi(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={"\u85e5\u6c34":0},r}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u6c34;this.setState({"\u85e5\u6c34":e})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u6c34,n=this.props,r=n.width,a=n.height;return y.a.createElement(E.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(E.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"}},y.a.createElement(E.a,{style:{height:a,flexDirection:"row",flexDirection:"row"}},y.a.createElement(E.a,{style:{width:r,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},"\u85e5\u6c34"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center",marginTop:-20}},y.a.createElement(E.a,{style:{flexDirection:"row",backgroundColor:"rgba(255,255,255,0.4)",alignItems:"center"}},y.a.createElement(qn.a,{style:{fontSize:40,padding:10},keyboardType:"decimal-pad",autoFocus:!0,selectTextOnFocus:!0,value:""+t,onChangeText:function(t){return e.setState({"\u85e5\u6c34":t})}}),y.a.createElement(b.a,{style:{paddingLeft:10,fontSize:40}},"c.c."))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u53d6\u6d88\u9078\u53d6"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"OK"))))))}}]),n}(y.a.Component);function Yi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Zi=function(e){u()(n,e);var t=Yi(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={"\u85e5\u818f":""},r}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u818f;this.setState({"\u85e5\u818f":e})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u818f,n=this.props,r=n.width,a=n.height;return y.a.createElement(E.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(E.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"}},y.a.createElement(E.a,{style:{height:a,flexDirection:"row",flexDirection:"row"}},y.a.createElement(E.a,{style:{width:r,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},"\u85e5\u818f"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center",marginTop:-20}},y.a.createElement(E.a,{style:{flexDirection:"row",backgroundColor:"rgba(255,255,255,0.4)",alignItems:"center"}},y.a.createElement(qn.a,{style:{fontSize:40,padding:10},placeholder:"\u90e8\u4f4d",autoFocus:!0,selectTextOnFocus:!0,value:t,onChangeText:function(t){return e.setState({"\u85e5\u818f":t})}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u53d6\u6d88\u9078\u53d6"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"OK"))))))}}]),n}(y.a.Component);function Xi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}!function(e){u()(n,e);var t=Xi(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={optionButtonWidth:0,optionButtonHeight:0,show_date_picker:!1,show_time_picker:!1,date:new Date,time:new Date,show_editor:"","\u85e5\u7c89":null,need_refrigeration:!1,"\u85e5\u6c34":null,"\u85e5\u818f":null,note:"",access_mode:"create"},r}c()(n,[{key:"componentDidMount",value:function(){}},{key:"getHeader",value:function(){var e=this.state,t=e.access_mode,n=e.date;if("read"===t){if(cn(n)===cn(new Date))return"\u4eca\u5929\u6258\u85e5\u55ae";return"\u661f\u671f"+["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][n.getDay()]}return"create"===t?"\u65b0\u589e\u6258\u85e5\u55ae":"edit"===t?"\u7de8\u8f2f\u4e2d...":void 0}},{key:"fetchAccessMode",value:function(){return this.state.access_mode}},{key:"componentDidUpdate",value:function(e){if(e.request!==this.props.request){var t=this.props.request;if(!t)return void this.setState({date:new Date,time:new Date,"\u85e5\u7c89":null,need_refrigeration:!1,"\u85e5\u6c34":null,"\u85e5\u818f":null,note:"",access_mode:"create"});var n=t.timestamp,r=t.medication,a=t.note,s=r.\u85e5\u7c89,i=r.need_refrigeration,o=r.\u85e5\u6c34,c=r.\u85e5\u818f;this.setState({date:n,time:n,"\u85e5\u7c89":s,need_refrigeration:i,"\u85e5\u6c34":o,"\u85e5\u818f":c,note:a,access_mode:"read"})}}},{key:"setDate",value:function(e){"ios"===Nn.a.OS?this.iosSetDate(e):this.androidSetDate(e)}},{key:"iosSetDate",value:function(e){"read"!==this.state.access_mode&&this.setState({date:e,time:e})}},{key:"androidSetDate",value:function(e){void 0!==e?this.setState({date:e,time:e,show_date_picker:!1}):this.setState({show_date_picker:!1})}},{key:"setTime",value:function(e){"ios"===Nn.a.OS?this.iosSetTime(e):this.androidSetTime(e)}},{key:"iosSetTime",value:function(e){"read"!==this.state.access_mode&&this.setState({time:e})}},{key:"androidSetTime",value:function(e){void 0!==e?this.setState({time:e,show_time_picker:!1}):this.setState({show_time_picker:!1})}},{key:"onFinishEdit",value:function(e,t){this.setState(O()({show_editor:""},e,t))}},{key:"onCancelSelect",value:function(e){this.setState(O()({show_editor:""},e,null))}},{key:"handleClickConfirmButton",value:function(){var e=this.state.access_mode;if("read"===e)this.setState({access_mode:"edit"});else if("create"===e)this.sendRequest(null);else if("edit"===e){var t=this.props.request.id;this.sendRequest(t)}}},{key:"sendRequest",value:function(e){var t=this,n=this.state,r=n.date,a=n.time,s=n.\u85e5\u7c89,i=n.need_refrigeration,o=n.\u85e5\u6c34,c=n.\u85e5\u818f,l=n.note,u=this.props,d=u.student_id,f=u.class_id,p={request_id:e,timestamp:cn(r)+" "+dn(a),class_id:f,"\u85e5\u7c89":s,need_refrigeration:i,"\u85e5\u6c34":o,"\u85e5\u818f":c,note:l};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/medicationrequest/student/"+d,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(p)}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message,a=e.data;n>200||"Internal server error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):t.props.onCreateRequestSuccess(a.id)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending medication request")}))}},{key:"deleteRequestConfirm",value:function(){confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest()}},{key:"deleteRequest",value:function(){var e=this,t=this.props,n=t.request,r=t.class_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/medicationrequest/"+n.id,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:r})}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message,a=t.data;n>200||"Internal Server Error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):e.props.onDeleteRequestSuccess(a.id)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.show_date_picker,r=t.show_time_picker,a=t.date,s=t.time,i=t.\u85e5\u7c89,o=t.\u85e5\u6c34,c=t.\u85e5\u818f,l=t.note,u=t.optionButtonWidth,d=t.optionButtonHeight,f=t.show_editor,p=t.access_mode;return n?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:3,justifyContent:"center"}}),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(C.a,{style:{width:"50%",padding:10,backgroundColor:"rgba(255,255,255,0.4)",alignSelf:"flex-end"},onPress:function(){return e.setState({show_date_picker:!1})}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"OK")))):r?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:3,justifyContent:"center"}}),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(C.a,{style:{width:"50%",padding:10,backgroundColor:"rgba(255,255,255,0.4)",alignSelf:"flex-end"},onPress:function(){return e.setState({show_time_picker:!1})}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"OK")))):y.a.createElement(Bn.a,{style:{flex:1},behavior:"padding",enabled:!0},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},this.getHeader())),y.a.createElement(E.a,{style:{flex:7}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-between",paddingVertical:10}},y.a.createElement(C.a,{disabled:"read"===p||""!==f,style:{backgroundColor:"rgba(255,255,255,0.4)",justifyContent:"center",padding:10,height:"100%"},onPress:function(){return e.setState({show_date_picker:!n})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},ln(a))),y.a.createElement(C.a,{disabled:"read"===p||""!==f,style:{backgroundColor:"rgba(255,255,255,0.4)",justifyContent:"center",padding:10,height:"100%"},onPress:function(){return e.setState({show_time_picker:!r})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},fn(s)))),"\u85e5\u7c89"===f?y.a.createElement(Gi,{"\u85e5\u7c89":i,width:u,height:d,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u7c89",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u7c89")}}):"\u85e5\u6c34"===f?y.a.createElement(Ji,{"\u85e5\u6c34":o,width:u,height:d,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u6c34",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u6c34")}}):"\u85e5\u818f"===f?y.a.createElement(Zi,{"\u85e5\u818f":c,width:u,height:d,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u818f",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u818f")}}):y.a.createElement(E.a,{style:{flex:4}},y.a.createElement(E.a,{style:{flex:3,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{disabled:"read"===p,style:{flex:1,backgroundColor:i?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:14,marginTop:14,marginRight:7,marginBottom:7},onLayout:function(t){var n=t.nativeEvent.layout,r=n.width,a=n.height;e.setState({optionButtonWidth:r,optionButtonHeight:a})},underlayColor:"#ff8944",onPress:function(){return e.setState({show_editor:"\u85e5\u7c89","\u85e5\u7c89":i||1})}},i?y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u7c89: ",i," \u5305"):y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u7c89")),y.a.createElement(C.a,{disabled:"read"===p,style:{flex:1,backgroundColor:this.state.need_refrigeration?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:7,marginTop:14,marginRight:14,marginBottom:7},underlayColor:"#ff8944",onPress:function(){return e.setState({need_refrigeration:!e.state.need_refrigeration})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u54c1\u9700\u51b7\u85cf"))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{disabled:"read"===p,style:{flex:1,backgroundColor:o?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:14,marginTop:7,marginRight:7,marginBottom:14},onPress:function(){return e.setState({show_editor:"\u85e5\u6c34","\u85e5\u6c34":o||0})}},o?y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u85e5\u6c34: ",o," c.c."):y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u6c34")),y.a.createElement(C.a,{disabled:"read"===p,style:{flex:1,backgroundColor:c?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:7,marginTop:7,marginRight:14,marginBottom:14},onPress:function(){return e.setState({show_editor:"\u85e5\u818f"})}},c?y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u85e5\u818f\u90e8\u4f4d: ",c):y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u818f")))),y.a.createElement(E.a,{style:{backgroundColor:"#b5e9e9"}},y.a.createElement(qn.a,{editable:"read"!==p,placeholder:"\u5099\u8a3b",placeholderTextColor:"grey",value:l,style:{backgroundColor:"#eaf8f8",borderRadius:3,fontSize:20,padding:20},onChangeText:function(t){return e.setState({note:t})}}))),void 0!==this.props.request&&this.props.request.administered?y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:30}},"\u5582\u85e5\u8001\u5e2b: ",this.props.request.teacher_name)):y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:10}},y.a.createElement(E.a,{style:{flex:1,marginHorizontal:7}},"edit"===p?y.a.createElement(C.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.deleteRequestConfirm()}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},"\u522a\u9664")):null),y.a.createElement(E.a,{style:{flex:1,marginHorizontal:7}},"edit"===p?y.a.createElement(C.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.setState({access_mode:"read"})}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},"\u53d6\u6d88\u7de8\u8f2f")):null),y.a.createElement(E.a,{style:{flex:1,marginHorizontal:7}},y.a.createElement(C.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.handleClickConfirmButton()}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"read"===p?"\u7de8\u8f2f":"create"===p?"\u65b0\u589e":"edit"===p?"\u9001\u51fa":null))))))}}])}(y.a.Component);function $i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var to=Pr.a.get("window").width,no=function(e){u()(n,e);var t=eo(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={today:new Date,tomorrow:new Date,SlideInRight:new ki.a.Value(0),SlideInLeft:new ki.a.Value(0),total_height:1,total_width:1,height:0,width:0,left:0,top:0,requests:[],day_of_week:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],selected_request_index:-1},r}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.route.params.selected_request_index,t=this.state.tomorrow;t.setDate(t.getDate()+1),this.setState({tomorrow:t}),this.fetchMedicationRequest(),this.initializePage(),void 0!==e&&this.selectRequest(e)}},{key:"isIOS",value:function(){return"ios"===Nn.a.OS}},{key:"fetchMedicationRequest",value:function(){var e,t,n,r,s,i,o,c;return a.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(this.props.isConnected){l.next=4;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),l.abrupt("return");case 4:return e=this.props.route.params,t=e.student_id,n=e.onGoBack,r=cn(new Date),l.next=8,a.a.awrap(hn("/medicationrequest/student/"+t+"?date="+r));case 8:if(s=l.sent,i=s.success,s.statusCode,o=s.message,c=s.data,i){l.next=13;break}return alert("Sorry \u53d6\u5f97\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u6216\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o),l.abrupt("return");case 13:this.denormalize(c),this.setState({requests:c}),n();case 16:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){for(var t=0;t<e.length;t++){e[t].title=new Date(e[t].title);for(var n=0;n<e[t].data.length;n++)e[t].data[n].timestamp=new Date(e[t].data[n].timestamp)}}},{key:"initializePage",value:function(){ki.a.sequence([ki.a.timing(this.state.SlideInRight,{toValue:1,duration:1e3,useNativeDriver:!0}),ki.a.timing(this.state.SlideInLeft,{toValue:1,duration:1e3,useNativeDriver:!0})]).start()}},{key:"viewRequest",value:function(){var e=this;this.setState({SlideInLeft:new ki.a.Value(0)},(function(){ki.a.timing(e.state.SlideInLeft,{toValue:1,duration:1e3,useNativeDriver:!0}).start()}))}},{key:"selectRequest",value:function(e){"edit"!==this.refs.main.fetchAccessMode()?this.setState({selected_request_index:e}):alert("\u9084\u5728\u7de8\u8f2f\u4e2d\u5594\u8acb\u5b8c\u6210\u518d\u96e2\u958b \u591a\u8b1d")}},{key:"onCreateRequestSuccess",value:function(e){var t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,a.a.awrap(this.fetchMedicationRequest());case 2:t=this.state.requests,this.get_todays_requests(t),n=-1,r=0;case 6:if(!(r<t.length)){s.next=13;break}if(t[r].id!==e){s.next=10;break}return n=r,s.abrupt("break",13);case 10:r++,s.next=6;break;case 13:this.setState({selected_request_index:n});case 14:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"get_todays_requests",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=new Date(e[n].timestamp);if(r.toDateString()!==(new Date).toDateString())break;e[n].timestamp=r,t.push(e[n])}this.props.getMedRequestSuccess(t)}},{key:"onDeleteRequestSuccess",value:function(e){for(var t=this.state.requests,n=[],r=0;r<t.length;r++)t[r].id!==e&&n.push(t[r]);this.setState({requests:n,selected_request_index:0}),this.get_todays_requests(n)}},{key:"deleteRequestConfirm",value:function(e){confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest(e)}},{key:"deleteRequest",value:function(e){var t=this;if(this.props.isConnected){var n=this.props.route.params.class_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/medicationrequest/"+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:n})}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message;e.data;n>200||"Internal Server Error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):t.fetchMedicationRequest()})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))}else alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"render",value:function(){var e=this,t=this.state,n=(t.SlideInRight,t.SlideInLeft,t.total_width,t.requests),r=(t.today,t.tomorrow,t.day_of_week),a=(t.selected_request_index,this.props.route.params),s=a.student_id,i=a.class_id;return y.a.createElement(E.a,{style:{flex:1,paddingHorizontal:20}},0===n.length&&y.a.createElement(E.a,{style:{padding:20,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:50}},"\u7121\u6258\u85e5\u55ae")),y.a.createElement(Vi.a,{sections:n,keyExtractor:function(e,t){return e+t},renderItem:function(t){var n=t.item,r=t.index,a=t.section;return y.a.createElement(E.a,{style:{width:"100%",aspectRatio:5,flexDirection:"row",marginVertical:7,justifyContent:"space-between",alignItems:"center"}},y.a.createElement(C.a,{style:{width:"65%",height:"100%",padding:20,backgroundColor:"#368cbf",borderRadius:40,justifyContent:"center",alignItems:"center"},onPress:function(){return e.props.navigation.push("AddMedicationRequestPage",{onGoBack:function(){return e.fetchMedicationRequest()},student_id:s,class_id:i,index:r,data:a.data})}},y.a.createElement(b.a,{style:{fontSize:30}},fn(n.timestamp))),y.a.createElement(C.a,{style:{width:"30%",height:"100%",padding:20,backgroundColor:"#fa625f",justifyContent:"center",borderRadius:40},onPress:function(){return e.deleteRequestConfirm(n.id)}},y.a.createElement(b.a,{style:{fontSize:.07*to,textAlign:"center"}},"\u522a\u9664")))},renderSectionHeader:function(t){var n=t.section.title;return y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"rgba(0,0,0,0.5)",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:e.isIOS()?20:12,marginTop:15,marginBottom:7,borderRadius:40}},y.a.createElement(b.a,{style:{fontSize:30,color:"white"}},""+un(n)),y.a.createElement(b.a,{style:{fontSize:30,color:"white"}},"\u661f\u671f"+r[n.getDay()]))}}),y.a.createElement(E.a,{style:{width:"100%",paddingVertical:10,justifyContent:"center",backgroundColor:"transparent"}},y.a.createElement(C.a,{style:{backgroundColor:"#f4d41f",padding:this.isIOS()?20:12,justifyContent:"center",borderRadius:40},onPress:function(){return e.props.navigation.push("AddMedicationRequestPage",{onGoBack:function(){return e.fetchMedicationRequest()},student_id:s,class_id:i,index:-1,data:null})}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u65b0\u589e"))))}}]),n}(y.a.Component),ro=Object(D.b)((function(e){return{isConnected:e.parent.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$i(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(k.a)({getMedRequestSuccess:li},e))}))(no);function ao(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var so=Pr.a.get("window"),io=so.width,oo=so.height,co=[{value:"\u611f\u5192",label:"\u611f\u5192"},{value:"\u6d41\u611f",label:"\u6d41\u611f"},{value:"\u8178\u75c5\u6bd2",label:"\u8178\u75c5\u6bd2"},{value:"\u6c34\u75d8",label:"\u6c34\u75d8"},{value:"\u8178\u80c3\u708e",label:"\u8178\u80c3\u708e"},{value:"\u5176\u4ed6",label:"\u5176\u4ed6"},{value:"Cancel",label:"\u8fd4\u56de"}],lo=function(e){u()(n,e);var t=ao(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).handleSelectStatus=function(e){"Cancel"===e?r.setState({showSelect:!1}):"\u5176\u4ed6"===e?r.setState({editing_other_option:!0,excuse_type:"\u5176\u4ed6",showSelect:!1}):r.setState({excuse_type:e,showSelect:!1})},r.state={max_date:(new Date).setDate((new Date).getDate()+30),cached_date:null,startDate:new Date,endDate:new Date,show_start_date_picker:!1,show_end_date_picker:!1,showSelect:!1,childIsSick:0,excuse_type:"none-medical",editing_other_option:!1,days:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],months:["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"],access_mode:"create",note:"",absence_time:"all_day",scrollHeight:"100%",request_id:""},r.setStartDate=r.setStartDate.bind(_()(r)),r.setEndDate=r.setEndDate.bind(_()(r)),r.setChildNotSick=r.setChildNotSick.bind(_()(r)),r.setChildSick=r.setChildSick.bind(_()(r)),r.onValueChange=r.onValueChange.bind(_()(r)),r.sendAbsenceNote=r.sendAbsenceNote.bind(_()(r)),r}return c()(n,[{key:"componentDidUpdate",value:function(e){if(e.request!==this.props.request){var t=this.props.request;if(!t)return void this.setState({startDate:new Date,endDate:new Date,childIsSick:0,excuse_type:"none-medical",note:"",absence_time:"all_day",access_mode:"create",cached_date:null,scrollHeight:"100%",request_id:""});var n=t.id,r=t.date,a=t.excuse_type,s=t.note,i=t.absence_time;this.setState({startDate:r,endDate:null,childIsSick:"none-medical"===a?0:1,excuse_type:a,note:s,absence_time:i,access_mode:"read",cached_date:null,request_id:n})}}},{key:"isIOS",value:function(){return"ios"===Nn.a.OS}},{key:"fetchAccessMode",value:function(){return this.state.access_mode}},{key:"showSelect",value:function(){this.setState({childIsSick:1,showSelect:!0})}},{key:"setChildSick",value:function(){this.setState({childIsSick:1})}},{key:"setChildNotSick",value:function(){this.setState({childIsSick:0,excuse_type:"none-medical"})}},{key:"editorOnBlur",value:function(){var e=this.state.excuse_type;this.setState({editing_other_option:!1,childIsSick:""===e?0:1,excuse_type:""===e?"none-medical":e})}},{key:"setStartDate",value:function(e){"ios"===Nn.a.OS?this.iosSetStartDate(e):this.androidSetStartDate(e)}},{key:"iosSetStartDate",value:function(e){var t=this.state.endDate;if("edit"===this.state.access_mode){var n=this.state,r=n.cached_date,a=n.startDate;this.setState({cached_date:null===r?a:r,startDate:e})}else this.setState({startDate:e,endDate:e<t?t:e})}},{key:"androidSetStartDate",value:function(e){if(void 0!==e){var t=this.state.endDate;if("edit"===this.state.access_mode){var n=this.state,r=n.cached_date,a=n.startDate,s=this.props.request.id;this.setState({cached_date:null===r?a:r,startDate:e,show_start_date_picker:!1}),this.props.checkUniqueStudentDate(s,e)}else this.setState({startDate:e,endDate:e<t?t:e,show_start_date_picker:!1})}else this.setState({show_start_date_picker:!1})}},{key:"onEndEditingStartDate",value:function(){var e=this.state.startDate;if("edit"===this.state.access_mode){var t=this.props.request.id;this.props.checkUniqueStudentDate(t,e)}this.setState({show_start_date_picker:!1})}},{key:"duplicateDateFound",value:function(){var e=this.state.cached_date;this.setState({startDate:e,cached_date:null})}},{key:"setEndDate",value:function(e){"ios"===Nn.a.OS?this.iosSetEndDate(e):this.androidSetEndDate(e)}},{key:"iosSetEndDate",value:function(e){var t=this.state.startDate;this.setState({startDate:e<t?e:t,endDate:e})}},{key:"androidSetEndDate",value:function(e){if(void 0!==e){var t=this.state.startDate;this.setState({startDate:e<t?e:t,endDate:e,show_end_date_picker:!1})}else this.setState({show_end_date_picker:!1})}},{key:"getDayDifference",value:function(){var e=this.state,t=e.startDate,n=e.endDate;return Math.round(Math.abs((n-t)/864e5))+1}},{key:"onValueChange",value:function(e){this.setState({excuse_type:e})}},{key:"setScrollHeight",value:function(e){this.setState({scrollHeight:e})}},{key:"handleClickConfirmButton",value:function(){var e=this.state.access_mode;if("read"===e)this.setState({access_mode:"edit"});else if("create"===e)this.sendAbsenceNote();else if("edit"===e){var t=this.props.request.id;this.editAbsenceNote(t)}}},{key:"sendAbsenceNote",value:function(){var e=this,t=this.state,n=t.excuse_type,r=t.note,a=t.absence_time,s=this.props,i=s.student_id,o=s.class_id,c=s.school_id,l=s.isConnected,u={student_id:i,class_id:o,school_id:c,startDate:cn(this.state.startDate),endDate:cn(this.state.endDate),excuse_type:n,note:r,absence_time:a};l?fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/absence-excuse",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(u)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message,a=t.data;n>200||"Internal server error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01 \u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):e.props.onCreateRequestSuccess(a.id)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01 \u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending absence request")})):alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"editAbsenceNote",value:function(e){var t=this,n=this.state,r=n.excuse_type,a=n.note,s=n.absence_time,i=this.props.class_id,o=cn(this.state.startDate);fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/absence-excuse",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:e,excuse_type:r,note:a,date:o,class_id:i,absence_time:s})}).then((function(e){return e.json()})).then((function(n){var r=n.statusCode,a=n.message;n.data;r>200||"Internal server error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):t.props.onCreateRequestSuccess(e)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when editing absence request")}))}},{key:"deleteRequestConfirm",value:function(){confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest()}},{key:"deleteRequest",value:function(){var e=this,t=this.props.request.id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/absence-excuse",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:t})}).then((function(e){return e.json()})).then((function(n){var r=n.statusCode,a=n.message;n.data;r>200||"Internal server error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):e.props.onDeleteRequestSuccess(t)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting absence request")}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.max_date,r=t.access_mode,a=t.startDate,s=t.endDate,i=t.excuse_type,o=t.editing_other_option,c=t.note,l=t.show_start_date_picker,u=t.show_end_date_picker,d=t.showSelect,f=t.absence_time,p=t.scrollHeight,h=t.request_id;return l?y.a.createElement(E.a,{style:{height:oo,marginTop:-120}},y.a.createElement(Lr,{start_date:a,datetime_type:"date",hideModal:function(){return e.setState({show_start_date_picker:!1})},selectDatetimeConfirm:function(t){return e.setStartDate(t)},minDatetime:new Date,maxDatetime:n})):u?y.a.createElement(E.a,{style:{height:oo,marginTop:-120}},y.a.createElement(Lr,{start_date:s,datetime_type:"date",hideModal:function(){return e.setState({show_end_date_picker:!1})},selectDatetimeConfirm:function(t){return e.setEndDate(t)},minDatetime:new Date,maxDatetime:n})):d?y.a.createElement(E.a,{style:{padding:30,height:"100%",alignItems:"center"}},co.map((function(t,n){var r=t.label,a=t.value;return y.a.createElement(C.a,{key:n,style:{width:"50%",padding:15,backgroundColor:"white",borderWidth:1,borderColor:"lightgrey"},onPress:function(){return e.handleSelectStatus(a)}},y.a.createElement(b.a,{style:{fontSize:25}},r))}))):y.a.createElement(E.a,{style:{paddingHorizontal:30,paddingVertical:30,height:"100%"}},y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(C.a,{disabled:"read"===r,style:{flex:1,padding:15,justifyContent:"center",backgroundColor:0===this.state.childIsSick?"#368cbf":"rgba(0,0,0,0.1)",borderTopLeftRadius:30,borderBottomLeftRadius:30},underlayColor:"#368cbf",onPress:this.setChildNotSick},y.a.createElement(b.a,{style:{fontSize:25,color:0===this.state.childIsSick?"white":"black",textAlign:"center"}},"\u4e8b\u5047")),o?y.a.createElement(E.a,{style:{flex:1,padding:15,borderTopRightRadius:30,borderBottomRightRadius:30,justifyContent:"center",backgroundColor:this.state.childIsSick?"#368cbf":"rgba(0,0,0,0.1)"}},y.a.createElement(qn.a,{autoFocus:!0,selectTextOnFocus:!0,style:{fontSize:25,color:this.state.childIsSick?"white":"black",textAlign:"center",paddingVertical:-1},value:i,onChangeText:function(t){return e.setState({excuse_type:t})},onBlur:function(){return e.editorOnBlur()}})):y.a.createElement(Wn,{style:{flex:1,padding:15,borderTopRightRadius:30,borderBottomRightRadius:30,justifyContent:"center",backgroundColor:0===this.state.childIsSick?"rgba(0,0,0,0.1)":"#368cbf"},disabled:"read"===r,textStyle:{fontSize:25,color:this.state.childIsSick?"white":"black",textAlign:"center"},selectedValue:"none-medical"===i?"\u75c5\u5047":i,showSelect:function(){return e.showSelect()},handleOnClick:this.setChildSick,handleSelectValue:function(t){return e.handleSelectStatus(t)}})),y.a.createElement(E.a,{style:{width:"100%"}},null===s?y.a.createElement(E.a,{style:{paddingVertical:20,width:"70%",alignSelf:"center"}},y.a.createElement(C.a,{disabled:"read"===r,style:{backgroundColor:"rgba(0,0,0,0.4)"},onPress:function(){return e.setState({show_start_date_picker:!0})}},y.a.createElement(E.a,{style:{padding:15,justifyContent:"center"}},y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{color:"white",fontSize:.12*io,fontWeight:"bold"}},a.getFullYear())),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{color:"white",fontSize:.12*io,fontWeight:"bold"}},a.getMonth()+1,"/",a.getDate())),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:.12*io,color:"white",fontWeight:"bold"}},"\u661f\u671f",this.state.days[a.getDay()]))))):y.a.createElement(E.a,{style:{alignItems:"center",paddingVertical:15}},y.a.createElement(E.a,{style:{width:"100%"}},y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.4)",fontSize:.1*io}},"\u958b\u59cb"),y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",padding:15},onPress:function(){return e.setState({show_start_date_picker:!0})}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},y.a.createElement(b.a,{style:{color:"white",fontSize:.09*io,fontWeight:"bold"}},un(a)),y.a.createElement(b.a,{style:{fontSize:.09*io,color:"white",fontWeight:"bold"}},"\u661f\u671f",this.state.days[a.getDay()])))),y.a.createElement(E.a,{style:{width:"100%",alignItems:"center",justifyContent:"center",padding:20}},y.a.createElement(b.a,{style:{fontSize:25}},"\u7e3d\u8a08 ",this.getDayDifference()," \u5929")),y.a.createElement(E.a,{style:{width:"100%"}},y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",padding:15},onPress:function(){return e.setState({show_end_date_picker:!0})}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},y.a.createElement(b.a,{style:{color:"white",fontSize:.09*io,fontWeight:"bold"}},un(s)),y.a.createElement(b.a,{style:{fontSize:.09*io,color:"white",fontWeight:"bold"}},"\u661f\u671f",this.state.days[s.getDay()]))),y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.4)",fontSize:.1*io,textAlign:"right"}},"\u7d50\u675f"))),y.a.createElement(E.a,{style:{flex:1,width:"100%",alignItems:"center"}},y.a.createElement(qn.a,{key:h,editable:"read"!==r,placeholder:"\u5099\u8a3b",placeholderTextColor:"grey",multiline:!0,scrollEnabled:!1,value:c,style:{width:"100%",height:p,backgroundColor:"#eaf8f8",borderRadius:3,fontSize:25,paddingTop:20,paddingBottom:20,paddingHorizontal:20,textAlignVertical:"center"},onChangeText:function(t){return e.setState({note:t})},onChange:function(t){return e.setScrollHeight(t.target.scrollHeight)},onLayout:function(t){var n=t.nativeEvent.target.scrollHeight;e.setState({scrollHeight:n})}})),y.a.createElement(E.a,{style:{flex:1,width:"100%",alignItems:"center",flexDirection:"row",justifyContent:"space-between"}},y.a.createElement(C.a,{disabled:"read"===r,style:{flex:1,paddingVertical:15,justifyContent:"center"},underlayColor:"transparent",onPress:function(){return e.setState({absence_time:"all_day"})}},y.a.createElement(b.a,{style:{width:"90%",fontSize:25,backgroundColor:"all_day"===f?"#368cbf":"rgba(0,0,0,0.1)",color:"all_day"===f?"white":"black",padding:15,textAlign:"center"}},"\u5168\u5929")),y.a.createElement(C.a,{disabled:"read"===r,style:{flex:1,paddingVertical:10,justifyContent:"center",alignItems:"center"},underlayColor:"transparent",onPress:function(){return e.setState({absence_time:"morning"})}},y.a.createElement(b.a,{style:{width:"90%",fontSize:25,backgroundColor:"morning"===f?"#368cbf":"rgba(0,0,0,0.1)",color:"morning"===f?"white":"black",padding:15,textAlign:"center"}},"\u65e9\u4e0a")),y.a.createElement(C.a,{disabled:"read"===r,style:{flex:1,paddingVertical:10,justifyContent:"center",alignItems:"flex-end"},underlayColor:"transparent",onPress:function(){return e.setState({absence_time:"evening"})}},y.a.createElement(b.a,{style:{width:"90%",fontSize:25,backgroundColor:"evening"===f?"#368cbf":"rgba(0,0,0,0.1)",color:"evening"===f?"white":"black",padding:15,textAlign:"center"}},"\u4e0b\u5348"))),y.a.createElement(E.a,{style:{marginVertical:20,width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"center"}},"edit"!==r?y.a.createElement(C.a,{style:{width:"100%",padding:20,justifyContent:"center",backgroundColor:"rgba(0,0,0,0.1)"},onPress:function(){return e.handleClickConfirmButton()}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"read"===r?"\u7de8\u8f2f":"create"===r?"\u65b0\u589e":null)):"edit"===r?y.a.createElement(E.a,{style:{width:"100%",flex:1,flexDirection:"row"}},y.a.createElement(C.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"#fa625f"},onPress:function(){return e.deleteRequestConfirm()}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u522a\u9664")),y.a.createElement(C.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"rgba(0,0,0,0.1)"},onPress:function(){return e.setState({access_mode:"read"})}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u53d6\u6d88\u7de8\u8f2f")),y.a.createElement(C.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"#00c07f"},onPress:function(){return e.handleClickConfirmButton()}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u9001\u51fa"))):null)))}}]),n}(y.a.Component),uo=(ue.a.create({dateContainer:{flex:1,width:"35%",justifyContent:"center"}}),Object(D.b)((function(e){return{isConnected:e.parent.isConnected}}),null,null,{forwardRef:!0})(lo));function fo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}Pr.a.get("window").height;var po=function(e){u()(n,e);var t=fo(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={todays_date:cn(new Date),SlideInRight:new ki.a.Value(0),SlideInLeft:new ki.a.Value(0),total_height:1,total_width:1,height:0,width:0,left:0,top:0,requests:[],day_of_week:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],selected_request_index:-1},r}return c()(n,[{key:"componentDidMount",value:function(){this.props.isConnected?(this.fetchAbsenceExcuse(),this.initializePage()):alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"isIOS",value:function(){return"ios"===Nn.a.OS}},{key:"fetchAbsenceExcuse",value:function(){var e,t,n,r=this;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=this.props.route.params.student_id,t=cn(new Date),n="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/absence-excuse/student/"+e+"?date="+t,s.next=5,a.a.awrap(fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message,a=e.data;t>200||"Internal server error"===n?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+n):(r.denormalize(a),r.setState({requests:a}))})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when fetching absence request")})));case 5:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){for(var t=0;t<e.length;t++)e[t].date=new Date(e[t].date)}},{key:"initializePage",value:function(){ki.a.sequence([ki.a.timing(this.state.SlideInRight,{toValue:1,duration:1e3,useNativeDriver:!0}),ki.a.timing(this.state.SlideInLeft,{toValue:1,duration:1e3,useNativeDriver:!0})]).start()}},{key:"selectRequest",value:function(e){"edit"!==this.refs.main.fetchAccessMode()?this.setState({selected_request_index:e}):alert("\u9084\u5728\u7de8\u8f2f\u4e2d\u5594\u8acb\u5b8c\u6210\u518d\u96e2\u958b \u591a\u8b1d")}},{key:"onCreateRequestSuccess",value:function(e){var t,n,r;return a.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,a.a.awrap(this.fetchAbsenceExcuse());case 2:t=this.state.requests,n=-1,r=0;case 5:if(!(r<t.length)){s.next=12;break}if(t[r].id!==e){s.next=9;break}return n=r,s.abrupt("break",12);case 9:r++,s.next=5;break;case 12:this.setState({selected_request_index:n});case 13:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"onDeleteRequestSuccess",value:function(e){for(var t=this.state.requests,n=[],r=0;r<t.length;r++)t[r].id!==e&&n.push(t[r]);this.setState({requests:n,selected_request_index:0})}},{key:"checkUniqueStudentDate",value:function(e,t){for(var n=this.state.requests,r=!1,a=0;a<n.length;a++)if(e!==n[a].id&&cn(t)===cn(n[a].date)){r=!0;break}r&&(alert("\u5df2\u7d93\u5728\u9019\u500b\u65e5\u671f\u8acb\u904e\u5047\u4e86"),this.refs.main.duplicateDateFound())}},{key:"render",value:function(){var e=this,t=this.state,n=t.SlideInRight,r=(t.SlideInLeft,t.total_width),a=t.requests,s=t.todays_date,i=t.day_of_week,o=t.selected_request_index,c=this.props.route.params,l=c.student_id,u=c.class_id,d=c.school_id,f=a[o];return y.a.createElement(Bn.a,{style:{flex:1,width:"100%",alignItems:"center"},behavior:"padding",keyboardVerticalOffset:85,enabled:!0},y.a.createElement(kn.a,{style:{width:"100%"}},y.a.createElement(E.a,{style:{width:"100%"}},y.a.createElement(kn.a,{horizontal:!0,showsHorizontalScrollIndicator:!1},a.map((function(t,a){var c=i[t.date.getDay()],l=t.date.getMonth()+1+"/"+t.date.getDate();return y.a.createElement(ki.a.View,{key:t.id,style:{padding:10,transform:[{translateX:n.interpolate({inputRange:[0,1],outputRange:[r,0]})}]}},y.a.createElement(C.a,{style:{height:100,width:100,padding:10,backgroundColor:o===a?"#368cbf":"rgba(0,0,0,0.2)",borderRadius:10},underlayColor:"#368cbf",onPress:function(){return e.selectRequest(a)}},y.a.createElement(E.a,null,cn(t.date)===s?y.a.createElement(b.a,{style:{fontSize:20,color:o===a?"white":"black"}},"\u4eca\u5929"):y.a.createElement(b.a,{style:{fontSize:20,color:o===a?"white":"black"}},"\u661f\u671f",c),y.a.createElement(b.a,{style:{fontSize:20,color:o===a?"white":"black"}},l))))})),y.a.createElement(ki.a.View,{style:{padding:10,transform:[{translateX:n.interpolate({inputRange:[0,1],outputRange:[r,0]})}]}},y.a.createElement(C.a,{style:{height:100,width:100,padding:10,backgroundColor:-1===o?"#368cbf":"rgba(0,0,0,0.2)",borderRadius:10},underlayColor:"#ff8944",ref:"welrnf",onPress:function(){return e.selectRequest(-1)}},y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20,color:-1===o?"white":"black"}},"\u65b0\u589e")))))),y.a.createElement(E.a,{style:{width:"100%",borderRadius:40,backgroundColor:"#b5e9e9"}},y.a.createElement(uo,{ref:"main",student_id:l,class_id:u,school_id:d,request:f,onCreateRequestSuccess:function(t){return e.onCreateRequestSuccess(t)},onDeleteRequestSuccess:function(t){return e.onDeleteRequestSuccess(t)},checkUniqueStudentDate:function(t,n){return e.checkUniqueStudentDate(t,n)}}))))}}]),n}(y.a.Component),ho=Object(D.b)((function(e){return{isConnected:e.parent.isConnected}}))(po);function mo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var yo=Pr.a.get("window"),go=yo.width,_o=yo.height,Eo=function(e){u()(n,e);var t=mo(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={time:null,provided_times:["5","10","15","20","25"],colors:["#ffe1d0","#ffddb7","#fff1b5","#dcf3d0","#b5e9e9"],hightlighted_colors:["#fa625f","#ff8944","#f4d41f","#00c07f","#368cbf"],choose_other_option:!1,total_height:_o-55,total_width:go},r.sendRequest=r.sendRequest.bind(_()(r)),r}return c()(n,[{key:"onBlur",value:function(){var e=this.state,t=e.time,n=e.choose_other_option,r=e.provided_times;n&&(""===t||r.includes(t))&&this.setState({choose_other_option:!1})}},{key:"sendRequest",value:function(){var e=this;if(this.props.isConnected){var t=this.props.route.params,n=t.child_id,r=t.school_id,a="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/attendance/pickup-request",s=n,i=new Date;i.setMinutes(i.getMinutes()+parseInt(this.state.time));var o={school_id:r,student_id:s,arrival_time:cn(i)+" "+dn(i)};fetch(a,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,r=t.message;n>200||"Internal server error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+r):e.props.navigation.goBack()})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending pickup request")}))}else alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"render",value:function(){var e=this,t=this.state,n=t.time,r=t.provided_times,a=t.colors,s=t.hightlighted_colors,i=t.choose_other_option,o=t.total_height,c=t.total_width;return y.a.createElement(Bn.a,{style:{flex:1},behavior:"padding",keyboardVerticalOffset:100,enabled:!0},y.a.createElement(kn.a,null,y.a.createElement(E.a,{style:{flex:3,flexDirection:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center"}},r.map((function(t,r){return y.a.createElement(E.a,{key:r,style:{width:"50%",height:.28*o,backgroundColor:n==t?s[r]:a[r],alignItems:"center",justifyContent:"center"}},y.a.createElement(C.a,{style:{width:"90%",height:"90%",borderWidth:n==t?5:0,borderColor:"white",backgroundColor:n==t?s[r]:a[r]},underlayColor:s[r],onPress:function(){return e.setState({time:t,choose_other_option:!1})}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:.2*c}},t),y.a.createElement(b.a,{style:{fontSize:.09*c}},"\u5206\u9418"))))})),y.a.createElement(E.a,{style:{width:"50%",height:.28*o,alignItems:"center",justifyContent:"center",backgroundColor:i?"black":"white"}},y.a.createElement(C.a,{style:{flexDirection:"row",width:"90%",height:"90%",backgroundColor:i?"black":"white",borderWidth:i?5:0,borderColor:"white",alignItems:"center",justifyContent:"center"},onPress:function(){return e.setState({choose_other_option:!0,time:""})}},i?y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%"}},y.a.createElement(qn.a,{autoFocus:!0,selectTextOnFocus:!0,onBlur:function(){return e.onBlur()},keyboardType:"numeric",value:n+"",style:{fontSize:.2*c,color:"white",width:"100%"},onChangeText:function(t){e.setState({time:t})}}),y.a.createElement(b.a,{style:{fontSize:.09*c,color:"white"}},"\u5206\u9418")):y.a.createElement(b.a,{style:{fontSize:50}},"\u5176\u4ed6")))),y.a.createElement(E.a,{style:{height:.16*o}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"lightgrey",alignItems:"center",justifyContent:"center"},onPress:function(){return e.sendRequest()}},y.a.createElement(b.a,{style:{fontSize:50}},"\u9001\u51fa")))))}}]),n}(y.a.Component),bo=Object(D.b)((function(e){return{isConnected:e.parent.isConnected}}))(Eo);function vo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function So(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vo(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Co=Pr.a.get("window").width,Do=function(e){u()(r,e);var t=wo(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={isLoading:!0,request_id:null,today:new Date,showDateTimeModal:!1,datetime_type:"",date:null,time_array:[],time_selected_index:null,before_meal:null,powder:!1,powder_refrigerated:!1,syrup:[],gel:null,other_type:null,note:"",administered:!1,teacher_name:"",medicated_timestamp:null,fever_entry:{temperature:"",powder:!1,powder_refrigerated:!1,syrup:[],other_type:null},data:null,index:-1,access_mode:"create",scrollHeight:"100%"},n}return c()(r,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.index;null!==e.data?this.switchRequest(t):this.setState({date:new Date,isLoading:!1})}},{key:"switchRequest",value:function(e){var t=this.props.route.params.data,n=t[e],r=n.id,a=n.timestamp,s=n.administered,i=n.fever_entry,o=n.medication,c=n.note,l=n.teacher_name,u=n.medicated_timestamp;this.setState(So(So({index:e,data:t,request_id:r,date:a,time_array:[a]},o),{},{note:c,fever_entry:i,administered:s,teacher_name:l,medicated_timestamp:null!==u?new Date(u):null,access_mode:"read",isLoading:!1}))}},{key:"isIOS",value:function(){return"ios"===Nn.a.OS}},{key:"selectDatetimeConfirm",value:function(e){var t=this.state,n=t.datetime_type,r=t.time_array,a=t.time_selected_index;if("date"===n)this.setState({date:e,showDateTimeModal:!1});else if(null!==a){for(var s=[],i=0;i<r.length;i++)i!==a?s.push(r[i]):s.push(e);this.setState({time_array:s,time_selected_index:null,showDateTimeModal:!1})}else this.setState({time_array:[].concat(T()(this.state.time_array),[e]),showDateTimeModal:!1})}},{key:"removeTime",value:function(e){var t=this.state.time_array;t.splice(e,1),this.setState({time_array:t})}},{key:"onSelectSyrup",value:function(){var e=this.state.syrup;this.setState({syrup:e.length?[]:[{amount:"",need_refrigerated:!1}]})}},{key:"editSyrupAmountEntry",value:function(e,t){var n=this.state.syrup;n[t].amount=e,this.setState({syrup:n})}},{key:"editSyrupRefrigerationEntry",value:function(e,t){var n=this.state.syrup;n[t].need_refrigerated=e,this.setState({syrup:n})}},{key:"removeSyrupEntry",value:function(e){var t=this.state.syrup;t.splice(e,1),this.setState({syrup:t})}},{key:"onSelectFeverSyrup",value:function(){var e=this.state.fever_entry;this.setState({fever_entry:So(So({},e),{},{syrup:e.syrup.length?[]:[{amount:"",need_refrigerated:!1}]})})}},{key:"editFeverSyrupAmountEntry",value:function(e,t){var n=this.state.fever_entry;n.syrup[t].amount=e,this.setState({fever_entry:n})}},{key:"editFeverSyrupRefrigerationEntry",value:function(e,t){var n=this.state.fever_entry;n.syrup[t].need_refrigerated=e,this.setState({fever_entry:n})}},{key:"removeFeverSyrupEntry",value:function(e){var t=this.state.fever_entry;t.syrup.splice(e,1),this.setState({fever_entry:t})}},{key:"timeIsEmpty",value:function(){return 0===this.state.time_array.length&&(alert("\u81f3\u5c11\u8981\u9078\u64c7\u4e00\u500b\u6642\u9593\uff01"),!0)}},{key:"sendRequest",value:function(){var e,t,n,r,s,i,o;return a.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(this.props.isConnected){c.next=4;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),c.abrupt("return");case 4:return e=this.props.route.params,t=e.student_id,n=e.onGoBack,r=this.normalizedData(),c.next=8,a.a.awrap(mn("/medicationrequest/student/"+t,r));case 8:if(s=c.sent,i=s.success,s.statusCode,o=s.message,s.data,i){c.next=13;break}return alert("Sorry \u9001\u51fa\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o),c.abrupt("return");case 13:this.setState({access_mode:"read"}),n(),this.props.navigation.goBack();case 16:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"normalizedData",value:function(){var e=this.props.route.params.class_id,t=this.state,n=t.request_id,r=t.date,a=t.time_array,s=t.before_meal,i=t.powder,o=t.powder_refrigerated,c=t.syrup,l=t.gel,u=t.other_type,d=t.note,f=t.fever_entry;return{request_id:n,class_id:e,date:cn(r),time_array:a.map((function(e){return dn(e)})),before_meal:s,powder:i,powder_refrigerated:o,syrup:c,gel:null===l?l:l.trim(),other_type:null===u?u:u.trim(),note:d.trim(),fever_entry:{temperature:f.temperature,powder:f.powder,powder_refrigerated:f.powder_refrigerated,syrup:f.syrup,other_type:null===f.other_type?f.other_type:f.other_type.trim()}}}},{key:"editable",value:function(){var e=this.state.date,t=new Date;return t.setHours(10,0,0,0),e.toDateString()===(new Date).toDateString()&&new Date<t||e>new Date}},{key:"onClickConfirm",value:function(){var e=this.state.access_mode;if("create"===e||"edit"===e){if(this.timeIsEmpty())return;this.sendRequest()}else this.setState({access_mode:"edit"})}},{key:"deleteRequestConfirm",value:function(){var e=this.state.request_id;confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest(e)}},{key:"deleteRequest",value:function(e){var t=this;if(this.props.isConnected){var n=this.props.route.params,r=n.class_id,a=n.onGoBack;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/medicationrequest/"+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:r})}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,r=e.message;e.data;n>200||"Internal Server Error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):(a(),t.props.navigation.goBack())})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))}else alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"cancelEdit",value:function(){var e=this.state.index;this.switchRequest(e)}},{key:"render",value:function(){var e=this,t=this.state,r=t.isLoading,a=t.date,s=t.time_array,i=t.showDateTimeModal,o=t.datetime_type,c=t.time_selected_index,l=t.before_meal,u=t.powder,d=t.powder_refrigerated,f=t.syrup,p=t.gel,h=t.other_type,m=t.note,g=t.fever_entry,_=t.administered,v=t.teacher_name,S=t.medicated_timestamp,w=t.data,D=t.access_mode,k=t.scrollHeight;return r?y.a.createElement(Tn,null):y.a.createElement(Bn.a,{style:{flex:1,width:"100%",alignItems:"center"},behavior:"padding",enabled:!0},i?y.a.createElement(Lr,{start_date:null===c?new Date:s[c],datetime_type:o,hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:new Date,maxDatetime:(new Date).setDate((new Date).getDate()+7)}):null,y.a.createElement(kn.a,{style:{width:"100%"}},null!==w&&w.length>1&&y.a.createElement(E.a,{style:{width:"100%"}},y.a.createElement(kn.a,{horizontal:!0,showsHorizontalScrollIndicator:!1},w.map((function(t,n){return y.a.createElement(E.a,{key:n,style:{padding:10}},y.a.createElement(C.a,{key:t.id,style:{padding:10,backgroundColor:e.state.index===n?"#ffddb7":"rgba(0,0,0,0.5)",justifyContent:"center",borderRadius:30},underlayColor:"#ffddb7",onPress:function(){return e.switchRequest(n)}},y.a.createElement(b.a,{style:{fontSize:30,color:e.state.index===n?"grey":"white"}},fn(t.timestamp))))})))),y.a.createElement(E.a,{style:{backgroundColor:"white",borderTopRightRadius:30,borderTopLeftRadius:30}},_&&y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"white",padding:20}},y.a.createElement(b.a,{style:{fontSize:30}},"\u9935\u85e5\u8001\u5e2b\uff1a",v),y.a.createElement(b.a,{style:{fontSize:30}},"\u9935\u85e5\u6642\u9593\uff1a",fn(S)))),y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{width:"100%",justifyContent:"center",backgroundColor:"#ff8944",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30},underlayColor:"transparent",onPress:function(){return e.setState({showDateTimeModal:!0,datetime_type:"date"})}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u65e5\u671f ",un(a))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",width:"100%",backgroundColor:"white",padding:20}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D||"edit"===D,style:{width:"80%",paddingBottom:10},underlayColor:"transparent",onPress:function(){return e.setState({showDateTimeModal:!0,datetime_type:"time"})}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:30}},"\u6642\u9593")),"create"===D&&y.a.createElement(rn.a,{source:n(927),style:{width:32,height:32,alignSelf:"flex-end"}}))),s.map((function(t,r){return y.a.createElement(E.a,{key:r,style:{width:"90%",justifyContent:"center",flexDirection:"row",paddingBottom:10}},y.a.createElement(C.a,{disabled:"read"===D,style:{width:"70%",backgroundColor:"#ffddb7",borderTopLeftRadius:15,borderBottomLeftRadius:15,justifyContent:"center"},underlayColor:"transparent",onPress:function(){return e.setState({showDateTimeModal:!0,datetime_type:"time",time_selected_index:r})}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},fn(t))),y.a.createElement(C.a,{disabled:"read"===D,style:{width:"30%",justifyContent:"center",padding:5,backgroundColor:"#ffddb7",borderBottomRightRadius:15,borderTopRightRadius:15},underlayColor:"transparent",onPress:function(){return e.removeTime(r)}},y.a.createElement(rn.a,{source:n(302),style:{width:32,height:32}})))}))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{padding:15,borderWidth:1,borderColor:"grey",backgroundColor:null!==l&&l?"#ffddb7":"white"},underlayColor:"#ff8944",onPress:function(){return e.setState({before_meal:!l||null})}},y.a.createElement(b.a,{style:{fontSize:25}},"\u9910\u524d")),y.a.createElement(C.a,{disabled:"read"===D,style:{padding:15,borderWidth:1,borderTopWidth:0,borderColor:"grey",backgroundColor:null===l||l?"white":"#ffddb7"},underlayColor:"#ff8944",onPress:function(){return e.setState({before_meal:!1===l&&null})}},y.a.createElement(b.a,{style:{fontSize:25}},"\u9910\u5f8c"))))),y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{width:"100%",justifyContent:"center",backgroundColor:"#00c07f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u85e5\u7269")),y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"white",paddingHorizontal:20}},y.a.createElement(E.a,{style:{backgroundColor:""}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{paddingTop:20,paddingBottom:10},onPress:function(){return e.setState({powder:!u})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:u?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginLeft:10,alignSelf:"center"}},"\u85e5\u7c89    "))),y.a.createElement(C.a,{disabled:"read"===D,style:{paddingTop:20,paddingBottom:10},onPress:function(){return e.setState({powder_refrigerated:!d})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:d?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:5}},"\u9700\u51b7\u85cf"))))),y.a.createElement(E.a,{style:{backgroundColor:""}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{paddingVertical:10},onPress:function(){return e.onSelectSyrup()},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:f.length?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginLeft:10}},"\u85e5\u6c34    "))),f.length&&"read"!==D?y.a.createElement(C.a,{style:{padding:10},onPress:function(){return e.setState({syrup:[].concat(T()(f),[{amount:"",need_refrigerated:!1}])})},underlayColor:"transparent"},y.a.createElement(rn.a,{source:n(928),style:{width:32,height:32}})):null),f.map((function(t,r){return y.a.createElement(E.a,{key:r,style:{flexDirection:"row",alignItems:"center",alignSelf:"center",marginBottom:20}},y.a.createElement(qn.a,{editable:"read"!==D,style:{width:62,fontSize:25},keyboardType:"number-pad",autoFocus:!0,placeholder:"____",value:t.amount,onChangeText:function(t){return e.editSyrupAmountEntry(t,r)}}),y.a.createElement(b.a,{style:{fontSize:25,marginRight:5}},"c.c."),y.a.createElement(C.a,{disabled:"read"===D,style:{padding:5},onPress:function(){return e.editSyrupRefrigerationEntry(!t.need_refrigerated,r)},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:t.need_refrigerated?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:5}},"\u9700\u51b7\u85cf"))),"read"!==D&&y.a.createElement(C.a,{disabled:"read"===D,style:{paddingHorizontal:10},onPress:function(){return e.removeSyrupEntry(r)},underlayColor:"transparent"},y.a.createElement(rn.a,{source:n(302),style:{width:32,height:32}})))}))),y.a.createElement(E.a,{style:{}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{paddingVertical:10},onPress:function(){return e.setState({gel:null===p?"":null})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===p?"white":"#00c07f"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:10}},"\u85e5\u818f"))),null===p?null:y.a.createElement(qn.a,{editable:"read"!==D,style:{flex:1,fontSize:25},autoFocus:!0,placeholder:"\u90e8\u4f4d",value:p,onChangeText:function(t){return e.setState({gel:t})}}))),y.a.createElement(E.a,{style:{}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{paddingVertical:10},onPress:function(){return e.setState({other_type:null===h?"":null})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===h?"white":"#00c07f"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:10}},"\u5176\u4ed6"))),null===h?null:y.a.createElement(qn.a,{editable:"read"!==D,style:{flex:1,fontSize:22,paddingHorizontal:10,paddingTop:3,paddingBottom:5,paddingLeft:0},placeholder:"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...",autoFocus:!0,textAlignVertical:"top",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:h,onChangeText:function(t){return e.setState({other_type:t})}}))))),y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{width:"100%",justifyContent:"center",backgroundColor:"#f4d41f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u5099\u8a3b")),y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"white",padding:20}},y.a.createElement(qn.a,{editable:"read"!==D,style:{height:k,padding:15,fontSize:25},placeholder:"\u9ede\u64ca\u586b\u5beb...",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:m,onChangeText:function(t){return e.setState({note:t})},onChange:function(t){return e.setState({scrollHeight:t.target.scrollHeight})},onLayout:function(t){var n=t.nativeEvent.target.scrollHeight;e.setState({scrollHeight:n})}}))),y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{width:"100%",justifyContent:"center",backgroundColor:"#fa625f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u767c\u71d2\u9935\u85e5")),y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"white",padding:20}},y.a.createElement(E.a,{style:{paddingVertical:10}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:.06*Co,marginHorizontal:10}},"\u767c\u71d2\u8d85\u904e"),y.a.createElement(qn.a,{editable:"read"!==D,style:{width:55,fontSize:25},keyboardType:"number-pad",value:g.temperature,onChangeText:function(t){return e.setState({fever_entry:So(So({},g),{},{temperature:t})})}}),y.a.createElement(b.a,{style:{fontSize:.06*Co}},"\xb0C \u4ee5\u4e0a\u624d\u7528\u85e5")),y.a.createElement(E.a,{style:{backgroundColor:""}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{paddingTop:20,paddingBottom:10},onPress:function(){return e.setState({fever_entry:So(So({},g),{},{powder:!g.powder})})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:g.powder?"#fa625f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginLeft:10}},"\u85e5\u7c89    "))),y.a.createElement(C.a,{disabled:"read"===D,style:{paddingTop:20,paddingBottom:10},onPress:function(){return e.setState({fever_entry:So(So({},g),{},{powder_refrigerated:!g.powder_refrigerated})})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:g.powder_refrigerated?"#fa625f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:5}},"\u9700\u51b7\u85cf"))))),y.a.createElement(E.a,{style:{backgroundColor:""}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{paddingVertical:10},onPress:function(){return e.onSelectFeverSyrup()},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:g.syrup.length?"#fa625f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginLeft:10}},"\u85e5\u6c34    "))),g.syrup.length&&"read"!==D?y.a.createElement(C.a,{style:{padding:10},onPress:function(){return e.setState({fever_entry:So(So({},g),{},{syrup:[].concat(T()(g.syrup),[{amount:"",need_refrigerated:!1}])})})},underlayColor:"transparent"},y.a.createElement(rn.a,{source:n(929),style:{width:32,height:32}})):null),g.syrup.map((function(t,r){return y.a.createElement(E.a,{key:r,style:{flexDirection:"row",alignItems:"center",alignSelf:"center",marginBottom:20}},y.a.createElement(qn.a,{editable:"read"!==D,style:{width:62,fontSize:25},keyboardType:"number-pad",autoFocus:!0,placeholder:"____",value:t.amount,onChangeText:function(t){return e.editFeverSyrupAmountEntry(t,r)}}),y.a.createElement(b.a,{style:{fontSize:25,marginRight:5}},"c.c."),y.a.createElement(C.a,{disabled:"read"===D,style:{padding:5},onPress:function(){return e.editFeverSyrupRefrigerationEntry(!t.need_refrigerated,r)},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:t.need_refrigerated?"#fa625f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:5}},"\u9700\u51b7\u85cf"))),"read"!==D&&y.a.createElement(C.a,{disabled:"read"===D,style:{paddingHorizontal:10},onPress:function(){return e.removeFeverSyrupEntry(r)},underlayColor:"transparent"},y.a.createElement(rn.a,{source:n(302),style:{width:32,height:32}})))}))),y.a.createElement(E.a,{style:{}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{disabled:"read"===D,style:{paddingVertical:10},onPress:function(){return e.setState({fever_entry:So(So({},g),{},{other_type:null===g.other_type?"":null})})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===g.other_type?"white":"#fa625f"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:10}},"\u5176\u4ed6"))),null===g.other_type?null:y.a.createElement(qn.a,{editable:"read"!==D,style:{flex:1,fontSize:22,paddingHorizontal:10,paddingTop:3,paddingBottom:5,paddingLeft:0},placeholder:"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...",autoFocus:!0,textAlignVertical:"top",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:g.other_type,onChangeText:function(t){return e.setState({fever_entry:So(So({},g),{},{other_type:t})})}})))))))),y.a.createElement(E.a,{style:{height:90,width:"100%",paddingHorizontal:20}},"read"===D?y.a.createElement(C.a,{disabled:!this.editable(),style:{width:"100%",height:"70%",backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onPress:function(){return e.onClickConfirm()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center",color:"white"}},"\u7de8\u8f2f")):"edit"===D?y.a.createElement(E.a,{style:{width:"100%",height:"70%",flexDirection:"row"}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.deleteRequestConfirm()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"\u522a\u9664")),y.a.createElement(C.a,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onPress:function(){return e.cancelEdit()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:.06*Co,textAlign:"center",color:"white"}},"\u53d6\u6d88\u7de8\u8f2f")),y.a.createElement(C.a,{style:{flex:1,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.onClickConfirm()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"\u9001\u51fa"))):y.a.createElement(C.a,{style:{width:"100%",height:"70%",backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onPress:function(){return e.onClickConfirm()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:50,textAlign:"center",color:"white"}},"\u9001\u51fa"))))}}]),r}(y.a.Component),ko=Object(D.b)((function(e){return{isConnected:e.parent.isConnected}}))(Do);function xo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Oo=Object(k.c)(si),Ao=Object(vr.a)(),jo=function(e){u()(n,e);var t=xo(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e=this;return y.a.createElement(D.a,{store:Oo},y.a.createElement(br.a,null,y.a.createElement(Ao.Navigator,{initialRouteName:"ParentHome",screenOptions:{gestureEnabled:!0,headerTitleStyle:{fontWeight:"bold",fontSize:30}}},y.a.createElement(Ao.Screen,{name:"ParentHome",component:Wi,initialParams:{parent_id:this.props.parent_id,loadAuth:this.props.loadAuth},options:{title:"\u5bb6\u9577\u9996\u9801",headerRight:function(){return y.a.createElement(C.a,{style:{padding:10,marginRight:20},onPress:function(){return e.props.handleSignOut()}},y.a.createElement(b.a,null,"\u767b\u51fa"))}}}),y.a.createElement(Ao.Screen,{name:"PickupRequest",component:bo,options:{title:"\u63a5\u56de\u544a\u77e5"}}),y.a.createElement(Ao.Screen,{name:"MedicationRequestPage",component:ro,options:{title:"\u6258\u85e5\u55ae"}}),y.a.createElement(Ao.Screen,{name:"AddMedicationRequestPage",component:ko,options:{title:"\u65b0\u589e\u6258\u85e5\u55ae"}}),y.a.createElement(Ao.Screen,{name:"AbsenceExcusePage",component:ho,options:{title:"\u8acb\u5047\u55ae"}}))))}}]),n}(y.a.Component);function Ro(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}var Po=function(e){u()(n,e);var t=Ro(n);function n(e){var r;return i()(this,n),(r=t.call(this,e)).state={code:""},r.confirmCode=r.confirmCode.bind(_()(r)),r}return c()(n,[{key:"confirmCode",value:function(){var e=this;w.a.confirmSignUp(this.props.username,this.state.code).then((function(t){console.log("data: ",t),e.props.getCurrentUser()})).catch((function(e){In.a.alert("Error!",e.message,[{text:"OK",onPress:function(){return console.log("err occured when setting up account for parent(s): ",e)}}])}))}},{key:"render",value:function(){var e=this;return console.log("this.state.code: ",this.state.code),y.a.createElement(le.Container,null,y.a.createElement(le.Content,{keyboardShouldPersistTaps:"always"},y.a.createElement(E.a,{style:{paddingTop:"20%",flexDirection:"row",justifyContent:"space-around",paddingBottom:"15%"}},y.a.createElement(qn.a,{style:{position:"absolute",color:"transparent"},autoFocus:!0,maxLength:6,caretHidden:!0,keyboardType:"numeric",onChangeText:function(t){e.setState({code:t})}}),Array(6).fill(0).map((function(t,n){return y.a.createElement(le.Card,{key:n,style:{width:50,height:50,backgroundColor:"white",borderColor:"black",justifyContent:"center"}},e.state.code.length>n?y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},e.state.code.charAt(n)):y.a.createElement(b.a,null))}))),y.a.createElement(le.Button,{rounded:!0,success:!0,style:{alignSelf:"center"},onPress:this.confirmCode},y.a.createElement(b.a,{style:{paddingHorizontal:5,color:"white"}},"Confirm code"))))}}]),n}(y.a.Component),To=(ue.a.create({input:{borderColor:"black",borderWidth:1}}),Po);function Io(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}n(221).a.ignoreWarnings(["Non-serializable values were found in the navigation state"]);var zo=function(e){u()(r,e);var t=Io(r);function r(e){var n;return i()(this,r),(n=t.call(this,e)).state={status:"",id:"",username:""},n.getCurrentUser=n.getCurrentUser.bind(_()(n)),n}return c()(r,[{key:"componentDidMount",value:function(){return a.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.awrap(S.b({Roboto:n(930),Roboto_medium:n(931)}));case 2:this.getCurrentUser();case 3:case"end":return e.stop()}}),null,this,null,Promise)}},{key:"getCurrentUser",value:function(){var e=this;this.setState({status:"loading"}),w.a.currentAuthenticatedUser().then((function(t){console.log(t.username),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+an+"/user?username="+t.username,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(n){var r=n.statusCode,a=(n.message,n.data);200===r?e.setState({status:a.role,id:a.id,username:t.username}):e.setState({status:"signedout"})})).catch((function(t){console.log("err: ",t),e.setState({status:"signedout"})}))})).catch((function(t){"not authenticated"==t&&e.setState({status:"signedout"}),e.setState({status:"signedout"})}))}},{key:"changeAuthState",value:function(e,t){this.setState({status:e,username:t})}},{key:"handleSignOut",value:function(){var e=this;w.a.signOut().then((function(){e.getCurrentUser()})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this;console.log("ENV: ",an);var t=this.state,n=t.status,r=t.username;return console.log("status: ",n),y.a.createElement(E.a,{style:{flex:1}},n.includes("parent")?y.a.createElement(jo,{parent_id:this.state.id,handleSignOut:function(){return e.handleSignOut()}}):"school"===n?y.a.createElement(Vs,{school_id:this.state.id,school_name:r,handleSignOut:function(){return e.handleSignOut()}}):"ConfirmSignUpPage"===n?y.a.createElement(To,{getCurrentUser:this.getCurrentUser,username:this.state.username}):"signedout"===n||"school"===n?y.a.createElement(Js,{loadAuth:this.getCurrentUser,changeAuthState:function(t,n){return e.changeAuthState(t,n)}}):y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,null,"Loading..."),y.a.createElement(v.a,{size:"large"})))}}]),r}(y.a.Component),Lo=n(541),Fo={identityPooId:"us-east-1:0a3c861f-48ca-4832-af57-28b4209e695e",region:"us-east-1",userPoolId:"us-east-1_QlbPkQ8Ds",userPoolWebClientId:"6maqsbp3gi2vj0tid4akmoiat6"},Mo=n(339),Bo=n(1291);function qo(e){var t=0;if("undefined"===typeof Symbol||null==e["function"===typeof Symbol?Symbol.iterator:"@@iterator"]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"===typeof e)return No(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return No(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e["function"===typeof Symbol?Symbol.iterator:"@@iterator"]()).next.bind(t)}function No(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Uo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h()(e);if(t){var a=h()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return f()(this,n)}}Lo.a.configure(Fo);var Ho=function(e){u()(r,e);var t=Uo(r);function r(e){var s;return i()(this,r),(s=t.call(this,e))._cacheSplashResourcesAsync=function(){var e;return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n(1257),t.abrupt("return",Bo.a.fromModule(e).downloadAsync());case 2:case"end":return t.stop()}}),null,null,null,Promise)},s._cacheResourcesAsync=function(){var e,t;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return Mo.a.hide(),e=[n(452)],t=e.map((function(e){return Bo.a.fromModule(e).downloadAsync()})),r.next=5,a.a.awrap(Promise.all(t));case 5:s.setState({isAppReady:!0});case 6:case"end":return r.stop()}}),null,null,null,Promise)},s.state={isSplashReady:!1,isAppReady:!1},Mo.a.preventAutoHide(),s}return c()(r,[{key:"componentDidMount",value:function(){this.forceSWupdate()}},{key:"forceSWupdate",value:function(){console.log("forceSWupdate: "),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then((function(e){for(var t,n=qo(e);!(t=n()).done;){var r=t.value;console.log("registration: ",r)}}))}},{key:"render",value:function(){return y.a.createElement(zo,null)}}]),r}(y.a.Component);b.a.defaultProps=b.a.defaultProps||{},b.a.defaultProps.allowFontScaling=!1,qn.a.defaultProps=qn.a.defaultProps||{},qn.a.defaultProps.allowFontScaling=!1},563:function(e,t,n){e.exports=n(564)},70:function(e,t,n){e.exports=n.p+"static/media/icon-thumbnail.f8c9cedd.png"},817:function(e,t,n){e.exports=n.p+"static/media/icon-checked-box.add46308.png"},818:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsSAAALEgHS3X78AAACN0lEQVR42u3dv28ScRzG8efbKkPLdcPE6OKPja2QuiqjCxCjf4FJdz0lcbrN0KK7iX/BxdTDoaOG0VK6uVWHpumikx4O1vBxqDFRcgmed9TA+zWXkjzv+wHLIQEAAAAAAGBeuCz+STkIC0teqenM6pJblXRR0vKMbTWUdCjZnpmir8NP0bvgzrdTD3DtyetbZgsbkl2es4P3vcke9v3a1qkEuB2GiwcHpbZJ9+f5EmKmTn/YaykIRmlev5D2jRn/5xHs5K8Vrz+e6hlwctlxL7iF/qa549+Icj8DykFYMHNt9h7ztByEhdwDLHmlpqQr7D3m0rJ3rp7/PcDUYOvEO3L+AZxUYelE1Wl8CjrPzoku/O0LzqR4k+Ikf7R9d3Wmlr35fC+zbTL5HoBsEIAABAABCAACEAAEIAAIQAAQgAAgAAFAAAKAAAQAAQgAAhAABCAACEAAEIAAIAABQAACgAAEAAEIAAIQAAQgAAhAABCAACAAAUAAAoAA/7c0z4yLNcGz0SZ8xtqMcZ+ncAa4I47bhGVkR1MIMBowdQLTbu4BzBSxdOIp0M09wGhl5aWkfdYeW/9DHH98lXuAwXr12GQtBv9jfhvdS/OTJqk+hvb92paZOsz+69LTfvug1k3z0tTfA/rDXkuyTdZ3Gztfeo/St/tHa503DUmbkq7O2fL7zsxPe+RnFkCSKs92zy7GcUNmdSdV7ORnrIozNnjspEOTBk6Kvnted7BePeYKAAAAAAAAgEn9AI63ihVnDPNHAAAAAElFTkSuQmCC"},882:function(e,t,n){e.exports=n.p+"static/media/icon-medication-powder.ea8d7086.png"},883:function(e,t,n){e.exports=n.p+"static/media/icon-medication-syrup.a7ee612b.png"},884:function(e,t,n){e.exports=n.p+"static/media/icon-medication-gel.12878684.png"},885:function(e,t,n){e.exports=n.p+"static/media/icon-medication-pill.b0c168c9.png"},915:function(e,t,n){e.exports=n.p+"static/media/icon-wellness.8e4dfdb5.png"},916:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAC2UlEQVRo3u2Xv24TQRDGv9mzHdt3tmMHCiQiJNqYylBAwRMgurwBSoNooKG0y4gyosk78BRI0IQulihxEiRiXETIh2WMdygSoZx3cv98ZA/J293c7ml++30zuwesxmosNSjpAv5wu+LXnZ8A4LUHBADjwzssPbs/5lV6dDIRv9PfKvnwX4L5udcebKYFKCRdMHF5I/bcKloAvhrJH3SKPo/eAXiyrAIq6QJN1Iw9V6Elxcfl0dsskk8FwFTYWGauf7j5gIBnWdWASr6EW8vMZaJXaWovMwBFaKWdO+zf9AB6mmUXSmEhuhF7LoIFX9WVh2BUrAKA0Uzw+aBaSnWyPgeSA1D8NsoLNcDMd60DUAIFFII1QMAt6wBMSKCAUfAV+xYCxW+jREFY5qJ9AI5fA8Y5QJhkDVBILgCa4IsrwcWl7e8VYeEZRg2QzzlQoBeflXcXQt+sW8hrH+0C/Dra/tx1t456C4fgcQ6K+ByCmXpXi0S9xeQv2tIgFwAAULv3pSspQcTd83diD+5b/yML5LO9XZrVqtPLsWJhrUT7+zNx/kGn6JdHYwCloKIDunYFAAD1umfEnLF35W7d/zQD8DkXFgKAidauEZuRG97E+GNuABznt7HbDlQt1LOK3ucGgDTcOLEgoJMpQGEpAOV4rHnxthoKUH7zeDhTwTX8or5Ge3vT61dgrj0TSnnhW1ZoGLGzs4YVC82FZOeaQwGm9MtIduo4dgCI2RUUCLWQmikjWaXmdgBAwm5HKEBKN8zTW9lSQOhCFA6gQUaymsgOgIZpFykWBDSTpTlbUgDmbke1UWghWVsKgAW7RFiIhWQZWLcDIHccN6Ju1gUl7SjAggIMeBGVLyVrqwZIqgEv4gekIZwnlmoA5kEGCrcQC3Zha0Us28WL0C1PFkoDgPwAsNxx3P8GIJ2FUM+ThU6F8GnEmu9CeGjrKrFDwMml0DER7WS9ZjVW4x+OPysh2phhVbaOAAAAAElFTkSuQmCC"},917:function(e,t,n){e.exports=n.p+"static/media/icon-milk.02c27d2c.png"},918:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0UlEQVRo3u2YwQnCQBBF/wQL0GMwdmAFWoJ9iAUJbprJSTvwpBcFIVc7GC8iRBNBRbIJ753CJId5mRmYXQkAIBp8o50HuQdtu5JbUvnKNLs/zaP7uw25JV3vGgQQ+JFB49QHORVoswK2kjVV5fndv+PvOoIhRgABBBBAAAEEWOZqOBXlwmS55ONH8JBKks5FWV2s/hu/uGupY/pZBUwKleTbIzNT/k0LZRF1yoQhjhVrOvVc93ElOpzWnxZpIQQQ6OsqMVq/3s20CfdCCAAA9JIb9gROYBxbOFYAAAAASUVORK5CYII="},919:function(e,t,n){e.exports=n.p+"static/media/icon-diaper.236e3240.png"},920:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABvklEQVRo3u2ZO0sDQRSFv1lFfGBg7SysLC20T62CIFb+D8EmhWUsxf+hpYUEtRBMZyCFQewCihZGQuIjMdmZa2MKQx6smSVZMqe9LHPPnHP37OyAg4NDrKHCPiCZnSW0OUaxAczbbki+azSKBUz5FXTwLnClIZVI8zAwAcnsLGFMHliIYjflu0Y9f40EzfZSWQmrs4c8the8UCtocxxV8wCNYqFT8wC+eBx1KnghDbcRpZ9N+bWHPGwOTiACz//pUQe9ygkbBEYOjsCwMTlKzcylw+eSFQJB4SzcoivbzkJWFbC5o3GagReEHErlEJPDm7qNm4WmUfggPuBDc2FoCvQb4i4W84EkkEQpkP99HY/KEGdR3vpYDvGoKJBEzIXLAZfELomjVkCbZZTaA7LxPA9MejMIv8kZRwsJd63ItJDEbohdErszMbwAN6Au0frSKTAELAK7ILtMeP86D3Qk8HnQ4V0JfGXPBup2Nrnthng8CCh4j2KxPn+fK9YICFxFQcBUSr3KGWsENKSAsm0CzeJ9txuYNyTYt0YgkeZBCasoToGqNQVqH9Tz1+jSc8tOVeAECdbU1vkTDg4O44cfoDWTjXIjQSwAAAAASUVORK5CYII="},921:function(e,t,n){e.exports=n.p+"static/media/icon-babies.a7fc62df.png"},922:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAACTklEQVRo3u2Zz2sTQRzFPzO7KbSaUkOjUAwIFQsipDnlD6hEqQd/FEoPFSke9FSkXuJJ8NZDTHuu1EtCxYL2YH9Y2j/AWw+5LNaTEay/ohUvNrvroWlcY6KB3U1SMu+0OzM7M2/ee18WBhSaC+HHpKmFpYhmmWlskSg1bWBr9+5cv2y0PIHUwlJEM60tIFTR9UViRyfHR/Jerie9JqBZZhoICVi2zOJJiR0BVoGQhXjo9XqeEziwjcC+PXVj9N3k+Eje1OStUu8Fr5fT6xmUGJuIIGXaQiQEBA/aLw0P1/zm/cdPUSAPsLPzIdbX2wvQPZN5ZleOXV5Z+c0fvoPY1KWZXMvMG64zkBibiNhSq+bpfxLYK+79LBS+XisKoYV7ehYDut5Ra6yTgAMFYZnR9SeP37pTQMp0tc3/DwE90HE8HH7hwh3HbKmngFFXBEq2AWDmfpKzZ/rLfbPZ5574eD07V37OGdtMPZim3szIOjxW9rxz8wBHuzpdbz5YMce5gdPOitDtaxUaisdckQh2dTIUj/lfhWrhVN8Jbl692NRfCckhhyLQbOheTfTjfPyP9yMbr/4as2W8qfrt4EC/UqAhcHPSvhCotE2tvmp2OpQKqAyoDFTA6e16yqjKgMpAnXZqZAbaW4Fanm5kdWpvBfzwtFJAZUBlQCmgMqAy0FYKKAItT2D/zmofOWPb9w3ljNfO128ehFhsgn0FcN6cNAaCl64V0KWZBApNcMdnHe66JrCWmTeEZUZBLILYbcCx7yJ4qgsGV7OP8ii0OH4Bz96jqU9mE24AAAAASUVORK5CYII="},923:function(e,t,n){e.exports=n.p+"static/media/icon-checked.83ee9de4.png"},924:function(e,t,n){e.exports=n.p+"static/media/icon-morningreminder.9cb15f85.png"},925:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABqUlEQVRo3u2Zu1LDMBBF7zJ0JC215Zq/YgYGjKHkzSQhEEogWG7gq+jjPq1My1IkgUxwg61dO4PvB3jO0eqxkoE2bdq0+XOYySRubKyLqn6KaoFP8zGACAADiLPDblL2cxvq8DZ/nsMvBrBSJTbVR56wCksE7DS7AjP4p6WRX87rZNqJmiswmzaPAOIi+Gza2UePPhsrEKYfIxCOJeDFd6HQ5g8MPpWCF61AkOQjaXixXSiw+T2Bz6ThRabQHP5cA967gLHuDsCFFrzXNWBSN9SG91YBk7ohGJfa8F4EjHW3AK7qgK88hUziBnXCV6qASdwAhOs64UtXILSu3wT4UgJh4noM3DQB3nMrQfq3u7JrILSuX1wFesumW3uaVRBYxLoSlcreBAnBg0xHQriVkJfwtnPUJaHUTstJKF5oZCREDh9NCbHTM0jyEVHRvdivRE3PKv4kxPsXaQn5BmzxtFj4OlddQqeD/HncjX1L6LxOE3F20DkBUPAjg3fD7XwNfnDMJGIwXlYNwHhv9hT6PZ2+fzER42gSdS3WKswUWGeD1O2jTZs2/ztfAkobJARJpfUAAAAASUVORK5CYII="},926:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABwklEQVRo3u1ZQVLCQBDs4Rxz9UryBat8EQIJRakIeOUqImBhElT8kW9gveIR9sx4pYRAyiRbEyt93UrSne6ZnWyAEiVKFBqU9gZOuK6B6FKtrCYGtC2UACdc1wB6BVABsFDfVsO0iEpG5AGg5pzrOZipEAIIdLF3PePKifTMpIi/P4iZnEjPALQOrL4pz2qCiGUXsQARlXTyiZVntQEEB1br7lxP8o5TJb2H8SKYce1Geix6H0gSJwKmS//sVqYDSZwAbqrReizbgQROMPHky7M7sgWc7E48Vr59Jy9CibsTdZxgPZLtQBInmJ9Uy+7KFnA6TiPl2z15EUoep64T6qFsBxI5QY/Kt/oyHUjkBPfcSD/IFnBy7OC+G2wGsgXsfEwUo40eqoO5fgHD3zeHhkvPupddxDHk0xQxFZm8mRo4Sp5HacibGSXiyIsfJQyQz3ecjo9NpuM0mSQv/4PGMPlsu9CxTQqY5kE+OwdOkM/rRCIbB46OB3heelYHOYLy6zZmjhapyORTRciNdBhDPjBFPpUAZv4EsP3l57vyrLYp8qkEqJb9Aeb6joiFWpl785mhGm0a1XATmv61VKJEiX+CH053J36ap3UTAAAAAElFTkSuQmCC"},927:function(e,t,n){e.exports=n.p+"static/media/icon-plus.e319f13c.png"},928:function(e,t,n){e.exports=n.p+"static/media/icon-plus-green.128442cf.png"},929:function(e,t,n){e.exports=n.p+"static/media/icon-plus-red.4fa4cf94.png"}},[[563,1,2]]]);
//# sourceMappingURL=app.cbada39e.chunk.js.map