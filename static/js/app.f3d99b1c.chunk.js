(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{1277:function(e,t,n){e.exports=n.p+"static/media/app-splash.0a3ec935.gif"},152:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsSAAALEgHS3X78AAACi0lEQVR42u3dsWsTYRjH8d97aRKJ6eDkIlXBScFFN3GzLnYNiBQjaSp0UJdi1+Cklg6KUi2xia0VJGPbRVcdHVx0ERRxcXIoSnqX3ONQERRbWk3Svtfv9w9ILve5e98ny51EREREREREtJtyvfqi1dHiMddWWaZBOR2StHeHnYtvMn1UoOcWB9VsrfY2EQBWKGSifG5KTmOSUp5cmG1J99N92XE3MxN5C2CFQibqzy1LOuPl+mB6kU5nz3UTIejm8Uf53JS3J3/t8hyMonDSyzvg55r/xqNlZ71aFsTHs9X5d17dAa7lRhNw8iWpz8Wpsn9LkLPB5AyLdtbHPWAgQeP6QR8B8gkC6PdyCiIAACAAACAAACAAACAAACAAACAAACAAACAAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACAAACgt5lJS052WoFOSjavtUfOe1efZ8cbSvbMLHXzjxcsXGyODN8ILHVF0mVJe3z5QV17enpYKloHP25FUq0VtCZz1YXPG94a5fL+MG6NOdlVSfs6dQCZ2cduNwJ8MbkHmWx4x00//bqlNapU6o9cq+TMjZt0AICt9V7O7qXbwUNXrzf/a7NYe4vHeUkTko7uNICdtge8lnQ3vfJ9wTUaHdlUXaMRSpozaX515NJQYDYh6RSb8O8TzXIgu5WenXvZxc3O9Ki+KGkxLBdPKLZrkrugbX7JxHYuQetNND2rOTJ8ZLOTU5L2gE1PND27BTcxOSUB4J8nmp5BbDA5+QzQsYmmZxB/mZx8nIJexdLt7MDhJVepxD793f41OVUqT1Y/fRgKpOsiIiIiIiIiog70A/W73/uabAUFAAAAAElFTkSuQmCC"},219:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAB4UlEQVRo3u2YvUvDQBiHf++dGYuLoKJDB4sfuCnEDmprrX+0iikiqOAoOOioUKxLzeAHvTsXBZHY3CXvRcX7jcnl8jzJm+TNASEhISEhIZZJO/HKsBs3fM0/bDUX0k684nKMsB34uLe2RDCHUpvjdHdjmR2+GzekVD2CSdK99VXb48gWXih5BGD2fVPfkNipHZ5dscFrkwCYe990b6Tu1PYvLksLZMCDUyIDHi4SuSUUvUbPAF4yds2Q0UdlymkMPABo6AnFUkJPrY26kjoBUM/YXehO5MBbz0m2J+SU4IJ3EuCS4IR3FigrwQ1fSKCohA/4wgKuEr7gSwnYSmgyI1/wpQVyJQgDGGgA0z7gWQQs7gR8wbMJOEqw9lFsAh8SI6lPKLveYYAHkNjigndqp23yGplIGMhKrha3wMer0hBmxgybKtsAerkoOe95r8+B8ApvMADQ99GKswjkfmGF2FZKbgK49SVB3uA/txKt5oKUKgEw/ytaiSK9jS8JqgLepwRVBf9FosfV3Ikq4QFgsnd6owS1AdxxPNhUJfyP/NT7/BnhmDu3hGikxDfjSn9NJw/Or8eUk4AYSZ6lxfb6ohAi+ZNLixkSxAmfIRHZwjvH+/J6N264Lq+HhISEhPzvvAH4usfGrPqHIQAAAABJRU5ErkJggg=="},273:function(e,t){},301:function(e,t,n){e.exports=n.p+"static/media/icon-teacher-thumbnail.0693cca6.png"},303:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABqUlEQVRo3u2Zu1LDMBBF7zJ0JC215Zq/YgYGjKHkzSQhEEogWG7gq+jjPq1My1IkgUxwg61dO4PvB3jO0eqxkoE2bdq0+XOYySRubKyLqn6KaoFP8zGACAADiLPDblL2cxvq8DZ/nsMvBrBSJTbVR56wCksE7DS7AjP4p6WRX87rZNqJmiswmzaPAOIi+Gza2UePPhsrEKYfIxCOJeDFd6HQ5g8MPpWCF61AkOQjaXixXSiw+T2Bz6ThRabQHP5cA967gLHuDsCFFrzXNWBSN9SG91YBk7ohGJfa8F4EjHW3AK7qgK88hUziBnXCV6qASdwAhOs64UtXILSu3wT4UgJh4noM3DQB3nMrQfq3u7JrILSuX1wFesumW3uaVRBYxLoSlcreBAnBg0xHQriVkJfwtnPUJaHUTstJKF5oZCREDh9NCbHTM0jyEVHRvdivRE3PKv4kxPsXaQn5BmzxtFj4OlddQqeD/HncjX1L6LxOE3F20DkBUPAjg3fD7XwNfnDMJGIwXlYNwHhv9hT6PZ2+fzER42gSdS3WKswUWGeD1O2jTZs2/ztfAkobJARJpfUAAAAASUVORK5CYII="},304:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABwklEQVRo3u1ZQVLCQBDs4Rxz9UryBat8EQIJRakIeOUqImBhElT8kW9gveIR9sx4pYRAyiRbEyt93UrSne6ZnWyAEiVKFBqU9gZOuK6B6FKtrCYGtC2UACdc1wB6BVABsFDfVsO0iEpG5AGg5pzrOZipEAIIdLF3PePKifTMpIi/P4iZnEjPALQOrL4pz2qCiGUXsQARlXTyiZVntQEEB1br7lxP8o5TJb2H8SKYce1Geix6H0gSJwKmS//sVqYDSZwAbqrReizbgQROMPHky7M7sgWc7E48Vr59Jy9CibsTdZxgPZLtQBInmJ9Uy+7KFnA6TiPl2z15EUoep64T6qFsBxI5QY/Kt/oyHUjkBPfcSD/IFnBy7OC+G2wGsgXsfEwUo40eqoO5fgHD3zeHhkvPupddxDHk0xQxFZm8mRo4Sp5HacibGSXiyIsfJQyQz3ecjo9NpuM0mSQv/4PGMPlsu9CxTQqY5kE+OwdOkM/rRCIbB46OB3heelYHOYLy6zZmjhapyORTRciNdBhDPjBFPpUAZv4EsP3l57vyrLYp8qkEqJb9Aeb6joiFWpl785mhGm0a1XATmv61VKJEiX+CH053J36ap3UTAAAAAElFTkSuQmCC"},444:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsSAAALEgHS3X78AAACQUlEQVR42u1bbW7CMAx9TIhb7CKM/R87yI4y2BF2HWgvsgLHoPuTSihLGtv5aNP5SREsJHbixvZzYIBCoVAoFC5sAHwBuAHoK21XAEezFzaOFW/cbgeJAa5m8rbiU7x7OAlsDNarHaP7ePrvgU4NIJjzDqAjBJ4OwP5hXusY03g+bxLoy+Y7lMUM7cchz24Dzg99pwT6omOZbyJVoD0u9HdsMBatV2NAAhk+3+WejJ4oh6sveQwIbcA37sxkb7H6SC6wChjANcbu7z0y+4AOrnypvtF1pHCBxnrKuVFMX+os0FqL57pYlvWuCwbcreNJzrrWyEWExqK6K7jNjgjtjSLKYt4sfz2N6Ok9TFCqL5sBiparWg7PkAlKmVjI12PliJihxAB3z3tuFoAwn4/pfJnSN0P1PlVeK3yyxahwaDyE1JgqJ5a6Zw+CK4bRSsiZTRBcTBYIBUFuOcstb32xYnKCwq33OY3KIPsE+8jG0HLfAeqd4NRBkJq/Y+4AJbGiWBC8B8Y2Qga3Zcahaqo0btbQanAuMSD2uzpq/uZ+f9CmJmapr8So+ZvLEaLSYPLqSjBfGgOSGGC9IHdOfstMtWjLrP+lLpCbWUYfYeqRPAe4fujz6g2Q+oRSmWc2A/h+2TGFAWadBVx5OqavujTompeyr1g5fGHc7HQT1BIsSHjAB4BvAM+BcZ0ZO5anY/t2S6gGJz0hWg2qAfy4mdddxft7Na+in8sfsJx/mPiUGGBjjHCteOMXs/kNFAqFQqH4g1+9qDy6b2x6HAAAAABJRU5ErkJggg=="},460:function(e,t,n){e.exports=n.p+"static/media/app_logo.fee19d58.png"},461:function(e,t,n){e.exports=n.p+"static/media/icon-checked.83ee9de4.png"},462:function(e,t,n){e.exports=n.p+"static/media/icon-plus.e319f13c.png"},551:function(e,t,n){"use strict";n.d(t,"a",(function(){return Ec}));var a=n(4),r=n.n(a),s=n(6),i=n.n(s),o=n(8),c=n.n(o),l=n(9),u=n.n(l),d=n(10),f=n.n(d),p=n(5),h=n.n(p),m=n(0),y=n.n(m),g=n(16),_=n.n(g),E=n(1),b=n(3),v=n(155),S=n(174),w=n(57),C=n(12),k=n(26),D=n(32),x=n(7),A=n.n(x);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j={class_id:"",passcodeTeacherId:{},teachers:{},students:{},isConnected:!1,errMessage:""};var T=n(21),P=n.n(T);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L={initialized:!1,present:new Set,absent:new Set,unmarked:new Set,attendance:{}};function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N={loaded:!1,fruit_name:"\u6c34\u679c",ratings:{},updatedStudents:new Set,err_message:"",data_dispatched:!0};function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K={by_student_id:{},records:{by_id:{},all_id:new Set},errorMessage:"",newDataForCreate:new Set,oldDataForEdit:new Set,records_with_error:new Set,data_dispatched:!0};function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J={by_student_id:{},records:{},record_id_for_update:new Set,errMessage:"",records_with_error:new Set,data_dispatched:!0};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z={loaded:!1,by_student_id:{},records:{by_id:{},all_id:new Set},newDataForCreate:new Set,oldDataForEdit:new Set,dataForRemoval:new Set,errMessage:"",data_dispatched:!0};function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te={by_student_id:{},records:{by_id:{},all_id:[]},all_dispatched:!0,data_to_update:[],new_data_for_create:new Set,old_data_for_edit:new Set,err_message:"",data_dispatched:!0};function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re={message_by_student_id:{},for_all:{text:""},student_id_for_update:new Set,data_dispatched:!0,parent_messages:{}};function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe={isConnected:!0,classes:{},pick_up_request:[],admin_passcode:"",viewing_status:"",passcodeAdminId:{},passcodeTeacherId:{},teacherOnDuty:"",teachers:{},students:{},attendance:{},student_present:new Set,student_absent:new Set,student_unmarked:new Set,teacher_present:new Set,teacher_absent:new Set,teacher_unmarked:new Set};var ce=Object(D.b)({classInfo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0,n=R({},e);switch(t.type){case"SET_CONNECT_STATE":var a=t.isConnected;return R(R({},e),{},{isConnected:a});case"INITIALIZE_CLASS":var r={},s={};return t.teacher_objs.forEach((function(t){r[t[0]]={name:t[1],passcode:t[2],logged_in:!1,in_time:"",out_time:""},e.passcodeTeacherId[t[2]]=t[0]})),t.students.forEach((function(e){var t=e.id,n=e.name,a=e.profile_picture,r=e.blood_type,i=e.address,o=e.home_phone,c=e.father_phone,l=e.mother_phone,u=e.conversation_id;s[t]={name:n,profile_picture:a,blood_type:r,address:i,home_phone:o,father_phone:c,mother_phone:l,conversation_id:u}})),R(R({},e),{},{passcodeTeacherId:e.passcodeTeacherId,teachers:r,students:s});case"SET_CLASS_ID":return R(R({},e),{},{class_id:t.class_id});case"FETCH_ATTENDANCE_SUCCESS":var i=t.data;return i.forEach((function(t){var a=t.attendance_id,r=t.teacher_id,s=t.in_time;n.teachers[r]=R(R({},e.teachers[r]),{},{logged_in:!0,attendance_id:a,in_time:s})})),n;case"MARK_TEACHER_LOGGED_IN":var o=t.teacher_id,c=t.time,l=t.attendance_id;return n.teachers[o]=R(R({},e.teachers[o]),{},{logged_in:!0,in_time:c,attendance_id:l}),n;case"MARK_TEACHER_LOGGED_OUT":var u=t.teacher_id,d=t.time;return n.teachers[u]=R(R({},e.teachers[u]),{},{logged_in:!1,out_time:d,attendance_id:""}),n;case"MARK_STAFF_ATTENDANCE_FAIL":var f=t.errMessage;return{errMessage:f};case"CLEAR_STATE":return{class_id:"",passcodeTeacherId:{},teachers:{},students:{},isConnected:!1,errMessage:""};default:return e}},attendance:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAKR_DISMISS":return z(z({},e),{},{attendance:z(z({},e.attendance),{},A()({},t.student_id,z(z({},e.attendance[t.student_id]),{},{present:!1,out_time:t.out_time})))});case"MARK_ABSENT":return e.unmarked.delete(t.student_id),z(z({},e),{},{absent:new Set([].concat(P()(e.absent),[t.student_id])),unmarked:e.unmarked,attendance:z(z({},e.attendance),{},A()({},t.student_id,z(z({},e.attendance[t.student_id]),{},{excuse_type:t.excuse_type})))});case"CLEAR_STATE":return{initialized:!1,present:new Set,absent:new Set,unmarked:new Set,attendance:{}};default:return e}},medicationrequests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{requests:{},unfinished:[],finished:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_REQUESTS":var n=t.requests,a=t.finished,r=t.unfinished;return F(F({},e),{},{requests:n,finished:a,unfinished:r});case"FILL_MED_REQUEST":var s=F({},e),i=e.unfinished,o=[];s.requests[t.request_id].administered=!0,s.finished=[].concat(P()(e.finished),[t.request_id]);for(var c=0;c<i.length;c++)i[c]!==t.request_id&&o.push(i[c]);return s.unfinished=o,s;case"CLEAR_STATE":return{requests:{},unfinished:[],finished:[]};default:return e}},appetite:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]={Breakfast:"0",Fruit:"0",Lunch:"0",Snack:"0",teacher_id:""}})),q(q({},e),{},{ratings:n});case"FETCH_CLASS_APPETITE_DATA":var a=t.fruit_name,r=t.ratings;return q(q({},e),{},{fruit_name:a,ratings:q(q({},e.ratings),r)});case"EDIT_FRUIT_NAME":var s=t.fruit_name;return q(q({},e),{},{fruit_name:s});case"RATE_APPETITE":var i,o=t.student_id,c=t.mealType,l=t.rating,u=t.teacher_id,d=e.updatedStudents,f=e.ratings[o][c].slice(-1);return""!==l&&(d=new Set([].concat(P()(e.updatedStudents),[o]))),q(q({},e),{},{ratings:q(q({},e.ratings),{},A()({},o,q(q({},e.ratings[o]),{},(i={},A()(i,c,l+f),A()(i,"teacher_id",u),i)))),updatedStudents:d,data_dispatched:!1});case"CLEAR_RATINGS":for(var p=t.meal_type,h=q({},e),m=Object.keys(e.ratings),y=new Set,g=0;g<m.length;g++){var _=m[g];"0"!==e.ratings[_][p]&&y.add(_),h.ratings[_]=q(q({},e.ratings[_]),{},A()({},p,"0"))}return h.updatedStudents=y,h.data_dispatched=!1,h;case"SET_ALL_RATINGS_TO_GREAT":var E=t.students_to_display,b=t.mealType,v=t.teacher_id,S=new Set(P()(e.updatedStudents)),w=q({},e.ratings);return E.map((function(t){var n;S.add(t);var a="1"===e.ratings[t][b].slice(-1);w[t]=q(q({},e.ratings[t]),{},(n={},A()(n,b,a?"\u80c3\u53e3\u4f731":"\u80c3\u53e3\u4f730"),A()(n,"teacher_id",v),n))})),q(q({},e),{},{ratings:w,updatedStudents:S,data_dispatched:!1});case"MARK_WATER_DRANK":var C,k=t.student_id,D=t.meal_type,x=t.teacher_id,O=new Set([].concat(P()(e.updatedStudents),[k])),R=e.ratings[k][D],j="1"===R.slice(-1);return q(q({},e),{},{ratings:q(q({},e.ratings),{},A()({},k,q(q({},e.ratings[k]),{},(C={},A()(C,D,j?R.slice(0,-1)+"0":R.slice(0,-1)+"1"),A()(C,"teacher_id",x),C)))),updatedStudents:O,data_dispatched:!1});case"SET_ALL_DRINK_WATER":var T=t.mealType,I=t.students_to_display,z=t.teacher_id,L=new Set(P()(I));w=q({},e.ratings);return I.forEach((function(t){var n,a=e.ratings[t][T].slice(0,-1);a+="1",w[t]=q(q({},e.ratings[t]),{},(n={},A()(n,T,a),A()(n,"teacher_id",z),n))})),q(q({},e),{},{ratings:w,updatedStudents:L,data_dispatched:!1});case"CLEAR_UPDATED_STUDENTS":return q(q({},e),{},{updatedStudents:new Set});case"ON_SEND_APPETITE_SUCCESS":return q(q({},e),{},{updatedStudents:new Set,data_dispatched:!0});case"ALERT_ERR_MESSAGE":var M=t.err_message;return q(q({},e),{},{err_message:M});case"CLEAR_ERR_MESSAGE":return q(q({},e),{},{err_message:""});case"ADD_STUDENT_ID_FOR_UPDATE":var F=t.student_id_array;return q(q({},e),{},{updatedStudents:new Set([].concat(P()(e.updatedStudents),P()(F))),data_dispatched:!1});case"CLEAR_STATE":return{loaded:!1,fruit_name:"\u6c34\u679c",ratings:{},updatedStudents:new Set,err_message:"",data_dispatched:!0};default:return e}},water:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{byId:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){n[e[0]]=[]})),{byId:n};case"ADD_WATER_RECORD":return e.byId[t.student_id].includes(t.time)||e.byId[t.student_id].push(t.time),H({},e);default:return e}},sleep:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]=[]})),V(V({},e),{},{by_student_id:n});case"FETCH_CLASS_SLEEP_DATA":var a=t.sleepData,r=a.by_student_id,s=a.records;return V(V({},e),{},{by_student_id:V({},r),records:{by_id:V({},s.by_id),all_id:new Set(P()(s.all_id))}});case"SET_SLEEP_TIME":var i=V({},e),o=t.student_id,c=t.index,l=t.sleep_time,u=t.teacher_id,d=i.by_student_id[o],f=d[c],p=i.records.by_id;if(l.setSeconds(0,0),null!==c){if(c>0&&l<=p[d[c-1]].sleep_time){for(var h=i.by_student_id[o],m=h.splice(c,1),y=0,g=0;g<h.length-1;g++)if(p[h[g]].sleep_time>l){y=g;break}h.splice(y,0,m[0]),i.by_student_id[o]=h}i.records.by_id[f].sleep_time=l,i.records.by_id[f].teacher_id=u,i.newDataForCreate.has(f)||i.oldDataForEdit.add(f)}else{var _=i.records.all_id.size;i.by_student_id[o].push(_),i.records.by_id[_]={student_id:o,sleep_time:l,wake_time:null,teacher_id:u},i.records.all_id.add(_),i.errorMessage="",i.newDataForCreate.add(_)}return i.data_dispatched=!1,i;case"SET_WAKE_TIME":var E=V({},e),b=t.student_id,v=t.index,S=t.wake_time,w=t.teacher_id,C=E.by_student_id[b][v];return S.setSeconds(0,0),E.records.by_id[C].wake_time=S,E.records.by_id[C].teacher_id=w,E.errorMessage="",E.newDataForCreate.has(C)||E.oldDataForEdit.add(C),E.data_dispatched=!1,E;case"REMOVE_WAKE_TIME":var k=t.record_id,D=t.teacher_id,x=V({},e),O=new Set(P()(e.records_with_error));return O.delete(k),x.records_with_error=O,x.records.by_id[k].wake_time=null,x.records.by_id[k].teacher_id=D,x.newDataForCreate.has(k)||x.oldDataForEdit.add(k),x.data_dispatched=!1,x;case"CREATE_SLEEP_RECORD_SUCCESS":return V(V({},e),{},{newDataForCreate:new Set,data_dispatched:!0});case"CREATE_SLEEP_RECORD_FAIL":return V(V({},e),{},{errorMessage:t.errMessage});case"EDIT_SLEEP_RECORD_SUCCESS":return V(V({},e),{},{oldDataForEdit:new Set,data_dispatched:!0});case"EDIT_SLEEP_RECORD_FAIL":return V(V({},e),{},{errorMessage:t.errMessage});case"REMOVE_RECORD_SUCCESS":var R=t.record_id,j=t.student_id,T=e.by_student_id[j],I=T.findIndex((function(e){return e===R})),z=new Set(P()(e.newDataForCreate));z.delete(R);var L=new Set(P()(e.oldDataForEdit));return L.delete(R),V(V({},e),{},{by_student_id:V(V({},e.by_student_id),{},A()({},j,[].concat(P()(T.slice(0,I)),P()(T.slice(I+1))))),newDataForCreate:z,oldDataForEdit:L,data_dispatched:z.size+L.size===0});case"REMOVE_RECORD_FAIL":return V(V({},e),{},{errorMessage:t.errorMessage});case"MARK_RECORD_ERROR":var M=t.record_id_array;return V(V({},e),{},{records_with_error:new Set([].concat(P()(e.records_with_error),P()(M)))});case"MARK_RECORD_CORRECT":var F=t.record_id,B=new Set(P()(e.records_with_error));return B.delete(F),V(V({},e),{},{records_with_error:B});case"ALERT_SLEEPLOG_ERROR_MESSAGE":var q=t.err_message;return V(V({},e),{},{errorMessage:q});case"CLEAR_SLEEPLOG_ERROR_MESSAGE":return V(V({},e),{},{errorMessage:""});case"CLEAR_STATE":return{by_student_id:{},records:{by_id:{},all_id:new Set},errorMessage:"",newDataForCreate:new Set,oldDataForEdit:new Set,records_with_error:new Set,data_dispatched:!0};default:return e}},healthstatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_STUDENT_WELLNESS":var n={},a={},r=0;return t.students.forEach((function(e){n[e]=[r,r+1],a[r]={temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""},a[r+1]={temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""},r+=2})),Q(Q({},e),{},{by_student_id:n,records:a});case"FETCH_CLASS_WELLNESS_DATA":for(var s=t.wellnessData,i=s.by_student_id,o=s.records,c=Object.keys(i),l=0;l<c.length;l++){var u=c[l],d=i[u];1===d.length&&(d.push(e.by_student_id[u][1]),i[u]=d)}return Q(Q({},e),{},{by_student_id:Q(Q({},e.by_student_id),i),records:Q(Q({},e.records),o)});case"ADD_RECORD":var f=e.by_student_id,p=e.records,h=t.student_id,m=Object.keys(e.records).length;return Q(Q({},e),{},{by_student_id:Q(Q({},f),{},A()({},h,[].concat(P()(f[h]),[m]))),records:Q(Q({},p),{},A()({},m,{temperature:"",status:"\u5065\u5eb7\u5bf6\u5bf6",time:null,teacher_id:""}))});case"ADD_HEALTH_STATUS":var y=t.student_id,g=t.record_id,_=t.status,E=t.teacher_id,b=new Set([].concat(P()(e.record_id_for_update),[g])),v=Q(Q({},e.records),{},A()({},g,Q(Q({},e.records[g]),{},{student_id:y,status:_,time:new Date,teacher_id:E})));return Q(Q({},e),{},{records:v,record_id_for_update:b,data_dispatched:!1});case"ADD_TEMPERATURE":var S=t.student_id,w=t.record_id,C=t.temperature,k=t.teacher_id,D=new Set([].concat(P()(e.record_id_for_update),[w])),x=Q(Q({},e.records),{},A()({},w,Q(Q({},e.records[w]),{},{student_id:S,temperature:C,time:new Date,teacher_id:k})));return Q(Q({},e),{},{records:x,record_id_for_update:D,data_dispatched:!1});case"INVALIDATE_WELLNESS_DATA":var O=t.record_id;t.errMessage;return Q(Q({},e),{},{records_with_error:new Set([].concat(P()(e.records_with_error),[O]))});case"SEND_WELLNESS_DATA_SUCCESS":return Q(Q({},e),{},{record_id_for_update:new Set,data_dispatched:!0});case"SEND_DATA_FAIL":return Q(Q({},e),{},{errMessage:t.errMessage});default:return e}},milk:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]=[]})),X(X({},e),{},{by_student_id:n});case"FETCH_CLASS_MILK_DATA":var a=t.milkData,r=a.by_student_id,s=a.records;return X(X({},e),{},{by_student_id:X({},r),records:{by_id:X({},s.by_id),all_id:new Set(P()(s.all_id))}});case"FETCH_CLASS_MILK_DATA_SUCCESS":case"ADD_MILK_RECORD":var i=X({},e),o=t.student_id,c=e.newDataForCreate.size;return i.records.by_id[c]={student_id:o,time:new Date,amount:"",milk_type:"\u914d\u65b9\u5976",teacher_id:""},i.by_student_id[o].push(c),i.newDataForCreate.add(c),i.data_dispatched=!1,i;case"EDIT_MILK_AMOUNT":var l=X({},e),u=t.record_id,d=t.milk_amount,f=t.teacher_id;return l.records.by_id[u].amount=d,l.records.by_id[u].teacher_id=f,l.newDataForCreate.has(u)||l.oldDataForEdit.add(u),l.data_dispatched=!1,l;case"EDIT_MILK_TYPE":var p=X({},e),h=t.record_id,m=t.teacher_id,y=e.records.by_id[h].milk_type;return p.records.by_id[h].milk_type="\u914d\u65b9\u5976"===y?"\u6bcd\u5976":"\u914d\u65b9\u5976",p.records.by_id[h].teacher_id=m,p.newDataForCreate.has(h)||p.oldDataForEdit.add(h),p.data_dispatched=!1,p;case"EDIT_MILK_TIME":var g=X({},e),_=t.record_id,E=t.date_time,b=t.teacher_id;return g.records.by_id[_].time=E,g.records.by_id[_].teacher_id=b,g.newDataForCreate.has(_)||g.oldDataForEdit.add(_),g.data_dispatched=!1,g;case"CREATE_DATA_SUCCESS":return X(X({},e),{},{newDataForCreate:new Set,data_dispatched:0===e.oldDataForEdit.size});case"CREATE_DATA_FAIL":return X(X({},e),{},{errMessage:t.errMessage});case"EDIT_DATA_SUCCESS":return X(X({},e),{},{oldDataForEdit:new Set,data_dispatched:0===e.newDataForCreate.size});case"EDIT_DATA_FAIL":return X(X({},e),{},{errMessage:t.errMessage});case"REMOVE_RECORD":var v=t.student_id,S=t.record_id,w=X({},e),C=e.by_student_id[v].indexOf(S);return C>-1&&w.by_student_id[v].splice(C,1),w.oldDataForEdit.has(S)&&w.oldDataForEdit.delete(S),w.newDataForCreate.has(S)?w.newDataForCreate.delete(S):w.dataForRemoval.add(S),w.data_dispatched=w.newDataForCreate.size+w.oldDataForEdit.size===0,w;case"REMOVE_MILK_RECORD_SUCCESS":return X(X({},e),{},{dataForRemoval:new Set,data_dispatched:e.newDataForCreate.size+e.oldDataForEdit.size===0});case"REMOVE_MILK_RECORD_FAIL":return X(X({},e),{},{errMessage:"Error occured while removing milk record, please try again"});case"CLEAR_STATE":return{loaded:!1,by_student_id:{},records:{by_id:{},all_id:new Set},newDataForCreate:new Set,oldDataForEdit:new Set,dataForRemoval:new Set,errMessage:"",data_dispatched:!0};default:return e}},diaper:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]={amount:"",records:[]}})),ee(ee({},e),{},{by_student_id:n});case"FETCH_CLASS_DIAPER_DATA":return ee(ee({},e),t.diaperData);case"ADD_DIAPER_RECORD":var a=t.student_id,r=t.time,s=t.cloth_diaper,i=t.teacher_id,o=ee({},e),c=o.records.all_id.length;return o.by_student_id[a].records.push(c),s||(o.by_student_id[a].amount-=1),o.records.by_id[c]={student_id:a,time:r,cloth_diaper:s,pee_or_poo:"\u5c0f\u4fbf",condition:s?"\u6709\u6fd5":"",teacher_id:i},o.records.all_id.push(c),o.all_dispatched=!1,o.new_data_for_create.add(c),o.data_dispatched=!1,o;case"EDIT_DIAPER_TIME":var l=t.record_id,u=t.time,d=t.teacher_id,f=e.new_data_for_create,p=ee({},e);return p.records.by_id[l].time=u,p.records.by_id[l].teacher_id=d,f.has(l)||p.old_data_for_edit.add(l),p.data_dispatched=!1,p;case"SWITCH_PEE_OR_POO":var h=t.record_id,m=t.teacher_id,y=e.new_data_for_create,g=ee({},e),_=g.records.by_id[h].pee_or_poo,E=g.records.by_id[h].cloth_diaper;return g.records.by_id[h].pee_or_poo="\u5c0f\u4fbf"===_?"\u5927\u4fbf":"\u5927\u4fbf"===_?"\u6d17\u6fa1":"\u5c0f\u4fbf",g.records.by_id[h].teacher_id=m,g.records.by_id[h].condition="\u5c0f\u4fbf"===_?"\u6b63\u5e38":("\u5927\u4fbf"!==_||E)&&"\u6d17\u6fa1"===_&&E?"\u6709\u6fd5":"",y.has(h)||g.old_data_for_edit.add(h),g.data_dispatched=!1,g;case"EDIT_CLOTH_DIAPER_CONDITION":var b=t.record_id,v=t.teacher_id,S=ee({},e),w=e.records.by_id[b].condition;return S.records.by_id[b].condition="\u6709\u6fd5"===w?"\u6210\u529f":"\u6709\u6fd5",S.records.by_id[b].teacher_id=v,e.new_data_for_create.has(b)||S.old_data_for_edit.add(b),S.data_dispatched=!1,S;case"EDIT_DIAPER_PEE_CONDITION":var C=t.record_id,k=t.teacher_id,D=t.student_id,x=ee({},e),A=e.records.by_id[C].condition;return""===A?(x.records.by_id[C].condition="\u6aa2\u67e5",x.by_student_id[D].amount+=1):(x.records.by_id[C].condition="",x.by_student_id[D].amount-=1),x.records.by_id[C].teacher_id=k,e.new_data_for_create.has(C)||x.old_data_for_edit.add(C),x.data_dispatched=!1,x;case"EDIT_POO_CONDITION":var O=t.record_id,R=t.condition,j=t.teacher_id,T=e.new_data_for_create,I=ee({},e);return I.records.by_id[O].condition=R,I.records.by_id[O].teacher_id=j,T.has(O)||I.old_data_for_edit.add(O),I.data_dispatched=!1,I;case"EDIT_SHOWER_CONDITION":var z=t.record_id,L=ee({},e),M=e.records.by_id[z].condition;return L.records.by_id[z].condition=""===M?"\u5927\u4fbf":"",e.new_data_for_create.has(z)||L.old_data_for_edit.add(z),L.data_dispatched=!1,L;case"REMOVE_DIAPER_RECORD_SUCCESS":var F=t.student_id,B=t.record_id,q=ee({},e),N=[],U=e.by_student_id[F].records,H=e.records.by_id[B];H.cloth_diaper||"\u5c0f\u4fbf"===H.pee_or_poo&&"\u6aa2\u67e5"===H.condition||(q.by_student_id[F].amount+=1);for(var W=0;W<U.length;W++)U[W]!==B&&N.push(U[W]);q.by_student_id[F].records=N;var V=new Set(P()(e.new_data_for_create));V.delete(B),q.new_data_for_create=V;var K=new Set(P()(e.old_data_for_edit));return K.delete(B),q.old_data_for_edit=K,q.data_dispatched=V.size+K.size===0,q;case"REMOVE_DIAPER_RECORD_FAIL":var G=t.err_message;return ee(ee({},e),{},{err_message:G});case"CREATE_DIAPER_RECORD_SUCCESS":return ee(ee({},e),{},{new_data_for_create:new Set,old_data_for_edit:new Set,data_dispatched:!0});case"CREATE_DIAPER_RECORD_FAIL":var Q=t.err_message;return ee(ee({},e),{},{err_message:Q});case"EDIT_DIAPER_RECORD_SUCCESS":return ee(ee({},e),{},{old_data_for_edit:new Set});case"EDIT_DIAPER_RECORD_FAIL":var J=t.err_message;return ee(ee({},e),{},{err_message:J});case"EDIT_DIAPER_AMOUNT_SUCCESS":return ee(ee({},e),{},{students_pending_amount_update:new Set,data_dispatched:e.new_data_for_create.size+e.old_data_for_edit.size===0});case"EDIT_DIAPER_AMOUNT_FAIL":var Y=t.err_message;return ee(ee({},e),{},{err_message:Y});case"CLEAR_ERR_MESSAGE":return ee(ee({},e),{},{err_message:""});case"CLEAR_STATE":return{by_student_id:{},records:{by_id:{},all_id:[]},all_dispatched:!0,data_to_update:[],new_data_for_create:new Set,old_data_for_edit:new Set,err_message:"",data_dispatched:!0};default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_CLASS":var n={};return t.students.forEach((function(e){var t=e.id;n[t]={text:"",things_to_bring:[0,0,0,0,0],other_item:"\u5176\u5b83",activities:[0,0,0,0,0,0,0,0,0],other_activity:"\u5176\u5b83",teacher_id:""}})),ae(ae({},e),{},{message_by_student_id:n});case"FETCH_CLASS_MESSAGE_DATA":var a=t.message_data;return ae(ae({},e),{},{message_by_student_id:ae(ae({},e.message_by_student_id),a),for_all:{text:""}});case"WRITE_TO_ALL":var r=t.text,s=t.teacher_id,i=ae({},e.message_by_student_id);return Object.keys(i).forEach((function(e){i[e].teacher_id=s})),ae(ae({},e),{},{for_all:ae(ae({},e.for_all),{},{text:r}),message_by_student_id:i,student_id_for_update:new Set(Object.keys(e.message_by_student_id)),data_dispatched:!1});case"WRITE_TO_ONE":var o=t.text,c=t.student_id,l=t.teacher_id,u=new Set([].concat(P()(e.student_id_for_update),[c]));return ae(ae({},e),{},{message_by_student_id:ae(ae({},e.message_by_student_id),{},A()({},c,ae(ae({},e.message_by_student_id[c]),{},{text:o,teacher_id:l}))),student_id_for_update:u,data_dispatched:!1});case"REMIND_ITEMS_TO_BRING_TO_ALL":var d=t.items_to_bring_bool,f=t.teacher_id,p=ae({},e.message_by_student_id);return Object.keys(p).forEach((function(e){p[e].things_to_bring=d,p[e].teacher_id=f})),ae(ae({},e),{},{message_by_student_id:p,student_id_for_update:new Set(Object.keys(p)),data_dispatched:!1});case"REMIND_ITEMS_TO_BRING_TO_ONE":var h=t.student_id,m=t.things_to_bring,y=t.teacher_id,g=ae({},e.message_by_student_id);return g[h].things_to_bring=m,g[h].teacher_id=y,ae(ae({},e),{},{message_by_student_id:g,student_id_for_update:new Set([].concat(P()(e.student_id_for_update),[h])),data_dispatched:!1});case"WRITE_ITEM_TO_BRING_TO_ALL":var _=t.item_to_bring,E=t.teacher_id,b=ae({},e.message_by_student_id);return Object.keys(b).forEach((function(e){b[e].other_item=""===_?"\u5176\u5b83":_,b[e].teacher_id=E})),ae(ae({},e),{},{message_by_student_id:b,student_id_for_update:new Set(Object.keys(b)),data_dispatched:!1});case"WRITE_ITEM_TO_BRING_TO_ONE":var v=t.student_id,S=t.item_to_bring,w=t.teacher_id;return ae(ae({},e),{},{message_by_student_id:ae(ae({},e.message_by_student_id),{},A()({},v,ae(ae({},e.message_by_student_id[v]),{},{other_item:S,teacher_id:w}))),student_id_for_update:new Set([].concat(P()(e.student_id_for_update),[v])),data_dispatched:!1});case"RECORD_ACTIVITIES_FOR_ALL":var C=t.new_acitivities_bool,k=t.teacher_id,D=ae({},e.message_by_student_id);return Object.keys(D).forEach((function(e){D[e].activities=C,D[e].teacher_id=k})),ae(ae({},e),{},{message_by_student_id:D,student_id_for_update:new Set(Object.keys(D)),data_dispatched:!1});case"RECORD_ACTIVITIES_FOR_ONE":var x=t.student_id,O=t.activities,R=t.teacher_id,j=ae({},e.message_by_student_id);return j[x].activities=O,j[x].teacher_id=R,ae(ae({},e),{},{message_by_student_id:j,student_id_for_update:new Set([].concat(P()(e.student_id_for_update),[x])),data_dispatched:!1});case"WRITE_ACTIVITY_FOR_ALL":var T=t.activity,I=t.teacher_id,z=ae({},e.message_by_student_id);return Object.keys(z).forEach((function(e){z[e].other_activity=""===T?"\u5176\u5b83":T,z[e].teacher_id=I})),ae(ae({},e),{},{message_by_student_id:z,student_id_for_update:new Set(Object.keys(z)),data_dispatched:!1});case"WRITE_ACTIVITY_FOR_ONE":var L=t.student_id,M=t.activity,F=t.teacher_id;return ae(ae({},e),{},{message_by_student_id:ae(ae({},e.message_by_student_id),{},A()({},L,ae(ae({},e.message_by_student_id[L]),{},{other_activity:M,teacher_id:F}))),student_id_for_update:new Set([].concat(P()(e.student_id_for_update),[L])),data_dispatched:!1});case"SEND_MESSAGE_ON_SUCCESS":return ae(ae({},e),{},{student_id_for_update:new Set,data_dispatched:!0});case"GET_PARENT_MESSAGE_SUCCESS":var B=t.messages;return ae(ae({},e),{},{parent_messages:B});case"CLEAR_STATE":return{message_by_student_id:{},student_id_for_update:new Set,for_all:{text:""},data_dispatched:!0,parent_messages:{}};default:return e}},school:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONNECT_STATE":var n=t.isConnected;return ie(ie({},e),{},{isConnected:n});case"FETCH_CLASSES_SUCCESS":var a=t.classes,r=t.admin_passcode;return ie(ie({},e),{},{classes:a,admin_passcode:r});case"FETCH_TEACHERS_SUCCESS":var s=t.admins,i=t.teachers,o=t.classes,c=ie({},e.classes),l=e.passcodeAdminId,u=e.passcodeTeacherId;return Object.keys(o).forEach((function(e){c[e].teachers=o[e].teachers})),Object.keys(s).forEach((function(e){l[s[e].passcode]=e})),Object.keys(i).forEach((function(e){u[i[e].passcode]=e})),ie(ie({},e),{},{passcodeAdminId:l,passcodeTeacherId:u,teachers:ie(ie({},i),s),classes:c,teacher_unmarked:new Set(Object.keys(i))});case"FETCH_STUDENTS_SUCCESS":var d=t.students,f=t.classes,p=ie({},e.classes);return Object.keys(f).forEach((function(e){p[e].students=f[e].students})),ie(ie({},e),{},{students:d,classes:p,student_unmarked:new Set(Object.keys(d))});case"FETCH_TEACHER_ATTENDANCE_SUCCESS":var h=t.attendance,m=t.teachers,y=ie({},e.teachers),g=new Set(Object.keys(e.teachers)),_=new Set,E=new Set;return Object.keys(m).forEach((function(e){y[e].attendance=m[e].attendance_array,y[e].present=m[e].present,y[e].total_minutes=m[e].total_minutes,m[e].present?_.add(e):E.add(e),g.delete(e)})),ie(ie({},e),{},{teachers:y,attendance:ie(ie({},e.attendance),h),teacher_present:_,teacher_absent:E,teacher_unmarked:g});case"FETCH_STUDENT_ATTENDANCE_SUCCESS":var b=t.attendance,v=t.students,S=t.present,w=t.absent,C=ie({},e.students),k=new Set(Object.keys(e.students));return Object.keys(v).forEach((function(e){C[e].attendance_id=v[e],(S.includes(e)||w.includes(e))&&k.delete(e)})),ie(ie({},e),{},{students:C,attendance:ie(ie({},e.attendance),b),student_present:new Set(P()(S)),student_absent:new Set(P()(w)),student_unmarked:k});case"EDIT_TEACHER_ON_DUTY":var D=t.teacher_id;return ie(ie({},e),{},{teacherOnDuty:D});case"ADD_PICKUP_REQUEST":var x=t.requests;return ie(ie({},e),{},{pick_up_request:x});case"UPDATE_VIEWING_STATUS":var A=t.status;return ie(ie({},e),{},{viewing_status:A});case"UPDATE_PROFILE_PICTURE":var O=t.student_id,R=t.uri,j=ie({},e.students);return j[O].profile_picture=R,ie(ie({},e),{},{students:j});case"EDIT_STUDENT_SUCCESS":var T=t.student_id,I=t.name,z=t.old_class_id,L=t.new_class_id,M=ie({},e.students),F=ie({},e.classes);M[T].name=I,M[T].class_id=L;for(var B=F[z].students,q=[],N=0;N<B.length;N++)B[N]!==T&&q.push(T);return F[z].students=q,(B=F[L].students).push(T),F[L].students=B,ie(ie({},e),{},{students:M,classes:F});case"UPDATE_TEACHER_PROFILE_PICTURE":var U=t.teacher_id,H=t.image_url,W=ie({},e.teachers);return W[U].profile_picture=H,ie(ie({},e),{},{teachers:W});case"CLEAR_STATE":return ie(ie({},e),{},{viewing_status:""});case"CLEAR_SCHOOL_STATE":return{isConnected:!1,classes:{},pick_up_request:[],passcodeAdminId:{},passcodeTeacherId:{},teacherOnDuty:"",teachers:{},students:{},attendance:{},student_present:new Set,student_absent:new Set,student_unmarked:new Set,teacher_present:new Set,teacher_absent:new Set,teacher_unmarked:new Set};default:return e}}}),le=n(13),ue=n(14),de=n(84),fe=n(29),pe=n(18),he=function(e,t){return{type:"INITIALIZE_CLASS",teacher_objs:e,students:t}},me=function(e,t,n,a){return{type:"RATE_APPETITE",student_id:e,mealType:t,rating:n,teacher_id:a}},ye=function(e,t){return{type:"MARK_PRESENT",student_id:e,in_time:t}},ge=function(e,t){return{type:"MARK_ABSENT",student_id:e,excuse_type:t}},_e=function(e,t,n){return{type:"INITIALIZE_REQUESTS",requests:e,finished:t,unfinished:n}},Ee=function(e){return{type:"FILL_MED_REQUEST",request_id:e}},be=function(e){return{type:"FETCH_ATTENDANCE_SUCCESS",data:e}},ve=function(e,t,n){return{type:"MARK_TEACHER_LOGGED_IN",teacher_id:e,time:t,attendance_id:n}},Se=function(e,t){return{type:"MARK_TEACHER_LOGGED_OUT",teacher_id:e,time:t}},we=function(e){return{type:"CLEAR_RATINGS",meal_type:e}},Ce=function(e,t,n){return{type:"SET_ALL_RATINGS_TO_GREAT",mealType:e,students_to_display:t,teacher_id:n}},ke=function(e,t,n){return{type:"SET_ALL_DRINK_WATER",mealType:e,students_to_display:t,teacher_id:n}},De=function(e){return{type:"ADD_RECORD",student_id:e}},xe=function(e,t,n,a){return{type:"ADD_HEALTH_STATUS",student_id:e,record_id:t,status:n,teacher_id:a}},Ae=function(e,t,n,a){return{type:"ADD_TEMPERATURE",student_id:e,record_id:t,temperature:n,teacher_id:a}},Oe=function(){return{type:"SEND_WELLNESS_DATA_SUCCESS"}},Re=function(e){return{type:"SEND_DATA_FAIL",errMessage:e}},je=function(e,t){return{type:"INVALIDATE_WELLNESS_DATA",record_id:e,errMessage:t}},Te=function(e,t,n,a){return{type:"SET_SLEEP_TIME",student_id:e,index:t,sleep_time:n,teacher_id:a}},Pe=function(e,t){return{type:"REMOVE_RECORD",record_id:e,student_id:t}},Ie=function(e,t){return{type:"REMOVE_RECORD_SUCCESS",record_id:e,student_id:t}},ze=function(e){return{type:"REMOVE_RECORD_FAIL",errorMessage:e}},Le=function(e,t,n,a){return{type:"SET_WAKE_TIME",student_id:e,index:t,wake_time:n,teacher_id:a}},Me=function(e,t){return{type:"REMOVE_WAKE_TIME",record_id:e,teacher_id:t}},Fe=function(e,t,n){return{type:"EDIT_MILK_AMOUNT",record_id:e,milk_amount:t,teacher_id:n}},Be=function(e,t,n){return{type:"EDIT_MILK_TIME",record_id:e,date_time:t,teacher_id:n}},qe=function(e,t){return{type:"UPDATE_DIAPER_AMOUNT",student_id:e,amount:t}},Ne=function(e,t,n,a){return{type:"ADD_DIAPER_RECORD",student_id:e,time:t,cloth_diaper:n,teacher_id:a}},Ue=function(e,t,n){return{type:"EDIT_DIAPER_TIME",record_id:e,time:t,teacher_id:n}},He=function(e,t){return{type:"SWITCH_PEE_OR_POO",record_id:e,teacher_id:t}},We=function(e,t,n){return{type:"EDIT_POO_CONDITION",record_id:e,condition:t,teacher_id:n}},Ve=function(e,t){return{type:"REMOVE_DIAPER_RECORD_SUCCESS",student_id:e,record_id:t}},Ke=function(e){return{type:"REMOVE_DIAPER_RECORD_FAIL",err_message:e}},Ge=function(){return{type:"CLEAR_ERR_MESSAGE"}},Qe=function(e){return{type:"ADD_MILK_RECORD",student_id:e}},Je=function(e,t){return{type:"FETCH_CLASS_APPETITE_DATA",fruit_name:e,ratings:t}},Ye=function(e){return{type:"FETCH_CLASS_WELLNESS_DATA",wellnessData:e}},Xe=function(e){return{type:"FETCH_CLASS_SLEEP_DATA",sleepData:e}},Ze=function(){return{type:"CLEAR_PENDNING_SLEEP_UPDATE"}},$e=function(e){return{type:"FETCH_CLASS_MILK_DATA",milkData:e}},et=function(){return{type:"CREATE_DATA_SUCCESS"}},tt=function(e){return{type:"CREATE_DATA_FAIL",errMessage:e}},nt=function(){return{type:"EDIT_DATA_SUCCESS"}},at=function(e){return{type:"EDIT_DATA_FAIL",errMessage:e}},rt=function(){return{type:"REMOVE_MILK_RECORD_SUCCESS"}},st=function(){return{type:"REMOVE_MILK_RECORD_FAIL"}},it=function(){return{type:"CREATE_SLEEP_RECORD_SUCCESS"}},ot=function(e){return{type:"CREATE_SLEEP_RECORD_FAIL",errMessage:e}},ct=function(){return{type:"EDIT_SLEEP_RECORD_SUCCESS"}},lt=function(e){return{type:"EDIT_SLEEP_RECORD_FAIL",errMessage:e}},ut=function(e){return{type:"FETCH_CLASS_DIAPER_DATA",diaperData:e}},dt=function(){return{type:"CREATE_DIAPER_RECORD_SUCCESS"}},ft=function(e){return{type:"CREATE_DIAPER_RECORD_FAIL",errMessage:e}},pt=function(){return{type:"EDIT_DIAPER_RECORD_SUCCESS"}},ht=function(e){return{type:"EDIT_DIAPER_RECORD_FAIL",errMessage:e}},mt=function(){return{type:"EDIT_DIAPER_AMOUNT_SUCCESS"}},yt=function(e){return{type:"EDIT_DIAPER_AMOUNT_FAIL",errMessage:e}},gt=function(e,t,n){return{type:"REMOVE_RECORD",student_id:e,record_id:t,index:n}},_t=function(){return{type:"CLEAR_STATE"}},Et=function(e){return{type:"SET_CLASS_ID",class_id:e}},bt=function(){return{type:"ON_SEND_APPETITE_SUCCESS"}},vt=function(e){return{type:"ALERT_ERR_MESSAGE",err_message:e}},St=function(){return{type:"CLEAR_ERR_MESSAGE"}},wt=function(e){return{type:"ADD_STUDENT_ID_FOR_UPDATE",student_id_array:e}},Ct=function(e,t,n){return{type:"MARK_WATER_DRANK",student_id:e,meal_type:t,teacher_id:n}},kt=function(e){return{type:"MARK_STAFF_ATTENDANCE_FAIL",errMessage:e}},Dt=function(e,t){return{type:"WRITE_TO_ALL",text:e,teacher_id:t}},xt=function(e,t,n){return{type:"WRITE_TO_ONE",text:e,student_id:t,teacher_id:n}},At=function(e,t){return{type:"REMIND_ITEMS_TO_BRING_TO_ALL",items_to_bring_bool:e,teacher_id:t}},Ot=function(e,t,n){return{type:"REMIND_ITEMS_TO_BRING_TO_ONE",student_id:e,things_to_bring:t,teacher_id:n}},Rt=function(e,t){return{type:"RECORD_ACTIVITIES_FOR_ALL",new_acitivities_bool:e,teacher_id:t}},jt=function(e,t,n){return{type:"RECORD_ACTIVITIES_FOR_ONE",student_id:e,activities:t,teacher_id:n}},Tt=function(e,t){return{type:"WRITE_ITEM_TO_BRING_TO_ALL",item_to_bring:e,teacher_id:t}},Pt=function(e,t,n){return{type:"WRITE_ITEM_TO_BRING_TO_ONE",student_id:e,item_to_bring:t,teacher_id:n}},It=function(e,t){return{type:"WRITE_ACTIVITY_FOR_ALL",activity:e,teacher_id:t}},zt=function(e,t,n){return{type:"WRITE_ACTIVITY_FOR_ONE",student_id:e,activity:t,teacher_id:n}},Lt=function(e){return{type:"FETCH_CLASS_MESSAGE_DATA",message_data:e}},Mt=function(e){return{type:"ALERT_SLEEPLOG_ERROR_MESSAGE",err_message:e}},Ft=function(){return{type:"CLEAR_SLEEPLOG_ERROR_MESSAGE"}},Bt=function(e){return{type:"EDIT_FRUIT_NAME",fruit_name:e}},qt=function(e,t,n){return{type:"FETCH_CLASSES_SUCCESS",classes:e,admin_passcode:t,email:n}},Nt=function(e,t,n){return{type:"FETCH_TEACHERS_SUCCESS",admins:e,teachers:t,classes:n}},Ut=function(e,t){return{type:"FETCH_STUDENTS_SUCCESS",students:e,classes:t}},Ht=function(e){return{type:"INITIALIZE_STUDENT_WELLNESS",students:e}},Wt=function(){return{type:"SEND_MESSAGE_ON_SUCCESS"}},Vt=function(e){return{type:"SET_CONNECT_STATE",isConnected:e}},Kt=function(){return{type:"CLEAR_SCHOOL_STATE"}},Gt=function(e,t){return{type:"FETCH_TEACHER_ATTENDANCE_SUCCESS",attendance:e,teachers:t}},Qt=function(e,t,n,a){return{type:"FETCH_STUDENT_ATTENDANCE_SUCCESS",attendance:e,students:t,present:n,absent:a}},Jt=function(e){return{type:"EDIT_TEACHER_ON_DUTY",teacher_id:e}},Yt=function(e){return{type:"ADD_PICKUP_REQUEST",requests:e}},Xt=function(e){return{type:"UPDATE_VIEWING_STATUS",status:e}},Zt=function(e,t){return{type:"UPDATE_PROFILE_PICTURE",student_id:e,uri:t}},$t=function(e,t,n,a){return{type:"EDIT_STUDENT_SUCCESS",student_id:e,name:t,old_class_id:n,new_class_id:a}},en=function(e,t){return{type:"UPDATE_TEACHER_PROFILE_PICTURE",teacher_id:e,image_url:t}},tn=function(e){return{type:"MARK_RECORD_ERROR",record_id_array:e}},nn=function(e){return{type:"MARK_RECORD_CORRECT",record_id:e}},an=function(e){return{type:"GET_PARENT_MESSAGE_SUCCESS",messages:e}};function rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function sn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var on=function(e){u()(n,e);var t=sn(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={passcode:"",err_message:"",number_array:[1,2,3,4,5,6,7,8,9]},a.handlePasscode=a.handlePasscode.bind(_()(a)),a}return c()(n,[{key:"handlePasscode",value:function(e){this.setState({passcode:this.state.passcode+e})}},{key:"handleEnterPasscode",value:function(){this.props.handleEnterPasscode(this.state.passcode),this.setState({passcode:""})}},{key:"render",value:function(){var e=this,t=this.state,n=t.passcode,a=t.number_array;return y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.5)",width:"100%",height:"100%",flex:1,justifyContent:"center",alignItems:"center",zIndex:2,position:"absolute"},underlayColor:"transparent",onPress:this.props.hideLoginPad},y.a.createElement(C.a,{style:{width:350,height:560,borderRadius:25,zIndex:3,position:"absolute",backgroundColor:"white"},underlayColor:"white",onPress:function(){}},y.a.createElement(le.View,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(le.View,{style:{flex:1,flexDirection:"row",width:310,height:100,margin:5,borderRadius:50,backgroundColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(le.Text,{style:{width:210,fontSize:40,fontWeight:"bold",paddingHorizontal:20,alignSelf:"center"}},n),y.a.createElement(C.a,{style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#ffe1d0",justifyContent:"center",alignItems:"center"},underlayColor:"#fa625f",onPress:function(){return e.setState({passcode:""})}},y.a.createElement(le.Text,{style:{fontSize:30}},"Clear"))),y.a.createElement(le.View,{style:{flex:3,flexDirection:"row",flexWrap:"wrap",justifyContent:"center"}},a.map((function(t){return y.a.createElement(C.a,{key:t,style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#fff1b5",justifyContent:"center",alignItems:"center"},underlayColor:"#f4d41f",onPress:function(){return e.handlePasscode(t)}},y.a.createElement(le.Text,{style:{fontSize:30}},t))}))),y.a.createElement(le.View,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{style:{width:100,height:100,margin:5,borderRadius:50,backgroundColor:"#fff1b5",justifyContent:"center",alignItems:"center"},underlayColor:"#f4d41f",onPress:function(){return e.handlePasscode(0)}},y.a.createElement(le.Text,{style:{fontSize:30}},"0")),y.a.createElement(C.a,{style:{width:210,height:100,margin:5,borderRadius:50,backgroundColor:"#dcf3d0",justifyContent:"center",alignItems:"center"},underlayColor:"#00c07f",onPress:function(){return e.handleEnterPasscode()}},y.a.createElement(le.Text,{style:{fontSize:30}},"Enter"))))))}}]),n}(y.a.Component),cn=(ue.a.create({button:{minWidth:"22%",aspectRatio:1,margin:5,justifyContent:"center"}}),Object(k.b)((function(e){return{class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rn(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({markTeacherLoggedIn:ve,markTeacherLoggedOut:Se},e))}))(on));n(533);var ln=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return null===e||void 0===e||""===e?"dev":-1!==e.indexOf("dev")?"prod":-1!==e.indexOf("staging")?"staging":-1!==e.indexOf("prod")?"prod":void 0}(n(94).a.manifest.releaseChannel);function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fn=function(e){return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)},pn=function(e){return e.getFullYear()+"/"+("0"+(e.getMonth()+1)).slice(-2)+"/"+("0"+e.getDate()).slice(-2)},hn=function(e){return("0"+(e.getMonth()+1)).slice(-2)+"/"+("0"+e.getDate()).slice(-2)},mn=function(e){return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},yn=function(e){return e.getHours()+":"+("0"+e.getMinutes()).slice(-2)},gn=function(e){return e.getHours()+":"+e.getMinutes()},_n=function(e){var t,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=!0,a.next=3,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,a=e.message,r=e.data;if(n>200)t=!1;else if(void 0===n)return{success:!1,statusCode:500,message:a,data:{}};return{success:t,statusCode:n,message:a,data:r}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return n=a.sent,a.abrupt("return",n);case 5:case"end":return a.stop()}}),null,null,null,Promise)},En=function(e,t){var n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=!0,s.next=3,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,a=e.message,r=e.data;if(t>200)n=!1;else if(void 0===t)return{success:!1,statusCode:500,message:a,data:{}};return{success:n,statusCode:t,message:a,data:r}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return a=s.sent,s.abrupt("return",a);case 5:case"end":return s.stop()}}),null,null,null,Promise)},bn=function(e,t){var n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n=!0,s.next=3,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+e,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,a=e.message,r=e.data;if(t>200)n=!1;else if(void 0===t)return{success:!1,statusCode:500,message:a,data:{}};return{success:n,statusCode:t,message:a,data:r}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return a=s.sent,s.abrupt("return",a);case 5:case"end":return s.stop()}}),null,null,null,Promise)},vn=function(e){var t,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=!0,a.next=3,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,a=e.message,r=e.data;if(n>200)t=!1;else if(void 0===n)return{success:!1,statusCode:500,message:a,data:{}};return{success:t,statusCode:n,message:a,data:r}})).catch((function(e){return{success:!1,statusCode:500,message:e.message,data:{}}})));case 3:return n=a.sent,a.abrupt("return",n);case 5:case"end":return a.stop()}}),null,null,null,Promise)},Sn=function(e,t,n,a){var s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return s="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/"+e+"/"+t+"?start_date="+n+"&end_date="+a,o.next=3,r.a.awrap(fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.log(e)})));case 3:return i=o.sent,o.abrupt("return",i);case 5:case"end":return o.stop()}}),null,null,null,Promise)},wn=function(e,t,n,a){var s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return s="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/"+e+"/class/"+t+"?start_date="+n+"&end_date="+a,o.next=3,r.a.awrap(fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){console.log(e)})));case 3:return i=o.sent,o.abrupt("return",i);case 5:case"end":return o.stop()}}),null,null,null,Promise)},Cn=function(e,t,n){var a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(a=e.record_id_for_update,s=[],0!==a.size){l.next=4;break}return l.abrupt("return",{success:!0,data:[]});case 4:return a.forEach((function(t){s.push(dn({record_id:t},e.records[t]))})),kn(s),i={date:n,class_id:t,data_objs:s},o="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/wellness/",l.next=10,r.a.awrap(fetch(o,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message,a=e.data;return t>200||void 0===t?{success:!1,statusCode:t,message:n}:{success:!0,statusCode:t,message:n,data:a}})).catch((function(e){return{success:!1,message:e}})));case 10:return c=l.sent,l.abrupt("return",c);case 12:case"end":return l.stop()}}),null,null,null,Promise)};function kn(e){for(var t=0;t<e.length;t++)e[t].time=mn(e[t].time)}function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function xn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var An=function(e){u()(a,e);var t=xn(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={selected_student_ids:[]},n}return c()(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"onSelectAttendanceType",value:function(e){var t=this.props.attendance;switch(e){case"present":return void this.setState({selected_student_ids:P()(t.present)});case"absent":return void this.setState({selected_student_ids:P()(t.absent)});case"unmarked":return void this.setState({selected_student_ids:P()(t.unmarked)})}}},{key:"fetchData",value:function(){var e=this,t="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance?date="+fn(new Date)+"&class_id="+this.props.class.class_id;fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){for(var n in t)null!==t[n][0]?e.props.markPresent(n,t[n][0]):null!==t[n][2]&&e.props.markAbsent(n,t[n][2]);e.setState({selected_student_ids:P()(e.props.attendance.unmarked)})})).catch((function(e){return console.log("err: ",e)}))}},{key:"handleOnClick",value:function(e){this.props.showModal(e)}},{key:"render",value:function(){var e=this;return y.a.createElement(le.Card,{style:{flex:1,alignItems:"center",justifyContent:"center"}},y.a.createElement(le.CardItem,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u51fa\u5e2d\u72c0\u6cc1")),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingLeft:5,paddingTop:5}},y.a.createElement(b.a,null,"\u51fa\u5e2d")),y.a.createElement(C.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#dcf3d0"},underlayColor:"#00c07f",onPress:function(){return e.onSelectAttendanceType("present")}},y.a.createElement(b.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0},this.props.attendance.present.size))),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingLeft:5,paddingTop:5}},y.a.createElement(b.a,null,"\u7f3a\u5e2d")),y.a.createElement(C.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#ffe1d0"},underlayColor:"#fa625f",onPress:function(){return e.onSelectAttendanceType("absent")}},y.a.createElement(b.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0},this.props.attendance.absent.size))),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingLeft:5,paddingTop:5}},y.a.createElement(b.a,null,"\u672a\u77e5")),y.a.createElement(C.a,{style:{flex:1,alignSelf:"center",width:"70%",height:"70%",backgroundColor:"#fff1b5"},underlayColor:"#f4d41f",onPress:function(){return e.onSelectAttendanceType("unmarked")}},y.a.createElement(b.a,{style:{flex:1,width:"100%",textAlign:"center",fontSize:60},adjustsFontSizeToFit:!0},this.props.attendance.unmarked.size)))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",flexWrap:"wrap"}},this.state.selected_student_ids.map((function(t){var a=e.props.attendance,r=a.present,s=a.unmarked;a.absent;return y.a.createElement(C.a,{key:t,style:{width:"31%",margin:"1%"},underlayColor:"transparent",onPress:function(){return e.handleOnClick(t)}},y.a.createElement(E.a,{style:On.cardContainer},y.a.createElement(le.Card,null,y.a.createElement(le.CardItem,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{source:""===e.props.class.students[t].profile_picture?n(62):{uri:e.props.class.students[t].profile_picture},style:{height:200,width:200,borderRadius:100,borderWidth:10,borderColor:r.has(t)?"#dcf3d0":s.has(t)?"#fff1b5":"#ffe1d0"}})),y.a.createElement(le.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5}},y.a.createElement(b.a,{style:{marginTop:-10}},e.props.class.students[t].name)))))}))))}}]),a}(y.a.Component),On=ue.a.create({cardContainer:{paddingVertical:5},thumbnailImage:{height:80,width:80,borderRadius:40}}),Rn=(Object(k.b)((function(e){return{attendance:e.attendance,class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dn(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({markAbsent:ge,markPresent:ye},e))}),null,{forwardRef:!0})(An),n(30));function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Tn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Pn=function(e){u()(a,e);var t=Tn(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={timerId:null},n}return c()(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=new Date,n=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate();fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/medicationrequest?date="+n+"&class_id="+this.props.class_id,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,a=t.message,r=t.data,s=r.requests,i=r.finished,o=r.unfinished;n>200||"Internal server error"===a?alert("\u6258\u85e5\u55ae\u53d6\u4e0d\u5b8c\u6574\uff0c\u8acb\u548c\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):e.props.initializeRequests(s,i,o)})).catch((function(e){alert("Error, please try again \u6258\u85e5\u55ae\u53d6\u4e0d\u5b8c\u6574\uff0c\u8acb\u548c\u5de5\u7a0b\u5e2b\u806f\u7e6b\uff1a"+e.message)}))}},{key:"render",value:function(){var e=this,t=this.props.students,a=this.props.medication_requests,r=a.requests,s=a.unfinished;return y.a.createElement(le.Card,{style:{flex:1,width:"90%"}},y.a.createElement(E.a,{style:{height:80,justifyContent:"center",marginTop:5}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center",position:"absolute"}},"\u6258\u85e5\u55ae"),y.a.createElement(C.a,{style:{width:"25%",alignSelf:"flex-end",position:"absolute",padding:5,backgroundColor:"#b5e9e9"},onPress:function(){e.props.navigation.push("TeacherMedicineLog",{request_id:null})}},y.a.createElement(b.a,{style:In.button_text},"\u67e5\u770b"))),y.a.createElement(E.a,{style:{}},y.a.createElement(Rn.a,{horizontal:!0},s.map((function(a){var s=r[a],i=s.student_id,o=s.timestamp,c=(s.medication,s.note,s.administered,s.teacher_id,gn(new Date(o)));return y.a.createElement(C.a,{key:a,style:{flex:1,margin:3},onPress:function(){e.props.navigation.push("TeacherMedicineLog",{request_id:a})}},y.a.createElement(le.Card,{style:{flex:1,alignItems:"center",paddingHorizontal:15}},y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:35}},c)),y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{source:""===t[i].profile_picture?n(62):{uri:t[i].profile_picture},style:In.thumbnailImage})),y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},t[i].name))))})))))}}]),a}(y.a.Component),In=ue.a.create({card:{width:"90%",flex:1},button:{width:"30%",backgroundColor:"#b5e9e9"},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}}),zn=Object(k.b)(null,(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({initializeRequests:_e},e))}),null,{forwardRef:!0})(Pn);function Ln(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Mn=function(e){u()(n,e);var t=Ln(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){return y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,null,"Loading..."),y.a.createElement(v.a,{size:"large"}))}}]),n}(y.a.Component);function Fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Bn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var qn=function(e){u()(n,e);var t=Bn(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).timer=function(){return setTimeout((function(){a.setState({color:"#ffe1d0"===a.state.color?"#fa625f":"#ffe1d0"}),a.timeoutId=a.timer()}),2e3)},a.state={color:"#ffe1d0",requestQueue:[],isLoading:!0},a.onConfirm=a.onConfirm.bind(_()(a)),a}return c()(n,[{key:"componentDidMount",value:function(){this.timeoutId=this.timer()}},{key:"onConfirm",value:function(e,t){var n=this,a=P()(this.props.pick_up_request);fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/attendance/pickup-request?request_id="+e,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var r=e.statusCode,s=e.message;200===r?(a.splice(t,1),n.props.addPickupRequest(a),0===a.length&&n.props.navigation.goBack()):fe.a.alert("Sorry \u53d6\u5f97\u63a5\u56de\u901a\u77e5\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+s,[{text:"Ok"}])})).catch((function(e){console.log("err: ",e)}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId)}},{key:"render",value:function(){var e=this,t=this.props,n=t.pick_up_request,a=t.students;return y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center",flexWrap:"wrap"}},n.map((function(t,n){var r=t.id,s=t.student_id,i=t.arrival_time,o=a[s];return y.a.createElement(E.a,{key:n,style:{width:"45%",height:"45%",marginTop:"5%",backgroundColor:e.state.color}},y.a.createElement(E.a,{style:{flex:2,alignItems:"center",justifyContent:"center"}},y.a.createElement(pe.a,{source:{uri:o.profile_picture},style:{width:"80%",aspectRatio:1}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:80,textAlign:"center"}},i)),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(C.a,{style:{backgroundColor:"grey",padding:15,alignSelf:"flex-end",justifyContent:"center",marginRight:15},onPress:function(){return e.onConfirm(r,n)}},y.a.createElement(b.a,{style:{fontSize:35,textAlign:"center",color:"lightgrey"}},"\u78ba\u8a8d")))))})))}}]),n}(y.a.Component),Nn=Object(k.b)((function(e){return{students:e.school.students,pick_up_request:e.school.pick_up_request}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({addPickupRequest:Yt},e))}),null,{forwardRef:!0})(qn),Un=n(48),Hn=n(24),Wn=n(20),Vn=n(227);function Kn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Gn=function(e){u()(n,e);var t=Kn(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={selectedIndex:0},a}return c()(n,[{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"showActionSheet",value:function(){}},{key:"iosShowActionSheet",value:function(){var e=this,t=this.props.options;Vn.a.showActionSheetWithOptions({options:t,cancelButtonIndex:t.length-1},(function(n){e.setState({selectedIndex:n}),e.props.handleSelectValue(t[n])}))}},{key:"androidShowActionSheet",value:function(){var e=this,t=this.props.options;le.ActionSheet.show({options:t,cancelButtonIndex:t.length-1},(function(n){e.setState({selectedIndex:n}),e.props.handleSelectValue(t[n])}))}},{key:"isOtherSelected",value:function(){var e=this.props,t=e.selectedValue;return e.options.indexOf(t)<0}},{key:"render",value:function(){var e=this,t=this.props,n=t.selectedValue,a=t.style,r=t.textStyle,s=t.disabled;return y.a.createElement(C.a,{disabled:s,style:a,onPress:function(){return e.props.showSelect()}},y.a.createElement(b.a,{style:r},n))}}]),n}(y.a.Component);function Qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Jn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Yn=function(e){u()(n,e);var t=Jn(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={other_option:""},a}return c()(n,[{key:"handleSelectStatus",value:function(e,t,n){"Cancel"!==n&&("\u5176\u4ed6"===n?this.setState({other_option:"\u5176\u4ed6"}):this.props.addHealthStatus(e,t,n,this.props.teacher_id))}},{key:"handleTempInput",value:function(e,t,n){var a="."===n.slice(-1)?n.slice(0,2):3===n.length?n.slice(0,2)+"."+n.slice(-1):n;this.props.addTemperature(e,t,a,this.props.teacher_id)}},{key:"render",value:function(){var e=this,t=this.props,n=t.student_id,a=t.record_id,r=t.records,s=t.records_with_error,i=t.autoFocus,o=r[a];return y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"center",borderWidth:2,borderColor:s.has(a)?"red":"transparent"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"rgba(255,255,255, 0.5)",marginRight:"10%",justifyContent:"center",padding:5}},y.a.createElement(Hn.a,{style:{fontSize:40},autoFocus:i,keyboardType:"decimal-pad",placeholder:"\u9ad4\u6eab",value:""+o.temperature,onChangeText:function(t){e.handleTempInput(n,a,t)}}),""===o.temperature?null:y.a.createElement(b.a,{style:{fontSize:30}},"\xb0")),y.a.createElement(E.a,{style:{flex:2}},""===this.state.other_option?y.a.createElement(Gn,{style:{backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:5},textStyle:{fontSize:40},selectedValue:o.status,options:["\u5065\u5eb7\u5bf6\u5bf6","\u767c\u71d2","\u5589\u56a8\u504f\u7d05","\u54b3\u55fd","\u6d41\u2fd0\u6d95","\u982d\u75db","\u6d3b\u52d5\u2f12\u4e0d\u4f73","\u5614\u5410","\u7cde\u4fbf\u5e36\u6709\u2f8e\u7d72","\u62c9\u809a\u5b50","\u5176\u4ed6","Cancel"],handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectStatus(n,a,t)}}):y.a.createElement(Hn.a,{style:{fontSize:40,backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:2},keyboardType:"default",autoFocus:""!==this.state.other_option,selectTextOnFocus:!0,value:o.status,onChangeText:function(t){e.handleSelectStatus(n,a,t)},onBlur:function(){return e.setState({other_option:""})}})))}}]),n}(y.a.Component),Xn=Object(k.b)((function(e){return{records:e.healthstatus.records,records_with_error:e.healthstatus.records_with_error}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({addHealthStatus:xe,addTemperature:Ae},e))}))(Yn);function Zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $n(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ea=function(e){u()(a,e);var t=$n(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={class_id:""},n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.class_id,n=e.student_id;"all"===t?this.getClassIdByStudentId(n):this.setState({class_id:t})}},{key:"getClassIdByStudentId",value:function(e){for(var t=this.props.classes,n=Object.keys(t),a="",r=0;r<n.length;r++)for(var s=t[n[r]].students,i=0;i<s.length;i++)s[i]===e&&(a=n[r]);this.setState({class_id:a})}},{key:"handleSend",value:function(e){var t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=this.props,n=t.wellness,a=t.isConnected,s=this.state.class_id,i=n.records,""!==i[e].temperature){c.next=7;break}return fe.a.alert("\u672a\u586b\u5beb!","",[{text:"OK"}]),c.abrupt("return");case 7:return a||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),c.next=10,r.a.awrap(Cn(n,s,fn(new Date)));case 10:(o=c.sent).success?(this.props.fetchStudentAttendance(),this.props.sendWellnessDataSuccess(),this.props.hideModal()):this.props.sendWellnessDataFail(o.message);case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"markAbsent",value:function(){var e,t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props,t=e.student_id,n=e.school_id,a=this.state.class_id,s={student_id:t,class_id:a,school_id:n,startDate:fn(new Date),endDate:fn(new Date),excuse_type:"none-medical",note:"\u6821\u65b9\u586b\u5beb"},l.next=5,r.a.awrap(En("/absence-excuse",s));case 5:if(i=l.sent,o=i.success,i.statusCode,c=i.message,i.data,o){l.next=10;break}return fe.a.alert("Sorry \u6a19\u8a18\u5b78\u751f\u7f3a\u5e2d\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+c,[{text:"Ok"}]),l.abrupt("return");case 10:this.props.fetchStudentAttendance(),this.props.hideModal();case 12:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props,a=(t.show,t.student_id),r=(t.teacher_id,t.students),s=t.student_unmarked,i=t.student_absent,o=t.teacherOnDuty,c=r[a],l=this.props.wellness.by_student_id[a][0];return y.a.createElement(E.a,{style:{flex:1,width:"80%",height:"70%",backgroundColor:i.has(a)?"#ffe1d0":s.has(a)?"#fff1b5":"#dcf3d0",zIndex:3,position:"absolute"}},y.a.createElement(E.a,{style:{flex:2,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(pe.a,{source:""===c.profile_picture?n(62):{uri:c.profile_picture},style:ta.thumbnailImage})),y.a.createElement(E.a,{style:{flex:1,alignItems:"flex-start"}},y.a.createElement(b.a,{style:{fontSize:60}},c.name),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"lightgrey",justifyContent:"center"},onPress:function(){return e.markAbsent()}},y.a.createElement(b.a,{style:{fontSize:40}},"\u7f3a\u5e2d")))),y.a.createElement(E.a,{style:{flex:2}},y.a.createElement(E.a,{style:{flex:3,alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:20}},"\u8840\u578b: ",c.blood_type," "),y.a.createElement(b.a,{style:{fontSize:20}},"\u5730\u5740: ",c.address),y.a.createElement(b.a,{style:{fontSize:20}},"\u5bb6\u88e1\u96fb\u8a71: ",c.home_phone),y.a.createElement(b.a,{style:{fontSize:20}},"\uff08\u7236\uff09\u624b\u6a5f: ",c.father_phone),y.a.createElement(b.a,{style:{fontSize:20}},"\uff08\u6bcd\uff09\u624b\u6a5f: ",c.mother_phone)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingHorizontal:30}},s.has(a)?y.a.createElement(Xn,{student_id:a,teacher_id:o,record_id:l,autoFocus:!0}):null)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},s.has(a)?y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{style:{backgroundColor:"red",flex:1,height:60,justifyContent:"center",alignItems:"center",margin:8},onPress:this.props.hideModal},y.a.createElement(b.a,{style:{fontSize:30}},"\u53d6\u6d88")),y.a.createElement(C.a,{style:{backgroundColor:"grey",flex:1,height:60,justifyContent:"center",alignItems:"center",margin:8},onPress:function(){return e.handleSend(l)}},y.a.createElement(b.a,{style:{fontSize:30}},"\u9001\u51fa"))):null))}}]),a}(y.a.Component),ta=ue.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),na=Object(k.b)((function(e){return{classes:e.school.classes,student_absent:e.school.student_absent,student_unmarked:e.school.student_unmarked,students:e.school.students,wellness:e.healthstatus,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zn(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({sendWellnessDataFail:Re,sendWellnessDataSuccess:Oe},e))}))(ea);function aa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ra(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var sa=function(e){u()(a,e);var t=ra(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={temperature:""},n}return c()(a,[{key:"editTemperature",value:function(e){var t="."===e.slice(-1)?e.slice(0,2):3===e.length?e.slice(0,2)+"."+e.slice(-1):e;this.setState({temperature:t})}},{key:"clock",value:function(){var e=this.props,t=e.isConnected,n=e.teacher_id,a=e.teachers[n];if(t)if(a.present){var r=a.attendance[a.attendance.length-1];this.clockout(r)}else this.clockin();else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"clockout",value:function(e){var t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.awrap(bn("/staff-attendance/"+e,{out_time:fn(new Date)+" "+mn(new Date)}));case 2:t=s.sent,n=t.success,t.statusCode,a=t.message,t.data,n||fe.a.alert("Sorry \u6253\u5361\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a,[{text:"Ok"}]),this.props.fetchTeacherAttendance(),this.props.hideModal();case 7:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"clockin",value:function(){var e,t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props,t=e.isConnected,n=e.teacher_id,a=this.state.temperature,t||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),c.next=5,r.a.awrap(En("/staff-attendance",{teacher_id:n,in_time:fn(new Date)+" "+mn(new Date),temperature:a||0}));case 5:if(s=c.sent,i=s.success,s.statusCode,o=s.message,s.data,i){c.next=10;break}return fe.a.alert("Sorry \u6253\u5361\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o,[{text:"Ok"}]),c.abrupt("return");case 10:this.props.fetchTeacherAttendance(),this.props.hideModal();case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"editTeacherOnDuty",value:function(e){var t=this.props,n=t.teacherOnDuty,a=t.teachers,r="\u672a\u767b\u5165";n===e?this.props.editTeacherOnDuty(""):(this.props.editTeacherOnDuty(e),r=a[e].name),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{paddingRight:20}},y.a.createElement(b.a,{style:{fontSize:30}},"\u503c\u73ed\u8001\u5e2b\uff1a"+r))}})}},{key:"render",value:function(){var e=this,t=this.props,a=(t.show,t.student_id,t.teacher_id),r=t.teachers,s=t.unmarked,i=t.absent,o=t.teacherOnDuty,c=t.attendance,l=this.state.temperature,u=r[a];return y.a.createElement(E.a,{style:{flex:1,width:"80%",height:"70%",backgroundColor:i.has(a)?"#ffe1d0":s.has(a)?"#fff1b5":"#dcf3d0",zIndex:3,position:"absolute"}},y.a.createElement(E.a,{style:{flex:3,flexDirection:"row",justifyContent:"space-evenly",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(pe.a,{source:""===u.profile_picture?n(301):{uri:u.profile_picture},style:ia.thumbnailImage}),y.a.createElement(Hn.a,{style:{fontSize:60},keyboardType:"decimal-pad",placeholder:"\u9ad4\u6eab",value:""+l,onChangeText:function(t){return e.editTemperature(t)}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:60}},u.name),y.a.createElement(C.a,{onPress:function(){return e.editTeacherOnDuty(a)},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(pe.a,{source:n(o===a?828:829),style:{width:80,aspectRatio:1}}),y.a.createElement(b.a,{style:{fontSize:40}},"\u503c\u73ed\u8001\u5e2b"))))),y.a.createElement(E.a,{style:{flex:2,paddingHorizontal:30,justifyContent:"space-evenly",alignItems:"center"}},u.attendance&&u.attendance.map((function(e){var t=c[e];return y.a.createElement(E.a,{key:e,style:{flex:1,flexDirection:"row",width:"60%",justifyContent:"space-around"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:50}},t.in_time)),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:50}},t.out_time)))})),y.a.createElement(E.a,{style:{flexDirection:"row",alignSelf:"flex-end",backgroundColor:"white",padding:10}},y.a.createElement(b.a,{style:{fontSize:25}},"\u4eca\u65e5\u7e3d\u8a08: ",Math.round(100*u.total_minutes)/100))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(C.a,{style:{backgroundColor:"red",flex:1,height:80,justifyContent:"center",alignItems:"center",margin:8},onPress:this.props.hideModal},y.a.createElement(b.a,{style:{fontSize:40}},"\u53d6\u6d88")),y.a.createElement(C.a,{style:{backgroundColor:"grey",flex:1,height:80,justifyContent:"center",alignItems:"center",margin:8},onPress:function(){return e.clock()}},y.a.createElement(b.a,{style:{fontSize:40}},"\u6253\u5361")))))}}]),a}(y.a.Component),ia=ue.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),oa=Object(k.b)((function(e){return{attendance:e.school.attendance,teachers:e.school.teachers,teacherOnDuty:e.school.teacherOnDuty,unmarked:e.school.teacher_unmarked,absent:e.school.teacher_absent,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aa(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({markPresent:ye,sendWellnessDataFail:Re,editTeacherOnDuty:Jt},e))}))(sa);function ca(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function la(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ua=function(e){u()(n,e);var t=la(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.show,a=t.student_id,r=t.teacher_id,s=t.students,i=(t.unmarked,t.absent,t.teacherOnDuty),o=t.class_id,c=t.school_id;if(!n)return null;s[a];return y.a.createElement(Un.a,{style:{backgroundColor:"transparent",justifyContent:"center",alignItems:"center",zIndex:2,position:"absolute",width:"100%",height:"100%"},behavior:"height",enabled:!0},y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.8)",width:"100%",height:"100%"},onPress:this.props.hideModal},y.a.createElement(E.a,null)),""!==a?y.a.createElement(na,{student_id:a,teacherOnDuty:i,class_id:o,school_id:c,fetchStudentAttendance:function(){return e.props.fetchStudentAttendance()},hideModal:this.props.hideModal}):y.a.createElement(oa,{teacher_id:r,teacherOnDuty:i,navigation:this.props.navigation,fetchTeacherAttendance:function(){return e.props.fetchTeacherAttendance()},hideModal:this.props.hideModal}))}}]),n}(y.a.Component),da=(ue.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),Object(k.b)((function(e){return{students:e.school.students,isConnected:e.classInfo.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ca(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ca(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({markPresent:ye,sendWellnessDataFail:Re},e))}))(ua)),fa=n(181);function pa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ha(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ma=function(e){u()(a,e);var t=ha(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={messages:[]},n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(new Date(e))}},{key:"componentDidUpdate",value:function(e){if(e.date!==this.props.date){var t=this.props.date;this.fetchData(new Date(t))}}},{key:"fetchData",value:function(e){var t,n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(t=this.props.class_id,this.props.class.isConnected){o.next=5;break}return alert("\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),o.abrupt("return");case 5:return o.next=7,r.a.awrap(_n("/message/class/"+t+"/unread?date="+fn(e)));case 7:if(n=o.sent,a=n.success,n.statusCode,s=n.message,i=n.data,a){o.next=12;break}return fe.a.alert("Sorry \u53d6\u5f97\u5bb6\u9577\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s,[{text:"Ok"}]),o.abrupt("return");case 12:this.setState({messages:i}),this.denormalize(i);case 14:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].student_id]=e[n].message_for_teacher;this.props.getParentMessageSuccess(t)}},{key:"messageIsRead",value:function(e,t){return!(null!==e&&!e)&&!(null!==t&&!t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.students,r=t.class_id,s=t.date,i=this.state.messages,o=s.toDateString()!==(new Date).toDateString();return y.a.createElement(le.Card,{style:{flex:1,width:"90%"}},y.a.createElement(E.a,{style:{height:80,justifyContent:"center",marginTop:5}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center",position:"absolute"}},"\u8a0a\u606f"),y.a.createElement(C.a,{style:{width:"25%",alignSelf:"flex-end",position:"absolute",padding:5,backgroundColor:"#b5e9e9"},onPress:function(){e.props.navigation.push("Inbox",{messages:i,students:a,class_id:r,date:s,onGoBack:function(t){return e.fetchData(t)}})}},y.a.createElement(b.a,{style:ya.button_text},"\u67e5\u770b"))),y.a.createElement(E.a,{style:{}},y.a.createElement(Rn.a,{horizontal:!0},i.map((function(t,c){t.activities,t.items_to_bring,t.message_for_teacher,t.other_activity,t.other_item;var l=t.student_id,u=(t.teacher_id,t.text,t.message_read),d=t.morning_reminder_read;return e.messageIsRead(u,d)&&!o?null:y.a.createElement(C.a,{key:c,style:{flex:1,margin:3},onPress:function(){e.props.navigation.push("Inbox",{messages:i,students:a,class_id:r,date:s,onGoBack:function(t){return e.fetchData(t)}})}},y.a.createElement(le.Card,{style:{flex:1,alignItems:"center",padding:15}},y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{source:""===a[l].profile_picture?n(62):{uri:a[l].profile_picture},style:ya.thumbnailImage})),y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},a[l].name))))})))))}}]),a}(y.a.Component),ya=ue.a.create({card:{width:"90%",flex:1},button:{width:"30%",backgroundColor:"#b5e9e9"},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}}),ga=Object(k.b)((function(e){return{class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pa(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({getParentMessageSuccess:an},e))}),null,{forwardRef:!0})(ma);function _a(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ea=function(e){u()(a,e);var t=_a(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={},n}return c()(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,a=t.class_students,r=(t.students,t.student_absent),s=t.student_unmarked;return y.a.createElement(le.Card,{style:{flex:1,width:"90%"}},y.a.createElement(E.a,{style:{height:80,justifyContent:"center",marginTop:5}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center",position:"absolute"}},"\u51fa\u5e2d\u72c0\u6cc1")),y.a.createElement(E.a,{style:{}},y.a.createElement(Rn.a,{horizontal:!0},P()(s).map((function(t){var r=a[t];if(void 0!==r)return y.a.createElement(C.a,{key:t,style:{flex:1,margin:3},onPress:function(){e.props.showLoginNumberPad(t)}},y.a.createElement(le.Card,{style:{flex:1,alignItems:"center",paddingHorizontal:15,padding:10,backgroundColor:"#fff1b5"}},y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{source:""===r.profile_picture||null===r.profile_picture?n(62):{uri:r.profile_picture},style:ba.thumbnailImage})),y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},r.name))))})),P()(r).map((function(t){var r=a[t];if(void 0!==r)return y.a.createElement(C.a,{key:t,style:{flex:1,margin:3},onPress:function(){e.props.showLoginNumberPad(t)}},y.a.createElement(le.Card,{style:{flex:1,alignItems:"center",paddingHorizontal:15,padding:10,backgroundColor:"#ffe1d0"}},y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{source:""===r.profile_picture?n(62):{uri:r.profile_picture},style:ba.thumbnailImage})),y.a.createElement(E.a,{style:{justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},r.name))))})))))}}]),a}(y.a.Component),ba=ue.a.create({card:{width:"90%",flex:1},button:{width:"30%",backgroundColor:"#b5e9e9"},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:30},thumbnailImage:{height:150,width:150,borderRadius:75}}),va=Object(k.b)((function(e){return{attendance:e.school.attendance,students:e.school.students,student_absent:e.school.student_absent,student_unmarked:e.school.student_unmarked}}),null)(Ea),Sa=n(43),wa=n(338),Ca=n.n(wa);n(830);function ka(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}Sa.a.get("window").width;var Da=function(e){u()(n,e);var t=ka(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).onChange=function(e){console.log(e)},a.isWeekday=function(e){var t=new Date("September 26, 2020"),n=e.getDay();return 0!==n&&6!==n||e.toDateString()===t.toDateString()},a.state={datetime:new Date,isLoading:!0},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.start_date;this.setState({datetime:e,isLoading:!1})}},{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"setDate",value:function(e){this.isIOS()?this.iosSetDate(e):this.androidSetDate(e)}},{key:"iosSetDate",value:function(e){this.setState({datetime:e})}},{key:"androidSetDate",value:function(e){void 0!==e?this.props.selectDatetimeConfirm(e):this.props.hideModal()}},{key:"selectDatetimeConfirm",value:function(e){this.props.selectDatetimeConfirm(e),this.props.hideModal()}},{key:"render",value:function(){var e=this,t=this.props,n=t.datetime_type,a=t.minDatetime,r=t.maxDatetime,s=t.minTime,i=t.maxTime,o=t.paddingVertical,c=this.state,l=c.datetime;return c.isLoading?null:y.a.createElement(C.a,{style:{width:"100%",height:"100%",zIndex:2,position:"absolute",paddingVertical:o,alignItems:"center",backgroundColor:"rgba(0,0,0,0.7)"}},y.a.createElement(E.a,{style:{}},"date"===n&&y.a.createElement(Ca.a,{onChange:function(t){return e.selectDatetimeConfirm(t)},inline:!0,selected:l,minDate:new Date(a),maxDate:new Date(r),onClickOutside:function(){return e.props.hideModal()},filterDate:this.isWeekday}),"time"===n&&y.a.createElement(Ca.a,{onChange:function(t){return e.selectDatetimeConfirm(t)},showTimeSelect:!0,showTimeSelectOnly:!0,timeIntervals:30,timeCaption:"Time",dateFormat:"h:mm aa",selected:l,minTime:s,maxTime:i,onClickOutside:function(){return e.props.hideModal()}})))}}]),n}(y.a.Component);function xa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Aa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Oa=function(e){u()(a,e);var t=Aa(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).timer=function(e){return setTimeout((function(){n.poll(e)}),1e4)},n._handleAppStateChange=function(e){if(n.state.appState.match(/inactive|background/)&&"active"===e&&n.state.date.toDateString()!==(new Date).toDateString()){n.setState({isLoading:!0});var t=n.props.route.params.class_id;n.props.clearState(),n.props.setClassId(t),n.initializeClass(t),n.unsubscribe=fa.a.addEventListener((function(e){var t=e.isConnected;n.props.setConnectState(t),t?n.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}}):n.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#fa625f",marginRight:20}})}})}))}n.setState({appState:e,date:new Date})},n.state={date:new Date,isLoading:!0,showLoginNumberPad:!1,pageClicked:"",alertForPickup:!1,pickupQueue:[],showModal:!1,modalStudentId:"",modalTeacherId:"",isAdmin:!1,admin_id:"",appState:"",showDateTimeModal:!1},n.initializeClass=n.initializeClass.bind(_()(n)),n.handleEnterPasscode=n.handleEnterPasscode.bind(_()(n)),n.hideLoginPad=n.hideLoginPad.bind(_()(n)),n.onConfirmPickup=n.onConfirmPickup.bind(_()(n)),n.showModal=n.showModal.bind(_()(n)),n.hideModal=n.hideModal.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){this.initializeConnectionStatus();var e=this.props.route.params,t=e.class_id,n=e.class_name,a=e.isAdmin,r=e.admin_id;this.setState({isAdmin:a,admin_id:r}),this.props.setClassId(t),this.initializeClass(t),this.timeoutId=this.timer(t),this.props.navigation.setOptions({title:n}),this.fetchStudentAttendance(),de.a.addEventListener("change",this._handleAppStateChange)}},{key:"initializeConnectionStatus",value:function(){var e=this;window.navigator.onLine?(this.setOnline(),window.addEventListener("online",(function(t){console.log("online"),e.setOnline()})),window.addEventListener("offline",(function(t){console.log("offline"),e.setOffline()}))):this.setOffline()}},{key:"setOnline",value:function(){this.props.setConnectState(!0),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}})}},{key:"setOffline",value:function(){this.props.setConnectState(!1),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#fa625f",marginRight:20}})}})}},{key:"poll",value:function(e){var t,n=this;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/class/"+e+"/updates",a.next=3,r.a.awrap(fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.data.forEach((function(e){"attendance"===e?n.fetchStudentAttendance():n.refs[e].fetchData(n.state.date)}))})).catch((function(e){console.log("teacherhome poll err: ",e)})));case 3:this.timeoutId=this.timer(e);case 4:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"initializeClass",value:function(e){var t=this;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/class/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log("teacherHome/resJson: ",e),t.props.initializeClass(e.teachers,e.students),t.setState({isLoading:!1})})).catch((function(e){console.log("initializeClass err: ",e)}))}},{key:"handleEnterPasscode",value:function(e){var t=this.state.date,n=this.props,a=n.passcodeAdminId,r=n.passcodeTeacherId,s=n.teachers,i=r[e]||a[e],o=void 0!==a[e];void 0===i?le.Toast.show({text:"\u5bc6\u78bc\u4e0d\u6b63\u78ba!",buttonText:"Okay",position:"top",type:"danger",duration:3e3}):"attendance_modal"===this.state.pageClicked?this.setState({showModal:!0,showLoginNumberPad:!1,modalTeacherId:i}):(this.props.navigation.navigate(this.state.pageClicked,{teacher_id:i,class:this.props.class,date:t,isAdmin:o,teacher_name:s[i].name}),this.setState({showLoginNumberPad:!1}))}},{key:"pageClicked",value:function(e){var t=this.state,n=t.isAdmin,a=t.admin_id,r=t.date;n?this.props.navigation.push(e,{class:this.props.class,teacher_id:a,date:r,isAdmin:n,teacher_name:this.props.teachers[a].name}):this.setState({showLoginNumberPad:!0,pageClicked:e})}},{key:"hideLoginPad",value:function(){this.setState({showLoginNumberPad:!1})}},{key:"onConfirmPickup",value:function(){var e=this.state.pickupQueue.slice(1,this.state.pickupQueue.length);this.setState({alertForPickup:0!==e.length,pickupQueue:e})}},{key:"showModal",value:function(e){this.setState({showLoginNumberPad:!0,pageClicked:"attendance_modal",modalStudentId:e})}},{key:"fetchStudentAttendance",value:function(){var e,t,n,a,s,i,o,c,l,u;return r.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e=this.props.route.params.class_id,t=fn(this.state.date),d.next=4,r.a.awrap(_n("/attendance/class?class_id="+e+"&date="+t));case 4:if(n=d.sent,a=n.success,n.statusCode,s=n.message,i=n.data,a){d.next=9;break}return fe.a.alert("Sorry \u53d6\u5f97\u5b78\u751f\u51fa\u5e2d\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s,[{text:"Ok"}]),d.abrupt("return");case 9:o=i.attendance,c=i.students,l=i.present,u=i.absent,this.props.fetchStudentAttendanceSuccess(o,c,l,u);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"hideModal",value:function(){this.setState({showModal:!1})}},{key:"selectDatetimeConfirm",value:function(e){this.state.isAdmin&&!this.hasUnsentRecords()&&this.setState({date:e,showDateTimeModal:!1})}},{key:"goBackADay",value:function(){var e=new Date(this.state.date.getTime());1===e.getDay()?e.setDate(e.getDate()-3):e.setDate(e.getDate()-1),this.selectDatetimeConfirm(e)}},{key:"goForwardADay",value:function(){var e=new Date(this.state.date.getTime());5===e.getDay()?e.setDate(e.getDate()+3):e.setDate(e.getDate()+1),this.selectDatetimeConfirm(e)}},{key:"hasUnsentRecords",value:function(){var e=this.props,t=e.wellness_dispatched,n=e.message_dispatched,a=e.appetite_dispatched,r=e.sleep_dispatched,s=e.milk_dispatched,i=e.diaper_dispatched;return!(t&&n&&a&&r&&s&&i)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId),de.a.removeEventListener("change",this._handleAppStateChange),window.removeEventListener("online",console.log("removing online listener")),window.removeEventListener("offline",console.log("removing offline listener")),this.props.clearState()}},{key:"render",value:function(){var e=this,t=this.props.route.params,a=t.school_id,r=t.class_id,s=this.state,i=s.isLoading,o=s.date,c=s.showModal,l=s.modalStudentId,u=s.modalTeacherId,d=s.showDateTimeModal,f=s.isAdmin,p=this.props,h=p.wellness_dispatched,m=p.message_dispatched,g=p.appetite_dispatched,_=p.sleep_dispatched,b=p.milk_dispatched,v=p.diaper_dispatched;return i?y.a.createElement(Mn,null):y.a.createElement(le.Container,{style:{flex:1}},this.state.showLoginNumberPad?y.a.createElement(cn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:this.hideLoginPad}):null,d&&y.a.createElement(Da,{start_date:o,datetime_type:"date",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:new Date}),y.a.createElement(da,{show:c,student_id:l,teacher_id:null,teacherOnDuty:u,class_id:r,school_id:a,navigation:this.props.navigation,fetchStudentAttendance:function(){return e.fetchStudentAttendance()},fetchTeacherAttendance:function(){return null},hideModal:function(){return e.hideModal()}}),y.a.createElement(le.Content,{contentContainerStyle:{marginTop:30,paddingBottom:50,alignItems:"center",justifyContent:"center"}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"15%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return e.goBackADay()}},y.a.createElement(pe.a,{source:n(303),style:{width:40,height:40}}))),y.a.createElement(C.a,{onPress:function(){f&&!e.hasUnsentRecords()&&e.setState({showDateTimeModal:!0})}},y.a.createElement(le.Text,{style:{fontSize:50}},pn(o))),y.a.createElement(E.a,{style:{width:"15%"}},o.toDateString()!==(new Date).toDateString()&&y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return e.goForwardADay()}},y.a.createElement(pe.a,{source:n(304),style:{width:40,height:40}})))),y.a.createElement(ga,{ref:"messages",class_id:r,students:this.props.class.students,navigation:this.props.navigation,date:o}),y.a.createElement(zn,{ref:"med_request",class_id:r,students:this.props.class.students,medication_requests:this.props.medication_requests,navigation:this.props.navigation,date:o}),y.a.createElement(E.a,{style:Ra.button_row},y.a.createElement(C.a,{style:Ra.record_button,onPress:function(){return e.pageClicked("WellnessLog")}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(E.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"}},h?null:y.a.createElement(pe.a,{source:n(152),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})),y.a.createElement(le.Text,{style:Ra.button_text},"\u5065\u5eb7"))),y.a.createElement(C.a,{style:Ra.record_button,onPress:function(){return e.pageClicked("MessageForParents")}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(E.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"}},m?null:y.a.createElement(pe.a,{source:n(152),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})),y.a.createElement(le.Text,{style:Ra.button_text},"\u8001\u5e2b","\n","\uf9cd\u2f94"))),y.a.createElement(C.a,{style:Ra.record_button,onPress:function(){return e.pageClicked("TeacherAppetiteLog")}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(E.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"}},g?null:y.a.createElement(pe.a,{source:n(152),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})),y.a.createElement(le.Text,{style:Ra.button_text},"\u98f2\u98df")))),y.a.createElement(E.a,{style:Ra.button_row},y.a.createElement(C.a,{style:Ra.record_button,onPress:function(){return e.pageClicked("TeacherSleepLog")}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(E.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"}},_?null:y.a.createElement(pe.a,{source:n(152),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})),y.a.createElement(le.Text,{style:Ra.button_text},"\u7761\u7720"))),y.a.createElement(C.a,{style:Ra.record_button,onPress:function(){return e.pageClicked("TeacherMilkLog")}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(E.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"}},b?null:y.a.createElement(pe.a,{source:n(152),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})),y.a.createElement(le.Text,{style:Ra.button_text},"\u9935\u5976"))),y.a.createElement(C.a,{style:Ra.record_button,onPress:function(){return e.pageClicked("DiaperLog")}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(E.a,{style:{zIndex:2,position:"absolute",width:"100%",height:"100%"}},v?null:y.a.createElement(pe.a,{source:n(152),style:{width:25,height:25,marginTop:3,alignSelf:"flex-end"}})),y.a.createElement(le.Text,{style:Ra.button_text},"\u63db\u5c3f\u5e03")))),y.a.createElement(va,{class_students:this.props.class.students,showLoginNumberPad:function(t){return e.setState({showLoginNumberPad:!0,modalStudentId:t,pageClicked:"attendance_modal"})}}),y.a.createElement(C.a,{style:Ra.button,onPress:function(){return e.props.navigation.goBack()}},y.a.createElement(le.Text,{style:Ra.button_text},"\u8fd4\u56de"))))}}]),a}(y.a.Component),Ra=ue.a.create({card:{width:"90%"},button_row:{width:"90%",height:100,justifyContent:"space-between",flexDirection:"row",marginVertical:7,paddingHorizontal:3},button_text:{width:"100%",textAlign:"center",color:"gray",fontSize:40},record_button:{width:"30%",height:"100%",backgroundColor:"#b5e9e9"},button:{width:"30%",backgroundColor:"#b5e9e9"}}),ja=Object(k.b)((function(e){return{class:e.classInfo,medication_requests:e.medicationrequests,attendance:e.attendance,teachers:e.school.teachers,passcodeAdminId:e.school.passcodeAdminId,passcodeTeacherId:e.school.passcodeTeacherId,wellness_dispatched:e.healthstatus.data_dispatched,message_dispatched:e.message.data_dispatched,appetite_dispatched:e.appetite.data_dispatched,sleep_dispatched:e.sleep.data_dispatched,milk_dispatched:e.milk.data_dispatched,diaper_dispatched:e.diaper.data_dispatched}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xa(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({setConnectState:Vt,initializeClass:he,setClassId:Et,fetchStudentAttendanceSuccess:Qt,clearState:_t},e))}))(Oa),Ta=n(482),Pa=n(1307);function Ia(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function za(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var La=function(e){u()(n,e);var t=za(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={classes:[],err_message:"",showLoginNumberPad:!1,pageClicked:"",class_id:"",admin_id:""},a.handleSignOut=a.handleSignOut.bind(_()(a)),a}return c()(n,[{key:"componentDidMount",value:function(){var e,t=this;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return window.addEventListener("offline",(function(e){t.props.setConnectState(!1)})),window.addEventListener("online",(function(){t.props.setConnectState(!0)})),e=this.props.route.params.school_id,n.next=5,r.a.awrap(this.fetchClassIdAndName());case 5:this.fetchTeacherData(e),this.fetchStudentData(e);case 7:case"end":return n.stop()}}),null,this,null,Promise)}},{key:"fetchClassIdAndName",value:function(){var e,t=this;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e=this.props.route.params.school_id,n.next=3,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/school/"+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,a=e.message,r=e.data;if(n>200||"Internal server error"===a)alert("Sorry \u53d6\u5f97\u6559\u5ba4\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+a);else{t.setState({classes:r.classes});var s={};r.classes.forEach((function(e){var t=e.id,n=e.name;s[t]={teachers:[],students:[],name:n}})),t.props.fetchClassesSuccess(s,r.admin_passcode)}})).catch((function(e){alert("Sorry \u53d6\u5f97\u6559\u5ba4\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b")})));case 3:case"end":return n.stop()}}),null,this,null,Promise)}},{key:"fetchTeacherData",value:function(e){var t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.a.awrap(_n("/school/"+e+"/teacher"));case 2:if(t=l.sent,n=t.success,t.statusCode,a=t.message,s=t.data,n){l.next=7;break}return alert("Sorry \u53d6\u5f97\u6559\u5e2b\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),l.abrupt("return");case 7:i=s.admins,o=s.teachers,c=s.classes,this.props.fetchTeachersSuccess(i,o,c),this.getAdminId(o);case 10:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"getAdminId",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)if("\u7ba1\u7406\u54e1"===e[t[n]].name)return void this.setState({admin_id:t[n]})}},{key:"fetchStudentData",value:function(e){var t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.a.awrap(_n("/school/"+e+"/student"));case 2:if(t=c.sent,n=t.success,t.statusCode,a=t.message,s=t.data,n){c.next=7;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),c.abrupt("return");case 7:i=s.students,o=s.classes,this.props.fetchStudentsSuccess(i,o),this.props.initializeStudentWellness(Object.keys(i));case 10:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"fetchPickupRequest",value:function(e){var t=this;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/attendance/pickup-request?school_id="+e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.data.length>0&&(t.props.addPickupRequest(e.data),t.props.navigation.navigate("PickupAlert",{}))})).catch((function(e){alert("Sorry \u53d6\u5f97\u63a5\u56de\u544a\u77e5\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b")}))}},{key:"fetchStudentAttendance",value:function(){var e,t,n,a,s,i,o,c,l,u;return r.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e=this.props.route.params.school_id,t=fn(new Date),d.next=4,r.a.awrap(_n("/attendance?school_id="+e+"&date="+t));case 4:if(n=d.sent,a=n.success,n.statusCode,s=n.message,i=n.data,a){d.next=9;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u51fa\u5e2d\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),d.abrupt("return");case 9:o=i.attendance,c=i.students,l=i.present,u=i.absent,this.props.fetchStudentAttendanceSuccess(o,c,l,u);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"handleEnterPasscode",value:function(e){console.log(e);var t=this.props.route.params,n=t.school_name,a=t.school_id,r=this.props,s=r.passcodeAdminId,i=r.passcodeTeacherId,o=r.classes,c=r.teachers,l=this.state,u=l.pageClicked,d=l.class_id,f=i[e],p=s[e];console.log(p),void 0===f&&void 0===p?alert("\u5bc6\u78bc\u4e0d\u6b63\u78ba\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"):void 0!==p?(this.setState({showLoginNumberPad:!1}),this.props.navigation.navigate(u,{school_name:n,school_id:a,class_id:d,class_name:"\u7ba1\u7406\u54e1\uff1a"+c[p].name,isAdmin:!0,admin_id:p})):""!==d&&!o[d].teachers.includes(f)||"AdminHome"===u?alert("Sorry \u6b0a\u9650\u4e0d\u5408\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"):(this.setState({showLoginNumberPad:!1}),this.props.updateViewingStatus("teacher"),this.props.navigation.navigate("TeacherHome",{class_id:d,class_name:o[d].name,isAdmin:!1}))}},{key:"hideLoginPad",value:function(){this.setState({showLoginNumberPad:!1})}},{key:"handleSignOut",value:function(){var e=this.props.route.params.loadAuth;w.a.signOut().then((function(){e()})).catch((function(e){return console.log(e)}))}},{key:"componentWillUnmount",value:function(){var e=this;window.removeEventListener("offline",(function(t){e.props.setConnectState(!1)})),window.removeEventListener("online",(function(t){e.props.setConnectState(!1)})),this.props.clearSchoolState()}},{key:"render",value:function(){var e=this,t=this.state,n=t.classes,a=t.showLoginNumberPad,r=this.props.route.params.school_id;return y.a.createElement(E.a,{style:{flex:1,flexDirection:"column"}},a?y.a.createElement(cn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:function(){return e.hideLoginPad()}}):null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{key:"admin",style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){return e.setState({showLoginNumberPad:!0,pageClicked:"AdminHome"})}},y.a.createElement(b.a,{style:{fontSize:50,textAlign:"center"}},"\u884c\u653f\u7ba1\u7406")),y.a.createElement(C.a,{key:"child_dismissal",style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){e.props.updateViewingStatus("dismissal"),e.props.navigation.push("DismissChildQRScan",{})}},y.a.createElement(b.a,{style:{fontSize:50,textAlign:"center"}},"\u653e\u5b78"))),y.a.createElement(C.a,{key:"attendance_page",style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){e.props.navigation.push("AttendancePage",{school_id:r})}},y.a.createElement(b.a,{style:{fontSize:80,textAlign:"center"}},"\u51fa\u5e2d/\u6253\u5361")),y.a.createElement(E.a,{style:{flex:3}},n.map((function(t){return"\u7ba1\u7406\u54e1"===t.name?null:y.a.createElement(C.a,{key:t.id,style:{flex:1,backgroundColor:"#74b987",margin:10,justifyContent:"center"},onPress:function(){return e.setState({showLoginNumberPad:!0,pageClicked:"TeacherHome",class_id:t.id})}},y.a.createElement(b.a,{style:{fontSize:80,textAlign:"center"}},t.name))}))))}}]),n}(y.a.Component),Ma=Object(k.b)((function(e){return{pick_up_request:e.school.pick_up_request,passcodeAdminId:e.school.passcodeAdminId,passcodeTeacherId:e.school.passcodeTeacherId,classes:e.school.classes,teachers:e.school.teachers,viewing_status:e.school.viewing_status,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ia(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ia(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({setConnectState:Vt,fetchClassesSuccess:qt,fetchTeachersSuccess:Nt,fetchStudentsSuccess:Ut,initializeStudentWellness:Ht,addPickupRequest:Yt,clearSchoolState:Kt,updateViewingStatus:Xt,fetchStudentAttendanceSuccess:Qt},e))}))(La);function Fa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ba(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var qa=function(e){u()(n,e);var t=Ba(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={logging_in:!1,teacher_id:""},a.handleEnterPasscode=a.handleEnterPasscode.bind(_()(a)),a.hideLoginPad=a.hideLoginPad.bind(_()(a)),a}return c()(n,[{key:"componentDidMount",value:function(){this.fetchStaffAttendanceByClassId()}},{key:"fetchStaffAttendanceByClassId",value:function(){var e=this,t=this.props.class,n=t.class_id;t.isConnected?fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance?class_id="+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){e.props.fetchAttendanceSuccess(t.data)})).catch((function(e){console.log("err: ",e)})):le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"handleEnterPasscode",value:function(e){var t=this.props.class.passcodeTeacherId[e];if(void 0===t||t!==this.state.teacher_id)le.Toast.show({text:"Wrong password!",buttonText:"Okay",position:"top",type:"warning",duration:3e3});else{var n=this.props.class.teachers[t],a=new Date;n.logged_in?this.clockOut(t,a):this.clockIn(t,a),this.setState({logging_in:!1})}}},{key:"clockIn",value:function(e,t){var n=this;if(this.props.class.isConnected){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({staff_id:e})}).then((function(e){return e.json()})).then((function(a){var r=a.statusCode,s=a.message,i=a.data;r>200||"Internal server error"===a.message?n.props.markStaffAttendanceFail(s):n.props.markTeacherLoggedIn(e,t,i.attendance_id)})).catch((function(e){console.log("err: ",e)}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"clockOut",value:function(e,t){var n=this;if(this.props.class.isConnected){var a=this.props.class.teachers[e].attendance_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/staff-attendance/"+a,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(a){var r=a.statusCode,s=a.message;r>200||"Internal server error"===s?n.props.markStaffAttendanceFail(s):n.props.markTeacherLoggedOut(e,t)})).catch((function(e){console.log("err: ",e)}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:5e3})}},{key:"hideLoginPad",value:function(){this.setState({logging_in:!1})}},{key:"render",value:function(){var e=this,t=this.props.class.errMessage;return y.a.createElement(le.Container,null,""!==t?y.a.createElement(le.Text,{style:{fontSize:20,color:"red"}},t):null,this.state.logging_in?y.a.createElement(cn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:this.hideLoginPad}):null,y.a.createElement(le.Content,{contentContainerStyle:{marginTop:30,paddingBottom:30,alignSelf:"center",flexDirection:"row"}},Object.keys(this.props.class.teachers).map((function(t){return y.a.createElement(C.a,{key:t,style:{margin:20},underlayColor:"transparent",onPress:function(){return e.setState({logging_in:!0,teacher_id:t})}},y.a.createElement(le.View,{style:Na.cardContainer},y.a.createElement(le.Card,null,y.a.createElement(le.CardItem,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{style:Na.thumbnailImage})),y.a.createElement(le.CardItem,{footer:!0,style:{justifyContent:"center",backgroundColor:e.props.class.teachers[t].logged_in?"#dcf3d0":"#ffe1d0"}},y.a.createElement(le.Text,null,e.props.class.teachers[t].name)))))}))))}}]),n}(y.a.Component),Na=ue.a.create({cardContainer:{width:119,height:150,margin:2,marginBottom:-2},thumbnailImage:{height:80,width:80,borderRadius:40}}),Ua=Object(k.b)((function(e){return{class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fa(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({markTeacherLoggedIn:ve,markTeacherLoggedOut:Se,markStaffAttendanceFail:kt,fetchAttendanceSuccess:be},e))}))(qa),Ha=n(115);function Wa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Va=function(e){u()(a,e);var t=Wa(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={medicated_time:new Date,showTimePicker:!1},n}return c()(a,[{key:"selectDatetimeConfirm",value:function(e){this.setState({medicated_time:e,showTimePicker:!1})}},{key:"render",value:function(){var e=this,t=this.props,a=t.thumbnail,r=t.student_name,s=t.request,i=this.state,o=i.medicated_time,c=i.showTimePicker,l=s.administered,u=s.fever_entry,d=s.medication,f=s.note,p=(s.student_id,s.teacher_id,s.timestamp),h=d.before_meal,m=d.gel,g=d.other_type,_=d.powder,v=d.powder_refrigerated,S=d.syrup,w=gn(new Date(p));return y.a.createElement(le.Card,{style:{flex:1,alignSelf:"center",width:"100%"}},c?y.a.createElement(Da,{start_date:o,datetime_type:"time",hideModal:function(){return e.setState({showTimePicker:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:null}):null,y.a.createElement(E.a,{style:{flex:.35,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center",justifyContent:"center"}},y.a.createElement(pe.a,{source:""===a?n(62):{uri:a},style:Ka.thumbnailImage})),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"flex-start"}},y.a.createElement(b.a,{style:{fontSize:70,fontWeight:"bold"}},r),y.a.createElement(b.a,{style:{fontSize:70,fontWeight:"bold"}},w," ",null===h?null:h?"\u9910\u524d":"\u9910\u5f8c"))),y.a.createElement(E.a,{style:{flex:.65,paddingBottom:20}},y.a.createElement(E.a,{style:{width:"100%",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-evenly"}},_&&y.a.createElement(E.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",flexDirection:"row",marginBottom:15,marginHorizontal:7}},y.a.createElement(pe.a,{source:n(893)}),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u85e5\u7c89"),v&&y.a.createElement(b.a,{style:{fontSize:30}},"\u9700\u51b7\u85cf"))),0!==S.length&&y.a.createElement(E.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7}},y.a.createElement(pe.a,{source:n(894)}),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u85e5\u6c34"),S.map((function(e,t){return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(b.a,{style:{fontSize:20}},e.amount," c.c."),e.need_refrigerated&&y.a.createElement(b.a,{style:{fontSize:20,marginLeft:20}},"\u9700\u51b7\u85cf"))})))),m&&y.a.createElement(E.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7}},y.a.createElement(pe.a,{source:n(895)}),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u85e5\u818f"),y.a.createElement(b.a,{style:{fontSize:30}},m))),g&&y.a.createElement(E.a,{style:{width:"48%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",marginBottom:15,flexDirection:"row",marginHorizontal:7}},y.a.createElement(pe.a,{source:n(896)}),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:30}},"\u5176\u4ed6"),y.a.createElement(b.a,{style:{fontSize:30}},g)))),y.a.createElement(E.a,{style:{width:"97%",marginHorizontal:10,flexDirection:"row",justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"32%",aspectRatio:1,backgroundColor:"#fff1b5"}},y.a.createElement(E.a,{style:{padding:10}},y.a.createElement(b.a,{style:{fontSize:30}},"\u5099\u8a3b")),y.a.createElement(E.a,{style:{padding:10}},y.a.createElement(b.a,{style:{fontSize:25}},f))),y.a.createElement(E.a,{style:{width:"40%",backgroundColor:"#fa625f"}},y.a.createElement(E.a,{style:{padding:10}},y.a.createElement(b.a,{style:{fontSize:30,color:"white"}},"\u767c\u71d2\u8d85\u904e ",u.temperature,"\xb0C")),y.a.createElement(E.a,{style:{padding:10}},u.powder&&y.a.createElement(b.a,{style:{fontSize:25,color:"white"}},"\u85e5\u7c89 ",u.powder_refrigerated&&"\u9700\u51b7\u85cf"),0!==u.syrup.length&&y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(b.a,{style:{fontSize:25,color:"white"}},"\u85e5\u6c34    "),u.syrup.map((function(e,t){return y.a.createElement(b.a,{key:t,style:{fontSize:25,color:"white"}},e.amount," c.c. ",e.need_refrigerated&&"\u9700\u51b7\u85cf")}))),u.other_type&&y.a.createElement(b.a,{style:{fontSize:25,color:"white"}},"\u5176\u4ed6    ",u.other_type))),y.a.createElement(E.a,{style:{width:"25%",justifyContent:"space-between"}},y.a.createElement(C.a,{style:{padding:15,backgroundColor:"rgba(0,0,0,0.2)",justifyContent:"center",alignItems:"center"},onPress:function(){return e.setState({showTimePicker:!0})}},y.a.createElement(b.a,{style:{fontSize:40}},yn(o))),y.a.createElement(C.a,{style:{padding:15,width:"100%",backgroundColor:l?"#dcf3d0":"#ffe1d0",alignItems:"center"},onPress:function(){return e.props.showLoginNumberPad()}},y.a.createElement(b.a,{style:{fontSize:40}},"\u5b8c\u6210"))))))}}]),a}(y.a.Component),Ka=ue.a.create({thumbnailImage:{height:180,width:180,borderRadius:90}});function Ga(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Qa(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ja=function(e){u()(a,e);var t=Qa(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,refreshing:!1,selected_request_id:"",showLoginNumberPad:!1},n.handleShowRequest=n.handleShowRequest.bind(_()(n)),n.handleFulfillRequest=n.handleFulfillRequest.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.route.params.request_id;null!==e?this.handleShowRequest(e):this.setState({isLoading:!1})}},{key:"handleShowRequest",value:function(e){this.setState({selected_request_id:e,isLoading:!1})}},{key:"handleEnterPasscode",value:function(e){var t=this.props.class.passcodeTeacherId[e];void 0===t?fe.a.alert("Wrong password","Please try again",[{text:"OK"}]):(this.setState({showLoginNumberPad:!1}),this.handleFulfillRequest(t))}},{key:"hideLoginPad",value:function(){this.setState({showLoginNumberPad:!1})}},{key:"handleFulfillRequest",value:function(e){var t=this,n=this.state.selected_request_id,a=this.props.requests.requests[n].student_id;this.props.class.isConnected?fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/medicationrequest",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:n,teacher_id:e,student_id:a})}).then((function(e){return e.json()})).then((function(e){var a=e.statusCode,r=e.message;e.data;a>200||"Internal server error"===r?fe.a.alert("Error, please try again",r,[{text:"OK"}]):(t.props.fillMedRequest(n),t.props.navigation.goBack())})).catch((function(e){fe.a.alert("Error, please try again",e.message,[{text:"OK"}])})):le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"render",value:function(){var e=this,t=this.state,a=t.selected_request_id,r=t.isLoading,s=t.showLoginNumberPad;if(r)return y.a.createElement(Mn,null);var i=this.props.requests.requests,o=this.props.class.students,c=i[a];return y.a.createElement(E.a,{style:{flex:1}},s?y.a.createElement(cn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:this.hideLoginPad}):null,y.a.createElement(Rn.a,{contentContainerStyle:{flex:1,padding:10},refreshControl:y.a.createElement(Ha.a,{style:{backgroundColor:"#E0FFFF"},refreshing:this.state.refreshing,onRefresh:this.fetchFromDB,tintColor:"#ff0000",title:"Loading...",titleColor:"#00ff00",colors:["#ff0000","#00ff00","#0000ff"],progressBackgroundColor:"#ffff00"})},y.a.createElement(E.a,{style:{flex:3}},""===a?null:y.a.createElement(Va,{thumbnail:o[c.student_id].profile_picture,student_name:o[c.student_id].name,request:c,showLoginNumberPad:function(){return e.setState({showLoginNumberPad:!0})}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(Rn.a,{horizontal:!0},Object.keys(i).map((function(t){var a=i[t].student_id,r=i[t],s=r.timestamp,c=r.administered,l=gn(new Date(s));return y.a.createElement(C.a,{key:t,style:Ya.cardContainer,underlayColor:"transparent",onPress:function(){return e.handleShowRequest(t)}},y.a.createElement(le.Card,{style:{flex:1,backgroundColor:c?"#dcf3d0":"#ffe1d0"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},l)),y.a.createElement(E.a,{style:{flex:2,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:""===e.props.class.students[a].profile_picture?n(62):{uri:o[a].profile_picture},style:Ya.thumbnailImage})),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},o[a].name))))}))))))}}]),a}(y.a.Component),Ya=ue.a.create({cardContainer:{width:170,paddingRight:5},thumbnailImage:{height:110,width:110,borderRadius:55}}),Xa=Object(k.b)((function(e){return{class:e.classInfo,requests:e.medicationrequests}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ga(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ga(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({initializeRequests:_e,fillMedRequest:Ee},e))}))(Ja);function Za(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function $a(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var er=function(e){u()(a,e);var t=$a(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,date:new Date,show_record:!1,showDateTimeModal:!1},n.handleSend=n.handleSend.bind(_()(n)),n.addRecord=n.addRecord.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.wellness.record_id_for_update,t=this.props.class.isConnected,n=this.props.route.params,a=n.date,r=n.teacher_name;0===e.size&&t?(this.setState({date:a}),this.fetchClassData(a)):this.setState({isLoading:!1}),t||le.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3}),this.props.navigation.setOptions({title:"\u5065\u5eb7 - "+r})}},{key:"fetchClassData",value:function(e){var t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(le.View,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#f4d41f",marginRight:20}})}}),t=new Date(e),n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=7,r.a.awrap(wn("wellness",this.props.class.class_id,n,a));case 7:s=i.sent,this.denormalize(s),this.props.fetchClassWellnessData(s.data),this.setState({isLoading:!1}),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(le.View,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}});case 12:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(Object.keys(e.data.records).length){var t=e.data.records;for(var n in t)e.data.records[n].time=new Date(t[n].time)}}},{key:"hasUnsentRecord",value:function(e){for(var t=this.props.wellness.record_id_for_update,n=!1,a=0;a<e.length;a++)if(t.has(e[a])){n=!0;break}return n}},{key:"addRecord",value:function(e){2!==this.props.wellness.by_student_id[e].length?this.props.addWellnessRecord(e):fe.a.alert("\u4eca\u5929\u5df2\u7d93\u91cf\u4e86\u5169\u6b21\u9ad4\u6eab\u4e86","",[{text:"OK"}])}},{key:"handleSend",value:function(){var e,t,n=this;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(e=this.props.wellness,this.props.class.isConnected){a.next=5;break}return le.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3}),a.abrupt("return");case 5:return this.setState({isLoading:!0}),a.next=8,r.a.awrap(Cn(e,this.props.class.class_id,fn(new Date)));case 8:(t=a.sent).success?(t.data.forEach((function(e){n.props.markPresent(e,new Date)})),this.props.sendWellnessDataSuccess(),this.props.navigation.goBack()):(this.props.sendWellnessDataFail(t.message),fe.a.alert("Err",t.message,[{text:"OK"}])),this.setState({isLoading:!1});case 11:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"wellnessDataValidated",value:function(){var e=this,t=this.props.wellness,n=t.records,a=t.record_id_for_update,r=!0;return a.forEach((function(t){""===n[t].temperature?(e.props.invalidateWellnessData(t,"Temperature is not filled out"),r=!1):""===n[t].status&&(e.props.invalidateWellnessData(t,"Health status is not filled out"),r=!1)})),r}},{key:"selectDatetimeConfirm",value:function(e){this.setState({date:e,showDateTimeModal:!1}),this.fetchClassData(e)}},{key:"render",value:function(){var e=this,t=this.props.wellness,a=t.by_student_id,r=(t.records,this.props.route.params),s=r.teacher_id,i=r.isAdmin,o=this.state,c=o.showDateTimeModal,l=o.date,u=o.isLoading;return y.a.createElement(Un.a,{style:{flex:1},behavior:"height",keyboardVerticalOffset:80,enabled:!0},c&&y.a.createElement(Da,{start_date:l,datetime_type:"date",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:new Date}),y.a.createElement(le.View,{style:{flexDirection:"row",width:"90%",justifyContent:"space-between",alignSelf:"center",alignItems:"center"}},y.a.createElement(C.a,{onPress:function(){e.props.wellness.data_dispatched&&i&&e.setState({showDateTimeModal:!0})}},y.a.createElement(le.Text,{style:{fontSize:40}},pn(l))),y.a.createElement(C.a,{disabled:u,style:{backgroundColor:u?"rgba(0,0,0,0.5)":"#dcf3d0",padding:10},onPress:this.handleSend},y.a.createElement(le.Text,{style:{fontSize:40}},"\u9001\u51fa"))),y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center",marginBottom:20}},Object.keys(this.props.class.students).map((function(t){var r=a[t];return y.a.createElement(le.View,{key:t,style:{width:"98%"}},y.a.createElement(le.Card,null,y.a.createElement(le.CardItem,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{style:tr.childThumbnail},y.a.createElement(pe.a,{source:""===e.props.class.students[t].profile_picture?n(62):{uri:e.props.class.students[t].profile_picture},style:tr.thumbnailImage})),y.a.createElement(le.View,{style:{flex:3}},y.a.createElement(le.View,{style:{flex:1,flexDirection:"row",paddingVertical:10}},y.a.createElement(le.View,{style:{flex:1}},y.a.createElement(le.Text,{style:{fontSize:25}},e.props.class.students[t].name)),y.a.createElement(le.View,{style:{flex:1,alignItems:"flex-end"}},e.hasUnsentRecord(r)?y.a.createElement(le.Text,{style:{color:"red",fontSize:15}},"\u672a\u9001\u51fa"):null)),r.map((function(e,n){return y.a.createElement(le.View,{style:{flex:1},key:e},0===n?y.a.createElement(le.Text,null,"\u65e9\u4e0a"):y.a.createElement(le.Text,null,"\u4e0b\u5348"),y.a.createElement(Xn,{student_id:t,record_id:e,teacher_id:s}))}))))))}))))}}]),a}(y.a.Component),tr=ue.a.create({childThumbnail:{flex:1,backgroundColor:"white",marginLeft:-7},thumbnailImage:{width:140,height:140,borderRadius:70},subHeading:{width:355,height:45,marginTop:10,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),nr=Object(k.b)((function(e){return{class:e.classInfo,wellness:e.healthstatus,unmarked:e.attendance.unmarked}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Za(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Za(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({fetchClassWellnessData:Ye,markPresent:ye,sendWellnessDataSuccess:Oe,sendWellnessDataFail:Re,addWellnessRecord:De,invalidateWellnessData:je},e))}))(er);function ar(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var rr=function(e){u()(n,e);var t=ar(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"render",value:function(){return y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(b.a,{style:{fontSize:30}},this.props.title))}}]),n}(y.a.Component);function sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ir(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sr(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function or(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var cr=function(e){u()(a,e);var t=or(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={date:new Date,isLoading:!0,mealType:"",selectedForCustomize:new Set,editingFruitType:!1,students_with_records:[],showDateTimeModal:!1,display_all_students:!0,students_to_display:new Set},n.handleRateFoodWellness=n.handleRateFoodWellness.bind(_()(n)),n.handleSend=n.handleSend.bind(_()(n)),n.handleClearAll=n.handleClearAll.bind(_()(n)),n.handleSetAll=n.handleSetAll.bind(_()(n)),n.handleAllDrank=n.handleAllDrank.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.date,n=e.teacher_name,a=this.props.appetite.updatedStudents,r=this.props.class,s=r.isConnected,i=r.students;this.setState({students_to_display:new Set(Object.keys(i))}),a.size>0||!s?this.setState({isLoading:!1}):(this.setState({date:t}),this.fetchClassData(t)),s||le.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3}),this.props.navigation.setOptions({title:"\u98f2\u98df - "+n})}},{key:"fetchClassData",value:function(e){var t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#f4d41f",marginRight:20}})}}),t=new Date(e),n=fn(t),t.setDate(t.getDate()+1),a=fn(t),l.next=7,r.a.awrap(wn("appetite",this.props.class.class_id,n,a));case 7:if(void 0!==(s=l.sent).data[n]){l.next=11;break}return this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}}),l.abrupt("return");case 11:i=s.data[n],o=i.fruit_name,c=i.ratings,this.props.fetchClassAppetiteData(o,c),this.setState({isLoading:!1,students_with_records:Object.keys(c)}),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}});case 15:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"editFruitName",value:function(e){this.props.editFruitName(e)}},{key:"fruitNameEditorOnBlur",value:function(){var e=this.state.students_with_records;this.setState({editingFruitType:!1}),""===this.props.appetite.fruit_name&&this.props.editFruitName("\u6c34\u679c"),e.length>1&&this.props.addStudentIdForUpdate(e)}},{key:"handleRateFoodWellness",value:function(e,t){if(""===this.state.mealType)le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3});else{var n=this.state.selectedForCustomize,a=this.props.route.params.teacher_id;n.delete(e),this.setState({selectedForCustomize:n}),this.props.rateAppetite(e,this.state.mealType,t,a)}}},{key:"onClickOther",value:function(e){var t=this.state,n=t.mealType,a=t.selectedForCustomize,r=this.props.route.params.teacher_id;""===n?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):(this.setState({selectedForCustomize:new Set([].concat(P()(a),[e]))}),this.props.rateAppetite(e,this.state.mealType,"",r))}},{key:"isRatingCustomized",value:function(e){return""!==this.state.mealType&&("\u80c3\u53e3\u4f73"!==e&&"\u6eff\u6eff\u4e00\u7897"!==e&&"\uff17/8\u5206\u6eff"!==e&&"\u534a\u7897"!==e&&"\u80c3\u53e3\u4e0d\u4f73"!==e&&""!==e)}},{key:"onCustomizeRating",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.rateAppetite(e,this.state.mealType,t,n)}},{key:"customizedRatingOnBlur",value:function(e){var t=this.state.selectedForCustomize;t.delete(e),this.setState({selectedForCustomize:t})}},{key:"markWaterDrank",value:function(e){var t=this.props.route.params.teacher_id;""===this.state.mealType?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):this.props.markWaterDrank(e,this.state.mealType,t)}},{key:"handleSetAll",value:function(){var e=this.props.route.params.teacher_id,t=this.state.students_to_display;""===this.state.mealType?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):this.props.setAllRatingsToGreat(this.state.mealType,P()(t),e)}},{key:"handleClearAll",value:function(){""===this.state.mealType?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):this.props.clearRatings(this.state.mealType)}},{key:"handleAllDrank",value:function(){var e=this.props.route.params.teacher_id,t=this.state.students_to_display;""===this.state.mealType?le.Toast.show({text:"\u8acb\u9078\u64c7\u9910\u6642",buttonText:"Okay",position:"top",duration:3e3}):this.props.setAllDrinkWater(this.state.mealType,P()(t),e)}},{key:"handleSend",value:function(){var e=this,t=this.props.class.isConnected,n=this.props.appetite,a=n.updatedStudents,r=n.fruit_name,s=[],i=this.props.appetite.ratings;if(0===a.size&&this.props.navigation.goBack(),t){a.forEach((function(e){var t=i[e],n={student_id:e,b_rating:t.Breakfast,f_rating:t.Fruit,l_rating:t.Lunch,s_rating:t.Snack,teacher_id:t.teacher_id};s.push(n)}));var o={date:fn(new Date),fruit_name:r,obj:s};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/appetite",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,a=t.message;n>200||"Internal Server Error"===a?e.props.alertErrMessage(a):(e.props.onSendAppetiteSuccess(),e.props.navigation.goBack())})).catch((function(t){e.props.alertErrMessage(t)}))}else le.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3})}},{key:"selectDatetimeConfirm",value:function(e){this.setState({date:e,showDateTimeModal:!1}),this.fetchClassData(e)}},{key:"addStudentToDisplayList",value:function(e){var t=this.state,n=t.display_all_students,a=t.students_to_display;if(n)this.setState({students_to_display:new Set([e]),display_all_students:!1});else if(a.has(e)){var r=new Set(P()(a));r.delete(e),this.setState({students_to_display:r})}else{var s=new Set(P()(a));s.add(e),this.setState({students_to_display:s})}}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this;""!==this.props.appetite.err_message&&fe.a.alert("Error!",this.props.appetite.err_message,[{text:"OK",onPress:function(){return e.props.clearAppetiteErrorMessage()}}]);var t=this.props.route.params.isAdmin,a=this.state,r=a.mealType,s=a.selectedForCustomize,i=a.editingFruitType,o=a.date,c=a.showDateTimeModal,l=a.display_all_students,u=a.students_to_display,d=this.props.class.students;return y.a.createElement(Un.a,{style:{flex:1,backgroundColor:"Breakfast"===r?"#ffe1d0":"Fruit"===r?"#ffddb7":"Lunch"===r?"#fff1b5":"Snack"===r?"#dcf3d0":"transparent"},behavior:"height",keyboardVerticalOffset:80,enabled:!0},c&&y.a.createElement(Da,{start_date:o,datetime_type:"date",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:new Date}),y.a.createElement(E.a,{style:lr.subHeading},y.a.createElement(C.a,{onPress:function(){e.props.appetite.data_dispatched&&t&&e.setState({showDateTimeModal:!0})}},y.a.createElement(b.a,{style:{fontSize:40}},pn(o))),y.a.createElement(C.a,{style:{backgroundColor:"#b5e9e9",padding:10},onPress:this.handleSetAll},y.a.createElement(b.a,{style:{color:"grey",fontSize:40}},"\u5168\u80c3\u53e3\u4f73")),y.a.createElement(C.a,{style:{backgroundColor:"#b5e9e9",padding:10},onPress:this.handleAllDrank},y.a.createElement(b.a,{style:{color:"grey",fontSize:40}},"\u5168\u559d\u6c34")),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend},y.a.createElement(b.a,{style:{color:"grey",fontSize:40}},"\u9001\u51fa"))),y.a.createElement(E.a,{style:lr.mealButtons},y.a.createElement(C.a,{style:{backgroundColor:"Breakfast"===r?"#fa625f":"#ffe1d0",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#fa625f",onPress:function(){return e.setState({mealType:"Breakfast",editingFruitType:!1})}},y.a.createElement(b.a,{style:lr.mealButtonText},"\u65e9\u9910")),y.a.createElement(C.a,{style:{backgroundColor:"Fruit"===r?"#ff8944":"#ffddb7",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%"},underlayColor:"#ff8944",onPress:function(){return e.setState({mealType:"Fruit"})},onLongPress:function(){return e.setState({mealType:"Fruit",editingFruitType:!0})}},i?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{paddingLeft:5}},"\u6c34\u679c:"),y.a.createElement(Hn.a,{autoFocus:!0,selectTextOnFocus:!0,style:{width:"95%",alignSelf:"center",fontSize:25,textAlign:"center",color:"grey",borderWidth:1},onChangeText:function(t){return e.editFruitName(t)},value:this.props.appetite.fruit_name,onBlur:function(){return e.fruitNameEditorOnBlur()}})):y.a.createElement(b.a,{style:lr.mealButtonText},this.props.appetite.fruit_name)),y.a.createElement(C.a,{style:{backgroundColor:"Lunch"===r?"#f4d41f":"#fff1b5",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#f4d41f",onPress:function(){return e.setState({mealType:"Lunch",editingFruitType:!1})}},y.a.createElement(b.a,{style:lr.mealButtonText},"\u5348\u9910")),y.a.createElement(C.a,{style:{backgroundColor:"Snack"===r?"#00c07f":"#dcf3d0",width:"23%",height:60,justifyContent:"center",marginHorizontal:"1%",padding:10},underlayColor:"#00c07f",onPress:function(){return e.setState({mealType:"Snack",editingFruitType:!1})}},y.a.createElement(b.a,{style:lr.mealButtonText},"\u9ede\u5fc3"))),y.a.createElement(E.a,{style:{width:"98%",flexDirection:"row",flexWrap:"wrap",alignSelf:"center",justifyContent:"space-evenly"}},y.a.createElement(C.a,{style:{padding:5,backgroundColor:l?"#b5e9e9":"rgba(255,255,255,0.8)",marginRight:3},onPress:function(){e.setState({display_all_students:!0,students_to_display:new Set(Object.keys(d))})}},y.a.createElement(b.a,{style:{fontSize:25}},"\u5168\u73ed")),Object.keys(d).map((function(t){return y.a.createElement(C.a,{key:t,style:{padding:5,backgroundColor:u.has(t)&&!l?"#b5e9e9":"rgba(255,255,255,0.8)",marginRight:3},onPress:function(){return e.addStudentToDisplayList(t)}},y.a.createElement(b.a,{style:{fontSize:25}},d[t].name))}))),y.a.createElement(le.Content,{contentContainerStyle:{alignItems:"center"}},P()(u).reverse().map((function(t){var a=""===r?"":e.props.appetite.ratings[t][r].slice(0,-1),i=""!==r&&"1"===e.props.appetite.ratings[t][r].slice(-1);return y.a.createElement(E.a,{key:t,style:{width:"98%"}},y.a.createElement(le.Card,null,y.a.createElement(le.CardItem,null,y.a.createElement(E.a,{style:lr.childThumbnail},y.a.createElement(pe.a,{source:""===e.props.class.students[t].profile_picture?n(62):{uri:e.props.class.students[t].profile_picture},style:lr.thumbnailImage})),y.a.createElement(E.a,{style:{width:"80%"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:30,paddingLeft:18,alignSelf:"center"}},e.props.class.students[t].name)),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{width:"80%",borderWidth:2,borderColor:"#368cbf",padding:10,justifyContent:"center",backgroundColor:i?"#368cbf":"white"},onPress:function(){return e.markWaterDrank(t)}},y.a.createElement(b.a,{style:{textAlign:"center",color:i?"#D3D3D3":"grey",fontSize:17}},"\u6709\u559d\u6c34"))),y.a.createElement(E.a,{style:{flex:2,alignItems:"flex-end"}},e.props.appetite.updatedStudents.has(t)?y.a.createElement(b.a,{style:{color:"red",fontSize:15}},"\u672a\u9001\u51fa"):null)),y.a.createElement(E.a,{style:ir(ir({},lr.cardBody),{},{marginVertical:15})},y.a.createElement(C.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\u80c3\u53e3\u4f73"===a?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return e.handleRateFoodWellness(t,"\u80c3\u53e3\u4f73")}},y.a.createElement(b.a,{style:{textAlign:"center",color:"\u80c3\u53e3\u4f73"===a?"#D3D3D3":"grey",fontSize:20}},"\u80c3\u53e3\u4f73")),y.a.createElement(C.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\u6eff\u6eff\u4e00\u7897"===a?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return e.handleRateFoodWellness(t,"\u6eff\u6eff\u4e00\u7897")}},y.a.createElement(b.a,{style:{textAlign:"center",color:"\u6eff\u6eff\u4e00\u7897"===a?"#D3D3D3":"grey",fontSize:20}},"\u6eff\u6eff\u4e00\u7897")),y.a.createElement(C.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\uff17/8\u5206\u6eff"===a?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return e.handleRateFoodWellness(t,"\uff17/8\u5206\u6eff")}},y.a.createElement(b.a,{style:{textAlign:"center",color:"\uff17/8\u5206\u6eff"===a?"#D3D3D3":"grey",fontSize:20}},"\uff17/8\u5206\u6eff"))),y.a.createElement(E.a,{style:lr.cardBody},y.a.createElement(C.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\u534a\u7897"===a?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return e.handleRateFoodWellness(t,"\u534a\u7897")}},y.a.createElement(b.a,{style:{textAlign:"center",color:"\u534a\u7897"===a?"#D3D3D3":"grey",fontSize:20}},"\u534a\u7897")),y.a.createElement(C.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:"\u80c3\u53e3\u4e0d\u4f73"===a?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return e.handleRateFoodWellness(t,"\u80c3\u53e3\u4e0d\u4f73")}},y.a.createElement(b.a,{style:{textAlign:"center",color:"\u80c3\u53e3\u4e0d\u4f73"===a?"#D3D3D3":"grey",fontSize:20}},"\u80c3\u53e3\u4e0d\u4f73")),y.a.createElement(C.a,{style:{width:"30%",height:"100%",justifyContent:"center",backgroundColor:e.isRatingCustomized(a)||s.has(t)?"#368cbf":"#b5e9e9",padding:15},onPress:function(){return e.onClickOther(t)}},e.isRatingCustomized(a)||s.has(t)?y.a.createElement(Hn.a,{style:{textAlign:"center",color:"#D3D3D3",fontSize:20},maxLength:6,autoFocus:""===a,onChangeText:function(n){return e.onCustomizeRating(t,n)},value:a,onBlur:function(){return e.customizedRatingOnBlur(t)}}):y.a.createElement(b.a,{style:{textAlign:"center",color:e.isRatingCustomized(a)||s.has(t)?"#D3D3D3":"grey",fontSize:20}},"Other"))))))))}))))}}]),a}(y.a.Component),lr=ue.a.create({childThumbnail:{width:"20%",justifyContent:"center",alignItems:"center"},cardBody:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between"},foodButton:{width:70,alignSelf:"center",margin:5,justifyContent:"center",backgroundColor:"#b5e9e9"},thumbnailImage:{height:130,width:130,borderRadius:65},subHeading:{width:"99%",paddingHorizontal:"4%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",zIndex:2},mealButtons:{width:"99%",marginVertical:15,flexDirection:"row",alignItems:"center",justifyContent:"center"},mealButtonText:{fontSize:30,textAlign:"center"},buttonText:{color:"grey",textAlign:"center"}}),ur=Object(k.b)((function(e){return{class:e.classInfo,appetite:e.appetite}}),(function(e){return ir({},Object(D.a)({rateAppetite:me,clearRatings:we,setAllRatingsToGreat:Ce,setAllDrinkWater:ke,fetchClassAppetiteData:Je,onSendAppetiteSuccess:bt,alertErrMessage:vt,markWaterDrank:Ct,editFruitName:Bt,clearAppetiteErrorMessage:St,addStudentIdForUpdate:wt},e))}))(cr);function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function fr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var hr=function(e){u()(a,e);var t=pr(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,date:new Date,showIOSDatePicker:!1,student_id:"",index:-1,recordType:"",teacher_id:"",confirmDelete:!1,showDateTimeModal:!1},n.handleOnClick=n.handleOnClick.bind(_()(n)),n.handleSend=n.handleSend.bind(_()(n)),n.updateReducerTime=n.updateReducerTime.bind(_()(n)),n.setTime=n.setTime.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.sleep,t=e.newDataForCreate,n=e.oldDataForEdit,a=this.props.class.isConnected,r=this.props.route.params,s=r.teacher_id,i=r.date,o=r.teacher_name;this.setState({teacher_id:s}),t.size+n.size===0&&a?this.fetchClassData(i):this.setState({isLoading:!1}),a||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),this.props.navigation.setOptions({title:"\u7761\u7720 - "+o})}},{key:"fetchClassData",value:function(e){var t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(le.View,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#f4d41f",marginRight:20}})}}),t=new Date(e),n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=7,r.a.awrap(wn("sleep",this.props.class.class_id,n,a));case 7:s=i.sent,this.denormalize(s),this.props.fetchClassSleepData(s.data),this.setState({isLoading:!1}),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(le.View,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}});case 12:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].sleep_time=new Date(t[n].sleep_time),t[n].wake_time=null===t[n].wake_time?null:new Date(t[n].wake_time);e.data.records.by_id=t}}},{key:"hasUnsentRecord",value:function(e){for(var t=this.props.sleep,n=t.newDataForCreate,a=t.oldDataForEdit,r=t.by_student_id[e],s=!1,i=0;i<r.length;i++)if(n.has(r[i])||a.has(r[i])){s=!0;break}return s}},{key:"handleOnClick",value:function(e){var t=this.props.sleep.by_student_id[e],n=this.props.sleep.records.by_id,a=t.length>0?n[t[t.length-1]]:null,r=a?a.wake_time:null;!t.length||r?this.props.setSleepTime(e,null,new Date,this.state.teacher_id):this.props.setWakeTime(e,t.length-1,new Date,this.state.teacher_id),this.checkLastRecord(e,n,t)}},{key:"checkLastRecord",value:function(e,t,n){var a=n.length,r=n[n.length-1],s=t[r];if(null!==s.wake_time&&s.sleep_time.getTime()>=s.wake_time.getTime()&&this.props.markRecordError([r]),a>1){var i=t[n[n.length-2]];s.sleep_time>=i.sleep_time&&s.sleep_time<=i.wake_time&&this.props.markRecordError([r])}}},{key:"setTime",value:function(e,t,n,a){this.setState({student_id:t,index:n,recordType:e,showDateTimeModal:!0,start_time:a||new Date})}},{key:"updateReducerTime",value:function(e,t){this.setState({showDateTimeModal:!1}),"sleep"===this.state.recordType?this.props.setSleepTime(this.state.student_id,e,t,this.state.teacher_id):this.props.setWakeTime(this.state.student_id,e,t,this.state.teacher_id),this.checkRecord(this.state.student_id,e)}},{key:"checkRecord",value:function(e,t){var n=this.props.sleep.by_student_id[e],a=this.props.sleep.records.by_id,r=n[t],s=a[r],i=this.props.sleep.records_with_error,o=null,c=null;if(!(t<0||t>n.length-1))if(null!==s.wake_time&&s.sleep_time.getTime()>=s.wake_time.getTime())this.props.markRecordError([r]);else{if(t>0){var l=a[o=n[t-1]];if(null!==l.wake_time&&s.sleep_time.getTime()<=l.wake_time.getTime())return void this.props.markRecordError([r])}if(t<n.length-1){var u=a[c=n[t+1]];if(s.wake_time>=u.sleep_time)return void this.props.markRecordError([r])}this.props.markRecordCorrect(r),null!==o&&i.has(o)&&this.checkRecord(e,t-1),null!==c&&i.has(c)&&this.checkRecord(e,t+1)}}},{key:"confirmToRemoveWakeTime",value:function(e,t,n){var a=this;t===this.props.sleep.by_student_id[n].length-1?fe.a.alert("\u78ba\u5b9a\u8981\u522a\u9664?","",[{text:"Yes",onPress:function(){return a.props.removeWakeTime(e,a.state.teacher_id)}},{text:"Cancel",style:"cancel"}]):this.props.alertSleeplogErrorMessage("\u9019\u500b\u7761\u7720\u8a18\u9304\u4e26\u4e0d\u80fd\u522a\u9664\uff0c\u53ea\u80fd\u6539\u9078")}},{key:"handleSend",value:function(){var e,t,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.props.class.isConnected){a.next=4;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),a.abrupt("return");case 4:if(this.setState({isLoading:!0}),e=this.props.sleep,t=e.newDataForCreate,n=e.oldDataForEdit,!t.size){a.next=16;break}return a.next=9,r.a.awrap(this.createRecord());case 9:if(!a.sent.success){a.next=14;break}this.props.createSleepRecordSuccess(),a.next=16;break;case 14:return this.props.createSleepRecordFail(),a.abrupt("return");case 16:if(!n.size){a.next=26;break}return a.next=19,r.a.awrap(this.editRecord());case 19:if(!a.sent.success){a.next=24;break}this.props.editSleepRecordSuccess(),a.next=26;break;case 24:return this.props.editSleepRecordFail(),a.abrupt("return");case 26:this.props.navigation.goBack();case 27:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"createRecord",value:function(){var e,t,n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.sleep,t=e.newDataForCreate,n=e.records,a=[],t.forEach((function(e){a.push(fr({},n.by_id[e]))})),this.normalize(a),s={date:fn(this.state.date),data_objs:a},o.next=7,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){return e.statusCode>200?{success:!1,status_code:e.statusCode,data:e.message}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=o.sent,o.abrupt("return",i);case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"editRecord",value:function(){var e,t,n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.sleep,t=e.oldDataForEdit,n=e.records,a=[],t.forEach((function(e){a.push(fr({record_id:e},n.by_id[e]))})),this.normalize(a),s={date:fn(new Date),data_objs:a},o.next=7,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){return e.statusCode>200?{success:!1,status_code:e.statusCode,data:e.message}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=o.sent,o.abrupt("return",i);case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"confirmToRemoveRecord",value:function(e,t){var n=this;fe.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"Yes",onPress:function(){return n.removeRecord(e,t)}},{text:"Cancel",style:"cancel"}])}},{key:"removeRecord",value:function(e,t){var n=this,a=this.props.sleep.newDataForCreate,r=this.props.class.isConnected;if(a.has(e))this.props.removeSleepRecordSuccess(e,t);else if(r){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/sleep",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({record_id:e})}).then((function(e){return e.json()})).then((function(a){var r=a.statusCode,s=a.message;return r>200||"Internal Server Error"===s?(n.props.removeSleepRecordFail(s),{success:!1,statusCode:r,message:s}):(n.props.removeSleepRecordSuccess(e,t),{success:!0,statusCode:r,message:s})})).catch((function(e){return n.props.removeSleepRecordFail(e),{success:!1,message:e}}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"normalize",value:function(e){for(var t=0;t<e.length;t++)e[t].sleep_time=mn(e[t].sleep_time),e[t].wake_time=null===e[t].wake_time?null:mn(e[t].wake_time)}},{key:"render",value:function(){var e=this;""!==this.props.sleep.errorMessage&&fe.a.alert("Add new record fail",this.props.sleep.errorMessage,[{text:"OK",onPress:function(){return e.props.clearSleeplogErrorMessage()}}]);var t=this.props.sleep.records_with_error,a=this.state,r=a.showDateTimeModal,s=a.start_time,i=a.date;return this.state.isLoading?y.a.createElement(Mn,null):y.a.createElement(le.Container,null,r?y.a.createElement(Da,{start_date:s,datetime_type:"time",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.updateReducerTime(e.state.index,t)},minDatetime:null,maxDatetime:null}):null,y.a.createElement(le.View,{style:mr.subHeading},y.a.createElement(le.View,{style:{flex:1,alignItems:"center"}},y.a.createElement(le.Text,{style:{fontSize:40}},i.getFullYear()+"."+(i.getMonth()+1)+"."+i.getDate())),y.a.createElement(le.View,{style:{flex:1,justifyContent:"center"}},y.a.createElement(C.a,{style:{alignSelf:"flex-end",backgroundColor:"#dcf3d0",padding:10,marginRight:50},onPress:this.handleSend,underlayColor:"#00c07f"},y.a.createElement(le.Text,{style:{fontSize:40,color:"grey"}},"\u9001\u51fa")))),y.a.createElement(le.Content,{contentContainerStyle:{alignItems:"center"}},Object.keys(this.props.class.students).map((function(a){var r=e.props.sleep.by_student_id[a],s=e.props.sleep.records.by_id,i=r.length>0?s[r[r.length-1]]:null,o=i?i.sleep_time:null,c=i?i.wake_time:null;return y.a.createElement(le.View,{key:a,style:{width:"98%"}},y.a.createElement(le.Card,{style:{flex:1,paddingVertical:15}},y.a.createElement(le.View,{style:{flex:1,flexDirection:"row"}},y.a.createElement(le.View,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{key:a,style:mr.thumbnail,onPress:function(){return e.handleOnClick(a)}},y.a.createElement(pe.a,{source:""===e.props.class.students[a].profile_picture?n(62):{uri:e.props.class.students[a].profile_picture},style:{width:140,height:140,borderRadius:70,borderWidth:8,borderColor:null!==o&&null===c?"#ffe1d0":"#dcf3d0"}}))),y.a.createElement(le.View,{style:{flex:3}},y.a.createElement(le.View,{style:{flex:1,flexDirection:"row",padding:10}},y.a.createElement(le.View,{style:{flex:1}},y.a.createElement(le.Text,{style:{fontSize:30}},e.props.class.students[a].name)),y.a.createElement(le.View,{style:{flex:1,alignItems:"flex-end"}},e.hasUnsentRecord(a)?y.a.createElement(le.Text,{style:{color:"red",fontSize:15}},"\u672a\u9001\u51fa"):null)),y.a.createElement(le.View,{style:mr.cardBody},y.a.createElement(le.View,{style:{width:"40%",height:"100%",paddingLeft:5}},y.a.createElement(le.Text,{style:{fontSize:20}},"\u5f9e")),y.a.createElement(le.View,{style:{width:"40%",height:"100%",paddingLeft:5}},y.a.createElement(le.Text,{style:{fontSize:20}},"\u5230"))),r.map((function(n,r){var i=s[n],o=i.sleep_time,c=i.wake_time;return y.a.createElement(le.View,{key:n,style:fr(fr({},mr.cardBody),{},{borderWidth:2,borderColor:t.has(n)?"red":"white"})},y.a.createElement(le.View,{style:{width:"35%",marginRight:"3%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setTime("sleep",a,r,o)}},null===o?y.a.createElement(le.Text,{style:{fontSize:30,textAlign:"center"}},"\u9078\u64c7\u6642\u9593"):y.a.createElement(le.Text,{style:{fontSize:35,textAlign:"center"}},o.getHours()+":"+o.getMinutes()))),y.a.createElement(le.View,{style:{width:"35%",marginRight:"3%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setTime("wake",a,r,c)},onLongPress:function(){return e.confirmToRemoveWakeTime(n,r,a)}},null===c?y.a.createElement(le.Text,{style:{fontSize:30,textAlign:"center"}},"\u9078\u64c7\u6642\u9593"):y.a.createElement(le.Text,{style:{fontSize:35,textAlign:"center"}},c.getHours()+":"+c.getMinutes()))),y.a.createElement(le.View,{style:{width:"20%",marginRight:"4%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return e.confirmToRemoveRecord(n,a)}},y.a.createElement(le.Text,{style:{fontSize:30,textAlign:"center"}},"\u79fb\u9664"))))}))))))}))))}}]),a}(y.a.Component),mr=ue.a.create({thumbnail:{},subHeading:{flexDirection:"row",alignItems:"center"},cardBody:{flex:1,flexDirection:"row",marginVertical:6}}),yr=Object(k.b)((function(e){return{class:e.classInfo,sleep:e.sleep}}),(function(e){return fr({},Object(D.a)({setSleepTime:Te,setWakeTime:Le,fetchClassSleepData:Xe,clearPendingSleepUpdate:Ze,createSleepRecordSuccess:it,createSleepRecordFail:ot,editSleepRecordSuccess:ct,editSleepRecordFail:lt,removeSleepRecord:Pe,removeSleepRecordSuccess:Ie,removeSleepRecordFail:ze,alertSleeplogErrorMessage:Mt,clearSleeplogErrorMessage:Ft,removeWakeTime:Me,markRecordError:tn,markRecordCorrect:nn},e))}))(hr);function gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gr(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Er(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var br=function(e){u()(a,e);var t=Er(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,date:new Date,showDateTimeModal:!1,record_id:""},n.handleSend=n.handleSend.bind(_()(n)),n.handleOnAddRecord=n.handleOnAddRecord.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.class.isConnected,t=this.props.route.params,n=t.date,a=t.teacher_name;!this.props.milk.loaded&&e?this.fetchClassData(n):this.setState({isLoading:!1}),e||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),this.props.navigation.setOptions({title:"\u9935\u5976 - "+a})}},{key:"checkUnsent",value:function(e){for(var t=this.props.milk,n=t.newDataForCreate,a=t.oldDataForEdit,r=(t.dataForRemoval,t.by_student_id[e]),s=!1,i=0;i<r.length;i++){var o=r[i];if(n.has(o)||a.has(o)){s=!0;break}}return s}},{key:"fetchClassData",value:function(e){var t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(this.props.class.isConnected){i.next=4;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),i.abrupt("return");case 4:return this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#f4d41f",marginRight:20}})}}),t=new Date(e),n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=11,r.a.awrap(wn("milkintake",this.props.class.class_id,n,a));case 11:s=i.sent,this.denormalize(s),this.props.fetchClassMilkData(s.data),this.setState({isLoading:!1}),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}});case 16:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].time=new Date(t[n].time)}}},{key:"handleEditMilkAmout",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.editMilkAmount(e,t,n)}},{key:"handleOnAddRecord",value:function(e){this.props.addMilkRecord(e)}},{key:"confirmToRemoveRecord",value:function(e,t,n){var a=this;fe.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"Yes",onPress:function(){return a.handleRemoveRecord(e,t,n)}},{text:"Cancel",style:"cancel"}])}},{key:"handleRemoveRecord",value:function(e,t,n){this.props.class.isConnected?(this.props.removeRecord(e,t,n),this.handleRemove(t,e)):le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"handleSend",value:function(){var e,t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(e=this.props.milk,t=e.newDataForCreate,n=e.oldDataForEdit,e.dataForRemoval,this.props.class.isConnected){i.next=5;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),i.abrupt("return");case 5:if(!t.size){i.next=15;break}return i.next=8,r.a.awrap(this.handleCreate());case 8:if(!(a=i.sent).success){i.next=13;break}this.props.createDataSuccess(),i.next=15;break;case 13:return this.props.createDataFail(a.data),i.abrupt("return");case 15:if(!n.size){i.next=25;break}return i.next=18,r.a.awrap(this.handleEdit());case 18:if(!(s=i.sent).success){i.next=23;break}this.props.editDataSuccess(),i.next=25;break;case 23:return this.props.editDataFail(s.data),i.abrupt("return");case 25:this.props.navigation.goBack();case 26:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"handleCreate",value:function(){var e,t,n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.milk,t=e.newDataForCreate,n=e.records,a=[],t.forEach((function(e){a.push(_r({},n.by_id[e]))})),this.normalize(a),s={date:fn(new Date),data_objs:a},o.next=7,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.errMessage,a=e.message;return t>200?{success:!1,status_code:t,data:n||a}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=o.sent,o.abrupt("return",i);case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"handleEdit",value:function(){var e,t,n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props.milk,t=e.oldDataForEdit,n=e.records,a=[],t.forEach((function(e){a.push(_r({record_id:e},n.by_id[e]))})),this.normalize(a),s={date:fn(new Date),data_objs:a},o.next=7,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message;return t>200?{success:!1,status_code:t,data:n}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:return i=o.sent,o.abrupt("return",i);case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"handleRemove",value:function(e,t){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.props.milk.dataForRemoval.has(e)){a.next=3;break}return a.abrupt("return");case 3:return n={record_id_array:e,student_id:t},"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",a.next=7,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/milkintake",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message;return t>200?{success:!1,status_code:t,data:n}:{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,data:e}})));case 7:a.sent.success?this.props.removeMilkRecordSuccess():this.props.removeMilkRecordFail();case 9:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"normalize",value:function(e){for(var t=0;t<e.length;t++)e[t].time=mn(e[t].time)}},{key:"selectDatetimeConfirm",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.record_id;this.setState({record_id:"",showDateTimeModal:!1}),this.props.editMilkTime(n,e,t)}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return y.a.createElement(Mn,null);var t=this.state,a=t.date,r=t.showDateTimeModal;return y.a.createElement(le.Container,null,r?y.a.createElement(Da,{start_date:a,datetime_type:"time",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:null}):null,y.a.createElement(E.a,{style:vr.subHeading},y.a.createElement(b.a,{style:{fontSize:40}},a.getFullYear()+"."+(a.getMonth()+1)+"."+a.getDate()),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend},y.a.createElement(b.a,{style:{fontSize:40,color:"grey"}},"\u9001\u51fa"))),y.a.createElement(le.Content,{contentContainerStyle:{alignItems:"center"}},Object.keys(this.props.class.students).map((function(t){var a=e.props.milk.by_student_id[t],r=e.props.milk.records.by_id;return y.a.createElement(E.a,{key:t,style:{width:"98%"}},y.a.createElement(le.Card,{style:{flex:1,paddingVertical:15}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:vr.childThumbnail,onPress:function(){return e.handleOnAddRecord(t)},underlayColor:"transparent"},y.a.createElement(pe.a,{source:""===e.props.class.students[t].profile_picture?n(62):{uri:e.props.class.students[t].profile_picture},style:vr.thumbnailImage}))),y.a.createElement(E.a,{style:{flex:3}},y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:30,paddingLeft:18}},e.props.class.students[t].name)),y.a.createElement(E.a,{style:{flex:1,paddingRight:15}},e.checkUnsent(t)?y.a.createElement(b.a,{style:{fontSize:15,paddingLeft:18,alignSelf:"flex-end",color:"red"}},"\u672a\u9001\u51fa"):null)),a.map((function(n,a){var s=r[n];return y.a.createElement(E.a,{key:n,style:vr.cardBody},y.a.createElement(E.a,{style:{width:"35%",marginRight:"3%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setState({showDateTimeModal:!0,record_id:n})}},y.a.createElement(b.a,{style:{fontSize:35,textAlign:"center"}},s.time.getHours()+":"+s.time.getMinutes()))),y.a.createElement(E.a,{style:{flexDirection:"row",width:"35%",marginRight:"3%",alignItems:"center",justifyContent:"center",backgroundColor:"#fef6dd",height:"100%",borderRadius:10}},y.a.createElement(Hn.a,{style:{flex:2,fontSize:35,textAlign:"center"},keyboardType:"decimal-pad",placeholder:"\u2f64\u91cf",value:""+s.amount,onChangeText:function(t){e.handleEditMilkAmout(n,t)}}),y.a.createElement(b.a,{style:{flex:1,fontSize:30,textAlign:"center"}},"c.c.")),y.a.createElement(E.a,{style:{width:"20%",marginRight:"4%",height:"100%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return e.confirmToRemoveRecord(t,n,a)}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"\u79fb\u9664"))))}))))))}))))}}]),a}(y.a.Component),vr=ue.a.create({childThumbnail:{},thumbnailImage:{width:140,height:140,borderRadius:70},subHeading:{width:"90%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",alignSelf:"center"},cardBody:{flexDirection:"row",marginVertical:6}}),Sr=Object(k.b)((function(e){return{class:e.classInfo,milk:e.milk}}),(function(e){return _r({},Object(D.a)({editMilkAmount:Fe,addMilkRecord:Qe,fetchClassMilkData:$e,createDataSuccess:et,createDataFail:tt,editDataSuccess:nt,editDataFail:at,removeRecord:gt,removeMilkRecordSuccess:rt,removeMilkRecordFail:st,editMilkTime:Be},e))}))(br),wr=n(329);function Cr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}!function(e){u()(n,e);var t=Cr(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={other_option:"\u5176\u4ed6"},a}c()(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({other_option:"\u5176\u4ed6"},(function(){console.log("mounted",e.refs.textRef.isFocused())}))}},{key:"onBlur",value:function(e){console.log("onBlur"),this.setState({other_option:""}),this.props.editPooCondition(e)}},{key:"render",value:function(){var e=this,t=this.state.other_option;return console.log("other_option ===: ","\u5176\u4ed6"===t),y.a.createElement(Hn.a,{ref:"textRef",autoFocus:"\u5176\u4ed6"===t,selectTextOnFocus:!0,style:{fontSize:30,textAlign:"center"},value:t,onChangeText:function(t){return e.setState({other_option:t})},onEndEditing:function(){return e.props.editPooCondition(t)},onBlur:function(){return e.onBlur(t)}})}}])}(y.a.Component);function kr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Dr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var xr=function(e){u()(n,e);var t=Dr(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={selected_other:!1,other_option:""},a}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"editPooCondition",value:function(e,t){var n=this.props.teacher_id;"\u53d6\u6d88\u7de8\u8f2f"!==t&&("\u5176\u4ed6"===t?this.setState({selected_other:!0,other_option:" "}):(console.log("editPooCondition: ",e,t,n),this.setState({selected_other:!1,other_option:t}),this.props.editPooCondition(e,t,n)))}},{key:"render",value:function(){var e=this,t=this.props,n=t.record_id,a=t.record,r=this.state,s=r.selected_other,i=r.other_option;return y.a.createElement(E.a,{style:{width:"23%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10}},s?y.a.createElement(Hn.a,{style:{fontSize:30,textAlign:"center"},keyboardType:"default",autoFocus:s,selectTextOnFocus:!0,value:i,onChangeText:function(t){return e.setState({other_option:t})},onBlur:function(){return e.editPooCondition(n,i)}}):y.a.createElement(Gn,{style:{alignItems:"center",padding:5},selectedValue:i||a.poo_condition,options:["\u6b63\u5e38","\u786c","\u8edf\u7cca","\u7a00\u6c34","\u5176\u4ed6","\u53d6\u6d88\u7de8\u8f2f"],textStyle:{fontSize:30},handleOnClick:function(){},handleSelectValue:function(t){return e.editPooCondition(n,t)}}))}}]),n}(y.a.Component),Ar=Object(k.b)((function(e){return{diaper_records:e.diaper,class:e.classInfo}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kr(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({editPooCondition:We},e))}))(xr);function Or(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Or(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Or(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Tr=function(e){u()(a,e);var t=jr(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,date:new Date,other_option:"",show_time_picker:!1,record_id_for_edit:"",cloth_diaper:!1,record_id:""},n.handleSend=n.handleSend.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.date,n=e.teacher_name,a=this.props.diaper_records,r=a.new_data_for_create,s=a.old_data_for_edit,i=this.props.class.isConnected;r.size+s.size===0&&i?this.fetchClassData(t):this.setState({isLoading:!1}),i||le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),this.props.navigation.setOptions({title:"\u5982\u5ec1 - "+n})}},{key:"checkUnsent",value:function(e){for(var t=this.props.diaper_records,n=t.new_data_for_create,a=t.old_data_for_edit,r=t.by_student_id[e].records,s=!1,i=0;i<r.length;i++)if(n.has(r[i])||a.has(r[i])){s=!0;break}return s}},{key:"fetchClassData",value:function(e){var t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(this.props.class.isConnected){i.next=4;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),i.abrupt("return");case 4:return this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#f4d41f",marginRight:20}})}}),t=new Date(e),n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=11,r.a.awrap(wn("diaper",this.props.class.class_id,n,a));case 11:s=i.sent,this.denormalize(s),this.props.fetchClassDiaperData(s.data),this.setState({isLoading:!1}),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}});case 16:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){if(e.data.records.all_id.length){var t=e.data.records.by_id;for(var n in t)t[n].time=new Date(t[n].time)}}},{key:"handleUpdateDiaperAmount",value:function(e,t){this.props.updateDiaperAmount(e,t)}},{key:"addDiaperRecord",value:function(e){var t=this.props.route.params.teacher_id;this.props.addDiaperRecord(e,new Date,this.state.cloth_diaper,t)}},{key:"setTime",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.record_id_for_edit;void 0!==e?(this.setState({show_time_picker:!1,record_id_for_edit:""}),this.props.editDiaperTime(n,e,t)):this.setState({show_time_picker:!1,record_id_for_edit:""})}},{key:"switchPeeOrPoo",value:function(e){var t=this.props.route.params.teacher_id;this.props.switchPeeOrPoo(e,t)}},{key:"editPooCondition",value:function(e,t){var n=this.props.route.params.teacher_id;"\u53d6\u6d88\u7de8\u8f2f"!==t&&("\u5176\u4ed6"===t?this.setState({record_id:e,other_option:"Please Fill Out"}):(this.setState({other_option:""}),this.props.editPooCondition(e,t,n)))}},{key:"confirmRemove",value:function(e,t){var n=this;fe.a.alert("\u78ba\u5b9a\u8981\u522a\u9664\uff1f","",[{text:"OK",onPress:function(){return n.removeDiaperRecord(e,t)}},{text:"Cancel",style:"cancel"}])}},{key:"removeDiaperRecord",value:function(e,t){var n=this,a=this.props.diaper_records.new_data_for_create,r=this.props.class.isConnected;if(a.has(t))this.props.removeDiaperRecordSuccess(e,t);else if(r){fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({record_id:t})}).then((function(e){return e.json()})).then((function(a){var r=a.statusCode,s=a.message;(r>200||"Internal Server Error"===s)&&n.props.removeDiaperRecordFail(s),n.props.removeDiaperRecordSuccess(e,t)})).catch((function(e){n.props.removeDiaperRecordFail(e)}))}else le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3})}},{key:"handleSend",value:function(){var e,t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(e=this.props.diaper_records,t=e.new_data_for_create,n=e.old_data_for_edit,this.props.class.isConnected){s.next=5;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),s.abrupt("return");case 5:if(!t.size&&!n.size){s.next=15;break}return s.next=8,r.a.awrap(this.createRecords());case 8:if(!(a=s.sent).success){s.next=13;break}this.props.createDiaperRecordSuccess(),s.next=15;break;case 13:return this.props.createDiaperRecordFail(a.data),s.abrupt("return");case 15:this.props.navigation.goBack();case 16:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"sendDiaperAmountData",value:function(){var e,t=this;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.props.class.isConnected){n.next=4;break}return le.Toast.show({text:"\u62cd\u8b1d \u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"warning",duration:2e3}),n.abrupt("return");case 4:return"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",n.next=7,r.a.awrap(Promise.all(Array.from(this.props.diaper_records.students_pending_amount_update).map((function(e){return fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/"+e,{method:"PUT",body:JSON.stringify({amount:t.props.diaper_records.by_student_id[e].amount}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){throw e}))}))).then((function(e){return{success:!0,status_code:200,data:e}})).catch((function(e){return{success:!1,status_code:500,err_message:"error occured while sending diaper amount data: "+e}})));case 7:return e=n.sent,n.abrupt("return",e);case 9:case"end":return n.stop()}}),null,this,null,Promise)}},{key:"createRecords",value:function(){var e,t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.diaper_records,t=e.new_data_for_create,n=e.old_data_for_edit,a=e.records,s=[],[].concat(P()(t),P()(n)).forEach((function(e){s.push(Rr({},a.by_id[e]))})),this.normalize(s),i={date:fn(new Date),data_objs:s},"https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",c.next=9,r.a.awrap(fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/diaper/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(i)}).then((function(e){return e.json()})).then((function(e){return 200===e.statusCode?{success:!0,status_code:200,data:e}:{success:!1,status_code:500,data:e.message}})).catch((function(e){return{success:!1,status_code:500,err_message:e}})));case 9:return o=c.sent,c.abrupt("return",o);case 11:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"editDiaperRecords",value:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),null,null,null,Promise)}},{key:"normalize",value:function(e){for(var t=0;t<e.length;t++)e[t].time=mn(e[t].time)}},{key:"render",value:function(){var e=this;""!==this.props.diaper_records.err_message&&fe.a.alert("Error!",this.props.diaper_records.err_message,[{text:"OK",onPress:function(){return e.props.clearDiaperlogErrorMessage()}}]);var t=this.props.route.params.teacher_id,a=this.state,r=a.show_time_picker,s=a.cloth_diaper,i=this.props.diaper_records,o=i.by_student_id,c=i.records,l=this.props.class.students,u=this.state.date;return y.a.createElement(Un.a,{style:{flex:1,paddingBottom:15},enabled:!0},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-evenly"}},y.a.createElement(b.a,{style:{fontSize:40}},pn(u)),y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(C.a,{style:{backgroundColor:s?"rgba(255,255,255,0.2)":"#ffe1d0",padding:10,marginRight:20},onPress:function(){return e.setState({cloth_diaper:!1})}},y.a.createElement(b.a,{style:{fontSize:40}},"\u5c3f\u5e03")),y.a.createElement(C.a,{style:{backgroundColor:s?"#ffe1d0":"rgba(255,255,255,0.2)",padding:10,marginRight:20},onPress:function(){return e.setState({cloth_diaper:!0})}},y.a.createElement(b.a,{style:{fontSize:40}},"\u5b78\u7fd2\u8932")),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0",padding:10},onPress:this.handleSend},y.a.createElement(b.a,{style:{fontSize:40}},"\u9001\u51fa")))),y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center"},keyboardShouldPersistTaps:"handled"},Object.keys(l).map((function(a){if(null===o[a])return null;var i=o[a].records;return y.a.createElement(E.a,{key:a,style:{width:"98%"}},y.a.createElement(le.Card,{style:{flex:1,flexDirection:"row",paddingVertical:15}},y.a.createElement(E.a,{style:{width:"23%",alignItems:"center",justifyContent:"center"}},y.a.createElement(C.a,{onPress:function(){return e.addDiaperRecord(a)},underlayColor:"transparent"},y.a.createElement(pe.a,{source:""===l[a].profile_picture?n(62):{uri:l[a].profile_picture},style:Pr.thumbnailImage}))),y.a.createElement(E.a,{style:{width:"77%"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:30}},l[a].name),e.checkUnsent(a)?y.a.createElement(b.a,{style:{fontSize:15,color:"red",marginLeft:15}},"\u672a\u9001\u51fa"):null)),i.map((function(n){var r=c.by_id[n];return r.cloth_diaper!==s?null:y.a.createElement(E.a,{key:n,style:{flex:1,flexDirection:"row",marginVertical:6,justifyContent:"space-between",paddingRight:15}},y.a.createElement(C.a,{style:{width:"\u5927\u4fbf"===r.pee_or_poo?"23%":"35%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.setState({record_id_for_edit:n,show_time_picker:!0})}},y.a.createElement(b.a,{style:{fontSize:35,textAlign:"center"}},r.time.getHours()+":"+r.time.getMinutes())),y.a.createElement(C.a,{style:{width:"\u5927\u4fbf"===r.pee_or_poo?"23%":"35%",height:"100%",justifyContent:"center",backgroundColor:"#fef6dd",borderRadius:10},onPress:function(){return e.switchPeeOrPoo(n)}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},""+r.pee_or_poo)),"\u5927\u4fbf"===r.pee_or_poo?y.a.createElement(Ar,{teacher_id:t,record_id:n,record:r}):null,y.a.createElement(C.a,{style:{width:"20%",height:"100%",justifyContent:"center",backgroundColor:"#ffe1d0",borderRadius:10},onPress:function(){return e.confirmRemove(a,n)}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"\u79fb\u9664")))})),r&&y.a.createElement(wr.a,{style:{width:"100%"},mode:"time",display:"spinner",value:new Date,onChange:function(t,n){return e.setTime(n)},minimumDate:new Date})))))}))))}}]),a}(y.a.Component),Pr=ue.a.create({thumbnailImage:{width:140,height:140,borderRadius:70}}),Ir=Object(k.b)((function(e){return{diaper_records:e.diaper,class:e.classInfo}}),(function(e){return Rr({},Object(D.a)({updateDiaperAmount:qe,addDiaperRecord:Ne,editDiaperTime:Ue,switchPeeOrPoo:He,editPooCondition:We,removeDiaperRecordSuccess:Ve,removeDiaperRecordFail:Ke,fetchClassDiaperData:ut,createDiaperRecordSuccess:dt,createDiaperRecordFail:ft,editDiaperRecordSuccess:pt,editDiaperRecordFail:ht,editDiaperAmountSuccess:mt,editDiaperAmountFail:yt,clearDiaperlogErrorMessage:Ge},e))}))(Tr),zr=n(25);function Lr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Mr=function(e){u()(n,e);var t=Lr(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"handleNavigate",value:function(e){var t=this.props.route.params,n=t.school_name,a=t.school_id;this.props.navigation.navigate(e,{school_name:n,school_id:a})}},{key:"render",value:function(){var e=this;return y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center"}},y.a.createElement(zr.a,{style:Fr.button,onClick:function(){return e.handleNavigate("AnnouncementHome")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u516c\u544a")),y.a.createElement(zr.a,{style:Fr.button,onClick:function(){return e.handleNavigate("Registration")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u65b0\u751f\u8a3b\u518a")),y.a.createElement(zr.a,{style:Fr.button,onClick:function(){return e.handleNavigate("Students")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u5b78\u751f\u8cc7\u6599")),y.a.createElement(zr.a,{style:Fr.button,onClick:function(){return e.handleNavigate("Teachers")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u6559\u5e2b\u8cc7\u6599")),y.a.createElement(zr.a,{style:Fr.button,onClick:function(){return e.handleNavigate("DownloadPage")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u4e0b\u8f09")))}}]),n}(y.a.Component);Mr.navigationOptions=function(e){e.navigation;return{headerTitle:y.a.createElement(rr,{title:"Admin Home"})}};var Fr=ue.a.create({button:{width:"80%",padding:50,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",marginVertical:20},button_text:{}}),Br=n(37),qr=n.n(Br),Nr=n(132);function Ur(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Hr=function(e){u()(a,e);var t=Ur(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={date:new Date,selected_all_classes:!0,selected_classes:new Set,class_id_list:[],text:"",announcements:[],page_number:0,announcement_on_display:{},is_loading:!0,unread_list:[],read_list:[],show_more:!1},n}return c()(a,[{key:"componentDidMount",value:function(){var e,t,n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:e=this.props.route.params.announcement,t=this.props.classes,n=[],Object.keys(t).forEach((function(e){"\u7ba1\u7406\u54e1"===t[e].name||t[e].name.includes("\u7562\u696d\u751f")||n.push(e)})),this.setState({class_id_list:n,selected_classes:new Set(n)}),void 0===e?this.fetchMostRecentAnnouncement():this.fetchReadStatusByAnnouncementId(e);case 6:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"fetchMostRecentAnnouncement",value:function(){var e,t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.route.params.school_id,l.next=3,r.a.awrap(_n("/announcement/most-recent?school_id="+e));case 3:t=l.sent,n=t.success,t.statusCode,t.message,a=t.data,n&&(s=this.separateReadUnread(a.read_status),i=qr()(s,2),o=i[0],c=i[1],this.setState({announcement_on_display:a,is_loading:!1,unread_list:o,read_list:c}));case 6:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"fetchReadStatusByAnnouncementId",value:function(e){var t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.a.awrap(_n("/announcement/"+e.id));case 2:t=l.sent,n=t.success,t.statusCode,t.message,a=t.data,n&&(s=this.separateReadUnread(a),i=qr()(s,2),o=i[0],c=i[1],this.setState({announcement_on_display:e,is_loading:!1,unread_list:o,read_list:c}));case 5:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"separateReadUnread",value:function(e){var t=[],n=[];for(var a in e)e[a]?n.push(a):t.push(a);return[t,n]}},{key:"showConfirmDeleteDialog",value:function(){confirm("\u78ba\u5b9a\u8981\u6c38\u4e45\u522a\u9664\u6b64\u516c\u544a?")&&this.deleteAnnouncementById()}},{key:"deleteAnnouncementById",value:function(){var e,t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=this.props.route.params.school_id,t=this.state.announcement_on_display,s.next=4,r.a.awrap(vn("/announcement/"+t.id));case 4:n=s.sent,a=n.success,n.statusCode,n.message,n.data,a&&this.props.navigation.navigate("AnnouncementHome",{school_id:e});case 7:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.students,a=this.props.route.params,s=a.school_id,i=a.school_name,o=this.state,c=o.announcement_on_display,l=o.is_loading,u=o.unread_list,d=o.read_list,f=o.show_more;return y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"flex-end",paddingVertical:7}},y.a.createElement(C.a,{style:{padding:10,backgroundColor:"lightblue",marginRight:10},onPress:function(){return e.fetchReadStatusByAnnouncementId(c)}},y.a.createElement(b.a,{style:{fontSize:20}},"\u5237\u65b0")),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"lightblue",marginRight:10},onPress:function(){return e.props.navigation.navigate("AnnouncementHome",{school_id:s,school_name:i})}},y.a.createElement(b.a,{style:{fontSize:20}},"\u6aa2\u8996\u5168\u90e8")),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"lightblue",marginRight:10},onPress:function(){return e.props.navigation.push("AddAnnouncementPage",{school_id:s,school_name:i})}},y.a.createElement(b.a,{style:{fontSize:20}},"\u65b0\u589e")),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"red",marginRight:10},onPress:function(){return e.showConfirmDeleteDialog()}},y.a.createElement(b.a,{style:{fontSize:20}},"\u522a\u9664"))),!l&&y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(le.Card,{style:{flex:1}},y.a.createElement(Rn.a,null,y.a.createElement(E.a,{style:{padding:20}},y.a.createElement(b.a,{style:{fontSize:28}},c.title),y.a.createElement(b.a,{style:{fontSize:18}},pn(new Date(c.timestamp)))),y.a.createElement(E.a,{style:{paddingHorizontal:20,height:f?-1:100,overflow:"hidden"}},y.a.createElement(b.a,{style:{fontSize:20}},c.text)),f&&y.a.createElement(E.a,{style:{flex:1,alignItems:"flex-start",padding:20}},c.links.map((function(e,t){return y.a.createElement(C.a,{key:t,style:{backgroundColor:"lightblue",padding:8,marginBottom:15},onPress:function(){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(Nr.a(e.url));case 2:t.sent;case 3:case"end":return t.stop()}}),null,null,null,Promise)}},y.a.createElement(b.a,{style:{fontSize:18}},e.text))}))),f&&y.a.createElement(E.a,{style:{flexDirection:"row",paddingHorizontal:20,flexWrap:"wrap"}},c.photo_url_arr.map((function(e,t){return y.a.createElement(C.a,{key:t,onPress:function(){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(Nr.a(e));case 2:t.sent;case 3:case"end":return t.stop()}}),null,null,null,Promise)}},y.a.createElement(pe.a,{source:{uri:e},style:{width:150,height:150,marginRight:10,marginTop:10}}))}))),y.a.createElement(E.a,{style:{width:"100%",paddingHorizontal:20}},y.a.createElement(C.a,{style:{padding:10,alignSelf:"flex-end",backgroundColor:"lightblue"},onPress:function(){return e.setState({show_more:!f})}},y.a.createElement(b.a,null,f?"\u96b1\u85cf":"\u66f4\u591a"))),y.a.createElement(E.a,{style:{flexDirection:"row",flexWrap:"wrap"}},u.map((function(e){var a=t[e];return y.a.createElement(C.a,{key:e,style:{height:300,width:"33.3%",padding:5}},y.a.createElement(le.Card,{style:{flex:1,padding:10,backgroundColor:"#ffe1d0"}},y.a.createElement(le.CardItem,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{source:""===a.profile_picture?n(62):{uri:a.profile_picture},style:{height:200,width:200,borderRadius:100}})),y.a.createElement(le.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5}},y.a.createElement(b.a,{style:{marginTop:-10}},a.name))))})),d.map((function(e){var a=t[e];return y.a.createElement(C.a,{key:e,style:{height:300,width:"33.3%",padding:5}},y.a.createElement(le.Card,{style:{flex:1,padding:10,backgroundColor:"#dcf3d0"}},y.a.createElement(le.CardItem,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{source:""===a.profile_picture?n(62):{uri:a.profile_picture},style:{height:200,width:200,borderRadius:100}})),y.a.createElement(le.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5}},y.a.createElement(b.a,{style:{marginTop:-10}},a.name))))})))))))}}]),a}(y.a.Component),Wr=Object(k.b)((function(e){return{classes:e.school.classes,students:e.school.students}}))(Hr);function Vr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Kr=function(e){u()(n,e);var t=Vr(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={studentDataArray:[{name:"",class_id:"",class_name:"",profile_picture:"",blood_type:""}]},a}return c()(n,[{key:"addStudent",value:function(){var e=this.state.studentDataArray;e.push({name:"",class_id:"",class_name:"",profile_picture:"",blood_type:""}),this.setState({studentDataArray:e})}},{key:"fillStudent",value:function(){var e=this.state.studentDataArray;e[0]={name:"John Smith",class_id:null,profile_picture:"",blood_type:"AB"},this.setState({studentDataArray:e})}},{key:"setName",value:function(e,t){var n=this.state.studentDataArray;n[t].name=e,this.setState({studentDataArray:n})}},{key:"setBloodType",value:function(e,t){var n=this.state.studentDataArray;n[t].blood_type=e,this.setState({studentDataArray:n})}},{key:"removeStudent",value:function(e){var t=this.state.studentDataArray;t.splice(e,1),this.setState({studentDataArray:t})}},{key:"handleSelectClass",value:function(e,t){for(var n=this.props.classes,a=this.state.studentDataArray,r="",s=0;s<Object.keys(n).length;s++){var i=Object.keys(n)[s];if(n[i].name===e){r=i;break}}a[t].class_id=r,a[t].class_name=e,this.setState({studentDataArray:a})}},{key:"getStudentDataArray",value:function(){return this.state.studentDataArray}},{key:"render",value:function(){var e=this,t=this.state.studentDataArray,n=this.props.classes,a=Object.keys(n).map((function(e){return n[e].name}));return y.a.createElement(E.a,{style:{width:"100%",padding:"5%",backgroundColor:"#368cbf"}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:5,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(b.a,{style:{fontSize:60}},"\u5b78\u751f\u8cc7\u6599"),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"#b5e9e9"},onPress:function(){return e.addStudent()}},y.a.createElement(b.a,{style:{fontSize:35}},"\u65b0\u589e\u5b78\u751f"))),t.map((function(n,r){var s=n.name,i=n.blood_type;return y.a.createElement(E.a,{key:r,style:{width:"100%",padding:"5%",backgroundColor:"#f4d41f"}},y.a.createElement(E.a,{style:{flexDirection:"row",padding:10,backgroundColor:"white",justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"50%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(Hn.a,{placeholder:"\u5168\u540d",value:s,style:{fontSize:30},onChangeText:function(t){return e.setName(t,r)}})),y.a.createElement(E.a,{style:{width:"20%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(Hn.a,{placeholder:"\u8840\u578b",value:i,style:{fontSize:30},onChangeText:function(t){return e.setBloodType(t,r)}})),y.a.createElement(C.a,{style:{width:"20%",padding:10,backgroundColor:"#fa625f",borderRadius:2,justifyContent:"center"},onPress:function(){return e.removeStudent(r)}},y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:30}},"\u79fb\u9664"))),y.a.createElement(E.a,{style:{padding:10,backgroundColor:"white"}},y.a.createElement(Gn,{style:{padding:10,backgroundColor:"#b5e9e9"},textStyle:{fontSize:30},selectedValue:t[r].class_name||"\u9078\u64c7\u5b78\u751f\u73ed\u7d1a",options:a,handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t,r)}})))})))}}]),n}(y.a.Component),Gr=n(143);function Qr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Jr=function(e){u()(n,e);var t=Qr(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={parentDataArray:[{name:"",email:"",username:"",password:"",role:"\u7236",mobile:"",address:"",work_phone:"",transportation:""}],parentSignUpStatus:[!1]},a}return c()(n,[{key:"addParent",value:function(){var e=this.state,t=e.parentDataArray,n=e.parentSignUpStatus;t.push({name:"",email:"",username:"",password:"",role:"\u7236",mobile:"",address:"",work_phone:"",transportation:""}),n.push(!1),this.setState({parentDataArray:t,parentSignUpStatus:n})}},{key:"fillParent",value:function(){var e=this.state.parentDataArray;e[0]={name:"Jane Smith",email:"caleb7947@gmail.com",username:"abc123",password:"password",role:"parent#mother",mobile:"061234567",address:"SOME ADDRESS",work_phone:"061234567",transportation:"car"},this.setState({parentDataArray:e})}},{key:"setName",value:function(e,t){var n=this.state.parentDataArray;n[t].name=e,this.setState({parentDataArray:n})}},{key:"setRole",value:function(e,t){var n=this.state.parentDataArray;n[t].role=e,this.setState({parentDataArray:n})}},{key:"setEmail",value:function(e,t){var n=this.state.parentDataArray;n[t].email=e,this.setState({parentDataArray:n})}},{key:"setUsername",value:function(e,t){var n=this.state.parentDataArray;n[t].username=e,this.setState({parentDataArray:n})}},{key:"toLowerCase",value:function(e,t){var n=e.nativeEvent.text,a=this.state.parentDataArray,r=n.toLowerCase();a[t].username=r,this.setState({parentDataArray:a})}},{key:"setPassword",value:function(e,t){var n=this.state.parentDataArray;n[t].password=e,this.setState({parentDataArray:n})}},{key:"removeParent",value:function(e){var t=this.state,n=t.parentDataArray,a=t.parentSignUpStatus;n.splice(e,1),a.splice(e,1),this.setState({parentDataArray:n,parentSignUpStatus:a})}},{key:"handleSignup",value:function(e){var t=this,n=this.state.parentDataArray[e],a=n.name,r=n.email,s=n.username,i=n.password;w.a.signUp({username:s,password:i,attributes:{name:a,email:r}}).then((function(n){var a=t.state.parentSignUpStatus;a[e]=!0,t.setState({parentSignUpStatus:a})})).catch((function(e){alert("\u8a3b\u518a\u6709\u554f\u984c!\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+e.message)}))}},{key:"getParentSignUpStatus",value:function(){return this.state.parentSignUpStatus}},{key:"getParentDataArray",value:function(){return this.state.parentDataArray}},{key:"render",value:function(){var e=this,t=this.state,n=t.parentDataArray,a=t.parentSignUpStatus;return y.a.createElement(E.a,{style:{width:"100%",padding:"5%",backgroundColor:"#f4d41f"}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:5,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(b.a,{style:{fontSize:60}},"\u5bb6\u9577\u8cc7\u6599"),y.a.createElement(C.a,{style:{padding:10,backgroundColor:"#b5e9e9"},onPress:function(){return e.addParent()}},y.a.createElement(b.a,{style:{fontSize:35}},"\u65b0\u589e\u5bb6\u9577"))),n.map((function(t,n){var r=t.name,s=t.email,i=t.username,o=t.password,c=t.role;t.mobile,t.address,t.work_phone,t.transportation;return y.a.createElement(E.a,{key:n,style:{padding:10,backgroundColor:"white",marginBottom:20}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"}},y.a.createElement(E.a,{style:{width:"50%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(Hn.a,{placeholder:"\u5168\u540d",value:r,style:{fontSize:30},onChangeText:function(t){return e.setName(t,n)}})),y.a.createElement(E.a,{style:{width:"20%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(Gr.a,{selectedValue:c,style:{height:50},onValueChange:function(t,a){return e.setRole(t,n)}},y.a.createElement(Gr.a.Item,{label:"\u7236",value:"\u7236"}),y.a.createElement(Gr.a.Item,{label:"\u6bcd",value:"\u6bcd"}))),y.a.createElement(C.a,{style:{width:"20%",padding:10,backgroundColor:"#fa625f",borderRadius:2,justifyContent:"center"},onPress:function(){return e.removeParent(n)}},y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:30}},"\u79fb\u9664"))),y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"}},y.a.createElement(E.a,{style:{width:"100%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(Hn.a,{placeholder:"Email",autoCapitalize:"none",keyboardType:"email-address",value:s,style:{fontSize:30},onChangeText:function(t){return e.setEmail(t,n)}}))),y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",marginBottom:"5%"}},y.a.createElement(E.a,{style:{width:"35%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(Hn.a,{placeholder:"\u5e33\u865f",autoCapitalize:"none",value:i,style:{fontSize:30},onChangeText:function(t){return e.setUsername(t,n)},onEndEditing:function(t){return e.toLowerCase(t,n)}})),y.a.createElement(E.a,{style:{width:"35%",padding:10,backgroundColor:"#F5F5F5",borderRadius:2,borderBottomWidth:2,borderBottomColor:"#b5e9e9",justifyContent:"center"}},y.a.createElement(Hn.a,{secureTextEntry:!0,placeholder:"\u5bc6\u78bc",value:o,style:{fontSize:30},onChangeText:function(t){return e.setPassword(t,n)}})),y.a.createElement(C.a,{style:{width:"20%",padding:5,backgroundColor:a[n]?"#dcf3d0":"#ffe1d0",justifyContent:"center"},onPress:function(){return e.handleSignup(n)},disable:a[n]},a[n]?y.a.createElement(b.a,{style:{fontSize:20}},"SUCCESS"):y.a.createElement(b.a,{style:{fontSize:35,alignSelf:"center"}},"\u8a3b\u518a"))))})))}}]),n}(y.a.Component),Yr=n(553);function Xr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Zr(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var $r=function(e){u()(n,e);var t=Zr(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={parentSignUpStatus:[!1],createFamilyProfileStatus:"not_created"},a}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"createFamilyProfile",value:function(){var e=this,t=!0;if(this.refs.parent.getParentSignUpStatus().forEach((function(e){t&=e})),t){var n=this.refs.parent.getParentDataArray(),a=this.refs.student.getStudentDataArray();this.setState({createFamilyProfileStatus:"creating"}),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/family/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({parentDataArray:n,studentDataArray:a})}).then((function(e){return e.json()})).then((function(t){t.statusCode>200||"Internal server error"===t.message?alert("Error!"+t.message):(e.fetchStudentData(),fe.a.alert("\u8a3b\u518a\u6210\u529f!","\u9ede\u9078OK\u4ee5\u96e2\u958b\u9801\u9762",[{text:"OK",onPress:function(){return e.props.navigation.goBack()}}]),e.setState({createFamilyProfileStatus:"created"}))})).catch((function(e){console.error(e)}))}else alert("Error! We cannot create family profile until all parents have been signed up")}},{key:"fetchStudentData",value:function(){var e,t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.route.params.school_id,c.next=3,r.a.awrap(_n("/school/"+e+"/student"));case 3:if(t=c.sent,n=t.success,t.statusCode,a=t.message,s=t.data,n){c.next=8;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),c.abrupt("return");case 8:i=s.students,o=s.classes,this.props.fetchStudentsSuccess(i,o);case 10:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state,n=(t.studentDataArray,t.parentDataArray,t.parentSignUpStatus,t.createFamilyProfileStatus);return y.a.createElement(Un.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(Yr.a,{style:{width:"100%"}},y.a.createElement(Kr,{ref:"student",classes:this.props.classes}),y.a.createElement(Jr,{ref:"parent"}),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-around"}},y.a.createElement(C.a,{style:{flex:1,padding:20,backgroundColor:"not_created"===n||"creating"===n?"#b5e9e9":"#00c07f",justifyContent:"center"},onPress:function(){return e.createFamilyProfile()}},"not_created"===n?y.a.createElement(b.a,{style:{fontSize:50,textAlign:"center"}},"\u5b8c\u6210"):"creating"===n?y.a.createElement(Mn,null):y.a.createElement(b.a,{style:{fontSize:50}},"SUCCESS")),y.a.createElement(C.a,{style:{flex:1,padding:20,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.navigation.goBack()}},y.a.createElement(b.a,{style:{fontSize:50,textAlign:"center"}},"\u8fd4\u56de")))))}}]),n}(y.a.Component),es=Object(k.b)((function(e){return{classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xr(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({fetchStudentsSuccess:Ut},e))}))($r),ts=n(130),ns=n(117),as=n(75);function rs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ss(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var is=Sa.a.get("window"),os=is.width,cs=is.height,ls=function(e){u()(n,e);var t=ss(n);function n(e){return i()(this,n),t.call(this,e)}return c()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.show,a=t.component,r=t.modal_padding;return n?y.a.createElement(Un.a,{style:{backgroundColor:"transparent",alignItems:"center",zIndex:2,position:"absolute",width:"100%",height:"100%"},behavior:"height",enabled:!0},y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.8)",width:"100%",height:"100%"},onPress:function(){return e.props.hideModal()}},y.a.createElement(E.a,null)),y.a.createElement(E.a,{style:{flex:1,marginTop:r,width:os/2,height:cs,backgroundColor:"white",zIndex:3,position:"absolute"}},a)):null}}]),n}(y.a.Component),us=(ue.a.create({thumbnailImage:{width:200,height:200,borderRadius:100}}),Object(k.b)((function(e){return{students:e.school.students,isConnected:e.school.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rs(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({},e))}))(ls));function ds(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function fs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ds(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ds(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ps(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var hs=function(e){u()(a,e);var t=ps(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={parents:[],student:null,isLoading:!0},n}return c()(a,[{key:"componentDidMount",value:function(){var e,t,n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.props,t=e.student_id,n=e.student,o.next=3,r.a.awrap(_n("/student/"+t+"/family"));case 3:if(a=o.sent,s=a.success,a.statusCode,i=a.message,a.data,s){o.next=8;break}return alert("Sorry \u53d6\u5f97\u5bb6\u5ead\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+i),o.abrupt("return");case 8:this.setState({parents:a.data,student:n,isLoading:!1});case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"addParent",value:function(){3!==this.state.parents.length?this.props.addParent({id:"",name:"",role:"",username:"",password:"",mobile:"",work_phone:"",address:""}):alert("Sorry \u4e00\u500b\u5bf6\u8c9d\u53ea\u80fd\u8a3b\u518a\u4e09\u4f4d\u5bb6\u9577\uff01")}},{key:"editStudentData",value:function(){var e,t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.student_id,t=this.state.student,n=t.name,a=t.class_id,l.next=5,r.a.awrap(bn("/student/"+e,{name:n,class_id:a}));case 5:if(s=l.sent,i=s.success,s.statusCode,o=s.message,s.data,i){l.next=10;break}return alert("Sorry \u7de8\u8f2f\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o),l.abrupt("return");case 10:this.props.hideModal(),c=this.props.student.class_id,this.props.editStudentSuccess(e,n,c,a);case 13:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"getClassNames",value:function(){var e=this.props.classes;return Object.keys(e).map((function(t){return e[t].name}))}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(a){t[a].name===e&&(n=a)})),this.setState({student:fs(fs({},this.state.student),{},{class_id:n})})}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,r=a.student,s=a.parents;return a.isLoading?y.a.createElement(Mn,null):y.a.createElement(E.a,{style:{flex:1,padding:30}},y.a.createElement(E.a,{style:{flex:3,flexDirection:"row",alignItems:"center",backgroundColor:"#DCDCDC"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(C.a,{style:{}},y.a.createElement(pe.a,{source:""===r.profile_picture?n(62):{uri:r.profile_picture},style:{width:200,height:200,borderRadius:100}}))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(Hn.a,{style:{fontSize:50},value:r.name,onChangeText:function(t){return e.setState({student:fs(fs({},e.state.student),{},{name:t})})}}),y.a.createElement(C.a,{style:{backgroundColor:"rgba(255,255,255, 0.5)",alignItems:"center",padding:5,width:"90%",marginTop:5}},y.a.createElement(b.a,{style:{fontSize:50}},t[r.class_id].name)))),y.a.createElement(E.a,{style:{flex:5,backgroundColor:"#F5F5F5"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},s.map((function(t){return y.a.createElement(E.a,{key:t.id,style:{width:"100%",height:"33%",padding:"1%"}},y.a.createElement(C.a,{style:{flex:1,padding:10,backgroundColor:"#b5e9e9",justifyContent:"center"},onPress:function(){return e.props.addParent(t)}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{paddingRight:10}},y.a.createElement(b.a,{style:{fontSize:20}},t.role)),y.a.createElement(E.a,null,y.a.createElement(E.a,{style:{width:"100%",flexDirection:"row"}},y.a.createElement(b.a,{style:{fontSize:20}},"\u59d3\u540d: ",t.name,"         "),y.a.createElement(b.a,{style:{fontSize:20}},"\u5e33\u865f: ",t.username,"         ")),y.a.createElement(b.a,{style:{fontSize:20}},"\u624b\u6a5f: ",t.mobile),y.a.createElement(b.a,{style:{fontSize:18}},"\u5de5\u4f5c/\u5bb6\u7528\u96fb\u8a71: ",t.work_phone),y.a.createElement(b.a,{style:{fontSize:18}},"\u5730\u5740: ",t.address)))))})),s.length<3?y.a.createElement(E.a,{style:{width:"100%",height:"33%",padding:"1%"}},y.a.createElement(C.a,{style:{flex:1,padding:10,backgroundColor:"white",justifyContent:"center",borderWidth:5,borderRadius:1,borderStyle:"dashed"},onPress:function(){return e.addParent()}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u65b0\u589e\u5bb6\u9577")))):null)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC"}},y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.hideModal()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u8fd4\u56de"))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.editStudentData()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u9001\u51fa")))))}}]),a}(y.a.Component);function ms(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ys(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ms(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ms(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var _s=function(e){u()(a,e);var t=gs(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={password:"",qr_data:"",name:""},n}return c()(a,[{key:"componentDidMount",value:function(){var e,t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(e=this.props,t=e.parent_data,n=e.isConnected,this.setState(ys(ys({},this.state),t)),n){c.next=5;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),c.abrupt("return");case 5:if(""==t.id){c.next=14;break}return c.next=8,r.a.awrap(_n("/user/"+t.id+"/qrcode"));case 8:if(a=c.sent,s=a.success,a.statusCode,i=a.message,o=a.data,s){c.next=13;break}return alert("Sorry \u53d6\u5f97\u5bb6\u9577QR Code\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+i),c.abrupt("return");case 13:this.setState({qr_data:o});case 14:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"postParent",value:function(){var e,t,n,a,s,i,o,c,l,u,d,f,p,h,m,y;return r.a.async((function(g){for(;;)switch(g.prev=g.next){case 0:if(e=this.props,t=e.student_id,n=e.isConnected,a=this.state,s=a.id,i=a.name,o=a.role,c=a.email,l=a.username,u=a.mobile,d=a.work_phone,f=a.address,n||alert("\u7db2\u8def\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b"),""!==s){g.next=9;break}return g.next=6,r.a.awrap(this.signUpParent());case 6:if(g.sent.success){g.next=9;break}return g.abrupt("return");case 9:return p={student_id:t,parent_data:{id:s,name:i,role:o,email:c,username:l,mobile:u,work_phone:d,address:f}},g.next=12,r.a.awrap(En("/student/"+t+"/family",p));case 12:if(h=g.sent,m=h.success,h.statusCode,y=h.message,h.data,m){g.next=17;break}return alert("Sorry \u65b0\u589e\u5bb6\u9577\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+y),g.abrupt("return");case 17:this.props.goBack();case 18:case"end":return g.stop()}}),null,this,null,Promise)}},{key:"signUpParent",value:function(){var e,t,n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=this.state,t=e.username,n=e.password,a=e.name,s=e.email,o.next=3,r.a.awrap(w.a.signUp({username:t,password:n,attributes:{name:a,email:s}}).then((function(e){return{success:!0}})).catch((function(e){return alert("\u5bb6\u9577\u8a3b\u518a\u6709\u554f\u984c!\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+e.message),{success:!1}})));case 3:return i=o.sent,o.abrupt("return",i);case 5:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state,a=t.id,r=t.name,s=t.username,i=t.password,o=t.mobile,c=t.work_phone,l=t.address,u=t.role,d=t.email;return y.a.createElement(E.a,{style:{flex:1,padding:30}},y.a.createElement(E.a,{style:{flex:1,backgroundColor:"#F5F5F5"}},y.a.createElement(Rn.a,null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",padding:10,justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"66%",padding:10,backgroundColor:"#ffddb7"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u59d3\u540d"),y.a.createElement(Hn.a,{style:{fontSize:35,textAlign:"center"},value:r,onChangeText:function(t){return e.setState({name:t})}})),y.a.createElement(E.a,{style:{width:"32%",padding:10,backgroundColor:"#ffddb7"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u89d2\u8272"),y.a.createElement(Hn.a,{style:{fontSize:35,textAlign:"center"},value:u,onChangeText:function(t){return e.setState({role:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(E.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"}},y.a.createElement(b.a,{style:{fontSize:15}},"Email"),y.a.createElement(Hn.a,{style:{fontSize:35},autoCapitalize:"none",keyboardType:"email-address",placeholder:"",value:d,onChangeText:function(t){return e.setState({email:t})}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",padding:10,justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"49%",padding:15,backgroundColor:"#ffddb7"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5e33\u865f"),y.a.createElement(Hn.a,{editable:""===a,style:{fontSize:35,textAlign:"center"},autoCapitalize:"none",value:s,onChangeText:function(t){return e.setState({username:t})}})),""===a?y.a.createElement(E.a,{style:{width:"49%",padding:15,backgroundColor:"#ffddb7"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5bc6\u78bc"),y.a.createElement(Hn.a,{secureTextEntry:!0,style:{fontSize:35,textAlign:"center"},value:i,onChangeText:function(t){return e.setState({password:t})}})):y.a.createElement(C.a,{style:{backgroundColor:"transparent",alignItems:"center",justifyContent:"center"},onPress:function(){return e.props.viewQRCode(e.state.qr_data)}},y.a.createElement(pe.a,{source:n(444),style:{width:120,height:120}}))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(E.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u624b\u6a5f"),y.a.createElement(Hn.a,{style:{fontSize:35},keyboardType:"number-pad",placeholder:"",value:o,onChangeText:function(t){return e.setState({mobile:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(E.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5de5\u4f5c/\u5bb6\u7528\u96fb\u8a71"),y.a.createElement(Hn.a,{style:{fontSize:35},keyboardType:"number-pad",placeholder:"",value:c,onChangeText:function(t){return e.setState({work_phone:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(E.a,{style:{padding:15,backgroundColor:"#ffddb7",height:"100%"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5730\u5740"),y.a.createElement(Hn.a,{style:{fontSize:35},placeholder:"",value:l,onChangeText:function(t){return e.setState({address:t})}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC"}},y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u8fd4\u56de"))),""!==a?y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u79fb\u9664"))):null,y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postParent()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},""===a?"\u65b0\u589e":"\u9001\u51fa")))))))}}]),a}(y.a.Component),Es=Object(k.b)((function(e){return{isConnected:e.school.isConnected}}),null)(_s),bs=n(258);function vs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ss=function(e){u()(n,e);var t=vs(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={},a}return c()(n,[{key:"render",value:function(){var e=this,t=this.props.parent_data,n=(t.name,t.role),a="\u6bcd"===n?"\u5abd\u5abd":"\u7236"===n?"\u7238\u7238":n;return y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:3,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:65}},this.props.student_name," ",a),y.a.createElement(bs.a,{value:this.props.qr_data,size:400})),y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(C.a,{style:{padding:15,backgroundColor:"#b5e9e9"},onPress:function(){return e.props.goBack()}},y.a.createElement(b.a,{style:{fontSize:30}},"\u8fd4\u56de"))))}}]),n}(y.a.Component);function ws(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Cs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ks=Sa.a.get("window"),Ds=(ks.width,ks.height),xs=function(e){u()(a,e);var t=Cs(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).getPermissionAsync=function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Wn.a.OS){t.next=6;break}return t.next=3,r.a.awrap(as.c(as.b));case 3:e=t.sent,"granted"!==e.status&&alert("Sorry, we need camera roll permissions to make this work!");case 6:case"end":return t.stop()}}),null,null,null,Promise)},n._pickImage=function(e,t){var a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,r.a.awrap(ts.a({mediaTypes:ns.a.All,allowsEditing:!0,aspect:[1,1],quality:.4,base64:!0}));case 3:(a=i.sent).cancelled||(s=a.base64,n.getProfilePictureURL(s,e,t)),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),console.log(i.t0);case 10:case"end":return i.stop()}}),null,null,[[0,7]],Promise)},n.state={showModal:!1,modal_type:"",student_id:"",parent_data:{},qr_data:"",modal_padding:0},n}return c()(a,[{key:"componentDidMount",value:function(){this.getPermissionAsync()}},{key:"getProfilePictureURL",value:function(e,t,n){var a,s,i,o,c,l,u;return r.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return a=this.props.route.params.school_name,s=this.props.students,i={image:e,url:n,path:a+"/profile_picture_"+t+"_"+(new Date).getMilliseconds()+".jpg"},d.next=5,r.a.awrap(En("/student/"+t+"/profile-picture",i));case 5:if(o=d.sent,c=o.success,o.statusCode,l=o.message,u=o.data,c){d.next=10;break}return alert("Sorry "+s[t].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l),d.abrupt("return");case 10:this.props.updateProfilePicture(t,u.image_url);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"getModalContent",value:function(){var e=this,t=this.props,n=t.students,a=t.classes,r=this.state,s=r.showModal,i=r.modal_type,o=r.student_id,c=r.parent_data,l=r.qr_data;return s?"student"===i?y.a.createElement(hs,{student_id:o,student:n[o],classes:a,addParent:function(t){return e.setState({modal_type:"add_parent",parent_data:t})},editStudentSuccess:function(t,n,a,r){return e.props.editStudentSuccess(t,n,a,r)},hideModal:function(){return e.hideModal()}}):"add_parent"===i?y.a.createElement(Es,{student_id:o,parent_data:c,viewQRCode:function(t){return e.setState({modal_type:"qrpage",qr_data:t})},goBack:function(){return e.setState({modal_type:"student"})}}):y.a.createElement(Ss,{qr_data:l,student_name:n[o].name,parent_data:c,goBack:function(){return e.setState({modal_type:"add_parent"})}}):null}},{key:"hideModal",value:function(){this.setState({showModal:!1})}},{key:"confirmDeleteStudent",value:function(e){var t=this,n=this.props.students;fe.a.alert(n[e].name+" \u522a\u9664\u78ba\u8a8d","\u522a\u9664\u9019\u500b\u5bf6\u8c9d\u6703\u5c07\u4e00\u5207\u6538\u95dc\u8cc7\u6599(\u5305\u8a87\u7236\u6bcd)\u522a\u9664",[{text:"\u53d6\u6d88",style:"cancel"},{text:"OK",onPress:function(){return t.deleteStudentById(e)}}])}},{key:"deleteStudentById",value:function(e){var t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=this.props.students,i.next=3,r.a.awrap(vn("/student/"+e+"/"));case 3:if(n=i.sent,a=n.success,n.statusCode,s=n.message,n.data,a){i.next=8;break}return alert("Sorry "+t[e].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),i.abrupt("return");case 8:this.fetchStudentData();case 9:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"fetchStudentData",value:function(){var e,t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props.route.params.school_id,c.next=3,r.a.awrap(_n("/school/"+e+"/student"));case 3:if(t=c.sent,n=t.success,t.statusCode,a=t.message,s=t.data,n){c.next=8;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),c.abrupt("return");case 8:i=s.students,o=s.classes,this.props.fetchStudentsSuccess(i,o);case 10:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.students,a=this.state,r=a.showModal,s=a.modal_padding;return y.a.createElement(E.a,null,y.a.createElement(us,{modal_padding:s,show:r,component:this.getModalContent(),hideModal:function(){return e.hideModal()}}),y.a.createElement(Rn.a,null,Object.keys(t).map((function(a,r){var s=t[a];return y.a.createElement(E.a,{key:a,style:{flex:1,backgroundColor:"lightgrey",flexDirection:"row",marginBottom:10,padding:15}},y.a.createElement(C.a,{style:{},onPress:function(){return e._pickImage(a,s.profile_picture)}},y.a.createElement(pe.a,{source:""===s.profile_picture?n(62):{uri:s.profile_picture},style:{width:200,height:200,borderRadius:100}})),y.a.createElement(E.a,{style:{flex:5,paddingLeft:15}},y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:50}},s.name)),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20}},"\u5730\u5740: ",s.address)),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20}},"\u624b\u6a5f(\u7236): ",s.father_phone)),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20}},"\u624b\u6a5f(\u6bcd): ",s.mother_phone))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"space-evenly"}},y.a.createElement(E.a,{style:{backgroundColor:"white"}},y.a.createElement(C.a,{style:{padding:15,justifyContent:"center"},onPress:function(t){return e.setState({showModal:!0,modal_type:"student",student_id:a,modal_padding:Math.max(0,t.nativeEvent.pageY-Ds)})}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u7de8\u8f2f"))),y.a.createElement(E.a,{style:{backgroundColor:"#fa625f"}},y.a.createElement(C.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.confirmDeleteStudent(a)}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u522a\u9664")))))}))))}}]),a}(y.a.Component),As=Object(k.b)((function(e){return{students:e.school.students,classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ws(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ws(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({updateProfilePicture:Zt,fetchStudentsSuccess:Ut,editStudentSuccess:$t},e))}))(xs);function Os(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Rs=function(e){u()(n,e);var t=Os(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={id:"",name:"",profile_picture:"",class_id:"",passcode:"",isAdmin:!1},a}return c()(n,[{key:"componentDidMount",value:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),null,null,null,Promise)}},{key:"postTeacher",value:function(){var e,t,n,a,s,i,o,c,l,u,d,f,p;return r.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return e=this.props,e.student_id,t=e.school_id,n=this.state,a=n.id,s=n.name,i=n.profile_picture,o=n.class_id,c=n.passcode,l=n.isAdmin,u={id:a,name:s,profile_picture:i,class_id:o,passcode:c,isAdmin:l},h.next=5,r.a.awrap(En("/school/"+t+"/teacher",u));case 5:if(d=h.sent,f=d.success,d.statusCode,p=d.message,d.data,f){h.next=10;break}return fe.a.alert("Sorry \u65b0\u589e\u6559\u5e2b\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+p,[{text:"Ok"}]),h.abrupt("return");case 10:this.props.goBack(),this.props.fetchTeacherData();case 12:case"end":return h.stop()}}),null,this,null,Promise)}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(a){t[a].name===e&&(n=a)})),this.setState({class_id:n,isAdmin:"\u7ba1\u7406\u54e1"===e})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,a=n.id,r=n.name,s=n.class_id,i=n.passcode;n.isAdmin;return y.a.createElement(E.a,{style:{flex:1,padding:30}},y.a.createElement(E.a,{style:{flex:1,backgroundColor:"#F5F5F5"}},y.a.createElement(Rn.a,null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",padding:20,justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u59d3\u540d"),y.a.createElement(Hn.a,{style:{fontSize:35,textAlign:"center"},value:r,onChangeText:function(t){return e.setState({name:t})}})),y.a.createElement(E.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5bc6\u78bc"),y.a.createElement(Hn.a,{style:{fontSize:35,textAlign:"center"},value:i,keyboardType:"number-pad",onChangeText:function(t){return e.setState({passcode:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:20}},y.a.createElement(E.a,{style:{padding:10,backgroundColor:"#ffddb7",height:"100%",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u73ed\u7d1a"),y.a.createElement(Gn,{style:{backgroundColor:"rgba(255,255,255, 0)",alignItems:"center",padding:5},textStyle:{fontSize:30},selectedValue:""===s?"\u9078\u64c7\u73ed\u7d1a":t[s].name,options:Object.keys(t).map((function(e){return t[e].name})),handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t)}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC",marginTop:20}},y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u8fd4\u56de"))),y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postTeacher()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},""===a?"\u65b0\u589e":"\u9001\u51fa")))))))}}]),n}(y.a.Component);function js(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ts=function(e){u()(n,e);var t=js(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={id:"",name:"",profile_picture:"",class_id:"",passcode:"",isAdmin:!1},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.teacher_id,n=e.teacher,a=e.classes,r=n.name,s=n.profile_picture,i=n.passcode,o=this.getClassIdByTeacherId(t,a);this.setState({id:t,name:r,profile_picture:s,passcode:i,class_id:o,isAdmin:""!==o&&"\u7ba1\u7406\u54e1"===a[o].name})}},{key:"getClassIdByTeacherId",value:function(e,t){for(var n=Object.keys(t),a=0;a<n.length;a++)for(var r=n[a],s=t[r].teachers,i=0;i<s.length;i++)if(e===s[i])return r;return""}},{key:"postTeacher",value:function(){var e,t,n,a,s,i,o,c,l,u,d,f,p;return r.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:return e=this.props,e.student_id,t=e.school_id,n=this.state,a=n.id,s=n.name,i=n.profile_picture,o=n.class_id,c=n.passcode,l=n.isAdmin,u={id:a,name:s,profile_picture:i,class_id:o,passcode:c,isAdmin:l},h.next=5,r.a.awrap(En("/school/"+t+"/teacher",u));case 5:if(d=h.sent,f=d.success,d.statusCode,p=d.message,d.data,f){h.next=10;break}return fe.a.alert("Sorry \u66f4\u6539\u6559\u5e2b\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+p,[{text:"Ok"}]),h.abrupt("return");case 10:this.props.goBack(),this.props.fetchTeacherData();case 12:case"end":return h.stop()}}),null,this,null,Promise)}},{key:"handleSelectClass",value:function(e){var t=this.props.classes,n="";Object.keys(t).forEach((function(a){t[a].name===e&&(n=a)})),this.setState({class_id:n,isAdmin:"\u7ba1\u7406\u54e1"===e})}},{key:"render",value:function(){var e=this,t=this.props,n=t.classes,a=(t.teacher,this.state),r=a.id,s=a.name,i=a.class_id,o=a.passcode;return y.a.createElement(E.a,{style:{flex:1,padding:30}},y.a.createElement(E.a,{style:{flex:1,backgroundColor:"#F5F5F5"}},y.a.createElement(Rn.a,null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",padding:20,justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u59d3\u540d"),y.a.createElement(Hn.a,{style:{fontSize:35,textAlign:"center"},value:s,onChangeText:function(t){return e.setState({name:t})}})),y.a.createElement(E.a,{style:{width:"48%",padding:10,backgroundColor:"#ffddb7",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u5bc6\u78bc"),y.a.createElement(Hn.a,{style:{fontSize:35,textAlign:"center"},value:o,keyboardType:"number-pad",onChangeText:function(t){return e.setState({passcode:t})}}))),y.a.createElement(E.a,{style:{flex:1,padding:20}},y.a.createElement(E.a,{style:{padding:10,backgroundColor:"#ffddb7",height:"100%",borderBottomWidth:3,borderRadius:10,borderBottomColor:"#ff8944"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u73ed\u7d1a"),y.a.createElement(Gn,{style:{backgroundColor:"rgba(255,255,255, 0)",alignItems:"center",padding:5},textStyle:{fontSize:30},selectedValue:""===i?"\u9078\u64c7\u73ed\u7d1a":n[i].name,options:Object.keys(n).map((function(e){return n[e].name})),handleOnClick:function(){},handleSelectValue:function(t){return e.handleSelectClass(t)}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"#DCDCDC",marginTop:20}},y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.goBack()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u8fd4\u56de"))),y.a.createElement(E.a,{style:{flex:1,padding:14}},y.a.createElement(C.a,{style:{flex:1,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.postTeacher()}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},""===r?"\u65b0\u589e":"\u9001\u51fa")))))))}}]),n}(y.a.Component);function Ps(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Is(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var zs=function(e){u()(a,e);var t=Is(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).getPermissionAsync=function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Wn.a.OS){t.next=8;break}return t.next=3,r.a.awrap(as.c(as.b));case 3:if(e=t.sent,"granted"===e.status){t.next=8;break}return alert("Sorry, we need camera roll permissions to make this work!"),t.abrupt("return");case 8:case"end":return t.stop()}}),null,null,null,Promise)},n._pickImage=function(e,t){var a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,r.a.awrap(ts.a({mediaTypes:ns.a.All,allowsEditing:!0,aspect:[1,1],quality:.4,base64:!0}));case 3:(a=i.sent).cancelled||(s=a.base64,n.getProfilePictureURL(s,e,t)),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),console.log(i.t0);case 10:case"end":return i.stop()}}),null,null,[[0,7]],Promise)},n.state={showModal:!1,modal_type:"",selected_teacher_id:""},n}return c()(a,[{key:"componentDidMount",value:function(){this.getPermissionAsync()}},{key:"getProfilePictureURL",value:function(e,t,n){var a,s,i,o,c,l,u;return r.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return a=this.props.route.params.school_name,s=this.props.teachers,i={image:e,url:n,path:a+"/teacher/profile_picture_"+t+"_"+(new Date).getMilliseconds()+".jpg"},d.next=5,r.a.awrap(bn("/user/"+t+"/profile-picture",i));case 5:if(o=d.sent,c=o.success,o.statusCode,l=o.message,u=o.data,c){d.next=10;break}return alert("Sorry "+s[t].name+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+l),d.abrupt("return");case 10:this.props.updateTeacherProfilePicture(t,u.image_url);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"fetchTeacherData",value:function(){var e,t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.route.params.school_id,l.next=3,r.a.awrap(_n("/school/"+e+"/teacher"));case 3:if(t=l.sent,n=t.success,t.statusCode,a=t.message,s=t.data,n){l.next=8;break}return alert("Sorry \u53d6\u5f97\u6559\u5e2b\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),l.abrupt("return");case 8:i=s.admins,o=s.teachers,c=s.classes,this.props.fetchTeachersSuccess(i,o,c);case 10:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"getModalContent",value:function(){var e=this,t=this.props.route.params.school_id,n=this.props,a=n.classes,r=n.teachers,s=this.state,i=s.modal_type,o=s.selected_teacher_id;return"add_teacher"===i?y.a.createElement(Rs,{classes:a,school_id:t,fetchTeacherData:function(){return e.fetchTeacherData()},goBack:function(){return e.hideModal()}}):"edit_teacher"===i?y.a.createElement(Ts,{classes:a,teacher_id:o,teacher:r[o],fetchTeacherData:function(){return e.fetchTeacherData()},goBack:function(){return e.hideModal()}}):void 0}},{key:"hideModal",value:function(){this.setState({showModal:!1})}},{key:"confirmDeleteTeacher",value:function(e){var t=this.props.teachers;confirm(t[e].name+" \u522a\u9664\u78ba\u8a8d")&&this.deleteTeacher(e)}},{key:"deleteTeacher",value:function(e){var t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.awrap(vn("/user/"+e));case 2:if(t=s.sent,n=t.success,t.statusCode,a=t.message,t.data,n){s.next=7;break}return alert("Sorry "+teachers[e].name+"\u522a\u9664\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+a),s.abrupt("return");case 7:this.fetchTeacherData();case 8:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.teachers,a=this.state.showModal;return y.a.createElement(E.a,null,y.a.createElement(us,{show:a,component:this.getModalContent(),hideModal:function(){return e.hideModal()}}),y.a.createElement(Rn.a,null,y.a.createElement(E.a,{style:{padding:20}},y.a.createElement(C.a,{style:{padding:10,alignSelf:"flex-end",backgroundColor:"#ffddb7"},onPress:function(){return e.setState({showModal:!0,modal_type:"add_teacher"})}},y.a.createElement(b.a,{style:{fontSize:40}},"\u65b0\u589e\u6559\u5e2b"))),Object.keys(t).map((function(a,r){var s=t[a];return y.a.createElement(E.a,{key:a,style:{flex:1,backgroundColor:"lightgrey",flexDirection:"row",marginBottom:10,padding:15}},y.a.createElement(C.a,{style:{},onPress:function(){return e._pickImage(a,s.profile_picture)}},y.a.createElement(pe.a,{source:""===s.profile_picture?n(301):{uri:s.profile_picture},style:{width:200,height:200,borderRadius:100}})),y.a.createElement(E.a,{style:{flex:5,paddingLeft:15}},y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:50}},s.name))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"space-evenly"}},y.a.createElement(E.a,{style:{backgroundColor:"white"}},y.a.createElement(C.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.setState({showModal:!0,modal_type:"edit_teacher",selected_teacher_id:a})}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u7de8\u8f2f"))),y.a.createElement(E.a,{style:{backgroundColor:"#fa625f"}},y.a.createElement(C.a,{style:{padding:15,justifyContent:"center"},onPress:function(){return e.confirmDeleteTeacher(a)}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u522a\u9664")))))}))))}}]),a}(y.a.Component),Ls=Object(k.b)((function(e){return{teachers:e.school.teachers,classes:e.school.classes}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ps(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ps(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({updateTeacherProfilePicture:en,fetchTeachersSuccess:Nt},e))}))(zs),Ms=function(e){var t=e.title,n=e.content,a=e.hideModal;return y.a.createElement(C.a,{style:{width:"100%",height:"100%",zIndex:2,position:"absolute",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.7)"},onPress:function(){return a()}},y.a.createElement(E.a,{style:{width:"80%",backgroundColor:"white"}},y.a.createElement(E.a,{style:{padding:10,fontSize:30}},y.a.createElement(b.a,null,t)),y.a.createElement(E.a,{style:{padding:10}},n)))},Fs=function(e){var t=e.label,n=e.value,a=e.keyboardType,r=e.onChangeText,s=e.labelStyle,i=e.inputStyle;return y.a.createElement(E.a,{style:{flexDirection:"row",padding:5,width:"100%"}},y.a.createElement(b.a,{style:s},t+": "),y.a.createElement(Hn.a,{value:n,keyboardType:a,style:i,onChangeText:function(e){return r(e)}}))};function Bs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function qs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bs(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ns(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Us=function(e){u()(a,e);var t=Ns(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={date:new Date,isLoading:!0,to_all_message:"",items_to_bring:["\u6bcd\u5976\u7c89","\u5c3f\u5e03","\u6c34\u58fa","\u8863\u7269"],other_item:"\u5176\u5b83",items_to_bring_bool:[0,0,0,0,0],activities_list:["\u5b30\u5152\u6309\u6469","\u97f3\u6a02\u5f8b\u52d5","\u6559\u5177\u64cd\u4f5c","\u7e6a\u672c\u6b23\u8cde","\u8a8d\u77e5\u5716\u7247","\u9ad4\u80fd\u6d3b\u52d5","\u85dd\u8853\u5275\u4f5c","\u591a\u5143\u8a9e\u8a00"],other_activity:"\u5176\u5b83",activities_bool:[0,0,0,0,0,0,0,0,0],message_by_student_id:{},editingOtherItemToBring:!1,editingOtherItemForStudent:"",editingOtherActivity:!1,editingOtherActivityForOne:"",showDateTimeModal:!1,growth_standard_by_student_id:{},show_growth_standard:!1,dob_year:"",dob_month:"",dob_date:""},n.recordActivitiesForAll=n.recordActivitiesForAll.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.date,n=e.teacher_name,a=this.props.message.student_id_for_update,r=this.props.class.isConnected;a.size>0||!r?this.setState({date:t,isLoading:!1}):(this.setState({date:t}),this.fetchClassData(t)),r||le.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3}),this.props.navigation.setOptions({title:"\u8001\u5e2b\uf9cd\u2f94 - "+n})}},{key:"fetchClassData",value:function(e){var t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#f4d41f",marginRight:20}})}}),t=new Date(e),n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=7,r.a.awrap(wn("message",this.props.class.class_id,n,a));case 7:s=i.sent,this.props.fetchClassMessageData(s.data),this.setState({isLoading:!1}),this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:"#00c07f",marginRight:20}})}});case 11:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"writeToAll",value:function(e){var t=this.props.route.params.teacher_id;this.props.writeToAll(e,t)}},{key:"writeToOne",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.writeToOne(e,t,n)}},{key:"remindItemsToBringToOne",value:function(e,t){var n=this.props.route.params.teacher_id,a=this.props.message.message_by_student_id,r=P()(a[e].things_to_bring),s=r[t]?0:1;r.splice(t,1,s),this.props.remindItemsToBringToOne(e,r,n)}},{key:"remindItemsToBringToAll",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.items_to_bring_bool,a=n[e]?0:1;n.splice(e,1,a),this.setState({items_to_bring_bool:n}),this.props.remindItemsToBringToAll(n,t)}},{key:"otherItemForAllEditorOnBlur",value:function(){var e=this.state.other_item;this.setState({editingOtherItemToBring:!1,other_item:""===e?"\u5176\u5b83":e})}},{key:"writeItemToBringToAll",value:function(e){var t=this.props.route.params.teacher_id;this.setState({other_item:e}),this.props.writeItemToBringToAll(e,t)}},{key:"writeItemToBringToOne",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.writeItemToBringToOne(e,t,n)}},{key:"editItemToBringToOneEditorOnBlur",value:function(e,t){this.setState({editingOtherItemForStudent:""}),""===t&&this.props.writeItemToBringToOne(e,"\u5176\u5b83")}},{key:"recordActivitiesForOne",value:function(e,t){var n=this.props.route.params.teacher_id,a=this.props.message.message_by_student_id,r=P()(a[e].activities),s=r[t]?0:1;r.splice(t,1,s),this.props.recordActivitiesForOne(e,r,n)}},{key:"recordActivitiesForAll",value:function(e){var t=this.props.route.params.teacher_id,n=this.state.activities_bool,a=n[e]?0:1;n.splice(e,1,a),this.setState({activities_bool:n}),this.props.recordActivitiesForAll(n,t)}},{key:"writeActivityForAll",value:function(e){var t=this.props.route.params.teacher_id;this.setState({other_activity:e}),this.props.writeActivityForAll(e,t)}},{key:"otherActivityEditorOnBlur",value:function(){var e=this.state.other_activity;this.setState({editingOtherActivity:!1,other_activity:""===e?"\u5176\u5b83":e})}},{key:"writeActivityForOne",value:function(e,t){var n=this.props.route.params.teacher_id;this.props.writeActivityForOne(e,t,n)}},{key:"activityForOneEditorOnBlur",value:function(e,t){this.setState({editingOtherActivityForOne:""}),""===t&&this.props.writeActivityForOne(e,"\u5176\u5b83")}},{key:"handleSend",value:function(){var e=this,t=this.props.message,n=t.message_by_student_id,a=t.student_id_for_update,r=this.props.class.isConnected;if(0!==a.size)if(r){var s={date:fn(new Date),data:this.normalize(n)};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/message",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,a=t.message;t.data;n>200||"Internal server error"===a?fe.a.alert("Error",a,[{text:"OK"}]):(e.props.sendMessageOnSuccess(),e.props.navigation.goBack())})).catch((function(e){fe.a.alert("Error",e,[{text:"OK"}])}))}else le.Toast.show({text:"\u7db2\u8def\u9023\u7dda\u9023\u4e0d\u5230! \u7b49\u4e00\u4e0b\u518d\u8a66\u8a66\u770b",buttonText:"Okay",position:"top",type:"danger",duration:4e3});else this.props.navigation.goBack()}},{key:"normalize",value:function(e){var t=this.props.message,n=t.student_id_for_update,a=t.for_all,r=[];return n.forEach((function(t){r.push(qs(qs({},e[t]),{},{text:a.text+" \n"+e[t].text,student_id:t}))})),r}},{key:"selectDatetimeConfirm",value:function(e){this.setState({date:e,showDateTimeModal:!1}),this.fetchClassData(e),this.fetchParentPreviousDayMessage(e)}},{key:"fetchParentPreviousDayMessage",value:function(e){var t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.awrap(_n("/message/class/"+this.props.class.class_id+"/previous-day?date="+fn(e)));case 2:t=s.sent,n=t.statusCode,t.message,a=t.data,200===n&&this.props.getParentMessageSuccess(a);case 5:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"showGrowthStandard",value:function(){var e=this.props.class.students,t=this.state.show_growth_standard,n={};Object.keys(e).map((function(e){n[e]={weight:"",height:"",hc:""}})),this.setState({growth_standard_by_student_id:n,show_growth_standard:!t})}},{key:"handleEndEditing",value:function(e){var t,n,a,s,i,o,c,l,u,d,f;return r.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(t=this.state.growth_standard_by_student_id,""===(n=t[e]).weight||""===n.height||""===n.hc){p.next=9;break}return a=n.weight,s=n.height,i=n.hc,p.next=6,r.a.awrap(this.sendGrowthStandardData(e,a,s,i));case 6:o=p.sent,c=o.success,o.statusCode,o.messate,l=o.data,c&&(u=l.weight_percentile,d=l.height_percentile,f=l.hc_percentile,this.setState({growth_standard_by_student_id:qs(qs({},t),{},A()({},e,qs(qs({},t[e]),{},{weight_percentile:u,height_percentile:d,hc_percentile:f})))}));case 9:case"end":return p.stop()}}),null,this,null,Promise)}},{key:"sendGrowthStandardData",value:function(e,t,n,a){var s,i,o,c,l=this;return r.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.a.awrap(En("/student/growth-standard-percentile",{student_id:e,weight:t,height:n,head_circumference:a,date:fn(new Date)}));case 2:return s=u.sent,i=s.success,s.statusCode,o=s.message,s.data,i||(c=this.props.class.students,fe.a.alert(c[e].name+"\u7684\u9ad4\u4f4d\u8868\u8a08\u7b97\u51fa\u5dee\u932f",o,[{text:"OK"},{text:"\u73fe\u5728\u586b\u5165",onPress:function(){return l.showDOBModal(e)}}])),u.abrupt("return",s);case 6:case"end":return u.stop()}}),null,this,null,Promise)}},{key:"confirmRecord",value:function(e){var t=this.props.route.params.teacher_id,n=this.props.message.message_by_student_id[e].text,a=this.state.growth_standard_by_student_id[e],r=a.weight,s=a.height,i=a.hc,o=a.weight_percentile,c=a.height_percentile,l=a.hc_percentile;null!==o?null!==c?null!==l?(n+="\n\u9ad4\u91cd: "+r+" kg ("+o+")\n\u8eab\u9ad8: "+s+" cm ("+c+")\n\u982d\u570d: "+i+" cm ("+l+")",this.props.writeToOne(n,e,t)):fe.a.alert("\u982d\u570d\u767e\u5206\u6bd4\u9084\u672a\u8a08\u7b97\u51fa\u4f86","",[{text:"OK"}]):fe.a.alert("\u8eab\u9ad8\u767e\u5206\u6bd4\u9084\u672a\u8a08\u7b97\u51fa\u4f86","",[{text:"OK"}]):fe.a.alert("\u9ad4\u91cd\u767e\u5206\u6bd4\u9084\u672a\u8a08\u7b97\u51fa\u4f86","",[{text:"OK"}])}},{key:"showDOBModal",value:function(e){this.setState({show_dob_modal:!0,student_id_dob_edit:e})}},{key:"editDOB",value:function(){var e,t,n,a,s,i,o,c,l,u,d=this;return r.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:return e=this.state,t=e.student_id_dob_edit,n=e.dob_year,a=e.dob_month,s=e.dob_date,i=e.growth_standard_by_student_id,o=i[t],o.weight,o.height,o.hc,f.next=4,r.a.awrap(bn("/student/"+t+"/dob",{dob:n+"-"+a+"-"+s}));case 4:c=f.sent,l=c.success,c.statusCode,u=c.message,c.data,l?(this.setState({show_dob_modal:!1}),fe.a.alert("\u66f4\u6539\u6210\u529f\uff01","",[{text:"OK",onPress:function(){return d.handleEndEditing(t)}}])):fe.a.alert("\u51fa\u751f\u5e74\u6708\u65e5\u66f4\u6539\u672a\u6210\u529f",u,[{text:"OK"}]);case 7:case"end":return f.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.props.route.params.isAdmin,a=this.props.teachers,r=this.props.class.students,s=this.props.message,i=s.message_by_student_id,o=s.for_all,c=s.data_dispatched,l=s.student_id_for_update,u=s.parent_messages,d=this.state,f=d.items_to_bring,p=d.items_to_bring_bool,h=d.activities_list,m=d.activities_bool,g=d.editingOtherItemToBring,_=d.editingOtherItemForStudent,v=d.editingOtherActivity,S=d.editingOtherActivityForOne,w=d.date,k=d.showDateTimeModal,D=d.growth_standard_by_student_id,x=d.show_growth_standard,O=d.show_dob_modal,R=d.dob_year,j=d.dob_month,T=d.dob_date;return y.a.createElement(Un.a,{style:{flex:1},behavior:"height",keyboardVerticalOffset:80,enabled:!0},k&&y.a.createElement(Da,{start_date:w,datetime_type:"date",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:new Date}),O&&y.a.createElement(Ms,{title:"\u5bf6\u8c9d\u51fa\u751f\u5e74\u6708\u65e5\u586b\u5165",content:y.a.createElement(E.a,{style:{backgroundColor:"rgba(0,0,0,0.2)"}},y.a.createElement(Fs,{label:"\u5e74",value:R,keyboardType:"numeric",onChangeText:function(t){return e.setState({dob_year:t})},labelStyle:{padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)"},inputStyle:{flex:1,padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)",borderLeftWidth:1,borderColor:"white"}}),y.a.createElement(Fs,{label:"\u6708",value:j,keyboardType:"numeric",onChangeText:function(t){return e.setState({dob_month:t})},labelStyle:{padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)"},inputStyle:{flex:1,padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)",borderLeftWidth:1,borderColor:"white"}}),y.a.createElement(Fs,{label:"\u65e5",value:T,keyboardType:"numeric",onChangeText:function(t){return e.setState({dob_date:t})},labelStyle:{padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)"},inputStyle:{flex:1,padding:15,fontSize:20,backgroundColor:"rgba(255,255,255,0.4)",borderLeftWidth:1,borderColor:"white"}}),y.a.createElement(C.a,{onPress:function(){return e.editDOB()}},y.a.createElement(b.a,{style:{fontSize:20,padding:15,backgroundColor:"#b5e9e9"}},"\u9001\u51fa"))),hideModal:function(){return e.setState({show_dob_modal:!1})}}),y.a.createElement(E.a,{style:{padding:10,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},y.a.createElement(C.a,{onPress:function(){c&&t&&e.setState({showDateTimeModal:!0})}},y.a.createElement(b.a,{style:{fontSize:40}},pn(w))),y.a.createElement(C.a,{style:{borderWidth:x?0:2,borderColor:x?"transparent":"green",backgroundColor:x?"#dcf3d0":"transparent"},onPress:function(){return e.showGrowthStandard()}},y.a.createElement(b.a,{style:{fontSize:40,padding:5}},"\u9ad4\u4f4d\u8868")),y.a.createElement(C.a,{style:{backgroundColor:"#dcf3d0"},onPress:function(){return e.handleSend()}},y.a.createElement(b.a,{style:{fontSize:40,padding:5}},"\u9001\u51fa"))),y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center",marginBottom:20}},y.a.createElement(E.a,{style:{width:"95%"}},y.a.createElement(le.Card,{style:{padding:10}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",paddingVertical:10}},y.a.createElement(E.a,{style:{width:"29%",backgroundColor:"#fff1b5",borderRadius:10,marginRight:5}},y.a.createElement(b.a,{style:{fontSize:35,alignSelf:"center"}},"\u5bb6\u9577\u6e96\u5099"),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",flexWrap:"wrap"}},f.map((function(t,n){return y.a.createElement(C.a,{key:n,style:{backgroundColor:p[n]?"#f4d41f":"#fff7d6",borderRadius:3,padding:3,margin:5},onPress:function(){return e.remindItemsToBringToAll(n)}},y.a.createElement(b.a,{style:{fontSize:20}},t))})),y.a.createElement(C.a,{style:{backgroundColor:p[4]?"#f4d41f":"#fff7d6",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#f4d41f",onPress:function(){return e.remindItemsToBringToAll(4)},onLongPress:function(){return e.setState({editingOtherItemToBring:!0})}},g?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(Hn.a,{autoFocus:!0,selectTextOnFocus:!0,value:this.state.other_item,style:{alignSelf:"center",fontSize:20,backgroundColor:p[4]?"#f4d41f":"#fff7d6"},onChangeText:function(t){return e.writeItemToBringToAll(t.trim())},onBlur:function(){return e.otherItemForAllEditorOnBlur()}})):y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:20}},this.state.other_item)))),y.a.createElement(E.a,{style:{width:"69%",backgroundColor:"#b5e9e9",borderRadius:10,marginLeft:5}},y.a.createElement(b.a,{style:{fontSize:35,alignSelf:"center"}},"\u4eca\u65e5\u6d3b\u52d5"),y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-evenly",flexWrap:"wrap"}},h.map((function(t,n){return y.a.createElement(C.a,{key:n,style:{backgroundColor:m[n]?"#368cbf":"#eaf8f8",borderRadius:3,padding:3,margin:5},onPress:function(){return e.recordActivitiesForAll(n)}},y.a.createElement(b.a,{style:{fontSize:20}},t))})),y.a.createElement(C.a,{style:{backgroundColor:m[8]?"#368cbf":"#eaf8f8",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#368cbf",onPress:function(){return e.recordActivitiesForAll(8)},onLongPress:function(){return e.setState({editingOtherActivity:!0})}},v?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(Hn.a,{autoFocus:!0,selectTextOnFocus:!0,value:this.state.other_activity,style:{alignSelf:"center",fontSize:20,backgroundColor:m[8]?"#368cbf":"#eaf8f8"},onChangeText:function(t){return e.writeActivityForAll(t.trim())},onBlur:function(){return e.otherActivityEditorOnBlur()}})):y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:20}},this.state.other_activity))))),y.a.createElement(Hn.a,{value:o.text,style:{alignSelf:"center",width:"100%",borderColor:"gray",borderWidth:2,borderRadius:10,fontSize:25,padding:20},multiline:!0,onChangeText:function(t){return e.writeToAll(t)},onEndEditing:function(){return e.writeToAll(o.text.trim())}})))),Object.keys(r).map((function(t){var s=i[t],c=s.text,d=s.things_to_bring,p=s.activities,m=s.other_item,g=s.other_activity,v=s.teacher_id,w=void 0===a[v]?"":"- "+a[v].name;return y.a.createElement(E.a,{key:t,style:{width:"95%"}},y.a.createElement(le.Card,{style:{padding:10}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center",justifyContent:"center"}},y.a.createElement(pe.a,{source:""===r[t].profile_picture?n(62):{uri:r[t].profile_picture},style:{width:100,height:100,borderRadius:50}}),y.a.createElement(b.a,{style:{fontSize:25}},r[t].name)),y.a.createElement(E.a,{style:{flex:4}},x&&y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(E.a,null,y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:15}},y.a.createElement(b.a,{style:{fontSize:20,paddingRight:15}},"\u9ad4\u91cd:"),y.a.createElement(Hn.a,{value:D[t].weight,keyboardType:"numeric",style:{fontSize:20,borderBottomWidth:1,paddingHorizontal:10,paddingVertical:1},onChangeText:function(n){e.setState({growth_standard_by_student_id:qs(qs({},D),{},A()({},t,qs(qs({},D[t]),{},{weight:n})))})},onBlur:function(){return e.handleEndEditing(t)}}),y.a.createElement(b.a,{style:{fontSize:20,marginLeft:15}},"kg"),y.a.createElement(b.a,{style:{fontSize:20,marginLeft:15}},D[t].weight_percentile&&"("+D[t].weight_percentile+")")),y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:15}},y.a.createElement(b.a,{style:{fontSize:20,paddingRight:15}},"\u8eab\u9ad8:"),y.a.createElement(Hn.a,{value:D[t].height,keyboardType:"numeric",style:{fontSize:20,borderBottomWidth:1,paddingHorizontal:10,paddingVertical:1},onChangeText:function(n){e.setState({growth_standard_by_student_id:qs(qs({},D),{},A()({},t,qs(qs({},D[t]),{},{height:n})))})},onBlur:function(){return e.handleEndEditing(t)}}),y.a.createElement(b.a,{style:{fontSize:20,marginLeft:15}},"cm"),y.a.createElement(b.a,{style:{fontSize:20,marginLeft:15}},D[t].height_percentile&&"("+D[t].height_percentile+")")),y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:15}},y.a.createElement(b.a,{style:{fontSize:20,paddingRight:15}},"\u982d\u570d:"),y.a.createElement(Hn.a,{value:D[t].hc,keyboardType:"numeric",style:{fontSize:20,borderBottomWidth:1,paddingHorizontal:10,paddingVertical:1},onChangeText:function(n){e.setState({growth_standard_by_student_id:qs(qs({},D),{},A()({},t,qs(qs({},D[t]),{},{hc:n})))})},onBlur:function(){return e.handleEndEditing(t)}}),y.a.createElement(b.a,{style:{fontSize:20,marginLeft:15}},"cm"),y.a.createElement(b.a,{style:{fontSize:20,marginLeft:15}},D[t].hc_percentile&&"("+D[t].hc_percentile+")"))),y.a.createElement(E.a,{style:{padding:10}},y.a.createElement(C.a,{style:{padding:10,backgroundColor:"#b5e9e9"},underlayColor:"#368cbf",onPress:function(){return e.confirmRecord(t)}},y.a.createElement(b.a,{style:{fontSize:20}},"\u78ba\u8a8d\u8f09\u5165")))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingBottom:10}},y.a.createElement(E.a,{style:{width:"29%",backgroundColor:"#fff1b5",borderRadius:10,marginRight:3}},y.a.createElement(b.a,{style:{fontSize:28,alignSelf:"center"}},"\u5bb6\u9577\u6e96\u5099"),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-evenly",flexWrap:"wrap"}},f.map((function(n,a){return y.a.createElement(C.a,{key:a,style:{backgroundColor:d[a]?"#f4d41f":"#fff7d6",borderRadius:3,padding:4,margin:5},onPress:function(){return e.remindItemsToBringToOne(t,a)}},y.a.createElement(b.a,{style:{fontSize:20}},n))})),y.a.createElement(C.a,{style:{backgroundColor:d[4]?"#f4d41f":"#fff7d6",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#f4d41f",onPress:function(){return e.remindItemsToBringToOne(t,4)},onLongPress:function(){return e.setState({editingOtherItemForStudent:t})}},_===t?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(Hn.a,{autoFocus:!0,selectTextOnFocus:!0,value:m,style:{alignSelf:"center",fontSize:20,backgroundColor:d[4]?"#f4d41f":"#fff7d6"},onChangeText:function(n){return e.writeItemToBringToOne(t,n.trim())},onBlur:function(){return e.editItemToBringToOneEditorOnBlur(t,m)}})):y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:20}},m)))),y.a.createElement(E.a,{style:{width:"70%",borderRadius:10,marginLeft:3,backgroundColor:"#b5e9e9"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:2}},y.a.createElement(b.a,{style:{fontSize:28,alignSelf:"flex-end"}},"\u4eca\u65e5\u6d3b\u52d5")),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},l.has(t)?y.a.createElement(b.a,{style:{fontSize:15,alignSelf:"flex-end",paddingRight:10,color:"red"}},"\u672a\u9001\u51fa"):null)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}},h.map((function(n,a){return y.a.createElement(C.a,{key:a,style:{backgroundColor:p[a]?"#368cbf":"#d6f2f2",borderRadius:3,padding:4,margin:5},onPress:function(){return e.recordActivitiesForOne(t,a)}},y.a.createElement(b.a,{style:{fontSize:20}},n))})),y.a.createElement(C.a,{style:{backgroundColor:p[8]?"#368cbf":"#d6f2f2",justifyContent:"center",borderRadius:3,padding:3,margin:5},underlayColor:"#368cbf",onPress:function(){return e.recordActivitiesForOne(t,8)},onLongPress:function(){return e.setState({editingOtherActivityForOne:t})}},S===t?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(Hn.a,{autoFocus:!0,selectTextOnFocus:!0,value:g,style:{alignSelf:"center",fontSize:20,backgroundColor:p[8]?"#368cbf":"#d6f2f2"},onChangeText:function(n){return e.writeActivityForOne(t,n.trim())},onBlur:function(){return e.activityForOneEditorOnBlur(t,g)}})):y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:20}},g))))),void 0!==u[t]&&y.a.createElement(b.a,{style:{fontSize:20,padding:20}},u[t]),""!==o.text&&y.a.createElement(Hn.a,{editable:!1,value:o.text,style:{borderColor:"gray",borderTopWidth:2,borderLeftWidth:2,borderRightWidth:2,borderTopLeftRadius:10,borderTopRightRadius:10,fontSize:25,padding:20,backgroundColor:"#F5F5F5"},multiline:!0}),y.a.createElement(Hn.a,{value:c,style:{borderColor:"gray",borderBottomWidth:2,borderLeftWidth:2,borderRightWidth:2,borderTopWidth:""!==o.text?0:2,borderBottomLeftRadius:10,borderBottomRightRadius:10,borderTopLeftRadius:""!==o.text?0:10,borderTopRightRadius:""!==o.text?0:10,fontSize:25,padding:20},multiline:!0,onChangeText:function(n){return e.writeToOne(n,t)},onEndEditing:function(){return e.writeToOne(c.trim(),t)}}),y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"flex-end"}},w)))))}))))}}]),a}(y.a.Component),Hs=(ue.a.create({cardContainer:{width:119,height:"100%",backgroundColor:"transparent"},thumbnailImage:{height:80,width:80,borderRadius:40}}),Object(k.b)((function(e){return{class:e.classInfo,message:e.message,teachers:e.school.teachers}}),(function(e){return qs({},Object(D.a)({writeToAll:Dt,writeToOne:xt,remindItemsToBringToAll:At,remindItemsToBringToOne:Ot,recordActivitiesForAll:Rt,recordActivitiesForOne:jt,writeItemToBringToAll:Tt,writeItemToBringToOne:Pt,writeActivityForAll:It,writeActivityForOne:zt,fetchClassMessageData:Lt,sendMessageOnSuccess:Wt,getParentMessageSuccess:an},e))}))(Us));function Ws(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Vs(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ks=function(e){u()(a,e);var t=Vs(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,display_list:[],students_or_teachers:"students",selected_class_id:"all",showLoginNumberPad:!1,showModal:!1,modalStudentId:"",teacherClicked:"",teacher_id:"",pageClicked:""},n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.school,t=e.students,n=e.teacherOnDuty,a=e.teachers,r=Object.keys(t);if(this.setState({display_list:r}),this.fetchTeacherAttendance(),this.fetchStudentAttendance(),""!==n){var s=a[n].name;this.props.navigation.setOptions({headerRight:function(){return y.a.createElement(E.a,{style:{paddingRight:20}},y.a.createElement(b.a,{style:{fontSize:30}},"\u503c\u73ed\u8001\u5e2b\uff1a"+s))}})}}},{key:"selectPersonType",value:function(e){var t=this.props.school.classes,n=this.state.selected_class_id;"all"!==n?this.setState({display_list:t[n][e],students_or_teachers:e}):this.setState({display_list:Object.keys(this.props.school[e]),students_or_teachers:e})}},{key:"selectClass",value:function(e){var t=this.props.school.classes,n=this.state.students_or_teachers;this.setState({display_list:t[e][n],selected_class_id:e})}},{key:"selectAttendanceType",value:function(e){var t=this.props.school.classes,n=this.state,a=n.students_or_teachers,r=n.selected_class_id,s=[],i=[];i="all"===r?Object.keys(this.props.school[a]):t[r][a];for(var o=0;o<i.length;o++)(this.props.school["student_"+e].has(i[o])||this.props.school["teacher_"+e].has(i[o]))&&s.push(i[o]);this.setState({display_list:s})}},{key:"fetchTeacherAttendance",value:function(){var e,t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.route.params.school_id,t=fn(new Date),l.next=4,r.a.awrap(_n("/staff-attendance?school_id="+e+"&date="+t));case 4:if(n=l.sent,a=n.success,n.statusCode,s=n.message,i=n.data,a){l.next=9;break}return alert("Sorry \u53d6\u5f97\u6559\u5e2b\u51fa\u5e2d\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),l.abrupt("return");case 9:o=i.attendance,c=i.teachers,this.props.fetchTeacherAttendanceSuccess(o,c);case 11:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"fetchStudentAttendance",value:function(){var e,t,n,a,s,i,o,c,l,u;return r.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return e=this.props.route.params.school_id,t=fn(new Date),d.next=4,r.a.awrap(_n("/attendance?school_id="+e+"&date="+t));case 4:if(n=d.sent,a=n.success,n.statusCode,s=n.message,i=n.data,a){d.next=9;break}return alert("Sorry \u53d6\u5f97\u5b78\u751f\u51fa\u5e2d\u8cc7\u6599\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s),d.abrupt("return");case 9:o=i.attendance,c=i.students,l=i.present,u=i.absent,this.props.fetchStudentAttendanceSuccess(o,c,l,u);case 11:case"end":return d.stop()}}),null,this,null,Promise)}},{key:"handleOnClick",value:function(e){var t=this.props.teacherOnDuty;if("students"===this.state.students_or_teachers){if(""===t)return void this.setState({showLoginNumberPad:!0,pageClicked:"student_modal",modalStudentId:e});this.showModal(e)}else this.setState({showLoginNumberPad:!0,teacherClicked:e})}},{key:"showModal",value:function(e){this.setState({modalStudentId:e,showModal:!0})}},{key:"handleEnterPasscode",value:function(e){var t=this.props.school.passcodeTeacherId,n=this.props,a=n.passcodeAdminId,r=(n.teachers,this.state),s=r.pageClicked,i=r.teacherClicked,o=t[e],c=a[e];void 0!==c?this.setState({teacher_id:c,pageClicked:"",showModal:!0,showLoginNumberPad:!1}):"student_modal"===s&&void 0!==o?this.setState({teacher_id:o,pageClicked:"",showModal:!0,showLoginNumberPad:!1}):void 0===o||o!==i?le.Toast.show({text:"Wrong password!",buttonText:"Okay",position:"top",type:"warning",duration:3e3}):this.setState({showModal:!0,showLoginNumberPad:!1})}},{key:"hideLoginPad",value:function(){this.setState({showLoginNumberPad:!1,modalStudentId:""})}},{key:"hideModal",value:function(){this.setState({showModal:!1,modalStudentId:"",teacher_id:""})}},{key:"render",value:function(){var e=this,t=this.props.route.params.school_id,a=this.props,r=a.school,s=a.teacherOnDuty,i=r.student_present,o=r.student_unmarked,c=(r.student_absent,r.teacher_present),l=r.teacher_unmarked,u=(r.teacher_absent,this.state),d=u.display_list,f=u.students_or_teachers,p=u.selected_class_id,h=u.modalStudentId,m=u.teacherClicked,g=u.teacher_id,_=u.showLoginNumberPad;return y.a.createElement(E.a,{style:{flex:1}},_?y.a.createElement(cn,{handleEnterPasscode:function(t){return e.handleEnterPasscode(t)},hideLoginPad:function(){return e.hideLoginPad()}}):null,y.a.createElement(da,{show:this.state.showModal,student_id:h,teacher_id:m,teacherOnDuty:s||g,class_id:p,school_id:t,navigation:this.props.navigation,fetchStudentAttendance:function(){return e.fetchStudentAttendance()},fetchTeacherAttendance:function(){return e.fetchTeacherAttendance()},hideModal:function(){return e.hideModal()}}),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"}},y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"students"===f?"lightgrey":"white",justifyContent:"center"},onPress:function(){return e.selectPersonType("students")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u5b78\u751f"))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"teachers"===f?"lightgrey":"white",justifyContent:"center"},onPress:function(){return e.selectPersonType("teachers")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u6559\u5e2b")))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"}},Object.keys(r.classes).map((function(t){return"all"===t?null:y.a.createElement(E.a,{key:t,style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:p===t?"lightgrey":"white",justifyContent:"center"},onPress:function(){return e.selectClass(t)}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},r.classes[t].name)))}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",backgroundColor:"white"}},y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"#ffe1d0",justifyContent:"center"},onPress:function(){return e.selectAttendanceType("absent")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u7f3a\u5e2d"))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"#fff1b5",justifyContent:"center"},onPress:function(){return e.selectAttendanceType("unmarked")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u672a\u77e5"))),y.a.createElement(E.a,{style:{flex:1,padding:10}},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"#dcf3d0",justifyContent:"center"},onPress:function(){return e.selectAttendanceType("present")}},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center"}},"\u51fa\u5e2d")))),y.a.createElement(E.a,{style:{flex:9,backgroundColor:"lightgrey"}},y.a.createElement(Rn.a,{contentContainerStyle:{flexDirection:"row",flexWrap:"wrap",backgroundColor:"transparent"}},d.map((function(t){var a=r[f][t];return y.a.createElement(C.a,{key:t,style:{height:300,width:"33.3%",padding:5},onPress:function(){return e.handleOnClick(t)}},y.a.createElement(le.Card,{style:{flex:1,padding:10,backgroundColor:"white"}},y.a.createElement(le.CardItem,{style:{justifyContent:"center"}},y.a.createElement(pe.a,{source:""===a.profile_picture&&"students"===f?n(62):""===a.profile_picture&&"teachers"===f?n(301):{uri:a.profile_picture},style:{height:200,width:200,borderRadius:100,borderWidth:10,borderColor:i.has(t)||c.has(t)?"#dcf3d0":o.has(t)||l.has(t)?"#fff1b5":"#ffe1d0"}})),y.a.createElement(le.CardItem,{footer:!0,style:{justifyContent:"center",marginTop:-5}},y.a.createElement(b.a,{style:{marginTop:-10}},a.name))))})))))}}]),a}(y.a.Component),Gs=Object(k.b)((function(e){return{school:e.school,teacherOnDuty:e.school.teacherOnDuty,teachers:e.school.teachers,passcodeAdminId:e.school.passcodeAdminId,attendance:e.attendance}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ws(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ws(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({fetchTeacherAttendanceSuccess:Gt,fetchStudentAttendanceSuccess:Qt},e))}))(Ks);function Qs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Js(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ys=function(e){u()(a,e);var t=Js(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={date:new Date,isLoading:!0,refreshing:!1,selected_request_id:"",showLoginNumberPad:!1,messages:[],messages_read:new Set,showDateModal:!1},n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.messages,n=e.date;this.setState({date:n,messages:this.sortMessages(t)})}},{key:"markRead",value:function(e,t,n,a){var s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,r.a.awrap(bn("/message/read",{message_id:e,morning_reminder_id:t,student_id:n}));case 2:if(s=l.sent,i=s.success,s.statusCode,o=s.message,s.data,i){l.next=7;break}return fe.a.alert("Sorry \u6a19\u8a18\u5df2\u8b80\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o,[{text:"Ok"}]),l.abrupt("return");case 7:this.bubbleDown(a),c=new Set(P()(this.state.messages_read)),null!==e&&c.add(e),null!==t&&c.add(t),this.setState({messages_read:c});case 12:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"bubbleDown",value:function(e){for(var t=this.state,n=t.messages,a=t.messages_read,r=n.length;e<r-1;){var s=n[e+1].message_id;if(!a.has(s)){var i=n[e];n[e]=n[e+1],n[e+1]=i}e+=1}this.setState({messages:n})}},{key:"sortMessages",value:function(e){for(var t=e,n=0,a=new Set,r=0;r<t.length;r++){var s=t[r],i=s.message_id,o=s.morning_reminder_id,c=s.message_read,l=s.morning_reminder_read;if(null!==c&&!c||null!==l&&!l){var u=t[n];t[n]=t[r],t[r]=u,n+=1}else null!==i&&a.add(i),null!==o&&a.add(o)}return this.setState({messages_read:a}),t}},{key:"refresh",value:function(e){var t,n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=this.props.route.params.class_id,o.next=3,r.a.awrap(_n("/message/class/"+t+"/unread?date="+fn(e)));case 3:if(n=o.sent,a=n.success,n.statusCode,s=n.message,i=n.data,a){o.next=8;break}return fe.a.alert("Sorry \u53d6\u5f97\u5bb6\u9577\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01","\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+s,[{text:"Ok"}]),o.abrupt("return");case 8:this.setState({messages:this.sortMessages(i)});case 9:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"selectDatetimeConfirm",value:function(e){this.setState({date:e,showDateModal:!1}),this.refresh(e)}},{key:"goBackADay",value:function(){var e=new Date(this.state.date.getTime());1===e.getDay()?e.setDate(e.getDate()-3):e.setDate(e.getDate()-1),this.selectDatetimeConfirm(e)}},{key:"goForwardADay",value:function(){var e=new Date(this.state.date.getTime());5===e.getDay()?e.setDate(e.getDate()+3):e.setDate(e.getDate()+1),this.selectDatetimeConfirm(e)}},{key:"componentWillUnmount",value:function(){var e=this.props.route.params;(0,e.onGoBack)(e.date)}},{key:"render",value:function(){var e=this,t=this.props.route.params.students,a=this.state,r=a.messages,s=a.messages_read,i=a.date,o=a.showDateModal;return y.a.createElement(E.a,{style:{flex:1,paddingBottom:40}},o&&y.a.createElement(Da,{start_date:i,datetime_type:"date",hideModal:function(){return e.setState({showDateModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:new Date}),y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between"}},y.a.createElement(E.a,{style:{width:"15%"}},y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return e.goBackADay()}},y.a.createElement(pe.a,{source:n(303),style:{width:40,height:40}}))),y.a.createElement(C.a,{style:{alignSelf:"center",padding:10},onPress:function(){return e.setState({showDateModal:!0})}},y.a.createElement(b.a,{style:{fontSize:50}},pn(i))),y.a.createElement(E.a,{style:{width:"15%"}},i.toDateString()!==(new Date).toDateString()&&y.a.createElement(C.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onPress:function(){return e.goForwardADay()}},y.a.createElement(pe.a,{source:n(304),style:{width:40,height:40}})))),y.a.createElement(Rn.a,null,r.map((function(a,r){var i=a.message_id,o=a.morning_reminder_id,c=(a.activities,a.items_to_bring,a.message_for_teacher),l=a.morning_reminder,u=(a.other_activity,a.other_item,a.student_id),d=(a.teacher_id,a.text),f=(a.message_read,a.morning_reminder_read,s.has(i)||s.has(o));return y.a.createElement(E.a,{key:r,style:{flexDirection:"row",backgroundColor:"white",borderWidth:1,borderColor:"lightgrey",marginBottom:20,padding:20}},y.a.createElement(E.a,null,y.a.createElement(pe.a,{source:""===t[u].profile_picture?n(62):{uri:t[u].profile_picture},style:Xs.thumbnailImage}),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",paddingTop:20}},y.a.createElement(b.a,{style:{fontSize:25}},t[u].name)),y.a.createElement(C.a,{disabled:f,style:{justifyContent:"center",alignItems:"center",marginTop:20,padding:15,backgroundColor:f?"#dcf3d0":"#ffe1d0"},onPress:function(){return e.markRead(i,o,u,r)}},y.a.createElement(b.a,{style:{fontSize:25}},f?"\u5df2\u8b80":"\u672a\u8b80"))),y.a.createElement(E.a,{style:{flex:1,marginLeft:20}},y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:25,fontWeight:"bold"}},"\u8001\u5e2b\u7684\u8a71:"),y.a.createElement(b.a,{style:{fontSize:20}},d&&d+"\n")),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:25,fontWeight:"bold"}},"\u5bb6\u9577\u56de\u61c9:"),y.a.createElement(b.a,{style:{fontSize:20}},c&&c+"\n")),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:25,fontWeight:"bold"}},"\u65e9\u6668\u53ee\u5680:"),y.a.createElement(b.a,{style:{fontSize:20}},l&&l+"\n"))))}))))}}]),a}(y.a.Component),Xs=ue.a.create({cardContainer:{width:170,paddingRight:5},thumbnailImage:{height:160,width:160,borderRadius:80}}),Zs=Object(k.b)((function(e){return{class:e.classInfo,requests:e.medicationrequests}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qs(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({},e))}))(Ys);function $s(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ei=function(e){u()(n,e);var t=$s(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={showModal:!1,modal_type:""},a}return c()(n,[{key:"componentDidMount",value:function(){}},{key:"handleNavigate",value:function(e){var t=this.props.route.params,n=t.school_name,a=t.school_id;this.props.navigation.navigate(e,{school_name:n,school_id:a})}},{key:"render",value:function(){var e=this;return y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center",justifyContent:"space-around"}},y.a.createElement(C.a,{style:{width:"80%",padding:50,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",marginVertical:20},onPress:function(){return e.handleNavigate("DownloadTeacherAttendance")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u5b78\u751f\u51fa\u52e4\u8868")),y.a.createElement(C.a,{style:{width:"80%",padding:50,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",marginVertical:20},onPress:function(){return e.handleNavigate("DownloadTeacherAttendance")},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:70}},"\u6559\u5e2b\u51fa\u52e4\u8868")))}}]),n}(y.a.Component);function ti(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ni=function(e){u()(n,e);var t=ti(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={showModal:!1,modal_type:""},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.school_name,n=e.school_id;console.log("school_name, school_id: ",t,n)}},{key:"render",value:function(){return y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center"}})}}]),n}(y.a.Component);function ai(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ri=function(e){u()(n,e);var t=ai(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={date:new Date,selected_all_classes:!0,selected_classes:new Set,class_id_list:[],text:"",announcements:[],page_number:0,is_loading:!0},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:this.unsubscribe=this.props.navigation.addListener("focus",(function(){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(e.fetchAnnouncements());case 2:case"end":return t.stop()}}),null,null,null,Promise)}));case 1:case"end":return t.stop()}}),null,this,null,Promise)}},{key:"fetchAnnouncements",value:function(){var e,t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.props.route.params.school_id,t=this.state.page_number,i.next=4,r.a.awrap(_n("/announcement?school_id="+e+"&page="+t));case 4:n=i.sent,a=n.success,n.statusCode,n.message,s=n.data,a&&this.setState({announcements:s});case 7:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"componentWillUnmount",value:function(){this.unsubscribe()}},{key:"render",value:function(){var e=this,t=this.props.route.params,n=t.school_id,a=t.school_name,r=this.props,s=(r.classes,r.students,this.state.announcements);return y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"flex-end",paddingVertical:7}},y.a.createElement(C.a,{style:{padding:10,backgroundColor:"lightblue",marginRight:10},onPress:function(){return e.props.navigation.push("AddAnnouncementPage",{school_id:n,school_name:a})}},y.a.createElement(b.a,{style:{fontSize:20}},"\u65b0\u589e"))),y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center"}},s.map((function(t,r){var s=pn(new Date(t.timestamp));return y.a.createElement(C.a,{key:t.id,style:{},onPress:function(){return e.props.navigation.push("Announcement",{school_id:n,announcement:t,school_name:a})}},y.a.createElement(le.Card,{style:{padding:20,width:"95%",height:200,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:"100%",overflow:"hidden"}},y.a.createElement(E.a,{style:{paddingBottom:20}},y.a.createElement(b.a,{style:{fontSize:25}},t.title),y.a.createElement(b.a,{style:{fontSize:15}},s)),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:18}},t.text)))))}))))}}]),n}(y.a.Component),si=Object(k.b)((function(e){return{classes:e.school.classes,students:e.school.students}}))(ri);function ii(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var oi=function(e){u()(n,e);var t=ii(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).getPermissionAsync=function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Wn.a.OS){t.next=6;break}return t.next=3,r.a.awrap(as.c(as.b));case 3:e=t.sent,"granted"!==e.status&&alert("Sorry, we need camera roll permissions to make this work!");case 6:case"end":return t.stop()}}),null,null,null,Promise)},a._pickImage=function(){var e,t;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,r.a.awrap(ts.a({mediaTypes:ns.a.All,allowsEditing:!1,quality:.4,base64:!0}));case 3:(e=n.sent).cancelled||(t=e.base64,a.setState({images:[].concat(P()(a.state.images),[t])})),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.log(n.t0);case 10:case"end":return n.stop()}}),null,null,[[0,7]],Promise)},a.state={date:new Date,selected_all_classes:!0,selected_classes:new Set,class_id_list:[],text:"",title:"",images:[],sendLoading:!1,links:[]},a}return c()(n,[{key:"componentDidMount",value:function(){this.getPermissionAsync();var e=this.props.classes,t=[];Object.keys(e).forEach((function(e){t.push(e)})),this.setState({class_id_list:t,selected_classes:new Set(t)})}},{key:"selectClass",value:function(e){var t=this.state,n=t.selected_classes,a=t.class_id_list,r=new Set(P()(n));r.has(e)?r.delete(e):r.add(e),this.setState({selected_classes:r,selected_all_classes:r.size===a.length})}},{key:"selectAllClasses",value:function(){var e=this.state.selected_all_classes;this.setState({selected_all_classes:!e,selected_classes:e?new Set:new Set(this.state.class_id_list)})}},{key:"postAnnouncement",value:function(){var e,t,n,a,s,i,o,c,l,u,d,f;return r.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(e=this.props.route.params,t=e.school_id,n=e.school_name,a=this.state,s=a.text,i=a.date,o=a.selected_classes,c=a.title,l=a.images,u=a.links,0!==o.size){p.next=5;break}return alert("\u8acb\u9078\u64c7\u73ed\u7d1a"),p.abrupt("return");case 5:if(""!==c){p.next=8;break}return alert("Title \u672a\u586b"),p.abrupt("return");case 8:return this.setState({sendLoading:!0}),p.next=11,r.a.awrap(En("/announcement",{school_id:t,title:c,text:s,timestamp:fn(i)+" "+mn(i),class_id_list:P()(o),images:l,school_name:n,links:u}));case 11:if(d=p.sent,f=d.success,d.statusCode,d.message,d.data,!f){p.next=17;break}this.props.navigation.navigate("AnnouncementHome",{school_id:t,school_name:n,update_page:!0}),p.next=19;break;case 17:return alert("\u9001\u51fa\u8a0a\u606f\u6642\u51fa\u72c0\u6cc1"),p.abrupt("return");case 19:case"end":return p.stop()}}),null,this,null,Promise)}},{key:"removeImage",value:function(e){var t=this.state.images;t.splice(e,1),this.setState({images:t})}},{key:"handleAddLink",value:function(){var e=this.state.links;e.push({text:"",url:""}),this.setState({links:e})}},{key:"handleChangeLinkText",value:function(e,t){var n=this.state.links;n[t].text=e,this.setState({links:n})}},{key:"handleChangeUrl",value:function(e,t){var n=this.state.links;n[t].url=e,this.setState({links:n})}},{key:"handleDeleteUrl",value:function(e){var t=this.state.links;t.splice(e,1),this.setState({links:t})}},{key:"render",value:function(){var e=this,t=this.props.classes,n=this.state,a=n.selected_all_classes,r=n.class_id_list,s=n.selected_classes,i=n.text,o=n.title,c=n.images,l=n.sendLoading,u=n.links;return y.a.createElement(Un.a,{style:{flex:1},behavior:"height",keyboardVerticalOffset:80,enabled:!0},y.a.createElement(Rn.a,{contentContainerStyle:{},keyboardShouldPersistTaps:"never"},y.a.createElement(E.a,{style:{padding:15,flexDirection:"row",alignItems:"center",flexWrap:"wrap"}},y.a.createElement(b.a,{style:{fontSize:25}},"\u73ed\u7d1a:"),r.map((function(n){return y.a.createElement(C.a,{key:n,style:{backgroundColor:s.has(n)?"#368cbf":"rgba(0, 0, 0, 0.1)",marginLeft:15},underlayColor:"#368cbf",onPress:function(){return e.selectClass(n)}},y.a.createElement(b.a,{style:{padding:10,fontSize:25,color:s.has(n)?"rgba(255,255,255,0.6)":"rgba(0, 0, 0, 0.5)"}},t[n].name))})),y.a.createElement(C.a,{style:{backgroundColor:a?"#368cbf":"rgba(0, 0, 0, 0.1)",marginLeft:15},underlayColor:"#368cbf",onPress:function(){return e.selectAllClasses()}},y.a.createElement(b.a,{style:{padding:10,fontSize:25,color:a?"rgba(255,255,255,0.6)":"rgba(0, 0, 0, 0.5)"}},"\u6240\u6709"))),y.a.createElement(E.a,{style:{padding:15,backgroundColor:"lightgrey"}},y.a.createElement(E.a,{style:{flexDirection:"row",width:"100%"}},y.a.createElement(b.a,{style:{fontSize:25}},"\u6a19\u984c: "),y.a.createElement(Hn.a,{value:o,placeholder:"\u5fc5\u586b",style:{flex:1,fontSize:25,borderBottomWidth:1,borderBottomColor:"gray"},onChangeText:function(t){return e.setState({title:t})}})),y.a.createElement(Hn.a,{value:i,style:{backgroundColor:"white",alignSelf:"center",width:"100%",borderColor:"gray",borderWidth:2,borderRadius:10,fontSize:25,padding:20,paddingTop:20,marginVertical:15},multiline:!0,onChangeText:function(t){return e.setState({text:t})}}),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:20,marginRight:20}},"\u9023\u7d50"),u.map((function(t,n){return y.a.createElement(E.a,{key:n,style:{flex:1,flexDirection:"row",marginTop:15}},y.a.createElement(E.a,{style:{flex:7,backgroundColor:"rgba(255,255,255,0.7)",padding:8,borderRadius:7}},y.a.createElement(b.a,{style:{}},"\u986f\u793a\u6587\u5b57"),y.a.createElement(Hn.a,{value:t.text,style:{padding:5,borderBottomWidth:1},onChangeText:function(t){return e.handleChangeLinkText(t,n)}}),y.a.createElement(b.a,{style:{marginTop:10}},"\u9023\u7d50"),y.a.createElement(Hn.a,{value:t.url,style:{padding:5,borderBottomWidth:1},onChangeText:function(t){return e.handleChangeUrl(t,n)}})),y.a.createElement(E.a,{style:{flex:1,backgroundColor:"grey"}},y.a.createElement(C.a,{style:{flex:1,padding:10,backgroundColor:"#ffe1d0",alignItems:"center",justifyContent:"center"},onPress:function(){return e.handleDeleteUrl(n)}},y.a.createElement(b.a,null,"\u522a\u9664"))))})),y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center",marginVertical:15}},y.a.createElement(C.a,{style:{backgroundColor:"rgba(255,255,255,0.7)",paddingVertical:10,paddingHorizontal:20,borderWidth:2,borderRadius:10,borderStyle:"dashed"},onPress:function(){return e.handleAddLink()}},y.a.createElement(b.a,null,"\u65b0\u589e")))),y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20}},"\u76f8\u7247"),y.a.createElement(E.a,{style:{flexDirection:"row",marginTop:20}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},c.map((function(t,n){return y.a.createElement(C.a,{key:n,onPress:function(){return e.removeImage(n)}},y.a.createElement(pe.a,{style:{width:100,height:100,marginRight:10,borderRadius:10},source:{uri:"data:image/png;base64,"+t}}))})),y.a.createElement(C.a,{style:{backgroundColor:"rgba(255,255,255,0.7)",width:100,height:100,justifyContent:"center",alignItems:"center",borderWidth:2,borderRadius:10,borderStyle:"dashed"},onPress:function(){return e._pickImage()}},y.a.createElement(b.a,null,"\u65b0\u589e"))),y.a.createElement(C.a,{disabled:l,style:{backgroundColor:"lightblue",padding:10,alignSelf:"flex-end"},onPress:function(){return e.postAnnouncement()}},l?y.a.createElement(Mn,null):y.a.createElement(b.a,{style:{fontSize:25}},"\u9001\u51fa")))))))}}]),n}(y.a.Component),ci=Object(k.b)((function(e){return{classes:e.school.classes}}))(oi);function li(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ui=Object(D.c)(ce),di=Object(Pa.a)(),fi=function(e){u()(n,e);var t=li(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e=this;return y.a.createElement(k.a,{store:ui},y.a.createElement(Ta.a,null,y.a.createElement(di.Navigator,{initialRouteName:"SchoolHome",screenOptions:{gestureEnabled:!1,headerTitleStyle:{fontWeight:"bold",fontSize:30,alignSelf:"center"}}},y.a.createElement(di.Screen,{name:"SchoolHome",component:Ma,initialParams:{school_id:this.props.school_id,school_name:this.props.school_name,loadAuth:this.props.loadAuth},options:{title:"",headerRight:function(){return y.a.createElement(C.a,{style:{padding:10,marginRight:20},onPress:function(){return e.props.handleSignOut()}},y.a.createElement(b.a,{style:{fontSize:30}},"\u767b\u51fa"))}}}),y.a.createElement(di.Screen,{name:"AdminHome",component:Mr,options:{gestureEnabled:!0,title:""}}),y.a.createElement(di.Screen,{name:"Announcement",component:Wr,options:{gestureEnabled:!0,title:"\u516c\u544a"}}),y.a.createElement(di.Screen,{name:"AnnouncementHome",component:si,options:{gestureEnabled:!0,title:"\u516c\u544a\u9996\u9801"}}),y.a.createElement(di.Screen,{name:"AddAnnouncementPage",component:ci,options:{gestureEnabled:!0,title:"\u65b0\u589e\u516c\u544a"}}),y.a.createElement(di.Screen,{name:"Registration",component:es,options:{headerLeft:null,title:""}}),y.a.createElement(di.Screen,{name:"Students",component:As,options:{gestureEnabled:!0,title:""}}),y.a.createElement(di.Screen,{name:"Teachers",component:Ls,options:{gestureEnabled:!0,title:""}}),y.a.createElement(di.Screen,{name:"DownloadPage",component:ei,options:{gestureEnabled:!0,title:"\u4e0b\u8f09"}}),y.a.createElement(di.Screen,{name:"DownloadTeacherAttendance",component:ni,options:{gestureEnabled:!0,title:"\u5b78\u751f\u51fa\u52e4\u4e0b\u8f09"}}),y.a.createElement(di.Screen,{name:"AttendancePage",component:Gs,options:{title:"\u51fa\u5e2d/\u6253\u5361",headerRight:function(){return y.a.createElement(E.a,{style:{paddingRight:20}},y.a.createElement(b.a,{style:{fontSize:30}},"\u503c\u73ed\u8001\u5e2b\uff1a\u672a\u767b\u5165"))}}}),y.a.createElement(di.Screen,{name:"TeacherHome",component:ja,options:{headerLeft:null,title:""}}),y.a.createElement(di.Screen,{name:"Inbox",component:Zs,options:{gestureEnabled:!0,title:""}}),y.a.createElement(di.Screen,{name:"PickupAlert",component:Nn}),y.a.createElement(di.Screen,{name:"TeacherClockInOut",component:Ua,options:{gestureEnabled:!0,title:"\u6253\u5361"}}),y.a.createElement(di.Screen,{name:"TeacherMedicineLog",component:Xa,options:{gestureEnabled:!0,title:"\u6258\u85e5\u55ae"}}),y.a.createElement(di.Screen,{name:"WellnessLog",component:nr,options:{gestureEnabled:!0,title:"\u5065\u5eb7"}}),y.a.createElement(di.Screen,{name:"MessageForParents",component:Hs,options:{gestureEnabled:!0,title:"\u8001\u5e2b\uf9cd\u2f94"}}),y.a.createElement(di.Screen,{name:"TeacherAppetiteLog",component:ur,options:{gestureEnabled:!0,title:"\u98f2\u98df"}}),y.a.createElement(di.Screen,{name:"TeacherSleepLog",component:yr,options:{gestureEnabled:!0,title:"\u7761\u7720"}}),y.a.createElement(di.Screen,{name:"TeacherMilkLog",component:Sr,options:{gestureEnabled:!0,title:"\u9935\u5976"}}),y.a.createElement(di.Screen,{name:"DiaperLog",component:Ir,options:{gestureEnabled:!0,title:"\u5982\u5ec1"}}))))}}]),n}(y.a.Component);function pi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var hi=function(e){u()(a,e);var t=pi(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={username:"",password:"",errMessage:"",user_type:"",isLoading:!1},n}return c()(a,[{key:"componentDidMount",value:function(){}},{key:"handleSignIn",value:function(){var e=this;this.setState({isLoading:!0});var t=this.state,n=t.username,a=t.password;w.a.signIn(n,a).then((function(t){"NEW_PASSWORD_REQUIRED"!==t.challengeName?(e.setState({isLoading:!1}),e.props.loadAuth()):e.completeNewPassword(t)})).catch((function(t){"UserNotConfirmedException"===t.code?e.props.changeAuthState("ConfirmSignUpPage",n):(e.props.changeAuthState("signedout",n),e.setState({errMessage:t.message,isLoading:!1}))}))}},{key:"completeNewPassword",value:function(e){var t=this;w.a.completeNewPassword(e,"barRoco",{name:"barroco"}).then((function(e){t.setState({isLoading:!1}),t.props.loadAuth()})).catch((function(e){t.setState({errMessage:e.message,isLoading:!1})}))}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return y.a.createElement(Mn,null);var t="ios"===Wn.a.OS?60:0,a=this.state.errMessage?y.a.createElement(le.Text,{style:{color:"red"}},this.state.errMessage):null;return y.a.createElement(Un.a,{style:mi.container,behavior:"padding",keyboardVerticalOffset:t,enabled:!0},y.a.createElement(pe.a,{source:n(460),style:{width:200,height:200}}),y.a.createElement(le.Text,{style:{fontSize:40}},"\u8acb\u767b\u5165"),a,y.a.createElement(Hn.a,{placeholder:"Email / \u5e33\u865f",keyboardType:"email-address",autoCapitalize:"none",style:mi.textInput,onChangeText:function(t){return e.setState({username:t})},value:this.state.username}),y.a.createElement(Hn.a,{secureTextEntry:!0,placeholder:"\u5bc6\u78bc",style:mi.textInput,onChangeText:function(t){return e.setState({password:t})},value:this.state.password}),y.a.createElement(le.View,{style:{marginTop:20}},y.a.createElement(C.a,{style:{backgroundColor:"grey",padding:20},onPress:function(){return e.handleSignIn()}},y.a.createElement(le.Text,{style:{fontSize:30}},"\u767b\u5165"))))}}]),a}(y.a.Component),mi=ue.a.create({container:{flex:1,justifyContent:"center",alignItems:"center"},textInput:{height:80,width:"90%",borderColor:"gray",borderWidth:1,marginTop:20,fontSize:30,padding:10}}),yi=hi,gi=n(260);function _i(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}!function(e){u()(n,e);var t=_i(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={username:"",name:"",user_type:"",email:"",password:"",errMessage:""},a}c()(n,[{key:"handleSignup",value:function(){var e=this,t=this.state,n=t.username,a=t.password,r=t.name,s=t.email,i=t.user_type;this.state.user_type?w.a.signUp({username:n,password:a,attributes:{name:r,email:s}}).then((function(t){console.log(e.state.user_type),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/user/"+n,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:r,email:s,role:i})}).then((function(e){return e.json()})).then((function(t){console.log(t),e.props.changeAuthState("ConfirmSignUpPage")})).catch((function(e){console.error(e)}))})).catch((function(t){e.setState({errMessage:t.message})})):this.setState({errMessage:"Please select user role"})}},{key:"setUserRole",value:function(e){this.setState({user_type:e})}},{key:"render",value:function(){var e=this;return y.a.createElement(Un.a,{style:Ei.container,behavior:"padding",enabled:!0},y.a.createElement(E.a,{style:{width:"45%",marginBottom:20,flexDirection:"row",justifyContent:"space-around"}},y.a.createElement(C.a,{style:{width:80,height:85},onPress:function(){e.setUserRole("teacher")}},y.a.createElement(gi.default,{name:"food-apple",size:80,color:"#C93D1B"})),y.a.createElement(C.a,{style:{width:80,height:85},onPress:function(){e.setUserRole("parent")}},y.a.createElement(gi.default,{name:"baby-buggy",size:80,color:"#f8c43a"}))),y.a.createElement(b.a,null,this.state.user_type," Sign Up"),""===this.state.errMessage?null:y.a.createElement(b.a,{style:{color:"red"}},this.state.errMessage),y.a.createElement(Hn.a,{placeholder:"username",style:Ei.textInput,onChangeText:function(t){return e.setState({username:t})},value:this.state.username}),y.a.createElement(Hn.a,{secureTextEntry:!0,placeholder:"password",style:Ei.textInput,onChangeText:function(t){return e.setState({password:t})},value:this.state.password}),y.a.createElement(Hn.a,{placeholder:"Name",style:Ei.textInput,onChangeText:function(t){return e.setState({name:t})},value:this.state.name}),y.a.createElement(Hn.a,{placeholder:"Email",style:Ei.textInput,onChangeText:function(t){return e.setState({email:t})},value:this.state.email}),y.a.createElement(E.a,{style:{width:"90%",margin:10,flexDirection:"row",justifyContent:"space-around"}},y.a.createElement(C.a,{style:{backgroundColor:"#35D0BA"},onPress:this.handleSignup.bind(this)},y.a.createElement(b.a,null,"Sign up")),y.a.createElement(C.a,{style:{backgroundColor:"#35D0BA"},onPress:function(){return e.props.changeAuthState("signedout")}},y.a.createElement(b.a,null," Already have an account? Sign in here"))))}}])}(y.a.Component);var Ei=ue.a.create({container:{flex:1,justifyContent:"center",alignItems:"center"},textInput:{height:40,width:"90%",borderColor:"gray",borderWidth:1,marginTop:8}});function bi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function vi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bi(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Si(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function wi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Si(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Si(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ci(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ki(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ci(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ci(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Di=Object(D.b)({parent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isConnected:!0,child_of_id:{},med_requests:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CONNECT_STATE":var n=t.isConnected;return vi(vi({},e),{},{isConnected:n});case"INITIALIZE_CHILDREN":var a=t.data;return a.forEach((function(t){var n=t.id,a=t.name,r=t.class_id,s=t.profile_picture,i=t.school_id,o=t.school_name;e.child_of_id[n]={name:a,class_id:r,profile_picture:s,school_id:i,school_name:o}})),vi({},e);case"MARK_PRESENT":var r=t.student_id;return e.child_of_id[r].present=!0,vi({},e);case"GET_MED_REQUEST_SUCCESS":var s=t.med_requests;return vi(vi({},e),{},{med_requests:s});case"EDIT_PROFILE_PICTURE":var i=t.student_id,o=t.image_url;return vi(vi({},e),{},{child_of_id:vi(vi({},e.child_of_id),{},A()({},i,vi(vi({},e.child_of_id[i]),{},{profile_picture:o})))});case"CLEAR_STATE":return{isConnected:!0,child_of_id:{},med_requests:[]};default:return e}},attendance:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{days:{1:[],2:[],3:[],4:[],5:[]},attendance:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITIALIZE_ATTENDANCE":return wi(wi({},e),{},{days:wi(wi({},e.days),{},A()({},t.day,[].concat(P()(e.days[t.day]),[t.attendance_id]))),attendance:wi(wi({},e.attendance),{},A()({},t.attendance_id,t.attendance_obj))});default:return e}},inbox:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{current_conversation_id:"",conversations_by_id:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MESSAGE_DATA":var n=ki({},e),a=t.messages,r=t.most_recently_read_message_id,s=t.conversation_id;return n.conversations_by_id[s]={messages:a,most_recently_read_message_id:r},n.current_conversation_id=s,n;case"SET_CURRENT_CONVERSATION_ID":return ki(ki({},e),{},{current_conversation_id:t.conversation_id});case"CLEAR_CURRENT_CONVERSATION_ID":return ki(ki({},e),{},{current_conversation_id:""});default:return e}}}),xi=function(e){return{type:"INITIALIZE_CHILDREN",data:e}},Ai=function(){return{type:"CLEAR_STATE"}},Oi=function(e){return{type:"GET_MED_REQUEST_SUCCESS",med_requests:e}},Ri=function(e){return{type:"MARK_PRESENT",student_id:e}},ji=function(e){return{type:"SET_CONNECT_STATE",isConnected:e}},Ti=function(e,t){return{type:"EDIT_PROFILE_PICTURE",student_id:e,image_url:t}};function Pi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ii=function(e){u()(a,e);var t=Pi(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={child_id:n.props.child_id,isLoading:!0},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.state.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date))}},{key:"fetchData",value:function(e,t){var n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=5,r.a.awrap(Sn("wellness",e,n,a));case 5:s=i.sent,this.setState({wellnessData:s,isLoading:!1}),s&&s[n]?this.props.updateTitleTemp(s[n][0][1]):this.props.updateTitleTemp("");case 8:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.wellnessData,a=e.isLoading,r=fn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:n(931),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u5065\u5eb7")),a?y.a.createElement(Mn,null):t&&t[r]?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",paddingBottom:5}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u6642\u9593")),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u9ad4\u6eab")),y.a.createElement(E.a,{style:{flex:2,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u4eca\u65e5\u72c0\u6cc1"))),t[r].map((function(e,t){return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},e[0])),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},e[1],"\xb0")),y.a.createElement(E.a,{style:{flex:2,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},e[2])))}))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),a}(y.a.Component);function zi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Li=function(e){u()(a,e);var t=zi(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={child_id:n.props.child_id,fruit_name:null,isLoading:!0,breakfast:null,fruit:null,lunch:null,snack:null},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.state.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1}),i.abrupt("return");case 3:return n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=8,r.a.awrap(Sn("appetite",e,n,a));case 8:s=i.sent,this.denormalizeAppetiteData(s.data,t);case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"denormalizeAppetiteData",value:function(e){var t=this.props.date,n=fn(t);if(e&&e[n]){var a=e[n],r=a.fruit_name,s=a.breakfast_rating,i=a.fruit_rating,o=a.lunch_rating,c=a.snack_rating,l=this.parseData(s),u=this.parseData(i),d=this.parseData(o),f=this.parseData(c);this.setState({fruit_name:r,breakfast:l,fruit:u,lunch:d,snack:f,appetiteData:e,isLoading:!1})}else this.setState({appetiteData:e,isLoading:!1})}},{key:"parseData",value:function(e){return{rating:e.slice(0,-1),water_drunk:parseInt(e.slice(-1))}}},{key:"getEmoji",value:function(){}},{key:"getWaterDrinkingStatus",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.appetiteData,a=e.isLoading,r=e.breakfast,s=e.fruit,i=e.lunch,o=e.snack,c=(e.rating,e.fruit_name),l=fn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:n(932),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u98f2\u98df")),a?y.a.createElement(Mn,null):t&&t[l]?y.a.createElement(E.a,null,y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:8}},r?y.a.createElement(E.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"}},"\u65e9\u9910")),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",padding:8}},y.a.createElement(b.a,{style:{fontSize:20}},r.rating||" ")),y.a.createElement(E.a,{style:{padding:5,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},r.water_drunk?"\u6709\u559d\u6c34":" "))):null,s?y.a.createElement(E.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"}},"\u6c34\u679c"!==c&&"\u6c34\u679c\u9910: "+c||"\u6c34\u679c")),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",padding:8}},y.a.createElement(b.a,{style:{fontSize:20}},s.rating||" ")),y.a.createElement(E.a,{style:{padding:5,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},s.water_drunk?"\u6709\u559d\u6c34":" "))):null),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:8}},i?y.a.createElement(E.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"}},"\u5348\u9910")),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",padding:8}},y.a.createElement(b.a,{style:{fontSize:20}},i.rating||" ")),y.a.createElement(E.a,{style:{padding:5,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},i.water_drunk?"\u6709\u559d\u6c34":" "))):null,o?y.a.createElement(E.a,{style:{width:"45%",justifyContent:"center",backgroundColor:"#F5F5F5",marginRight:"5%"}},y.a.createElement(E.a,{style:{padding:5}},y.a.createElement(b.a,{style:{fontSize:17,color:"rgba(0,0,0,0.8)"}},"\u9ede\u5fc3")),y.a.createElement(E.a,{style:{justifyContent:"center",alignItems:"center",padding:8}},y.a.createElement(b.a,{style:{fontSize:20}},o.rating||" ")),y.a.createElement(E.a,{style:{padding:5,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},o.water_drunk?"\u6709\u559d\u6c34":" "))):null)):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),a}(y.a.Component);function Mi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Fi=function(e){u()(a,e);var t=Mi(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1}),i.abrupt("return");case 3:return n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=8,r.a.awrap(Sn("milkintake",e,n,a));case 8:s=i.sent,this.setState({milkIntakeData:s,isLoading:!1});case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.milkIntakeData,a=e.isLoading,r=fn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:n(933),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u559d\u5976")),a?y.a.createElement(Mn,null):t&&t[r]?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:5}},y.a.createElement(E.a,{style:{width:"25%",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u6642\u9593")),y.a.createElement(E.a,{style:{width:"28%",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u91cf")),y.a.createElement(E.a,{style:{width:"28%",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u4e73\u54c1")),y.a.createElement(E.a,{style:{width:"19%",justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u8001\u5e2b"))),t[r].map((function(e,t){var n=e.time,a=e.amount,r=e.milk_type,s=e.teacher_name;return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{width:"25%"}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center",color:"#404040"}},n)),y.a.createElement(E.a,{style:{width:"28%"}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center",color:"#404040"}},a," c.c.")),y.a.createElement(E.a,{style:{width:"28%"}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center",color:"#404040"}},r)),y.a.createElement(E.a,{style:{width:"19%"}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center",color:"#404040"}},null!==s&&s.slice(1))))}))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),a}(y.a.Component);function Bi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var qi=function(e){u()(a,e);var t=Bi(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1}),i.abrupt("return");case 3:return n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=8,r.a.awrap(Sn("sleep",e,n,a));case 8:s=i.sent,this.setState({sleepData:s,isLoading:!1});case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.sleepData,a=e.isLoading,r=fn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:n(934),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u7761\u7720")),a?y.a.createElement(Mn,null):t&&t[r]?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:5}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u5f9e")),y.a.createElement(E.a,{style:{flex:1}}),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u5230"))),t[r].map((function(e,t){var n=e.sleep_time,a=e.wake_time,r=e.hours,s=e.minutes;return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},n)),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#404040"}},r,"H ",s,"M")),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center"}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"#404040"}},a)))}))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),a}(y.a.Component);function Ni(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ui=function(e){u()(a,e);var t=Ni(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime())))}},{key:"fetchData",value:function(e,t){var n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!(t.getHours()<17)){i.next=3;break}return this.setState({isLoading:!1}),i.abrupt("return");case 3:return n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=8,r.a.awrap(Sn("diaper",e,n,a));case 8:s=i.sent,this.setState({isLoading:!1,diaperData:s});case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this.state,t=e.isLoading,a=e.diaperData,r=fn(this.props.date);return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:n(935),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u5982\u5ec1")),t?y.a.createElement(Mn,null):a&&a[r]?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(E.a,{style:{flexDirection:"row",paddingBottom:5}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u6642\u9593")),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u6392\u6cc4")),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u4f7f\u7528")),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:15,textAlign:"center",color:"#606060"}},"\u72c0\u6cc1"))),a[r].map((function(e,t){var n=e.time,a=e.cloth_diaper,r=e.pee_or_poo,s=e.condition;e.teacher_id;return y.a.createElement(E.a,{key:t,style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:23,textAlign:"center",color:"#404040"}},n)),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:23,textAlign:"center",color:"#404040"}},r)),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:23,textAlign:"center",color:"#404040"}},a?"\u5b78\u7fd2\u8932":"\u5c3f\u5e03")),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(b.a,{style:{fontSize:23,textAlign:"center",color:"#404040"}},s)))}))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),a}(y.a.Component);function Hi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Wi=function(e){u()(a,e);var t=Hi(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={child_id:n.props.child_id,isLoading:!0,data_available:!1,items_to_bring:[],activities:[],text:"",teacher_id:"",message_id:null,message_for_teacher:"",isConnected:!0,scrollHeight:"100%",message_read:!1},n.fetchData=n.fetchData.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.state.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0,message_for_teacher:"",scrollHeight:"100%"}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id?(this.setState({isLoading:!0,message_for_teacher:"",scrollHeight:"100%"}),this.fetchData(this.props.child_id,new Date)):this.props.isConnected!=e.isConnected&&this.setState({isConnected:this.props.isConnected})}},{key:"setScrollHeight",value:function(e){this.setState({scrollHeight:e})}},{key:"fetchData",value:function(e,t){var n,a,s,i;return r.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!((n=new Date(t.getTime())).getHours()<17)){o.next=4;break}return this.setState({isLoading:!1,message_for_teacher:"",data_available:!1}),o.abrupt("return");case 4:return a=fn(n),n.setDate(n.getDate()+1),s=fn(n),o.next=9,r.a.awrap(Sn("message",e,a,s));case 9:if(void 0!==(i=o.sent).data&&void 0!==i.data[a]){o.next=13;break}return this.setState({isLoading:!1,message_for_teacher:"",data_available:!1}),o.abrupt("return");case 13:this.denormalize(i.data[a]);case 14:case"end":return o.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){for(var t=["\u6bcd\u5976\u7c89","\u5c3f\u5e03","\u6c34\u58fa","\u8863\u7269"],n=["\u5b30\u5152\u6309\u6469","\u97f3\u6a02\u5f8b\u52d5","\u6559\u5177\u64cd\u4f5c","\u7e6a\u672c\u6b23\u8cde","\u8a8d\u77e5\u5716\u7247","\u9ad4\u80fd\u6d3b\u52d5","\u85dd\u8853\u5275\u4f5c","\u591a\u5143\u8a9e\u8a00"],a=[],r=[],s=0;s<e.items_to_bring.length-1;s++)e.items_to_bring[s]&&a.push(t[s]);e.items_to_bring[e.items_to_bring.length-1]&&a.push(e.other_item);for(s=0;s<e.activities.length-1;s++)e.activities[s]&&r.push(n[s]);e.activities[e.activities.length-1]&&r.push(e.other_activity),this.setState({isLoading:!1,data_available:!0,message_id:e.message_id,items_to_bring:a,activities:r,text:e.text,teacher_id:e.teacher_id,message_for_teacher:e.message_for_teacher,message_read:e.message_read})}},{key:"sendMessage",value:function(){var e,t,n,a,s,i,o,c,l,u,d,f;return r.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:if(e=this.props,t=e.class_id,n=e.parent_id,a=e.date,s=this.state,i=s.message_for_teacher,o=s.message_id,c=s.isConnected,this.editable()&&""!==i){p.next=4;break}return p.abrupt("return");case 4:if(c){p.next=7;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),p.abrupt("return");case 7:return l={student_id:this.props.child_id,parent_id:n,message_id:o,message_for_teacher:i,timestamp:fn(a)+" "+mn(a)},p.next=10,r.a.awrap(En("/message/class/"+t,l));case 10:if(u=p.sent,d=u.success,u.statusCode,f=u.message,u.data,d){p.next=15;break}return alert("Sorry \u50b3\u9001\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+f),p.abrupt("return");case 15:alert("\u8a0a\u606f\u50b3\u9054\u6210\u529f\uff01"),this.fetchData(this.state.child_id,new Date(a.getTime()));case 17:case"end":return p.stop()}}),null,this,null,Promise)}},{key:"editable",value:function(){var e=this.props.date,t=new Date;return 6===t.getDay()?t.setDate(t.getDate()-1):0===t.getDay()&&t.setDate(t.getDate()-2),t.setHours(17,0,0,0),e.getTime()>=t.getTime()||this.before4am()}},{key:"before4am",value:function(){var e=this.props.date,t=new Date,n=new Date;return 1===t.getDay()?(n.setDate(n.getDate()-3),e.toDateString()===n.toDateString()&&t.getHours()<4):t.getDay()>1&&t.getDay()<6&&(n.setDate(n.getDate()-1),e.toDateString()===n.toDateString()&&t.getHours()<4)}},{key:"showMessageForTeacher",value:function(){var e=this.props.date,t=new Date;return t.setHours(0,0,0,1),!(e.toDateString()!==t.toDateString()||!this.editable())||e<t}},{key:"render",value:function(){var e=this,t=this.state,a=t.items_to_bring,r=t.activities,s=t.text,i=(t.teacher_id,t.isLoading),o=t.data_available,c=t.message_for_teacher,l=t.scrollHeight,u=t.message_read;this.props.date;return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,alignItems:"center",justifyContent:"center"}},y.a.createElement(pe.a,{source:n(936),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u8a0a\u606f")),i?y.a.createElement(Mn,null):o?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8,paddingRight:8}},y.a.createElement(E.a,{style:{padding:5,marginBottom:6,backgroundColor:"#F5F5F5"}},y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15}},"\u611b\u7684\u5c0f\u8a9e"),y.a.createElement(b.a,{style:{fontSize:25,paddingVertical:7}},s)),y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,padding:5,backgroundColor:"#F5F5F5",marginRight:3}},y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15}},"\u5bb6\u9577\u6e96\u5099"),a.length?y.a.createElement(E.a,{style:{alignItems:"center",paddingVertical:7}},a.map((function(e,t){return y.a.createElement(b.a,{key:t,style:{padding:5,backgroundColor:"lightgrey",marginBottom:3,fontSize:25}},e)}))):null),y.a.createElement(E.a,{style:{flex:1,padding:5,backgroundColor:"#F5F5F5",marginLeft:3}},y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.8)",fontSize:15}},"\u4eca\u65e5\u6d3b\u52d5"),r.length?y.a.createElement(E.a,{style:{alignItems:"center",paddingVertical:7}},r.map((function(e,t){return y.a.createElement(b.a,{key:t,style:{padding:5,backgroundColor:"lightgrey",marginBottom:3,fontSize:25}},e)}))):null)),y.a.createElement(E.a,{style:{backgroundColor:"#ffddb7",marginTop:5}},y.a.createElement(E.a,{style:{padding:5,flexDirection:"row",justifyContent:"space-between"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u7d66\u8001\u5e2b\u7684\u8a71"),""!==c&&y.a.createElement(b.a,{style:{fontSize:15}},u?"\u5df2\u8b80":"\u672a\u8b80")),y.a.createElement(Hn.a,{editable:this.editable(),style:{height:l,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.7)",paddingTop:10,padding:10,fontSize:25},placeholder:this.editable()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":i?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",scrollEnabled:!1,multiline:!0,value:c,onChangeText:function(t){return e.setState({message_for_teacher:t})},onChange:function(t){return e.setScrollHeight(t.target.scrollHeight)},onLayout:function(t){var n=t.nativeEvent.target.scrollHeight;e.setState({scrollHeight:n})}}),y.a.createElement(zr.a,{disabled:!this.editable(),style:{padding:10,justifyContent:"center"},onClick:function(){return e.sendMessage()}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u9001\u51fa")))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8,paddingRight:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304"),this.showMessageForTeacher()&&y.a.createElement(E.a,{style:{backgroundColor:"#ffddb7",marginTop:5}},y.a.createElement(E.a,{style:{padding:5,flexDirection:"row",justifyContent:"space-between"}},y.a.createElement(b.a,{style:{fontSize:15}},"\u7d66\u8001\u5e2b\u7684\u8a71"),""!==c&&y.a.createElement(b.a,{style:{fontSize:15}},u?"\u5df2\u8b80":"\u672a\u8b80")),y.a.createElement(Hn.a,{editable:this.editable(),style:{height:l,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.7)",paddingTop:10,padding:10,fontSize:25},placeholder:this.editable()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":i?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",scrollEnabled:!1,multiline:!0,value:c,onChangeText:function(t){return e.setState({message_for_teacher:t})},onChange:function(t){return e.setScrollHeight(t.target.scrollHeight)}}),y.a.createElement(zr.a,{disabled:!this.editable(),style:{padding:10,justifyContent:"center"},onClick:function(){return e.sendMessage()}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u9001\u51fa")))))))}}]),a}(y.a.Component);function Vi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ki(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Gi=function(e){u()(a,e);var t=Ki(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).getPermissionAsync=function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if("ios"!==Wn.a.OS){t.next=6;break}return t.next=3,r.a.awrap(as.c(as.b));case 3:e=t.sent,"granted"!==e.status&&alert("Sorry, we need camera roll permissions to make this work!");case 6:case"end":return t.stop()}}),null,null,null,Promise)},n._pickImage=function(e,t){var a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,r.a.awrap(ts.a({mediaTypes:ns.a.All,allowsEditing:!0,aspect:[1,1],quality:.4,base64:!0}));case 3:(a=i.sent).cancelled||(s=a.uri,n.getProfilePictureURL(s.replace(/^data:image\/\w+;base64,/,""),e,t)),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),console.log(i.t0);case 10:case"end":return i.stop()}}),null,null,[[0,7]],Promise)},n.state={temperature:"",borderRadius:0},n}return c()(a,[{key:"componentDidMount",value:function(){this.getPermissionAsync()}},{key:"componentDidUpdate",value:function(e){this.props.temperature!==e.temperature&&this.setState({temperature:this.props.temperature})}},{key:"getProfilePictureURL",value:function(e,t,n){var a,s,i,o,c,l,u,d;return r.a.async((function(f){for(;;)switch(f.prev=f.next){case 0:return a=this.props,s=a.student_name,i=a.student,o={image:e,url:n,path:i.school_name+"/profile_picture_"+t+"_"+(new Date).getMilliseconds()+".jpg"},f.next=4,r.a.awrap(En("/student/"+t+"/profile-picture",o));case 4:if(c=f.sent,l=c.success,c.statusCode,u=c.message,d=c.data,l){f.next=9;break}return alert("Sorry "+s+"\u7167\u7247\u4e0a\u50b3\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+u),f.abrupt("return");case 9:this.props.editProfilePicture(t,d.image_url);case 10:case"end":return f.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state,a=t.temperature,r=(t.borderRadius,this.props),s=r.student_id,i=r.student,o=r.student_name;return y.a.createElement(E.a,{style:{width:"97%",marginLeft:"3%",alignSelf:"flex-start",flexDirection:"row"}},y.a.createElement(le.Card,{style:{flexDirection:"row",width:"85%",alignItems:"center",paddingVertical:15}},y.a.createElement(C.a,{style:{flex:1,width:"50%",alignItems:"center"},onLayout:function(t){var n=t.nativeEvent.layout.width;e.setState({borderRadius:n/2})},onPress:function(){return e._pickImage(s,i.profile_picture)}},y.a.createElement(pe.a,{source:""===i.profile_picture?n(62):{uri:i.profile_picture},style:""===i.profile_picture?{width:130,height:130}:{width:130,height:130,borderRadius:65}})),y.a.createElement(E.a,{style:{height:"90%",width:"50%",paddingLeft:10}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{height:"50%",alignItems:"flex-start",justifyContent:"flex-end"}},y.a.createElement(b.a,{style:{fontSize:40}},o)),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingTop:5}},y.a.createElement(E.a,{style:{flex:1,height:"100%",backgroundColor:"#F5F5F5",justifyContent:"center"}},y.a.createElement(b.a,{style:{padding:5}},"\u65e9\u4e0a\u9ad4\u6eab"),y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},""===a?"\u672a\u91cf":a+"\xb0")),y.a.createElement(zr.a,{style:{backgroundColor:"#F5F5F5",alignItems:"center",justifyContent:"center"},onClick:function(){return e.props.viewQRCode()}},y.a.createElement(pe.a,{source:n(444),style:{width:65,height:65}})))))),y.a.createElement(le.Card,{style:{width:"20%"}},y.a.createElement(zr.a,{style:{flex:1,justifyContent:"center",paddingLeft:5},underlayColor:"#F5F5F5",onClick:function(){return e.props.selectOtherChildProfile()}},y.a.createElement(pe.a,{source:n(937),style:{width:43,height:43,opacity:.6}}))))}}]),a}(y.a.Component),Qi=Object(k.b)(null,(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vi(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({editProfilePicture:Ti},e))}))(Gi),Ji=n(23);function Yi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Xi=function(e){u()(a,e);var t=Yi(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={showSelector:!1,SlideInRight:new Ji.a.Value(0)},n}return c()(a,[{key:"slideIn",value:function(){var e=this;this.setState({showSelector:!0},(function(){Ji.a.timing(e.state.SlideInRight,{toValue:1,duration:200,useNativeDriver:!0}).start()}))}},{key:"onSelectStudent",value:function(e){this.props.onSelectStudent(e),Ji.a.timing(this.state.SlideInRight,{toValue:0,duration:500,useNativeDriver:!0}).start(),this.setState({showSelector:!1})}},{key:"render",value:function(){var e=this,t=Sa.a.get("window").width,a=this.state,r=a.showSelector,s=a.SlideInRight,i=this.props.student_of_id;return r?y.a.createElement(Ji.a.View,{style:{zIndex:2,width:"100%",height:"100%",position:"absolute",backgroundColor:"rgba(0,0,0,0.7)",transform:[{translateX:s.interpolate({inputRange:[0,1],outputRange:[t,0]})}],alignItems:"center"}},Object.keys(i).map((function(a){return y.a.createElement(C.a,{key:a,style:{marginTop:t/4},onPress:function(){return e.onSelectStudent(a)},underlayColor:"transparent"},y.a.createElement(pe.a,{source:""===i[a].profile_picture?n(62):{uri:i[a].profile_picture},style:{width:160,height:160,borderRadius:80,backgroundColor:"rgba(255,255,255,0.6)"}}))}))):null}}]),a}(y.a.Component);function Zi(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var $i=Sa.a.get("window"),eo=($i.width,$i.height),to=function(e){u()(n,e);var t=Zi(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={isLoading:!0,data:""},a}return c()(n,[{key:"componentDidMount",value:function(){var e,t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e=this.props,t=e.parent_id,n=e.isConnected,c.next=3,r.a.awrap(_n("/user/"+t+"/qrcode"));case 3:if(a=c.sent,s=a.success,a.statusCode,i=a.message,o=a.data,n){c.next=8;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),c.abrupt("return");case 8:if(s){c.next=11;break}return alert("Sorry \u53d6\u5f97\u5bb6\u9577QR Code\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+i),c.abrupt("return");case 11:this.setState({isLoading:!1,data:o});case 12:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this;return y.a.createElement(E.a,{style:{height:eo,zIndex:2,width:"100%",position:"absolute",backgroundColor:"white",justifyContent:"space-evenly",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:3,justifyContent:"center",alignItems:"center"}},this.state.isLoading?y.a.createElement(Mn,null):y.a.createElement(bs.a,{value:this.state.data,size:300})),y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(C.a,{style:{padding:15,backgroundColor:"#b5e9e9"},onPress:function(){return e.props.hideQRCode()}},y.a.createElement(b.a,{style:{fontSize:30}},"\u8fd4\u56de")))))}}]),n}(y.a.Component),no=Object(k.b)((function(e){return{isConnected:e.parent.isConnected}}))(to);function ao(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ro(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var so=function(e){u()(a,e);var t=ro(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,med_requests:[]},n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id&&(this.setState({isLoading:!0}),this.fetchData(this.props.child_id,new Date))}},{key:"afterFive",value:function(){return this.props.date.getHours()>=17}},{key:"fetchData",value:function(e,t){var n,a=this;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return n="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/medicationrequest/student/"+e+"?date="+fn(t),s.next=3,r.a.awrap(fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var n=e.data,r=a.get_todays_requests(n,t);a.setState({med_requests:r}),a.setState({isLoading:!1})})).catch((function(e){alert("Sorry \u53d6\u5f97\u4eca\u65e5\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when fetching medication request")})));case 3:case"end":return s.stop()}}),null,null,null,Promise)}},{key:"get_todays_requests",value:function(e,t){for(var n=[],a=0;a<e.length;a++){if(new Date(e[a].title).toDateString()===t.toDateString()){n=e[a].data;for(var r=0;r<n.length;r++)n[r].timestamp=new Date(n[r].timestamp);break}}return n}},{key:"render",value:function(){var e=this,t=this.state.med_requests,a=this.state.isLoading;return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:n(938),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u4eca\u65e5\u85e5\u55ae")),a?y.a.createElement(Mn,null):t.length?y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:8}},y.a.createElement(Rn.a,{horizontal:!0,contentContainerStyle:{paddingBottom:10}},t.map((function(a,r){return y.a.createElement(zr.a,{key:a.id,style:{padding:10,backgroundColor:"#F5F5F5",marginRight:15,justifyContent:"center"},underlayColor:"#ff8944",onClick:function(){return e.props.viewMedRequest(r,t)}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},e.afterFive()&&a.administered?y.a.createElement(pe.a,{source:n(461),style:{width:20,height:20}}):null,y.a.createElement(b.a,{style:{alignSelf:"center",fontSize:25,color:"rgba(0,0,0,0.8)"}},yn(a.timestamp))))})))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))}}]),a}(y.a.Component),io=Object(k.b)((function(e){return{med_requests:e.parent.med_requests}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ao(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ao(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({getMedRequestSuccess:Oi},e))}),null,{forwardRef:!0})(so),oo=n(31);function co(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var lo=function(e){u()(a,e);var t=co(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,morning_reminder_id:null,text:"",reminder_read:!1,isConnected:!0,scrollHeight:"100%",milk_timestamp:new Date,diaper_timestamp:new Date,milk_amount:"",diaper_type:"\u5c0f\u4fbf",showDateTimeModal:!1,showDateTimeModalType:"",includeMilkIntake:!1,includeDiaper:!1},n.fetchData=n.fetchData.bind(_()(n)),n.onSendMessageDelay=Object(oo.debounce)(n.sendMessage,1e3).bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.date;this.fetchData(this.props.child_id,new Date(e.getTime()))}},{key:"componentDidUpdate",value:function(e){this.props.date!==e.date?(this.setState({isLoading:!0,text:"",scrollHeight:"100%",includeMilkIntake:!1,milk_timestamp:new Date,milk_amount:"",includeDiaper:!1,diaper_timestamp:new Date,diaper_type:"\u5c0f\u4fbf"}),this.fetchData(this.props.child_id,new Date(this.props.date.getTime()))):this.props.child_id!==e.child_id?(this.setState({isLoading:!0,text:"",scrollHeight:"100%",includeMilkIntake:!1,milk_timestamp:new Date,milk_amount:"",includeDiaper:!1,diaper_timestamp:new Date,diaper_type:"\u5c0f\u4fbf"}),this.fetchData(this.props.child_id,new Date)):this.props.isConnected!=e.isConnected&&this.setState({isConnected:this.props.isConnected})}},{key:"setScrollHeight",value:function(e){this.setState({scrollHeight:e})}},{key:"fetchData",value:function(e,t){var n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return n=fn(t),t.setDate(t.getDate()+1),a=fn(t),i.next=5,r.a.awrap(Sn("morningreminder",e,n,a));case 5:if(void 0!==(s=i.sent).data&&void 0!==s.data[n]){i.next=9;break}return this.setState({isLoading:!1,morning_reminder_id:null,text:"",reminder_read:!1}),i.abrupt("return");case 9:this.setState({isLoading:!1,morning_reminder_id:s.data[n].morning_reminder_id,text:s.data[n].text,reminder_read:s.data[n].reminder_read});case 10:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"sendMessage",value:function(){var e,t,n,a,s,i,o,c,l,u,d,f,p,h,m,y,g,_,E;return r.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(e=this.props,t=e.class_id,n=e.date,a=e.parent_id,s=this.state,i=s.text,o=s.morning_reminder_id,c=s.isConnected,l=s.includeMilkIntake,u=s.milk_timestamp,d=s.milk_amount,f=s.includeDiaper,p=s.diaper_timestamp,h=s.diaper_type,this.editable()&&(""!==i||l||f)){b.next=4;break}return b.abrupt("return");case 4:if(c){b.next=7;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),b.abrupt("return");case 7:return m=i,f&&(m="\u5982\u5ec1: "+yn(p)+" "+h+"\n"+m),l&&(m="\u9935\u5976: "+yn(u)+" "+d+" c.c.\n"+m),y={morning_reminder_id:o,student_id:this.props.child_id,parent_id:a,timestamp:fn(n)+" "+mn(n),text:m},b.next=13,r.a.awrap(En("/morningreminder/class/"+t,y));case 13:if(g=b.sent,_=g.success,g.statusCode,E=g.message,g.data,_){b.next=18;break}return alert("Sorry \u50b3\u9001\u8a0a\u606f\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+E),b.abrupt("return");case 18:alert("\u8a0a\u606f\u50b3\u9054\u6210\u529f\uff01"),this.setState({includeMilkIntake:!1,milk_timestamp:new Date,milk_amount:"",includeDiaper:!1,diaper_timestamp:new Date,diaper_type:"\u5c0f\u4fbf",morning_reminder_id:""}),this.fetchData(this.props.child_id,new Date(this.props.date));case 21:case"end":return b.stop()}}),null,this,null,Promise)}},{key:"editable",value:function(){var e=this.props.date,t=new Date;return t.setHours(17,0,0),e.toDateString()===(new Date).toDateString()&&new Date<t||e.toDateString()!==(new Date).toDateString()&&e>new Date}},{key:"selectDatetimeConfirm",value:function(e){var t=this.state.showDateTimeModalType;"milkintake"===t?this.setState({milk_timestamp:e}):"diaper"===t&&this.setState({diaper_timestamp:e})}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoading,r=t.text,s=t.scrollHeight,i=t.morning_reminder_id,o=t.reminder_read,c=t.milk_timestamp,l=t.milk_amount,u=t.diaper_timestamp,d=t.diaper_type,f=(t.showDateTimeModal,t.includeMilkIntake),p=t.includeDiaper;return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:n(939),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8,flexDirection:"row",justifyContent:"space-between",paddingRight:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u611b\u7684\u53ee\u5680"),""!==r&&y.a.createElement(b.a,{style:{fontSize:20}},o?"\u5df2\u8b80":"\u672a\u8b80")),y.a.createElement(E.a,{style:{flex:1,paddingVertical:8,paddingRight:8}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center",backgroundColor:f?"#dcf3d0":"transparent"}},y.a.createElement(zr.a,{disabled:!0,onClick:function(){e.editable()&&e.setState({includeMilkIntake:!f})}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:f?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:20,marginLeft:10,alignSelf:"center"}},"\u9935\u5976: "))),y.a.createElement(zr.a,{style:{justifyContent:"center",alignItems:"center",padding:10},onClick:function(){e.editable()&&(e.setState({showDateTimeModalType:"milkintake",includeMilkIntake:!0}),e.props.showTimeModal())}},y.a.createElement(b.a,{style:{fontSize:25}},""+yn(c))),y.a.createElement(Hn.a,{editable:this.editable(),style:{marginLeft:15,width:55,fontSize:25},keyboardType:"number-pad",placeholder:"_____",value:""+l,onChangeText:function(t){return e.setState({milk_amount:t})},onFocus:function(){e.editable()&&e.setState({includeMilkIntake:!0})}}),y.a.createElement(b.a,{style:{fontSize:20}},"  c.c.")),y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center",marginTop:10,backgroundColor:p?"#dcf3d0":"transparent"}},y.a.createElement(zr.a,{disabled:!0,onClick:function(){e.editable()&&e.setState({includeDiaper:!p})}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:p?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:20,marginLeft:10,alignSelf:"center"}},"\u5982\u5ec1: "))),y.a.createElement(zr.a,{style:{justifyContent:"center",alignItems:"center",padding:5},onClick:function(){e.editable()&&(e.setState({showDateTimeModalType:"diaper",includeDiaper:!0}),e.props.showTimeModal())}},y.a.createElement(b.a,{style:{fontSize:25,padding:5}},""+yn(u))),y.a.createElement(zr.a,{style:{marginLeft:15,justifyContent:"center",alignItems:"center",padding:10},onClick:function(){e.editable()&&e.setState({diaper_type:"\u5c0f\u4fbf"===d?"\u5927\u4fbf":"\u5927\u4fbf"===d?"\u7121\u6392\u4fbf":"\u5c0f\u4fbf",includeDiaper:!0})}},y.a.createElement(b.a,{style:{fontSize:20}},d))),y.a.createElement(Hn.a,{key:i,editable:this.editable(),style:{width:"100%",height:s,backgroundColor:"#dcf3d0",fontSize:25,paddingTop:10,padding:10,marginTop:10},placeholder:this.editable()?"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...":a?"\u4e0b\u8f09\u4e2d...":"\u5df2\u4e0d\u80fd\u586b\u5beb",value:r,multiline:!0,scrollEnabled:!1,onChangeText:function(t){return e.setState({text:t})},onChange:function(t){return e.setScrollHeight(t.target.scrollHeight)},onLayout:function(t){var n=t.nativeEvent.target.scrollHeight;e.setState({scrollHeight:n})}}),y.a.createElement(zr.a,{disabled:!this.editable(),style:{backgroundColor:"#00c07f",padding:10,justifyContent:"center",alignItems:"center"},underlayColor:"transparent",onClick:this.onSendMessageDelay},y.a.createElement(b.a,{style:{fontSize:25}},"\u9001\u51fa"))))))}}]),a}(y.a.Component);function uo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var fo=function(e){u()(a,e);var t=uo(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={announcements:[]},n}return c()(a,[{key:"componentDidMount",value:function(){this.fetchAnnouncement()}},{key:"componentDidUpdate",value:function(e){(this.props.date!==e.date||this.props.child_id!==e.child_id)&&(this.setState({isLoading:!0}),this.fetchAnnouncement())}},{key:"fetchAnnouncement",value:function(){var e,t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=this.props.parent_id,s.next=3,r.a.awrap(_n("/announcement/unread?parent_id="+e+"&page=0"));case 3:t=s.sent,n=t.success,t.statusCode,t.message,a=t.data,n&&this.setState({announcements:a});case 6:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"render",value:function(){var e=this,t=this.state.announcements;return 0===t.length?null:y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(zr.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"},onClick:function(){return e.props.viewMore(t)}},y.a.createElement(pe.a,{source:n(940),style:{width:38,height:38}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u65b0\u516c\u544a")),y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(Rn.a,{horizontal:!0,contentContainerStyle:{paddingBottom:10}},t.map((function(a,r){var s=new Date(a.timestamp);return y.a.createElement(zr.a,{key:a.id,style:{padding:10,backgroundColor:"#F5F5F5",marginRight:15,justifyContent:"center"},underlayColor:"#ff8944",onClick:function(){return e.props.viewAnnouncement(r,t)}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",alignItems:"center"}},a.read?y.a.createElement(pe.a,{source:n(461),style:{width:20,height:20}}):null,y.a.createElement(b.a,{style:{marginLeft:3,alignSelf:"center",fontSize:25,color:"rgba(0,0,0,0.8)"}},hn(s))))})))))))}}]),a}(y.a.Component),po=function(e){var t=e.student_id,a=Object(m.useState)(!0),s=qr()(a,2),i=s[0],o=s[1],c=Object(m.useState)(null),l=qr()(c,2),u=l[0],d=l[1],f=Object(m.useState)(null),p=qr()(f,2),h=p[0],g=p[1],_=Object(m.useState)(null),v=qr()(_,2),S=v[0],w=v[1],C=Object(m.useState)(null),k=qr()(C,2),D=k[0],x=k[1];Object(m.useEffect)((function(){var t=e.date;A(t)}),[e.date]);var A=function(e){var n,a,s,i,c,l,u,f;return r.a.async((function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,r.a.awrap(_n("/attendance/"+t+"?date="+fn(e)));case 2:n=p.sent,a=n.success,s=n.statusCode,n.message,i=n.data,a?(c=i.in_time,l=i.out_time,u=i.excuse_type,f=i.absence_time,"none-medical"===u&&(u="\u4e8b\u5047"),d(c),g(l),w(u),x(f),o(!1)):400===s&&(d(null),g(null),w(null),x(null),o(!1));case 5:case"end":return p.stop()}}),null,null,null,Promise)};return y.a.createElement(le.Card,{style:{width:"93%"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:56,height:56,justifyContent:"center",alignItems:"center"}},y.a.createElement(pe.a,{source:n(941),style:{width:48,height:48}})),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{paddingTop:8}},y.a.createElement(b.a,{style:{fontSize:20}},"\u51fa\u52e4")),i?y.a.createElement(Mn,null):null!==u||null!==h||null!==S?y.a.createElement(E.a,{style:{flex:1,paddingVertical:8,alignItems:"center"}},null!==S&&y.a.createElement(E.a,{style:{flex:1,paddingBottom:8}},y.a.createElement(b.a,{style:{fontSize:25}},"\u8acb\u5047: "+S+" ("+{morning:"\u65e9\u4e0a",evening:"\u4e0b\u5348",all_day:"\u5168\u5929"}[D]+")")),y.a.createElement(E.a,{style:{flex:1,width:"100%",flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(b.a,null,"\u5230\u6821"),null!==u&&y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},u)),y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(b.a,null,"\u96e2\u6821"),null!==h&&y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},h)))):y.a.createElement(E.a,{style:{flex:1,paddingVertical:8}},y.a.createElement(b.a,{style:{fontSize:17}},"\u6c92\u6709\u65b0\u7d00\u9304")))))},ho=function(e){return y.a.createElement(E.a,{style:{zIndex:2,width:"100%",height:"100%",position:"absolute",backgroundColor:"rgba(0,0,0,1)",alignItems:"center"}},y.a.createElement(zr.a,{style:{paddingTop:30,paddingBottom:15,borderBottomWidth:2,borderBottomColor:"grey"},onClick:function(){return e.onItemClick("DownloadPage")}},y.a.createElement(b.a,{style:{fontSize:25,color:"grey",fontWeight:"bold"}}," \u4e0b\u8f09 ")))};function mo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function yo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var go=Sa.a.get("window").width,_o=function(e){u()(a,e);var t=yo(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).timer=function(){return setTimeout((function(){n.poll(n.state.child_id)}),1e4)},n._handleAppStateChange=function(e){n.state.appState.match(/inactive|background/)&&"active"===e&&(n.checkStudentAttendance(n.state.child_id),n.state.date.toDateString()!==(new Date).toDateString()&&(new Date).getHours()>3&&n.initializeChildren()),n.setState({appState:e})},n.state={date:new Date,child_id:"",student_id_array:[],message:"",refreshing:!1,showQR:!1,temperature:"",appState:"",showDateTimeModal:!1,present:!1,showTimeModal:!1,showMainMenu:!1},n.initializeChildren=n.initializeChildren.bind(_()(n)),n}return c()(a,[{key:"poll",value:function(e){var t,n=this;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/family/updates?student_id="+e,a.next=3,r.a.awrap(fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){t.data.forEach((function(t){n.refs[t].fetchData(e,new Date(n.state.date))}))})).catch((function(e){console.log("polling error: ",e)})));case 3:this.timeoutId=this.timer();case 4:case"end":return a.stop()}}),null,this,null,Promise)}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("offline",(function(t){e.props.setConnectState(!1)})),window.addEventListener("online",(function(t){e.props.setConnectState(!0)})),this.initializeChildren(),this.timeoutId=this.timer(),de.a.addEventListener("change",this._handleAppStateChange),this.props.navigation.setOptions({headerLeft:function(){return y.a.createElement(zr.a,{style:{padding:15},onClick:function(){return e.setState({showMainMenu:!e.state.showMainMenu})}},y.a.createElement(pe.a,{source:n(942),style:{width:20,height:20}}))}})}},{key:"setDate",value:function(){var e=new Date;6===e.getDay()?e.setDate(e.getDate()-1):0===e.getDay()&&e.setDate(e.getDate()-2),this.selectDatetimeConfirm(e)}},{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"initializeChildren",value:function(){var e=this,t=this.props.route.params.parent_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/family/"+t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,a=t.message,r=t.data;if(n>200||"Internal server error"===a)alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a);else{e.props.initializeChildren(r);var s=Object.keys(e.props.parent.child_of_id);e.setState({child_id:s[0],student_id_array:s}),e.setDate()}})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when initializing student profiles")}))}},{key:"checkStudentAttendance",value:function(e){var t,n,a,s;return r.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(this.state.date.toDateString()===(new Date).toDateString()){i.next=2;break}return i.abrupt("return");case 2:return t=new Date,i.next=5,r.a.awrap(_n("/attendance/"+e+"?date="+fn(t)));case 5:n=i.sent,a=n.success,n.statusCode,n.message,s=n.data,a&&(s.in_time,s.out_time,s.excuse_type);case 8:case"end":return i.stop()}}),null,this,null,Promise)}},{key:"onSelectStudent",value:function(e){this.setState({child_id:e})}},{key:"markPresent",value:function(e){this.state.date;this.setState({temperature:e,present:""!==e})}},{key:"selectDatetimeConfirm",value:function(e){var t=this,n=new Date;n.setHours(0,0,0,0),e.getTime()<n.getTime()?e.setHours(18):e.toDateString()===(new Date).toDateString()?e.setTime(new Date):e.setHours(16,0,0),this.setState({date:e,showDateTimeModal:!1},(function(){return t.checkStudentAttendance(t.state.child_id)}))}},{key:"getDayDifference",value:function(e,t){var n=new Date(e),a=new Date(t);n.setHours(0),a.setHours(0);return Math.round((a-n)/864e5)}},{key:"goBackADay",value:function(){var e=new Date(this.state.date.getTime());1===e.getDay()?e.setDate(e.getDate()-3):e.setDate(e.getDate()-1),this.selectDatetimeConfirm(e)}},{key:"goForwardADay",value:function(){var e=new Date(this.state.date.getTime());5===e.getDay()?e.setDate(e.getDate()+3):e.setDate(e.getDate()+1),this.selectDatetimeConfirm(e)}},{key:"onMenuItemClick",value:function(e){var t=this.state.child_id;this.setState({showMainMenu:!1}),this.props.navigation.navigate(e,{student_id:t,students:this.props.parent.child_of_id})}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutId),de.a.removeEventListener("change",this._handleAppStateChange),this.props.clearState()}},{key:"render",value:function(){var e=this,t=this.props.route.params.parent_id,a=this.props.isConnected,r=this.state,s=r.date,i=r.child_id,o=r.showQR,c=r.temperature,l=r.showDateTimeModal,u=r.present,d=r.showTimeModal,f=r.showMainMenu;if(""===i)return y.a.createElement(Mn,null);var p=this.props.parent.child_of_id[i],h=this.getDayDifference(s,new Date);return y.a.createElement(Un.a,{enabled:!0,behavior:"padding",keyboardVerticalOffset:100,style:{flex:1,zIndex:1}},y.a.createElement(Xi,{ref:"profile_selector",student_of_id:this.props.parent.child_of_id,onSelectStudent:function(t){return e.onSelectStudent(t)}}),o?y.a.createElement(no,{hideQRCode:function(){return e.setState({showQR:!1})},parent_id:t}):null,l?y.a.createElement(Da,{start_date:s,datetime_type:"date",hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:(new Date).setDate((new Date).getDate()-30),maxDatetime:(new Date).setDate((new Date).getDate()+1),paddingVertical:100}):null,d&&y.a.createElement(Da,{start_date:new Date,datetime_type:"time",hideModal:function(){return e.setState({showTimeModal:!1})},selectDatetimeConfirm:function(t){return e.refs.morningreminder.selectDatetimeConfirm(t)},minDatetime:null,maxDatetime:null,minTime:null,maxTime:null,paddingVertical:400}),f&&y.a.createElement(ho,{onItemClick:function(t){return e.onMenuItemClick(t)},onHide:function(){return e.setState({showMainMenu:!1})}}),y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center",justifyContent:"center",paddingBottom:30},refreshControl:y.a.createElement(Ha.a,{style:{backgroundColor:"transparent"},refreshing:this.state.refreshing,onRefresh:this.initializeChildren,tintColor:"#ff8944",title:"Loading...",titleColor:"#368cbf",colors:["#ff8944","#368cbf","#0000ff"],progressBackgroundColor:"#ffff00"})},y.a.createElement(E.a,{style:{width:"100%",flexDirection:"row",backgroundColor:"white"}},y.a.createElement(E.a,{style:{width:"15%"}},h<30?y.a.createElement(zr.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onClick:function(){return e.goBackADay()}},y.a.createElement(pe.a,{source:n(303),style:{width:40,height:40}})):null),y.a.createElement(zr.a,{style:{width:"70%",justifyContent:"center"},onClick:function(){return e.setState({showDateTimeModal:!0})}},y.a.createElement(b.a,{style:{fontSize:.12*go,textAlign:"center"}},pn(s))),y.a.createElement(E.a,{style:{width:"15%"}},h>=0?y.a.createElement(zr.a,{style:{flex:1,justifyContent:"center",alignItems:"center"},onClick:function(){return e.goForwardADay()}},y.a.createElement(pe.a,{source:n(304),style:{width:40,height:40}})):null)),y.a.createElement(Qi,{student_id:i,student:p,students:this.props.parent.child_of_id,student_name:this.props.parent.child_of_id[i].name,selectOtherChildProfile:function(){return e.refs.profile_selector.slideIn()},viewQRCode:function(){return e.setState({showQR:!0})},temperature:c}),y.a.createElement(E.a,{style:{flex:1,width:"93%",flexDirection:"row",justifyContent:"space-between",marginVertical:5}},y.a.createElement(zr.a,{style:{width:"30%",padding:10,backgroundColor:"#ffe1d0"},onClick:function(){return e.props.navigation.navigate("PickupRequest",{child_id:i,school_id:p.school_id})}},y.a.createElement(b.a,{style:{fontSize:.05*go,textAlign:"center"}},"\u63a5\u56de\u544a\u77e5")),y.a.createElement(zr.a,{style:{width:"30%",padding:10,backgroundColor:"#fff1b5"},onClick:function(){return e.props.navigation.push("MedicationRequestPage",{onGoBack:function(){return e.refs.med_request.fetchData(i,new Date)},student_id:i,class_id:p.class_id})}},y.a.createElement(b.a,{style:{fontSize:.05*go,textAlign:"center"}},"\u6258\u85e5\u55ae")),y.a.createElement(zr.a,{style:{width:"30%",padding:10,backgroundColor:"#b5e9e9"},onClick:function(){return e.props.navigation.navigate("AbsenceExcusePage",{student_id:i,class_id:null===p.class_id?"":p.class_id,school_id:p.school_id})}},y.a.createElement(b.a,{style:{fontSize:.05*go,textAlign:"center"}},"\u8acb\u5047\u55ae"))),y.a.createElement(fo,{child_id:i,date:s,parent_id:t,ref:"announcement",viewAnnouncement:function(n,a){return e.props.navigation.push("AnnouncementPage",{onGoBack:function(){return e.refs.announcement.fetchAnnouncement()},index:n,data:a,parent_id:t})},viewMore:function(n){return e.props.navigation.push("AnnouncementListPage",{announcements:n,parent_id:t,viewAnnouncement:function(n,a){return e.props.navigation.push("AnnouncementPage",{onGoBack:function(){return e.refs.announcement.fetchAnnouncement()},index:n,data:a,parent_id:t})}})}}),y.a.createElement(lo,{child_id:i,date:s,class_id:p.class_id,ref:"morningreminder",present:u,isConnected:a,parent_id:t,showTimeModal:function(){return e.setState({showTimeModal:!0})}}),y.a.createElement(po,{student_id:i,date:s,ref:"attendance"}),y.a.createElement(io,{child_id:i,date:s,ref:"med_request",viewMedRequest:function(t,n){return e.props.navigation.push("AddMedicationRequestPage",{onGoBack:function(){return e.refs.med_request.fetchData(i,new Date)},student_id:i,class_id:null===p.class_id?"":p.class_id,index:t,data:n})}}),y.a.createElement(Ii,{child_id:i,date:s,ref:"wellness",updateTitleTemp:function(t){return e.markPresent(t)}}),y.a.createElement(Wi,{child_id:i,date:s,class_id:p.class_id,ref:"messages",parent_id:t}),y.a.createElement(Li,{child_id:i,date:s,ref:"appetite"}),y.a.createElement(Fi,{child_id:i,date:s,ref:"milkintake"}),y.a.createElement(qi,{child_id:i,date:s,ref:"sleep"}),y.a.createElement(Ui,{child_id:i,date:s,ref:"diaper"})))}}]),a}(y.a.Component),Eo=(ue.a.create({button_text:{fontSize:18,textAlign:"center"},button:{width:"30%",padding:20,justifyContent:"center"}}),Object(k.b)((function(e){return{parent:e.parent,isConnected:e.parent.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mo(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({setConnectState:ji,initializeChildren:xi,markPresent:Ri,clearState:Ai},e))}))(_o)),bo=n(161);function vo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}Sa.a.get("window").width;var So=function(e){u()(n,e);var t=vo(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={"\u85e5\u7c89":0},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u7c89;this.setState({"\u85e5\u7c89":parseInt(e)})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u7c89,n=this.props,a=n.width,r=n.height;return y.a.createElement(E.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(E.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"}},y.a.createElement(E.a,{style:{height:r,flexDirection:"row",flexDirection:"row"}},y.a.createElement(E.a,{style:{width:a,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},"\u85e5\u7c89"))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",height:.8*r,aspectRatio:1,justifyContent:"center",borderRadius:.4*r},onPress:function(){return e.setState({"\u85e5\u7c89":0===t?0:t-1})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"white"}},"-")),y.a.createElement(b.a,{style:{fontSize:40,paddingHorizontal:15}},t," \u5305"),y.a.createElement(C.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",height:.8*r,aspectRatio:1,justifyContent:"center",borderRadius:.4*r},onPress:function(){return e.setState({"\u85e5\u7c89":t+1})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center",color:"white"}},"+"))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()}},y.a.createElement(b.a,{style:{fontSize:.12*a,textAlign:"center"}},"\u53d6\u6d88\u9078\u53d6"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"OK"))))))}}]),n}(y.a.Component);function wo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Co=function(e){u()(n,e);var t=wo(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={"\u85e5\u6c34":0},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u6c34;this.setState({"\u85e5\u6c34":e})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u6c34,n=this.props,a=n.width,r=n.height;return y.a.createElement(E.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(E.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"}},y.a.createElement(E.a,{style:{height:r,flexDirection:"row",flexDirection:"row"}},y.a.createElement(E.a,{style:{width:a,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},"\u85e5\u6c34"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center",marginTop:-20}},y.a.createElement(E.a,{style:{flexDirection:"row",backgroundColor:"rgba(255,255,255,0.4)",alignItems:"center"}},y.a.createElement(Hn.a,{style:{fontSize:40,padding:10},keyboardType:"decimal-pad",autoFocus:!0,selectTextOnFocus:!0,value:""+t,onChangeText:function(t){return e.setState({"\u85e5\u6c34":t})}}),y.a.createElement(b.a,{style:{paddingLeft:10,fontSize:40}},"c.c."))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u53d6\u6d88\u9078\u53d6"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"OK"))))))}}]),n}(y.a.Component);function ko(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Do=function(e){u()(n,e);var t=ko(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={"\u85e5\u818f":""},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.\u85e5\u818f;this.setState({"\u85e5\u818f":e})}},{key:"render",value:function(){var e=this,t=this.state.\u85e5\u818f,n=this.props,a=n.width,r=n.height;return y.a.createElement(E.a,{style:{flex:4,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(E.a,{style:{flex:3,margin:14,backgroundColor:"#ffddb7"}},y.a.createElement(E.a,{style:{height:r,flexDirection:"row",flexDirection:"row"}},y.a.createElement(E.a,{style:{width:a,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},"\u85e5\u818f"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center",marginTop:-20}},y.a.createElement(E.a,{style:{flexDirection:"row",backgroundColor:"rgba(255,255,255,0.4)",alignItems:"center"}},y.a.createElement(Hn.a,{style:{fontSize:40,padding:10},placeholder:"\u90e8\u4f4d",autoFocus:!0,selectTextOnFocus:!0,value:t,onChangeText:function(t){return e.setState({"\u85e5\u818f":t})}}))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#fa625f",justifyContent:"center"},onPress:function(){return e.props.onCancelSelect()}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u53d6\u6d88\u9078\u53d6"))),y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(C.a,{style:{height:"70%",aspectRatio:2,padding:5,backgroundColor:"#00c07f",justifyContent:"center"},onPress:function(){return e.props.onFinishEdit(t)}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"OK"))))))}}]),n}(y.a.Component);function xo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}!function(e){u()(n,e);var t=xo(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={optionButtonWidth:0,optionButtonHeight:0,show_date_picker:!1,show_time_picker:!1,date:new Date,time:new Date,show_editor:"","\u85e5\u7c89":null,need_refrigeration:!1,"\u85e5\u6c34":null,"\u85e5\u818f":null,note:"",access_mode:"create"},a}c()(n,[{key:"componentDidMount",value:function(){}},{key:"getHeader",value:function(){var e=this.state,t=e.access_mode,n=e.date;if("read"===t){if(fn(n)===fn(new Date))return"\u4eca\u5929\u6258\u85e5\u55ae";return"\u661f\u671f"+["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"][n.getDay()]}return"create"===t?"\u65b0\u589e\u6258\u85e5\u55ae":"edit"===t?"\u7de8\u8f2f\u4e2d...":void 0}},{key:"fetchAccessMode",value:function(){return this.state.access_mode}},{key:"componentDidUpdate",value:function(e){if(e.request!==this.props.request){var t=this.props.request;if(!t)return void this.setState({date:new Date,time:new Date,"\u85e5\u7c89":null,need_refrigeration:!1,"\u85e5\u6c34":null,"\u85e5\u818f":null,note:"",access_mode:"create"});var n=t.timestamp,a=t.medication,r=t.note,s=a.\u85e5\u7c89,i=a.need_refrigeration,o=a.\u85e5\u6c34,c=a.\u85e5\u818f;this.setState({date:n,time:n,"\u85e5\u7c89":s,need_refrigeration:i,"\u85e5\u6c34":o,"\u85e5\u818f":c,note:r,access_mode:"read"})}}},{key:"setDate",value:function(e){"ios"===Wn.a.OS?this.iosSetDate(e):this.androidSetDate(e)}},{key:"iosSetDate",value:function(e){"read"!==this.state.access_mode&&this.setState({date:e,time:e})}},{key:"androidSetDate",value:function(e){void 0!==e?this.setState({date:e,time:e,show_date_picker:!1}):this.setState({show_date_picker:!1})}},{key:"setTime",value:function(e){"ios"===Wn.a.OS?this.iosSetTime(e):this.androidSetTime(e)}},{key:"iosSetTime",value:function(e){"read"!==this.state.access_mode&&this.setState({time:e})}},{key:"androidSetTime",value:function(e){void 0!==e?this.setState({time:e,show_time_picker:!1}):this.setState({show_time_picker:!1})}},{key:"onFinishEdit",value:function(e,t){this.setState(A()({show_editor:""},e,t))}},{key:"onCancelSelect",value:function(e){this.setState(A()({show_editor:""},e,null))}},{key:"handleClickConfirmButton",value:function(){var e=this.state.access_mode;if("read"===e)this.setState({access_mode:"edit"});else if("create"===e)this.sendRequest(null);else if("edit"===e){var t=this.props.request.id;this.sendRequest(t)}}},{key:"sendRequest",value:function(e){var t=this,n=this.state,a=n.date,r=n.time,s=n.\u85e5\u7c89,i=n.need_refrigeration,o=n.\u85e5\u6c34,c=n.\u85e5\u818f,l=n.note,u=this.props,d=u.student_id,f=u.class_id,p={request_id:e,timestamp:fn(a)+" "+mn(r),class_id:f,"\u85e5\u7c89":s,need_refrigeration:i,"\u85e5\u6c34":o,"\u85e5\u818f":c,note:l};fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/medicationrequest/student/"+d,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(p)}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,a=e.message,r=e.data;n>200||"Internal server error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):t.props.onCreateRequestSuccess(r.id)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending medication request")}))}},{key:"deleteRequestConfirm",value:function(){confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest()}},{key:"deleteRequest",value:function(){var e=this,t=this.props,n=t.request,a=t.class_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/medicationrequest/"+n.id,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:a})}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,a=t.message,r=t.data;n>200||"Internal Server Error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):e.props.onDeleteRequestSuccess(r.id)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.show_date_picker,a=t.show_time_picker,r=t.date,s=t.time,i=t.\u85e5\u7c89,o=t.\u85e5\u6c34,c=t.\u85e5\u818f,l=t.note,u=t.optionButtonWidth,d=t.optionButtonHeight,f=t.show_editor,p=t.access_mode;return n?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:3,justifyContent:"center"}}),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(C.a,{style:{width:"50%",padding:10,backgroundColor:"rgba(255,255,255,0.4)",alignSelf:"flex-end"},onPress:function(){return e.setState({show_date_picker:!1})}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"OK")))):a?y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(E.a,{style:{flex:3,justifyContent:"center"}}),y.a.createElement(E.a,{style:{flex:1}},y.a.createElement(C.a,{style:{width:"50%",padding:10,backgroundColor:"rgba(255,255,255,0.4)",alignSelf:"flex-end"},onPress:function(){return e.setState({show_time_picker:!1})}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"OK")))):y.a.createElement(Un.a,{style:{flex:1},behavior:"padding",enabled:!0},y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},this.getHeader())),y.a.createElement(E.a,{style:{flex:7}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"space-between",paddingVertical:10}},y.a.createElement(C.a,{disabled:"read"===p||""!==f,style:{backgroundColor:"rgba(255,255,255,0.4)",justifyContent:"center",padding:10,height:"100%"},onPress:function(){return e.setState({show_date_picker:!n})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},pn(r))),y.a.createElement(C.a,{disabled:"read"===p||""!==f,style:{backgroundColor:"rgba(255,255,255,0.4)",justifyContent:"center",padding:10,height:"100%"},onPress:function(){return e.setState({show_time_picker:!a})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},yn(s)))),"\u85e5\u7c89"===f?y.a.createElement(So,{"\u85e5\u7c89":i,width:u,height:d,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u7c89",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u7c89")}}):"\u85e5\u6c34"===f?y.a.createElement(Co,{"\u85e5\u6c34":o,width:u,height:d,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u6c34",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u6c34")}}):"\u85e5\u818f"===f?y.a.createElement(Do,{"\u85e5\u818f":c,width:u,height:d,onFinishEdit:function(t){return e.onFinishEdit("\u85e5\u818f",t)},onCancelSelect:function(){return e.onCancelSelect("\u85e5\u818f")}}):y.a.createElement(E.a,{style:{flex:4}},y.a.createElement(E.a,{style:{flex:3,backgroundColor:"rgba(255,255,255,0.4)"}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{disabled:"read"===p,style:{flex:1,backgroundColor:i?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:14,marginTop:14,marginRight:7,marginBottom:7},onLayout:function(t){var n=t.nativeEvent.layout,a=n.width,r=n.height;e.setState({optionButtonWidth:a,optionButtonHeight:r})},underlayColor:"#ff8944",onPress:function(){return e.setState({show_editor:"\u85e5\u7c89","\u85e5\u7c89":i||1})}},i?y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u7c89: ",i," \u5305"):y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u7c89")),y.a.createElement(C.a,{disabled:"read"===p,style:{flex:1,backgroundColor:this.state.need_refrigeration?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:7,marginTop:14,marginRight:14,marginBottom:7},underlayColor:"#ff8944",onPress:function(){return e.setState({need_refrigeration:!e.state.need_refrigeration})}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u54c1\u9700\u51b7\u85cf"))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row"}},y.a.createElement(C.a,{disabled:"read"===p,style:{flex:1,backgroundColor:o?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:14,marginTop:7,marginRight:7,marginBottom:14},onPress:function(){return e.setState({show_editor:"\u85e5\u6c34","\u85e5\u6c34":o||0})}},o?y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u85e5\u6c34: ",o," c.c."):y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u6c34")),y.a.createElement(C.a,{disabled:"read"===p,style:{flex:1,backgroundColor:c?"#ff8944":"#ffddb7",justifyContent:"center",marginLeft:7,marginTop:7,marginRight:14,marginBottom:14},onPress:function(){return e.setState({show_editor:"\u85e5\u818f"})}},c?y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u85e5\u818f\u90e8\u4f4d: ",c):y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u85e5\u818f")))),y.a.createElement(E.a,{style:{backgroundColor:"#b5e9e9"}},y.a.createElement(Hn.a,{editable:"read"!==p,placeholder:"\u5099\u8a3b",placeholderTextColor:"grey",value:l,style:{backgroundColor:"#eaf8f8",borderRadius:3,fontSize:20,padding:20},onChangeText:function(t){return e.setState({note:t})}}))),void 0!==this.props.request&&this.props.request.administered?y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:30}},"\u5582\u85e5\u8001\u5e2b: ",this.props.request.teacher_name)):y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",paddingVertical:10}},y.a.createElement(E.a,{style:{flex:1,marginHorizontal:7}},"edit"===p?y.a.createElement(C.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.deleteRequestConfirm()}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},"\u522a\u9664")):null),y.a.createElement(E.a,{style:{flex:1,marginHorizontal:7}},"edit"===p?y.a.createElement(C.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.setState({access_mode:"read"})}},y.a.createElement(b.a,{style:{fontSize:17,textAlign:"center"}},"\u53d6\u6d88\u7de8\u8f2f")):null),y.a.createElement(E.a,{style:{flex:1,marginHorizontal:7}},y.a.createElement(C.a,{disabled:""!==f,style:{height:"100%",padding:10,justifyContent:"center",backgroundColor:"rgba(255,255,255,0.4)"},onPress:function(){return e.handleClickConfirmButton()}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"read"===p?"\u7de8\u8f2f":"create"===p?"\u65b0\u589e":"edit"===p?"\u9001\u51fa":null))))))}}])}(y.a.Component);function Ao(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Oo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Ro=Sa.a.get("window").width,jo=function(e){u()(n,e);var t=Oo(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={today:new Date,tomorrow:new Date,SlideInRight:new Ji.a.Value(0),SlideInLeft:new Ji.a.Value(0),total_height:1,total_width:1,height:0,width:0,left:0,top:0,requests:[],day_of_week:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],selected_request_index:-1},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.route.params.selected_request_index,t=this.state.tomorrow;t.setDate(t.getDate()+1),this.setState({tomorrow:t}),this.fetchMedicationRequest(),this.initializePage(),void 0!==e&&this.selectRequest(e)}},{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"fetchMedicationRequest",value:function(){var e,t,n,a,s,i,o,c;return r.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(this.props.isConnected){l.next=4;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),l.abrupt("return");case 4:return e=this.props.route.params,t=e.student_id,n=e.onGoBack,a=fn(new Date),l.next=8,r.a.awrap(_n("/medicationrequest/student/"+t+"?date="+a));case 8:if(s=l.sent,i=s.success,s.statusCode,o=s.message,c=s.data,i){l.next=13;break}return alert("Sorry \u53d6\u5f97\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u6216\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o),l.abrupt("return");case 13:this.denormalize(c),this.setState({requests:c}),n();case 16:case"end":return l.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){for(var t=0;t<e.length;t++){e[t].title=new Date(e[t].title);for(var n=0;n<e[t].data.length;n++)e[t].data[n].timestamp=new Date(e[t].data[n].timestamp)}}},{key:"initializePage",value:function(){Ji.a.sequence([Ji.a.timing(this.state.SlideInRight,{toValue:1,duration:1e3,useNativeDriver:!0}),Ji.a.timing(this.state.SlideInLeft,{toValue:1,duration:1e3,useNativeDriver:!0})]).start()}},{key:"viewRequest",value:function(){var e=this;this.setState({SlideInLeft:new Ji.a.Value(0)},(function(){Ji.a.timing(e.state.SlideInLeft,{toValue:1,duration:1e3,useNativeDriver:!0}).start()}))}},{key:"selectRequest",value:function(e){"edit"!==this.refs.main.fetchAccessMode()?this.setState({selected_request_index:e}):alert("\u9084\u5728\u7de8\u8f2f\u4e2d\u5594\u8acb\u5b8c\u6210\u518d\u96e2\u958b \u591a\u8b1d")}},{key:"onCreateRequestSuccess",value:function(e){var t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.awrap(this.fetchMedicationRequest());case 2:t=this.state.requests,this.get_todays_requests(t),n=-1,a=0;case 6:if(!(a<t.length)){s.next=13;break}if(t[a].id!==e){s.next=10;break}return n=a,s.abrupt("break",13);case 10:a++,s.next=6;break;case 13:this.setState({selected_request_index:n});case 14:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"get_todays_requests",value:function(e){for(var t=[],n=0;n<e.length;n++){var a=new Date(e[n].timestamp);if(a.toDateString()!==(new Date).toDateString())break;e[n].timestamp=a,t.push(e[n])}this.props.getMedRequestSuccess(t)}},{key:"onDeleteRequestSuccess",value:function(e){for(var t=this.state.requests,n=[],a=0;a<t.length;a++)t[a].id!==e&&n.push(t[a]);this.setState({requests:n,selected_request_index:0}),this.get_todays_requests(n)}},{key:"deleteRequestConfirm",value:function(e){confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest(e)}},{key:"deleteRequest",value:function(e){var t=this;if(this.props.isConnected){var n=this.props.route.params.class_id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/medicationrequest/"+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:n})}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,a=e.message;e.data;n>200||"Internal Server Error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):t.fetchMedicationRequest()})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))}else alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"render",value:function(){var e=this,t=this.state,n=(t.SlideInRight,t.SlideInLeft,t.total_width,t.requests),a=(t.today,t.tomorrow,t.day_of_week),r=(t.selected_request_index,this.props.route.params),s=r.student_id,i=r.class_id;return y.a.createElement(E.a,{style:{flex:1,paddingHorizontal:20}},0===n.length&&y.a.createElement(E.a,{style:{padding:20,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:50}},"\u7121\u6258\u85e5\u55ae")),y.a.createElement(bo.a,{sections:n,keyExtractor:function(e,t){return e+t},renderItem:function(t){var n=t.item,a=t.index,r=t.section;return y.a.createElement(E.a,{style:{width:"100%",aspectRatio:5,flexDirection:"row",marginVertical:7,justifyContent:"space-between",alignItems:"center"}},y.a.createElement(zr.a,{style:{width:"65%",height:"100%",padding:20,backgroundColor:"#368cbf",borderRadius:40,justifyContent:"center",alignItems:"center"},onClick:function(){return e.props.navigation.push("AddMedicationRequestPage",{onGoBack:function(){return e.fetchMedicationRequest()},student_id:s,class_id:i,index:a,data:r.data})}},y.a.createElement(b.a,{style:{fontSize:30}},yn(n.timestamp))),y.a.createElement(zr.a,{style:{width:"30%",height:"100%",padding:20,backgroundColor:"#fa625f",justifyContent:"center",borderRadius:40},onClick:function(){return e.deleteRequestConfirm(n.id)}},y.a.createElement(b.a,{style:{fontSize:.07*Ro,textAlign:"center"}},"\u522a\u9664")))},renderSectionHeader:function(t){var n=t.section.title;return y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"rgba(0,0,0,0.5)",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:e.isIOS()?20:12,marginTop:15,marginBottom:7,borderRadius:40}},y.a.createElement(b.a,{style:{fontSize:30,color:"white"}},""+hn(n)),y.a.createElement(b.a,{style:{fontSize:30,color:"white"}},"\u661f\u671f"+a[n.getDay()]))}}),y.a.createElement(E.a,{style:{width:"100%",paddingVertical:10,justifyContent:"center",backgroundColor:"transparent"}},y.a.createElement(zr.a,{style:{backgroundColor:"#f4d41f",padding:this.isIOS()?20:12,justifyContent:"center",borderRadius:40},onClick:function(){return e.props.navigation.push("AddMedicationRequestPage",{onGoBack:function(){return e.fetchMedicationRequest()},student_id:s,class_id:i,index:-1,data:null})}},y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},"\u65b0\u589e"))))}}]),n}(y.a.Component),To=Object(k.b)((function(e){return{isConnected:e.parent.isConnected}}),(function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ao(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ao(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(D.a)({getMedRequestSuccess:Oi},e))}))(jo);function Po(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Io=Sa.a.get("window"),zo=Io.width,Lo=Io.height,Mo=[{value:"\u611f\u5192",label:"\u611f\u5192"},{value:"\u6d41\u611f",label:"\u6d41\u611f"},{value:"\u8178\u75c5\u6bd2",label:"\u8178\u75c5\u6bd2"},{value:"\u6c34\u75d8",label:"\u6c34\u75d8"},{value:"\u8178\u80c3\u708e",label:"\u8178\u80c3\u708e"},{value:"\u5176\u4ed6",label:"\u5176\u4ed6"},{value:"Cancel",label:"\u8fd4\u56de"}],Fo=function(e){u()(n,e);var t=Po(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).handleSelectStatus=function(e){"Cancel"===e?a.setState({showSelect:!1}):"\u5176\u4ed6"===e?a.setState({editing_other_option:!0,excuse_type:"\u5176\u4ed6",showSelect:!1}):a.setState({excuse_type:e,showSelect:!1})},a.state={max_date:(new Date).setDate((new Date).getDate()+30),cached_date:null,startDate:new Date,endDate:new Date,show_start_date_picker:!1,show_end_date_picker:!1,showSelect:!1,childIsSick:0,excuse_type:"none-medical",editing_other_option:!1,days:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],months:["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"],access_mode:"create",note:"",absence_time:"all_day",scrollHeight:"100%",request_id:""},a.setStartDate=a.setStartDate.bind(_()(a)),a.setEndDate=a.setEndDate.bind(_()(a)),a.setChildNotSick=a.setChildNotSick.bind(_()(a)),a.setChildSick=a.setChildSick.bind(_()(a)),a.onValueChange=a.onValueChange.bind(_()(a)),a.sendAbsenceNote=a.sendAbsenceNote.bind(_()(a)),a}return c()(n,[{key:"componentDidUpdate",value:function(e){if(e.request!==this.props.request){var t=this.props.request;if(!t)return void this.setState({startDate:new Date,endDate:new Date,childIsSick:0,excuse_type:"none-medical",note:"",absence_time:"all_day",access_mode:"create",cached_date:null,scrollHeight:"100%",request_id:""});var n=t.id,a=t.date,r=t.excuse_type,s=t.note,i=t.absence_time;this.setState({startDate:a,endDate:null,childIsSick:"none-medical"===r?0:1,excuse_type:r,note:s,absence_time:i,access_mode:"read",cached_date:null,request_id:n})}}},{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"fetchAccessMode",value:function(){return this.state.access_mode}},{key:"showSelect",value:function(){this.setState({childIsSick:1,showSelect:!0})}},{key:"setChildSick",value:function(){this.setState({childIsSick:1})}},{key:"setChildNotSick",value:function(){"read"!==this.state.access_mode&&this.setState({childIsSick:0,excuse_type:"none-medical"})}},{key:"editorOnBlur",value:function(){var e=this.state.excuse_type;this.setState({editing_other_option:!1,childIsSick:""===e?0:1,excuse_type:""===e?"none-medical":e})}},{key:"setStartDate",value:function(e){"ios"===Wn.a.OS?this.iosSetStartDate(e):this.androidSetStartDate(e)}},{key:"iosSetStartDate",value:function(e){var t=this.state.endDate;if("edit"===this.state.access_mode){var n=this.state,a=n.cached_date,r=n.startDate;this.setState({cached_date:null===a?r:a,startDate:e})}else this.setState({startDate:e,endDate:e<t?t:e})}},{key:"androidSetStartDate",value:function(e){if(void 0!==e){var t=this.state.endDate;if("edit"===this.state.access_mode){var n=this.state,a=n.cached_date,r=n.startDate,s=this.props.request.id;this.setState({cached_date:null===a?r:a,startDate:e,show_start_date_picker:!1}),this.props.checkUniqueStudentDate(s,e)}else this.setState({startDate:e,endDate:e<t?t:e,show_start_date_picker:!1})}else this.setState({show_start_date_picker:!1})}},{key:"onEndEditingStartDate",value:function(){var e=this.state.startDate;if("edit"===this.state.access_mode){var t=this.props.request.id;this.props.checkUniqueStudentDate(t,e)}this.setState({show_start_date_picker:!1})}},{key:"duplicateDateFound",value:function(){var e=this.state.cached_date;this.setState({startDate:e,cached_date:null})}},{key:"setEndDate",value:function(e){"ios"===Wn.a.OS?this.iosSetEndDate(e):this.androidSetEndDate(e)}},{key:"iosSetEndDate",value:function(e){var t=this.state.startDate;this.setState({startDate:e<t?e:t,endDate:e})}},{key:"androidSetEndDate",value:function(e){if(void 0!==e){var t=this.state.startDate;this.setState({startDate:e<t?e:t,endDate:e,show_end_date_picker:!1})}else this.setState({show_end_date_picker:!1})}},{key:"getDayDifference",value:function(){var e=this.state,t=e.startDate,n=e.endDate;return Math.round(Math.abs((n-t)/864e5))+1}},{key:"onValueChange",value:function(e){this.setState({excuse_type:e})}},{key:"setScrollHeight",value:function(e){this.setState({scrollHeight:e})}},{key:"handleClickConfirmButton",value:function(){var e=this.state.access_mode;if("read"===e)this.setState({access_mode:"edit"});else if("create"===e)this.sendAbsenceNote();else if("edit"===e){var t=this.props.request.id;this.editAbsenceNote(t)}}},{key:"sendAbsenceNote",value:function(){var e=this,t=this.state,n=t.excuse_type,a=t.note,r=t.absence_time,s=this.props,i=s.student_id,o=s.class_id,c=s.school_id,l=s.isConnected,u={student_id:i,class_id:o,school_id:c,startDate:fn(this.state.startDate),endDate:fn(this.state.endDate),excuse_type:n,note:a,absence_time:r};l?fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/absence-excuse",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(u)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,a=t.message,r=t.data;n>200||"Internal server error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01 \u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):e.props.onCreateRequestSuccess(r.id)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01 \u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending absence request")})):alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"editAbsenceNote",value:function(e){var t=this,n=this.state,a=n.excuse_type,r=n.note,s=n.absence_time,i=this.props.class_id,o=fn(this.state.startDate);fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/absence-excuse",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:e,excuse_type:a,note:r,date:o,class_id:i,absence_time:s})}).then((function(e){return e.json()})).then((function(n){var a=n.statusCode,r=n.message;n.data;a>200||"Internal server error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):t.props.onCreateRequestSuccess(e)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when editing absence request")}))}},{key:"deleteRequestConfirm",value:function(){confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest()}},{key:"deleteRequest",value:function(){var e=this,t=this.props.request.id;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/absence-excuse",{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({request_id:t})}).then((function(e){return e.json()})).then((function(n){var a=n.statusCode,r=n.message;n.data;a>200||"Internal server error"===r?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+r):e.props.onDeleteRequestSuccess(t)})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting absence request")}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.max_date,a=t.access_mode,r=t.startDate,s=t.endDate,i=t.excuse_type,o=t.editing_other_option,c=t.note,l=t.show_start_date_picker,u=t.show_end_date_picker,d=t.showSelect,f=t.absence_time,p=t.scrollHeight,h=t.request_id;return l?y.a.createElement(E.a,{style:{height:Lo,marginTop:-120}},y.a.createElement(Da,{start_date:r,datetime_type:"date",hideModal:function(){return e.setState({show_start_date_picker:!1})},selectDatetimeConfirm:function(t){return e.setStartDate(t)},minDatetime:new Date,maxDatetime:n,paddingVertical:100})):u?y.a.createElement(E.a,{style:{height:Lo,marginTop:-120}},y.a.createElement(Da,{start_date:s,datetime_type:"date",hideModal:function(){return e.setState({show_end_date_picker:!1})},selectDatetimeConfirm:function(t){return e.setEndDate(t)},minDatetime:new Date,maxDatetime:n,paddingVertical:100})):d?y.a.createElement(E.a,{style:{padding:30,height:"100%",alignItems:"center"}},Mo.map((function(t,n){var a=t.label,r=t.value;return y.a.createElement(zr.a,{key:n,style:{width:"50%",padding:15,backgroundColor:"white",borderWidth:1,borderColor:"lightgrey"},onClick:function(){return e.handleSelectStatus(r)}},y.a.createElement(b.a,{style:{fontSize:25}},a))}))):y.a.createElement(E.a,{style:{paddingHorizontal:30,paddingVertical:30,height:"100%"}},y.a.createElement(E.a,{style:{flexDirection:"row"}},y.a.createElement(zr.a,{disabled:"read"===a,style:{flex:1,padding:15,justifyContent:"center",backgroundColor:0===this.state.childIsSick?"#368cbf":"rgba(0,0,0,0.1)",borderTopLeftRadius:30,borderBottomLeftRadius:30},underlayColor:"#368cbf",onClick:this.setChildNotSick},y.a.createElement(b.a,{style:{fontSize:25,color:0===this.state.childIsSick?"white":"black",textAlign:"center"}},"\u4e8b\u5047")),o?y.a.createElement(E.a,{style:{flex:1,padding:15,borderTopRightRadius:30,borderBottomRightRadius:30,justifyContent:"center",backgroundColor:this.state.childIsSick?"#368cbf":"rgba(0,0,0,0.1)"}},y.a.createElement(Hn.a,{autoFocus:!0,selectTextOnFocus:!0,style:{fontSize:25,color:this.state.childIsSick?"white":"black",textAlign:"center",paddingVertical:-1},value:i,onChangeText:function(t){return e.setState({excuse_type:t})},onBlur:function(){return e.editorOnBlur()}})):y.a.createElement(Gn,{style:{flex:1,padding:15,borderTopRightRadius:30,borderBottomRightRadius:30,justifyContent:"center",backgroundColor:0===this.state.childIsSick?"rgba(0,0,0,0.1)":"#368cbf"},disabled:"read"===a,textStyle:{fontSize:25,color:this.state.childIsSick?"white":"black",textAlign:"center"},selectedValue:"none-medical"===i?"\u75c5\u5047":i,showSelect:function(){return e.showSelect()},handleOnClick:this.setChildSick,handleSelectValue:function(t){return e.handleSelectStatus(t)}})),y.a.createElement(E.a,{style:{width:"100%"}},null===s?y.a.createElement(E.a,{style:{paddingVertical:20,width:"70%",alignSelf:"center"}},y.a.createElement(zr.a,{disabled:"read"===a,style:{backgroundColor:"rgba(0,0,0,0.4)"},onClick:function(){"read"!==a&&e.setState({show_start_date_picker:!0})}},y.a.createElement(E.a,{style:{padding:15,justifyContent:"center"}},y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{color:"white",fontSize:.12*zo,fontWeight:"bold"}},r.getFullYear())),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{color:"white",fontSize:.12*zo,fontWeight:"bold"}},r.getMonth()+1,"/",r.getDate())),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:.12*zo,color:"white",fontWeight:"bold"}},"\u661f\u671f",this.state.days[r.getDay()]))))):y.a.createElement(E.a,{style:{alignItems:"center",paddingVertical:15}},y.a.createElement(E.a,{style:{width:"100%"}},y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.4)",fontSize:.1*zo}},"\u958b\u59cb"),y.a.createElement(zr.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",padding:15},onClick:function(){return e.setState({show_start_date_picker:!0})}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},y.a.createElement(b.a,{style:{color:"white",fontSize:.09*zo,fontWeight:"bold"}},hn(r)),y.a.createElement(b.a,{style:{fontSize:.09*zo,color:"white",fontWeight:"bold"}},"\u661f\u671f",this.state.days[r.getDay()])))),y.a.createElement(E.a,{style:{width:"100%",alignItems:"center",justifyContent:"center",padding:20}},y.a.createElement(b.a,{style:{fontSize:25}},"\u7e3d\u8a08 ",this.getDayDifference()," \u5929")),y.a.createElement(E.a,{style:{width:"100%"}},y.a.createElement(zr.a,{style:{backgroundColor:"rgba(0,0,0,0.4)",padding:15},onClick:function(){return e.setState({show_end_date_picker:!0})}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}},y.a.createElement(b.a,{style:{color:"white",fontSize:.09*zo,fontWeight:"bold"}},hn(s)),y.a.createElement(b.a,{style:{fontSize:.09*zo,color:"white",fontWeight:"bold"}},"\u661f\u671f",this.state.days[s.getDay()]))),y.a.createElement(b.a,{style:{color:"rgba(0,0,0,0.4)",fontSize:.1*zo,textAlign:"right"}},"\u7d50\u675f"))),y.a.createElement(E.a,{style:{flex:1,width:"100%",alignItems:"center"}},y.a.createElement(Hn.a,{key:h,editable:"read"!==a,placeholder:"\u5099\u8a3b",placeholderTextColor:"grey",multiline:!0,scrollEnabled:!1,value:c,style:{width:"100%",height:p,backgroundColor:"#eaf8f8",borderRadius:3,fontSize:25,paddingTop:20,paddingBottom:20,paddingHorizontal:20,textAlignVertical:"center"},onChangeText:function(t){return e.setState({note:t})},onChange:function(t){return e.setScrollHeight(t.target.scrollHeight)},onLayout:function(t){var n=t.nativeEvent.target.scrollHeight;e.setState({scrollHeight:n})}})),y.a.createElement(E.a,{style:{flex:1,width:"100%",alignItems:"center",flexDirection:"row",justifyContent:"space-between"}},y.a.createElement(zr.a,{disabled:"read"===a,style:{flex:1,paddingVertical:15,justifyContent:"center"},underlayColor:"transparent",onClick:function(){"read"!==a&&e.setState({absence_time:"all_day"})}},y.a.createElement(b.a,{style:{width:"90%",fontSize:25,backgroundColor:"all_day"===f?"#368cbf":"rgba(0,0,0,0.1)",color:"all_day"===f?"white":"black",padding:15,textAlign:"center"}},"\u5168\u5929")),y.a.createElement(zr.a,{disabled:"read"===a,style:{flex:1,paddingVertical:10,justifyContent:"center",alignItems:"center"},underlayColor:"transparent",onClick:function(){"read"!==a&&e.setState({absence_time:"morning"})}},y.a.createElement(b.a,{style:{width:"90%",fontSize:25,backgroundColor:"morning"===f?"#368cbf":"rgba(0,0,0,0.1)",color:"morning"===f?"white":"black",padding:15,textAlign:"center"}},"\u65e9\u4e0a")),y.a.createElement(zr.a,{disabled:"read"===a,style:{flex:1,paddingVertical:10,justifyContent:"center",alignItems:"flex-end"},underlayColor:"transparent",onClick:function(){"read"!==a&&e.setState({absence_time:"evening"})}},y.a.createElement(b.a,{style:{width:"90%",fontSize:25,backgroundColor:"evening"===f?"#368cbf":"rgba(0,0,0,0.1)",color:"evening"===f?"white":"black",padding:15,textAlign:"center"}},"\u4e0b\u5348"))),y.a.createElement(E.a,{style:{marginVertical:20,width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"center"}},"edit"!==a?y.a.createElement(zr.a,{style:{width:"100%",padding:20,justifyContent:"center",backgroundColor:"rgba(0,0,0,0.1)"},onClick:function(){return e.handleClickConfirmButton()}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"read"===a?"\u7de8\u8f2f":"create"===a?"\u65b0\u589e":null)):"edit"===a?y.a.createElement(E.a,{style:{width:"100%",flex:1,flexDirection:"row"}},y.a.createElement(zr.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"#fa625f"},onClick:function(){return e.deleteRequestConfirm()}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u522a\u9664")),y.a.createElement(zr.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"rgba(0,0,0,0.1)"},onClick:function(){return e.setState({access_mode:"read"})}},y.a.createElement(b.a,{style:{fontSize:20,textAlign:"center"}},"\u53d6\u6d88\u7de8\u8f2f")),y.a.createElement(zr.a,{style:{flex:1,paddingVertical:20,paddingHorizontal:10,justifyContent:"center",backgroundColor:"#00c07f"},onClick:function(){return e.handleClickConfirmButton()}},y.a.createElement(b.a,{style:{fontSize:25,textAlign:"center"}},"\u9001\u51fa"))):null)))}}]),n}(y.a.Component),Bo=(ue.a.create({dateContainer:{flex:1,width:"35%",justifyContent:"center"}}),Object(k.b)((function(e){return{isConnected:e.parent.isConnected}}),null,null,{forwardRef:!0})(Fo));function qo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}Sa.a.get("window").height;var No=function(e){u()(n,e);var t=qo(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={todays_date:fn(new Date),SlideInRight:new Ji.a.Value(0),SlideInLeft:new Ji.a.Value(0),total_height:1,total_width:1,height:0,width:0,left:0,top:0,requests:[],day_of_week:["\u5929","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],selected_request_index:-1},a}return c()(n,[{key:"componentDidMount",value:function(){this.props.isConnected?(this.fetchAbsenceExcuse(),this.initializePage()):alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"fetchAbsenceExcuse",value:function(){var e,t,n,a=this;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=this.props.route.params.student_id,t=fn(new Date),n="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/absence-excuse/student/"+e+"?date="+t,s.next=5,r.a.awrap(fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){var t=e.statusCode,n=e.message,r=e.data;t>200||"Internal server error"===n?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+n):(a.denormalize(r),a.setState({requests:r}))})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when fetching absence request")})));case 5:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"denormalize",value:function(e){for(var t=0;t<e.length;t++)e[t].date=new Date(e[t].date)}},{key:"initializePage",value:function(){Ji.a.sequence([Ji.a.timing(this.state.SlideInRight,{toValue:1,duration:1e3,useNativeDriver:!0}),Ji.a.timing(this.state.SlideInLeft,{toValue:1,duration:1e3,useNativeDriver:!0})]).start()}},{key:"selectRequest",value:function(e){"edit"!==this.refs.main.fetchAccessMode()?this.setState({selected_request_index:e}):alert("\u9084\u5728\u7de8\u8f2f\u4e2d\u5594\u8acb\u5b8c\u6210\u518d\u96e2\u958b \u591a\u8b1d")}},{key:"onCreateRequestSuccess",value:function(e){var t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.awrap(this.fetchAbsenceExcuse());case 2:t=this.state.requests,n=-1,a=0;case 5:if(!(a<t.length)){s.next=12;break}if(t[a].id!==e){s.next=9;break}return n=a,s.abrupt("break",12);case 9:a++,s.next=5;break;case 12:this.setState({selected_request_index:n});case 13:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"onDeleteRequestSuccess",value:function(e){for(var t=this.state.requests,n=[],a=0;a<t.length;a++)t[a].id!==e&&n.push(t[a]);this.setState({requests:n,selected_request_index:0})}},{key:"checkUniqueStudentDate",value:function(e,t){for(var n=this.state.requests,a=!1,r=0;r<n.length;r++)if(e!==n[r].id&&fn(t)===fn(n[r].date)){a=!0;break}a&&(alert("\u5df2\u7d93\u5728\u9019\u500b\u65e5\u671f\u8acb\u904e\u5047\u4e86"),this.refs.main.duplicateDateFound())}},{key:"render",value:function(){var e=this,t=this.state,n=t.SlideInRight,a=(t.SlideInLeft,t.total_width),r=t.requests,s=t.todays_date,i=t.day_of_week,o=t.selected_request_index,c=this.props.route.params,l=c.student_id,u=c.class_id,d=c.school_id,f=r[o];return y.a.createElement(Un.a,{style:{flex:1,width:"100%",alignItems:"center"},behavior:"padding",keyboardVerticalOffset:85,enabled:!0},y.a.createElement(Rn.a,{style:{width:"100%"}},y.a.createElement(E.a,{style:{width:"100%"}},y.a.createElement(Rn.a,{horizontal:!0,showsHorizontalScrollIndicator:!1},r.map((function(t,r){var c=i[t.date.getDay()],l=t.date.getMonth()+1+"/"+t.date.getDate();return y.a.createElement(Ji.a.View,{key:t.id,style:{padding:10,transform:[{translateX:n.interpolate({inputRange:[0,1],outputRange:[a,0]})}]}},y.a.createElement(zr.a,{style:{height:100,width:100,padding:10,backgroundColor:o===r?"#368cbf":"rgba(0,0,0,0.2)",borderRadius:10},underlayColor:"#368cbf",onClick:function(){return e.selectRequest(r)}},y.a.createElement(E.a,null,fn(t.date)===s?y.a.createElement(b.a,{style:{fontSize:20,color:o===r?"white":"black"}},"\u4eca\u5929"):y.a.createElement(b.a,{style:{fontSize:20,color:o===r?"white":"black"}},"\u661f\u671f",c),y.a.createElement(b.a,{style:{fontSize:20,color:o===r?"white":"black"}},l))))})),y.a.createElement(Ji.a.View,{style:{padding:10,transform:[{translateX:n.interpolate({inputRange:[0,1],outputRange:[a,0]})}]}},y.a.createElement(zr.a,{style:{height:100,width:100,padding:10,backgroundColor:-1===o?"#368cbf":"rgba(0,0,0,0.2)",borderRadius:10},underlayColor:"#ff8944",ref:"welrnf",onClick:function(){return e.selectRequest(-1)}},y.a.createElement(E.a,null,y.a.createElement(b.a,{style:{fontSize:20,color:-1===o?"white":"black"}},"\u65b0\u589e")))))),y.a.createElement(E.a,{style:{width:"100%",borderRadius:40,backgroundColor:"#b5e9e9"}},y.a.createElement(Bo,{ref:"main",student_id:l,class_id:u,school_id:d,request:f,onCreateRequestSuccess:function(t){return e.onCreateRequestSuccess(t)},onDeleteRequestSuccess:function(t){return e.onDeleteRequestSuccess(t)},checkUniqueStudentDate:function(t,n){return e.checkUniqueStudentDate(t,n)}}))))}}]),n}(y.a.Component),Uo=Object(k.b)((function(e){return{isConnected:e.parent.isConnected}}))(No);function Ho(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Wo=Sa.a.get("window"),Vo=Wo.width,Ko=Wo.height,Go=function(e){u()(n,e);var t=Ho(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={time:null,provided_times:["5","10","15","20","25"],colors:["#ffe1d0","#ffddb7","#fff1b5","#dcf3d0","#b5e9e9"],hightlighted_colors:["#fa625f","#ff8944","#f4d41f","#00c07f","#368cbf"],choose_other_option:!1,total_height:Ko-55,total_width:Vo},a.sendRequest=a.sendRequest.bind(_()(a)),a}return c()(n,[{key:"onBlur",value:function(){var e=this.state,t=e.time,n=e.choose_other_option,a=e.provided_times;n&&(""===t||a.includes(t))&&this.setState({choose_other_option:!1})}},{key:"sendRequest",value:function(){var e=this;if(this.props.isConnected){var t=this.props.route.params,n=t.child_id,a=t.school_id,r="https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/attendance/pickup-request",s=n,i=new Date;i.setMinutes(i.getMinutes()+parseInt(this.state.time));var o={school_id:a,student_id:s,arrival_time:fn(i)+" "+mn(i)};fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)}).then((function(e){return e.json()})).then((function(t){var n=t.statusCode,a=t.message;n>200||"Internal server error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b "+a):e.props.navigation.goBack()})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when sending pickup request")}))}else alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"render",value:function(){var e=this,t=this.state,n=t.time,a=t.provided_times,r=t.colors,s=t.hightlighted_colors,i=t.choose_other_option,o=t.total_height,c=t.total_width;return y.a.createElement(Un.a,{style:{flex:1},behavior:"padding",keyboardVerticalOffset:100,enabled:!0},y.a.createElement(Rn.a,null,y.a.createElement(E.a,{style:{flex:3,flexDirection:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center"}},a.map((function(t,a){return y.a.createElement(E.a,{key:a,style:{width:"50%",height:.28*o,backgroundColor:n==t?s[a]:r[a],alignItems:"center",justifyContent:"center"}},y.a.createElement(zr.a,{style:{width:"90%",height:"90%",borderWidth:n==t?5:0,borderColor:"white",backgroundColor:n==t?s[a]:r[a]},underlayColor:s[a],onClick:function(){return e.setState({time:t,choose_other_option:!1})}},y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:.2*c}},t),y.a.createElement(b.a,{style:{fontSize:.09*c}},"\u5206\u9418"))))})),y.a.createElement(E.a,{style:{width:"50%",height:.28*o,alignItems:"center",justifyContent:"center",backgroundColor:i?"black":"white"}},y.a.createElement(zr.a,{style:{flexDirection:"row",width:"90%",height:"90%",backgroundColor:i?"black":"white",borderWidth:i?5:0,borderColor:"white",alignItems:"center",justifyContent:"center"},onClick:function(){return e.setState({choose_other_option:!0,time:""})}},i?y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center",width:"100%"}},y.a.createElement(Hn.a,{autoFocus:!0,selectTextOnFocus:!0,onBlur:function(){return e.onBlur()},keyboardType:"numeric",value:n+"",style:{fontSize:.2*c,color:"white",width:"100%"},onChangeText:function(t){e.setState({time:t})}}),y.a.createElement(b.a,{style:{fontSize:.09*c,color:"white"}},"\u5206\u9418")):y.a.createElement(b.a,{style:{fontSize:50}},"\u5176\u4ed6")))),y.a.createElement(E.a,{style:{height:.16*o}},y.a.createElement(zr.a,{style:{flex:1,backgroundColor:"lightgrey",alignItems:"center",justifyContent:"center"},onClick:function(){return e.sendRequest()}},y.a.createElement(b.a,{style:{fontSize:50}},"\u9001\u51fa")))))}}]),n}(y.a.Component),Qo=Object(k.b)((function(e){return{isConnected:e.parent.isConnected}}))(Go);function Jo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Yo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jo(Object(n),!0).forEach((function(t){A()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xo(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var Zo=Sa.a.get("window").width,$o=function(e){u()(a,e);var t=Xo(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={isLoading:!0,request_id:null,today:new Date,showDateTimeModal:!1,datetime_type:"",time_array:[],time_selected_index:null,before_meal:null,powder:!1,powder_refrigerated:!1,syrup:[],gel:null,other_type:null,note:"",administered:!1,teacher_name:"",medicated_timestamp:null,fever_entry:{temperature:"",powder:!1,powder_refrigerated:!1,syrup:[],other_type:null},data:null,index:-1,access_mode:"create",scrollHeight:"100%",date_array:[],date_selected_index:null},n}return c()(a,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.index;null!==e.data?this.switchRequest(t):this.setState({date_array:[new Date],isLoading:!1})}},{key:"switchRequest",value:function(e){var t=this.props.route.params.data,n=t[e],a=n.id,r=n.timestamp,s=n.administered,i=n.fever_entry,o=n.medication,c=n.note,l=n.teacher_name,u=n.medicated_timestamp;this.setState(Yo(Yo({index:e,data:t,request_id:a,date_array:[r],time_array:[r]},o),{},{note:c,fever_entry:i,administered:s,teacher_name:l,medicated_timestamp:null!==u?new Date(u):null,access_mode:"read",isLoading:!1}))}},{key:"isIOS",value:function(){return"ios"===Wn.a.OS}},{key:"selectDatetimeConfirm",value:function(e){"date"===this.state.datetime_type?this.handleDateSelected(e):this.handleTimeSelected(e)}},{key:"handleDateSelected",value:function(e){var t=this.state,n=t.date_array,a=t.date_selected_index;if(null!==a){for(var r=[],s=0;s<n.length;s++)s!==a?r.push(n[s]):r.push(e);this.setState({date_array:r,date_selected_index:null,showDateTimeModal:!1})}else this.setState({date_array:[].concat(P()(n),[e]),showDateTimeModal:!1})}},{key:"handleTimeSelected",value:function(e){var t=this.state,n=t.time_array,a=t.time_selected_index;if(null!==a){for(var r=[],s=0;s<n.length;s++)s!==a?r.push(n[s]):r.push(e);this.setState({time_array:r,time_selected_index:null,showDateTimeModal:!1})}else this.setState({time_array:[].concat(P()(n),[e]),showDateTimeModal:!1})}},{key:"removeDate",value:function(e){var t=this.state.date_array;t.splice(e,1),this.setState({date_array:t})}},{key:"removeTime",value:function(e){var t=this.state.time_array;t.splice(e,1),this.setState({time_array:t})}},{key:"onSelectSyrup",value:function(){var e=this.state.syrup;this.setState({syrup:e.length?[]:[{amount:"",need_refrigerated:!1,note:""}]})}},{key:"editSyrupAmountEntry",value:function(e,t){var n=this.state.syrup;n[t].amount=e,this.setState({syrup:n})}},{key:"editSyrupNoteEntry",value:function(e,t){var n=this.state.syrup;n[t].note=e,this.setState({syrup:n})}},{key:"editSyrupRefrigerationEntry",value:function(e,t){var n=this.state.syrup;n[t].need_refrigerated=e,this.setState({syrup:n})}},{key:"removeSyrupEntry",value:function(e){var t=this.state.syrup;t.splice(e,1),this.setState({syrup:t})}},{key:"onSelectFeverSyrup",value:function(){var e=this.state.fever_entry;this.setState({fever_entry:Yo(Yo({},e),{},{syrup:e.syrup.length?[]:[{amount:"",need_refrigerated:!1}]})})}},{key:"editFeverSyrupAmountEntry",value:function(e,t){var n=this.state.fever_entry;n.syrup[t].amount=e,this.setState({fever_entry:n})}},{key:"editFeverSyrupRefrigerationEntry",value:function(e,t){var n=this.state.fever_entry;n.syrup[t].need_refrigerated=e,this.setState({fever_entry:n})}},{key:"removeFeverSyrupEntry",value:function(e){var t=this.state.fever_entry;t.syrup.splice(e,1),this.setState({fever_entry:t})}},{key:"timeIsEmpty",value:function(){return 0===this.state.time_array.length&&(alert("\u81f3\u5c11\u8981\u9078\u64c7\u4e00\u500b\u6642\u9593\uff01"),!0)}},{key:"sendRequest",value:function(){var e,t,n,a,s,i,o;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(this.props.isConnected){c.next=4;break}return alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b"),c.abrupt("return");case 4:return e=this.props.route.params,t=e.student_id,n=e.onGoBack,a=this.normalizedData(),c.next=8,r.a.awrap(En("/medicationrequest/student/"+t,a));case 8:if(s=c.sent,i=s.success,s.statusCode,o=s.message,s.data,i){c.next=13;break}return alert("Sorry \u9001\u51fa\u6258\u85e5\u55ae\u6642\u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b\n\n"+o),c.abrupt("return");case 13:this.setState({access_mode:"read"}),n(),this.props.navigation.goBack();case 16:case"end":return c.stop()}}),null,this,null,Promise)}},{key:"normalizedData",value:function(){var e=this.props.route.params.class_id,t=this.state,n=t.request_id,a=t.date_array,r=t.time_array,s=t.before_meal,i=t.powder,o=t.powder_refrigerated,c=t.syrup,l=t.gel,u=t.other_type,d=t.note,f=t.fever_entry;return{request_id:n,class_id:e,date_array:a.map((function(e){return fn(e)})),time_array:r.map((function(e){return mn(e)})),before_meal:s,powder:i,powder_refrigerated:o,syrup:c,gel:null===l?l:l.trim(),other_type:null===u?u:u.trim(),note:d.trim(),fever_entry:{temperature:f.temperature,powder:f.powder,powder_refrigerated:f.powder_refrigerated,syrup:f.syrup,other_type:null===f.other_type?f.other_type:f.other_type.trim()}}}},{key:"editable",value:function(){var e=this.state.date_array[0],t=new Date;t.setHours(10,0,0,0);var n=new Date;return n.setDate(n.getDate()+1),n.setHours(0,0,0,0),e.toDateString()===(new Date).toDateString()&&new Date<t||e.getTime()>n.getTime()}},{key:"onClickConfirm",value:function(){var e=this.state.access_mode;if("create"===e||"edit"===e){if(this.timeIsEmpty())return;this.sendRequest()}else this.setState({access_mode:"edit"})}},{key:"deleteRequestConfirm",value:function(){var e=this.state.request_id;confirm("\u78ba\u5b9a\u8981\u522a\u9664\uff1f")&&this.deleteRequest(e)}},{key:"deleteRequest",value:function(e){var t=this;if(this.props.isConnected){var n=this.props.route.params,a=n.class_id,r=n.onGoBack;fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/medicationrequest/"+e,{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({class_id:a})}).then((function(e){return e.json()})).then((function(e){var n=e.statusCode,a=e.message;e.data;n>200||"Internal Server Error"===a?alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b"+a):(r(),t.props.navigation.goBack())})).catch((function(e){alert("Sorry \u96fb\u8166\u51fa\u72c0\u6cc1\u4e86\uff01\u8acb\u622a\u5716\u548c\u8207\u5de5\u7a0b\u5e2b\u806f\u7e6b: error occurred when deleting medication request")}))}else alert("\u7db2\u8def\u9023\u4e0d\u5230! \u8acb\u7a0d\u5f8c\u518d\u8a66\u8a66\u770b")}},{key:"cancelEdit",value:function(){var e=this.state.index;this.switchRequest(e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.isLoading,r=t.time_array,s=t.showDateTimeModal,i=t.datetime_type,o=t.time_selected_index,c=t.before_meal,l=t.powder,u=t.powder_refrigerated,d=t.syrup,f=t.gel,p=t.other_type,h=t.note,m=t.fever_entry,g=t.administered,_=t.teacher_name,v=t.medicated_timestamp,S=t.data,w=t.access_mode,C=t.scrollHeight,k=t.date_array;t.date_selected_index;return a?y.a.createElement(Mn,null):y.a.createElement(Un.a,{style:{flex:1,width:"100%",alignItems:"center"},behavior:"padding",enabled:!0},s?y.a.createElement(Da,{start_date:null===o?new Date:r[o],datetime_type:i,hideModal:function(){return e.setState({showDateTimeModal:!1})},selectDatetimeConfirm:function(t){return e.selectDatetimeConfirm(t)},minDatetime:new Date,maxDatetime:(new Date).setDate((new Date).getDate()+7),minTime:(new Date).setHours(7,0,0),maxTime:(new Date).setHours(20,0,0),paddingVertical:100}):null,y.a.createElement(Rn.a,{style:{width:"100%"}},null!==S&&S.length>1&&y.a.createElement(E.a,{style:{width:"100%"}},y.a.createElement(Rn.a,{horizontal:!0,showsHorizontalScrollIndicator:!1},S.map((function(t,n){return y.a.createElement(E.a,{key:n,style:{padding:10}},y.a.createElement(zr.a,{key:t.id,style:{padding:10,backgroundColor:e.state.index===n?"#ffddb7":"rgba(0,0,0,0.5)",justifyContent:"center",borderRadius:30},underlayColor:"#ffddb7",onClick:function(){return e.switchRequest(n)}},y.a.createElement(b.a,{style:{fontSize:25,color:e.state.index===n?"grey":"white"}},yn(t.timestamp))))})))),y.a.createElement(E.a,{style:{backgroundColor:"white",borderTopRightRadius:30,borderTopLeftRadius:30}},g&&y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"white",padding:20}},y.a.createElement(b.a,{style:{fontSize:25}},"\u9935\u85e5\u8001\u5e2b\uff1a",_),y.a.createElement(b.a,{style:{fontSize:25}},"\u9935\u85e5\u6642\u9593\uff1a",yn(v)))),y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(E.a,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:"#ff8944",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30}},y.a.createElement(b.a,{style:{fontSize:25}},"\u65e5\u671f ")),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",width:"100%",backgroundColor:"white",padding:20,alignItems:"flex-start"}},y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w||"edit"===w,style:{width:"80%",paddingBottom:15},underlayColor:"transparent",onClick:function(){"read"!==w&&"edit"!==w&&e.setState({showDateTimeModal:!0,datetime_type:"date"})}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,paddingLeft:15}},y.a.createElement(b.a,{style:{fontSize:25}},"\u65e5\u671f")),"create"===w&&y.a.createElement(pe.a,{source:n(462),style:{width:32,height:32,alignSelf:"flex-end"}}))),k.map((function(t,a){return y.a.createElement(E.a,{key:a,style:{width:"90%",justifyContent:"center",flexDirection:"row",paddingBottom:10}},y.a.createElement(zr.a,{disabled:"read"===w,style:{width:"70%",backgroundColor:"#ffddb7",borderTopLeftRadius:15,borderBottomLeftRadius:15,justifyContent:"center"},underlayColor:"transparent",onClick:function(){"read"!==w&&e.setState({showDateTimeModal:!0,datetime_type:"date",date_selected_index:a})}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},hn(t))),y.a.createElement(zr.a,{disabled:"read"===w,style:{width:"30%",justifyContent:"center",padding:5,backgroundColor:"#ffddb7",borderBottomRightRadius:15,borderTopRightRadius:15},underlayColor:"transparent",onClick:function(){"read"!==w&&e.removeDate(a)}},y.a.createElement(pe.a,{source:n(219),style:{width:32,height:32}})))}))),y.a.createElement(E.a,{style:{flex:1,alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w||"edit"===w,style:{width:"80%",paddingBottom:15},underlayColor:"transparent",onClick:function(){"read"!==w&&"edit"!==w&&e.setState({showDateTimeModal:!0,datetime_type:"time"})}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(E.a,{style:{flex:1,paddingLeft:15}},y.a.createElement(b.a,{style:{fontSize:25}},"\u6642\u9593")),"create"===w&&y.a.createElement(pe.a,{source:n(462),style:{width:32,height:32,alignSelf:"flex-end"}}))),r.map((function(t,a){return y.a.createElement(E.a,{key:a,style:{width:"90%",justifyContent:"center",flexDirection:"row",paddingBottom:10}},y.a.createElement(zr.a,{disabled:"read"===w,style:{width:"70%",backgroundColor:"#ffddb7",borderTopLeftRadius:15,borderBottomLeftRadius:15,justifyContent:"center"},underlayColor:"transparent",onClick:function(){"read"!==w&&e.setState({showDateTimeModal:!0,datetime_type:"time",time_selected_index:a})}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},yn(t))),y.a.createElement(zr.a,{disabled:"read"===w,style:{width:"30%",justifyContent:"center",padding:5,backgroundColor:"#ffddb7",borderBottomRightRadius:15,borderTopRightRadius:15},underlayColor:"transparent",onClick:function(){"read"!==w&&e.removeTime(a)}},y.a.createElement(pe.a,{source:n(219),style:{width:32,height:32}})))})))),y.a.createElement(E.a,{style:{flex:1,flexDirection:"row",justifyContent:"center",alignItems:"center",paddingBottom:20}},y.a.createElement(zr.a,{disabled:"read"===w,style:{padding:15,borderWidth:1,borderColor:"grey",backgroundColor:null!==c&&c?"#ffddb7":"white"},underlayColor:"#ff8944",onClick:function(){"read"!==w&&e.setState({before_meal:!c||null})}},y.a.createElement(b.a,{style:{fontSize:25}},"\u9910\u524d")),y.a.createElement(zr.a,{disabled:"read"===w,style:{padding:15,borderWidth:1,borderLeftWidth:0,borderColor:"grey",backgroundColor:null===c||c?"white":"#ffddb7"},underlayColor:"#ff8944",onClick:function(){"read"!==w&&e.setState({before_meal:!1===c&&null})}},y.a.createElement(b.a,{style:{fontSize:25}},"\u9910\u5f8c")))),y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{width:"100%",justifyContent:"center",backgroundColor:"#00c07f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u85e5\u7269")),y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"white",paddingHorizontal:20}},y.a.createElement(E.a,{style:{backgroundColor:""}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingTop:20,paddingBottom:10},onClick:function(){"read"!==w&&e.setState({powder:!l})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:l?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginLeft:10,alignSelf:"center"}},"\u85e5\u7c89    "))),y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingTop:20,paddingBottom:10},onClick:function(){"read"!==w&&e.setState({powder_refrigerated:!u})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:u?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:5}},"\u9700\u51b7\u85cf"))))),y.a.createElement(E.a,{style:{backgroundColor:""}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingVertical:10},onClick:function(){"read"!==w&&e.onSelectSyrup()},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:d.length?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginLeft:10}},"\u85e5\u6c34    "))),d.length&&"read"!==w?y.a.createElement(zr.a,{style:{padding:10},onClick:function(){return e.setState({syrup:[].concat(P()(d),[{amount:"",need_refrigerated:!1,note:""}])})},underlayColor:"transparent"},y.a.createElement(pe.a,{source:n(943),style:{width:32,height:32}})):null),d.map((function(t,a){return y.a.createElement(E.a,{key:a,style:{flexDirection:"row",alignItems:"center",alignSelf:"center",marginBottom:20}},y.a.createElement(Hn.a,{editable:"read"!==w,style:{width:35,fontSize:25,textAlign:"center",marginHorizontal:10},keyboardType:"number-pad",autoFocus:!0,placeholder:"____",value:t.amount,onChangeText:function(t){return e.editSyrupAmountEntry(t,a)}}),y.a.createElement(b.a,{style:{fontSize:20,marginRight:5}},"c.c."),y.a.createElement(zr.a,{disabled:"read"===w,style:{padding:5},onClick:function(){"read"!==w&&e.editSyrupRefrigerationEntry(!t.need_refrigerated,a)},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:t.need_refrigerated?"#00c07f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:5}},"\u9700\u51b7\u85cf"))),y.a.createElement(Hn.a,{editable:"read"!==w,style:{fontSize:25,textAlign:"center",marginHorizontal:10,width:60},placeholder:"\u5099\u8a3b",value:t.note,onChangeText:function(t){return e.editSyrupNoteEntry(t,a)}}),"read"!==w&&y.a.createElement(zr.a,{style:{paddingHorizontal:10},onClick:function(){return e.removeSyrupEntry(a)},underlayColor:"transparent"},y.a.createElement(pe.a,{source:n(219),style:{width:32,height:32}})))}))),y.a.createElement(E.a,{style:{}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingVertical:10},onClick:function(){"read"!==w&&e.setState({gel:null===f?"":null})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===f?"white":"#00c07f"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:10}},"\u85e5\u818f"))),null===f?null:y.a.createElement(Hn.a,{editable:"read"!==w,style:{flex:1,fontSize:25},autoFocus:!0,placeholder:"\u90e8\u4f4d",value:f,onChangeText:function(t){return e.setState({gel:t})}}))),y.a.createElement(E.a,{style:{}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingVertical:10},onClick:function(){"read"!==w&&e.setState({other_type:null===p?"":null})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===p?"white":"#00c07f"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:10}},"\u5176\u4ed6"))),null===p?null:y.a.createElement(Hn.a,{editable:"read"!==w,style:{flex:1,fontSize:22,paddingHorizontal:10,paddingTop:3,paddingBottom:5,paddingLeft:0},placeholder:"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...",autoFocus:!0,textAlignVertical:"top",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:p,onChangeText:function(t){return e.setState({other_type:t})}}))))),y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{width:"100%",justifyContent:"center",backgroundColor:"#f4d41f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u5099\u8a3b")),y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"white",padding:20}},y.a.createElement(Hn.a,{editable:"read"!==w,style:{height:C,padding:15,fontSize:25},placeholder:"\u9ede\u64ca\u586b\u5beb...",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:h,onChangeText:function(t){return e.setState({note:t})},onChange:function(t){return e.setState({scrollHeight:t.target.scrollHeight})},onLayout:function(t){var n=t.nativeEvent.target.scrollHeight;e.setState({scrollHeight:n})}}))),y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{width:"100%",justifyContent:"center",backgroundColor:"#fa625f",padding:10,borderTopLeftRadius:30,borderTopRightRadius:30}},y.a.createElement(b.a,{style:{fontSize:25,alignSelf:"center"}},"\u767c\u71d2\u9935\u85e5")),y.a.createElement(E.a,{style:{width:"100%",backgroundColor:"white",padding:20}},y.a.createElement(E.a,{style:{paddingVertical:10}},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:.06*Zo,marginHorizontal:10}},"\u767c\u71d2\u8d85\u904e"),y.a.createElement(Hn.a,{editable:"read"!==w,style:{width:55,fontSize:25},keyboardType:"number-pad",value:m.temperature,onChangeText:function(t){return e.setState({fever_entry:Yo(Yo({},m),{},{temperature:t})})}}),y.a.createElement(b.a,{style:{fontSize:.06*Zo}},"\xb0C \u4ee5\u4e0a\u624d\u7528\u85e5")),y.a.createElement(E.a,{style:{backgroundColor:""}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingTop:20,paddingBottom:10},onClick:function(){"read"!==w&&e.setState({fever_entry:Yo(Yo({},m),{},{powder:!m.powder})})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:m.powder?"#fa625f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginLeft:10}},"\u85e5\u7c89    "))),y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingTop:20,paddingBottom:10},onClick:function(){"read"!==w&&e.setState({fever_entry:Yo(Yo({},m),{},{powder_refrigerated:!m.powder_refrigerated})})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:m.powder_refrigerated?"#fa625f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:5}},"\u9700\u51b7\u85cf"))))),y.a.createElement(E.a,{style:{backgroundColor:""}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingVertical:10},onClick:function(){"read"!==w&&e.onSelectFeverSyrup()},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:m.syrup.length?"#fa625f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginLeft:10}},"\u85e5\u6c34    "))),m.syrup.length&&"read"!==w?y.a.createElement(zr.a,{style:{padding:10},onClick:function(){return e.setState({fever_entry:Yo(Yo({},m),{},{syrup:[].concat(P()(m.syrup),[{amount:"",need_refrigerated:!1}])})})},underlayColor:"transparent"},y.a.createElement(pe.a,{source:n(944),style:{width:32,height:32}})):null),m.syrup.map((function(t,a){return y.a.createElement(E.a,{key:a,style:{flexDirection:"row",alignItems:"center",alignSelf:"center",marginBottom:20}},y.a.createElement(Hn.a,{editable:"read"!==w,style:{width:62,fontSize:25},keyboardType:"number-pad",autoFocus:!0,placeholder:"____",value:t.amount,onChangeText:function(t){return e.editFeverSyrupAmountEntry(t,a)}}),y.a.createElement(b.a,{style:{fontSize:25,marginRight:5}},"c.c."),y.a.createElement(zr.a,{disabled:"read"===w,style:{padding:5},onClick:function(){"read"!==w&&e.editFeverSyrupRefrigerationEntry(!t.need_refrigerated,a)},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,marginLeft:10,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:t.need_refrigerated?"#fa625f":"white"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:5}},"\u9700\u51b7\u85cf"))),"read"!==w&&y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingHorizontal:10},onClick:function(){"read"!==w&&e.removeFeverSyrupEntry(a)},underlayColor:"transparent"},y.a.createElement(pe.a,{source:n(219),style:{width:32,height:32}})))}))),y.a.createElement(E.a,{style:{}},y.a.createElement(E.a,{style:{flexDirection:"row",alignItems:"center"}},y.a.createElement(zr.a,{disabled:"read"===w,style:{paddingVertical:10},onClick:function(){"read"!==w&&e.setState({fever_entry:Yo(Yo({},m),{},{other_type:null===m.other_type?"":null})})},underlayColor:"transparent"},y.a.createElement(E.a,{style:{flexDirection:"row",justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:"center",alignItems:"center"}},y.a.createElement(E.a,{style:{width:16,height:16,borderRadius:8,backgroundColor:null===m.other_type?"white":"#fa625f"}})),y.a.createElement(b.a,{style:{fontSize:25,marginHorizontal:10}},"\u5176\u4ed6"))),null===m.other_type?null:y.a.createElement(Hn.a,{editable:"read"!==w,style:{flex:1,fontSize:22,paddingHorizontal:10,paddingTop:3,paddingBottom:5,paddingLeft:0},placeholder:"\u9ede\u64ca\u6211\u958b\u59cb\u586b\u5beb...",autoFocus:!0,textAlignVertical:"top",multiline:!0,blurOnSubmit:!0,scrollEnabled:!1,value:m.other_type,onChangeText:function(t){return e.setState({fever_entry:Yo(Yo({},m),{},{other_type:t})})}})))))))),y.a.createElement(E.a,{style:{height:90,width:"100%",paddingHorizontal:20}},"read"===w?y.a.createElement(zr.a,{disabled:!this.editable(),style:{width:"100%",height:"70%",backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onClick:function(){e.editable()&&e.onClickConfirm()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:40,textAlign:"center",color:"white"}},"\u7de8\u8f2f")):"edit"===w?y.a.createElement(E.a,{style:{width:"100%",height:"70%",flexDirection:"row"}},y.a.createElement(zr.a,{style:{flex:1,backgroundColor:"#fa625f",justifyContent:"center"},onClick:function(){return e.deleteRequestConfirm()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"\u522a\u9664")),y.a.createElement(zr.a,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onClick:function(){return e.cancelEdit()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:.06*Zo,textAlign:"center",color:"white"}},"\u53d6\u6d88\u7de8\u8f2f")),y.a.createElement(zr.a,{style:{flex:1,backgroundColor:"#00c07f",justifyContent:"center"},onClick:function(){return e.onClickConfirm()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center"}},"\u9001\u51fa"))):y.a.createElement(zr.a,{style:{width:"100%",height:"70%",backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center"},onClick:function(){return e.onClickConfirm()},underlayColor:"transparent"},y.a.createElement(b.a,{style:{fontSize:30,textAlign:"center",color:"white"}},"\u9001\u51fa"))))}}]),a}(y.a.Component),ec=Object(k.b)((function(e){return{isConnected:e.parent.isConnected}}))($o);n(310);function tc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var nc=function(e){u()(n,e);var t=tc(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={index:-1,data:[]},a}return c()(n,[{key:"componentDidMount",value:function(){var e=this.props.route.params,t=e.index,n=e.data;this.setState({index:t,data:n}),this.markRead(n[t].id)}},{key:"markRead",value:function(e){var t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return t=this.props.route.params.parent_id,n=fn(new Date)+" "+mn(new Date),s.next=4,r.a.awrap(bn("/announcement/"+e+"/read",{parent_id:t,timestamp:n}));case 4:a=s.sent,a.success,a.statusCode,a.message,a.data;case 6:case"end":return s.stop()}}),null,this,null,Promise)}},{key:"componentWillUnmount",value:function(){(0,this.props.route.params.onGoBack)()}},{key:"render",value:function(){var e=this,t=this.state,n=t.index,a=t.data;if(n<0)return y.a.createElement(Mn,null);var s=a[n];return y.a.createElement(le.Card,{style:{flex:1}},y.a.createElement(E.a,{style:{padding:20,alignItems:"center"}},y.a.createElement(b.a,{style:{fontSize:25}},s.title),y.a.createElement(b.a,null,pn(new Date(s.timestamp)))),y.a.createElement(E.a,{style:{flex:1,padding:20}},y.a.createElement(b.a,null,s.text),y.a.createElement(E.a,{style:{paddingTop:50,alignItems:"flex-start"}},s.links.map((function(e,t){return y.a.createElement(zr.a,{key:t,style:{padding:8,backgroundColor:"lightblue"},onClick:function(){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.a.awrap(Nr.a(e.url));case 2:t.sent;case 3:case"end":return t.stop()}}),null,null,null,Promise)}},y.a.createElement(b.a,null,e.text))}))),y.a.createElement(E.a,{style:{flexDirection:"row",paddingTop:50,flexWrap:"wrap"}},s.photo_url_arr.map((function(t,n){return y.a.createElement(C.a,{key:n,onPress:function(){var n;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r.a.awrap(Nr.a(t));case 2:n=a.sent,e.setState({result:n});case 4:case"end":return a.stop()}}),null,null,null,Promise)}},y.a.createElement(pe.a,{source:{uri:t},style:{width:150,height:150,marginRight:10,marginTop:10}}))})))))}}]),n}(y.a.Component),ac=function(e){var t=e.route.params,n=t.parent_id,a=t.viewAnnouncement,s=Object(m.useState)(e.route.params.announcements),i=qr()(s,2),o=i[0],c=i[1],l=Object(m.useState)(0),u=qr()(l,2),d=u[0],f=u[1],p=Object(m.useState)(!1),h=qr()(p,2),g=h[0],_=h[1];Object(m.useEffect)((function(){0!==d&&v()}),[d]);var v=function(){var e,t,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,r.a.awrap(_n("/announcement/unread?parent_id="+n+"&page="+d));case 2:e=s.sent,t=e.success,e.statusCode,e.message,a=e.data,t&&(c([].concat(P()(o),P()(a))),a.length<3&&_(!0));case 5:case"end":return s.stop()}}),null,null,null,Promise)};return y.a.createElement(Rn.a,{contentContainerStyle:{alignItems:"center"}},o.map((function(e,t){var n=pn(new Date(e.timestamp));return y.a.createElement(zr.a,{key:e.id,style:{width:"100%",alignItems:"center"},onClick:function(){return a(t,o)}},y.a.createElement(le.Card,{style:{padding:20,width:"95%",height:200,flexDirection:"row"}},y.a.createElement(E.a,{style:{width:"100%",overflow:"hidden"}},y.a.createElement(E.a,{style:{paddingBottom:20}},y.a.createElement(b.a,{style:{fontSize:25}},e.title),y.a.createElement(b.a,{style:{fontSize:15}},n)),y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:18}},e.text)))))})),g?y.a.createElement(E.a,{style:{padding:15}},y.a.createElement(b.a,{style:{fontSize:18}},"\u7121\u66f4\u591a\u8a0a\u606f")):y.a.createElement(zr.a,{style:{width:"95%",padding:15,backgroundColor:"rgba(0,0,0,0.2)",alignItems:"center"},onClick:function(){return f(d+1)}},y.a.createElement(b.a,{style:{fontSize:20}},"\u6aa2\u8996\u66f4\u591a")))},rc=function(e){var t=e.route.params.students,n=["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341","\u5341\u4e00","\u5341\u4e8c"],a=Object(m.useState)(0),s=qr()(a,2),i=s[0],o=s[1],c=Object(m.useState)(""),l=qr()(c,2),u=(l[0],l[1],Sa.a.get("window").height),d=Object(m.useState)(new Ji.a.Value(0)),f=qr()(d,2),p=f[0],h=(f[1],Object(m.useState)(e.route.params.student_id)),g=qr()(h,2),_=g[0],v=g[1],S=Object(m.useState)(""),w=qr()(S,2),k=w[0],D=w[1],x=Object(m.useState)(""),A=qr()(x,2),O=A[0],R=A[1],j=Object(m.useState)(!1),T=qr()(j,2),P=T[0],I=T[1],z=Object(m.useState)(!1),L=qr()(z,2),M=L[0],F=L[1],B=function(e){D(e),Ji.a.timing(p,{toValue:1,duration:300}).start()},q=function(){Ji.a.timing(p,{toValue:0,duration:200}).start()},N=function(){var e=(new Date).getMonth();return n.slice(0,e+1)}();return y.a.createElement(E.a,{style:{flex:1,alignItems:"center",paddingHorizontal:15,overflow:"hidden"}},P&&y.a.createElement(Ms,{title:"\u4e0b\u8f09\u9023\u7d50",content:y.a.createElement(E.a,{style:{alignItems:"center"}},y.a.createElement(b.a,null,"\u5bf6\u8c9d"+n[i]+"\u6708\u7684\u8cc7\u6599\u6e96\u5099\u597d\u4e86\uff0c\n\u9ede\u64ca\u9023\u7d50\u9078\u64c7\u4e0b\u8f09\u65b9\u5f0f\n\n"),y.a.createElement(zr.a,{style:{padding:10,backgroundColor:"#dcf3d0"},onClick:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.awrap(Nr.a("https://gina-mobile-app.s3.amazonaws.com/"+O));case 2:e.sent;case 3:case"end":return e.stop()}}),null,null,null,Promise)}},y.a.createElement(b.a,null,n[i]+"\u6708\u4efd\u806f\u7d61\u7c3f\u7d00\u9304"))),hideModal:function(){return I(!1)}}),y.a.createElement(E.a,{style:{marginTop:25,borderWidth:2,borderRadius:10,borderColor:"lightgrey",padding:20,backgroundColor:"rgba(255,255,255,0.8)",width:"85%"}},y.a.createElement(E.a,{style:{}},y.a.createElement(b.a,{style:{fontSize:25}},"\u6574\u6708\u806f\u7d61\u7c3f")),y.a.createElement(E.a,{style:{flex:1,width:"100%",flexDirection:"row",marginTop:15}},y.a.createElement(E.a,{style:{flex:1,paddingVertical:20,alignItems:"center",justifyContent:"center",backgroundColor:"lightgrey",borderTopLeftRadius:15}},y.a.createElement(b.a,{style:{fontSize:25}},"\u6708\u4efd")),y.a.createElement(zr.a,{style:{flex:2},onClick:function(){return B("month")}},y.a.createElement(b.a,{style:{fontSize:25,paddingVertical:20,borderWidth:1,borderColor:"lightgrey",textAlign:"center"}},n[i],"\u6708"))),y.a.createElement(E.a,{style:{flex:1,width:"100%",flexDirection:"row",marginTop:15}},y.a.createElement(E.a,{style:{flex:1,paddingVertical:20,alignItems:"center",justifyContent:"center",backgroundColor:"lightgrey",borderBottomLeftRadius:15}},y.a.createElement(b.a,{style:{fontSize:25}},"\u5bf6\u8c9d")),y.a.createElement(C.a,{style:{flex:2},onClick:function(){return B("student")}},y.a.createElement(b.a,{style:{fontSize:25,paddingVertical:20,textAlign:"center",borderWidth:1,borderColor:"lightgrey"}},t[_].name))),y.a.createElement(C.a,{style:{paddingTop:20,alignSelf:"flex-end"},onClick:function(){return function(){var e,t,n,a;return r.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!M){s.next=2;break}return s.abrupt("return");case 2:return F(!0),(e=new Date).setMonth(i,1),s.next=7,r.a.awrap(_n("/student/"+_+"/monthly-report?month="+fn(e)));case 7:if(t=s.sent,n=t.success,t.statusCode,t.message,a=t.data,n){s.next=12;break}return alert("\u6574\u7406\u5bf6\u8c9d\u8cc7\u6599\u4e2d\u51fa\u554f\u984c\uff0c\u8acb\u622a\u5716\u7d66\u5de5\u7a0b\u5e2b"),s.abrupt("return");case 12:R(a),I(!0),F(!1);case 15:case"end":return s.stop()}}),null,null,null,Promise)}()}},y.a.createElement(b.a,{style:{fontSize:25,backgroundColor:"#dcf3d0",padding:20,textAlign:"center"}},M?"\u6e96\u5099\u4e2d\u3002\u3002\u3002":"\u78ba\u5b9a"))),y.a.createElement(Ji.a.View,{style:[ue.a.absoluteFill,{flex:1,backgroundColor:"rgba(0,0,0,0.5)",transform:[{translateY:p.interpolate({inputRange:[0,.01],outputRange:[u,0],extrapolate:"clamp"})}],opacity:p.interpolate({inputRange:[.01,.5],outputRange:[0,1],extrapolate:"clamp"})}]},y.a.createElement(C.a,{style:{flex:1,backgroundColor:"transparent"},underlayColor:"transparent",onPress:function(){return q()}},y.a.createElement(E.a,null)),y.a.createElement(E.a,{style:{flex:1,position:"absolute",top:u,width:"100%",height:"100%",justifyContent:"flex-end"}},y.a.createElement(E.a,{style:{flex:3}}),y.a.createElement(Ji.a.View,{style:{flex:1,backgroundColor:"rgba(255,255,255,1)",marginHorizontal:10,paddingHorizontal:10,minHeight:200,transform:[{translateY:p.interpolate({inputRange:[.01,1],outputRange:[0,-1*u],extrapolate:"clamp"})}]}},y.a.createElement(E.a,{style:{padding:15}},y.a.createElement(b.a,{style:{fontSize:25}},"month"===k?"\u8acb\u9078\u64c7\u806f\u7d61\u7c3f\u6708\u4efd":"\u8acb\u78ba\u8a8d\u5bf6\u8c9d\u540d\u7a31")),"month"===k&&y.a.createElement(Rn.a,{horizontal:!0,contentContainerStyle:{alignItems:"center",justifyContent:"center"}},N.map((function(e,t){return y.a.createElement(zr.a,{key:t,style:{flex:1,padding:20,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",margin:10,marginVertical:20,height:80,width:100},onClick:function(){o(t),q()},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:20}},e+"\u6708"))}))),"student"===k&&y.a.createElement(Rn.a,{horizontal:!0,contentContainerStyle:{alignItems:"center",justifyContent:"center"}},Object.keys(t).map((function(e){return y.a.createElement(zr.a,{key:e,style:{padding:30,alignItems:"center",justifyContent:"center",backgroundColor:"#b5e9e9",margin:15,height:80,width:100},onClick:function(){v(e),q()},underlayColor:"#368cbf"},y.a.createElement(b.a,{style:{fontSize:20}},""+t[e].name))})))))))};function sc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var ic=Object(D.c)(Di),oc=Object(Pa.a)(),cc=function(e){u()(n,e);var t=sc(n);function n(){return i()(this,n),t.apply(this,arguments)}return c()(n,[{key:"render",value:function(){var e=this;return y.a.createElement(k.a,{store:ic},y.a.createElement(Ta.a,null,y.a.createElement(oc.Navigator,{initialRouteName:"ParentHome",screenOptions:{gestureEnabled:!0,headerTitleStyle:{fontWeight:"bold",fontSize:30}}},y.a.createElement(oc.Screen,{name:"ParentHome",component:Eo,initialParams:{parent_id:this.props.parent_id,loadAuth:this.props.loadAuth},options:{title:"\u5bb6\u9577\u9996\u9801",headerRight:function(){return y.a.createElement(C.a,{style:{padding:10,marginRight:20},onPress:function(){return e.props.handleSignOut()}},y.a.createElement(b.a,null,"\u767b\u51fa"))},headerLeft:null}}),y.a.createElement(oc.Screen,{name:"DownloadPage",component:rc,options:{title:"\u8cc7\u6599\u4e0b\u8f09"}}),y.a.createElement(oc.Screen,{name:"PickupRequest",component:Qo,options:{title:"\u63a5\u56de\u544a\u77e5"}}),y.a.createElement(oc.Screen,{name:"MedicationRequestPage",component:To,options:{title:"\u6258\u85e5\u55ae"}}),y.a.createElement(oc.Screen,{name:"AddMedicationRequestPage",component:ec,options:{title:"\u65b0\u589e\u6258\u85e5\u55ae"}}),y.a.createElement(oc.Screen,{name:"AbsenceExcusePage",component:Uo,options:{title:"\u8acb\u5047\u55ae"}}),y.a.createElement(oc.Screen,{name:"AnnouncementPage",component:nc,options:{title:"\u516c\u544a"}}),y.a.createElement(oc.Screen,{name:"AnnouncementListPage",component:ac,options:{title:"\u516c\u544a"}}))))}}]),n}(y.a.Component);function lc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}var uc=function(e){u()(n,e);var t=lc(n);function n(e){var a;return i()(this,n),(a=t.call(this,e)).state={code:""},a.confirmCode=a.confirmCode.bind(_()(a)),a}return c()(n,[{key:"confirmCode",value:function(){var e=this;w.a.confirmSignUp(this.props.username,this.state.code).then((function(t){console.log("data: ",t),e.props.getCurrentUser()})).catch((function(e){fe.a.alert("Error!",e.message,[{text:"OK",onPress:function(){return console.log("err occured when setting up account for parent(s): ",e)}}])}))}},{key:"render",value:function(){var e=this;return console.log("this.state.code: ",this.state.code),y.a.createElement(le.Container,null,y.a.createElement(le.Content,{keyboardShouldPersistTaps:"always"},y.a.createElement(E.a,{style:{paddingTop:"20%",flexDirection:"row",justifyContent:"space-around",paddingBottom:"15%"}},y.a.createElement(Hn.a,{style:{position:"absolute",color:"transparent"},autoFocus:!0,maxLength:6,caretHidden:!0,keyboardType:"numeric",onChangeText:function(t){e.setState({code:t})}}),Array(6).fill(0).map((function(t,n){return y.a.createElement(le.Card,{key:n,style:{width:50,height:50,backgroundColor:"white",borderColor:"black",justifyContent:"center"}},e.state.code.length>n?y.a.createElement(b.a,{style:{fontSize:30,alignSelf:"center"}},e.state.code.charAt(n)):y.a.createElement(b.a,null))}))),y.a.createElement(le.Button,{rounded:!0,success:!0,style:{alignSelf:"center"},onPress:this.confirmCode},y.a.createElement(b.a,{style:{paddingHorizontal:5,color:"white"}},"Confirm code"))))}}]),n}(y.a.Component),dc=(ue.a.create({input:{borderColor:"black",borderWidth:1}}),uc);function fc(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}n(226).a.ignoreWarnings(["Non-serializable values were found in the navigation state"]);var pc=function(e){u()(a,e);var t=fc(a);function a(e){var n;return i()(this,a),(n=t.call(this,e)).state={status:"",id:"",username:""},n.getCurrentUser=n.getCurrentUser.bind(_()(n)),n}return c()(a,[{key:"componentDidMount",value:function(){return r.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.awrap(S.b({Roboto:n(950),Roboto_medium:n(951)}));case 2:this.getCurrentUser();case 3:case"end":return e.stop()}}),null,this,null,Promise)}},{key:"getCurrentUser",value:function(){var e=this;this.setState({status:"loading"}),w.a.currentAuthenticatedUser().then((function(t){console.log(t.username),fetch("https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/"+ln+"/user?username="+t.username,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(n){var a=n.statusCode,r=(n.message,n.data);200===a?e.setState({status:r.role,id:r.id,username:t.username}):e.setState({status:"signedout"})})).catch((function(t){console.log("err: ",t),e.setState({status:"signedout"})}))})).catch((function(t){"not authenticated"==t&&e.setState({status:"signedout"}),e.setState({status:"signedout"})}))}},{key:"changeAuthState",value:function(e,t){this.setState({status:e,username:t})}},{key:"handleSignOut",value:function(){var e=this;w.a.signOut().then((function(){e.getCurrentUser()})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this;console.log("ENV: ",ln);var t=this.state,n=t.status,a=t.username;return console.log("status: ",n),y.a.createElement(E.a,{style:{flex:1}},n.includes("parent")?y.a.createElement(cc,{parent_id:this.state.id,handleSignOut:function(){return e.handleSignOut()}}):"school"===n?y.a.createElement(fi,{school_id:this.state.id,school_name:a,handleSignOut:function(){return e.handleSignOut()}}):"ConfirmSignUpPage"===n?y.a.createElement(dc,{getCurrentUser:this.getCurrentUser,username:this.state.username}):"signedout"===n||"school"===n?y.a.createElement(yi,{loadAuth:this.getCurrentUser,changeAuthState:function(t,n){return e.changeAuthState(t,n)}}):y.a.createElement(E.a,{style:{flex:1,justifyContent:"center",alignItems:"center"}},y.a.createElement(b.a,null,"Loading..."),y.a.createElement(v.a,{size:"large"})))}}]),a}(y.a.Component),hc=n(552),mc={identityPooId:"us-east-1:0a3c861f-48ca-4832-af57-28b4209e695e",region:"us-east-1",userPoolId:"us-east-1_QlbPkQ8Ds",userPoolWebClientId:"6maqsbp3gi2vj0tid4akmoiat6"},yc=n(345),gc=n(1308);function _c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=h()(e);if(t){var r=h()(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return f()(this,n)}}hc.a.configure(mc);var Ec=function(e){u()(a,e);var t=_c(a);function a(e){var s;return i()(this,a),(s=t.call(this,e))._cacheSplashResourcesAsync=function(){var e;return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n(1277),t.abrupt("return",gc.a.fromModule(e).downloadAsync());case 2:case"end":return t.stop()}}),null,null,null,Promise)},s._cacheResourcesAsync=function(){var e,t;return r.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return yc.a.hide(),e=[n(460)],t=e.map((function(e){return gc.a.fromModule(e).downloadAsync()})),a.next=5,r.a.awrap(Promise.all(t));case 5:s.setState({isAppReady:!0});case 6:case"end":return a.stop()}}),null,null,null,Promise)},s.state={isSplashReady:!1,isAppReady:!1},yc.a.preventAutoHide(),s}return c()(a,[{key:"render",value:function(){return y.a.createElement(pc,null)}}]),a}(y.a.Component);b.a.defaultProps=b.a.defaultProps||{},b.a.defaultProps.allowFontScaling=!1,Hn.a.defaultProps=Hn.a.defaultProps||{},Hn.a.defaultProps.allowFontScaling=!1},575:function(e,t,n){e.exports=n(576)},62:function(e,t,n){e.exports=n.p+"static/media/icon-thumbnail.f8c9cedd.png"},828:function(e,t,n){e.exports=n.p+"static/media/icon-checked-box.add46308.png"},829:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsSAAALEgHS3X78AAACN0lEQVR42u3dv28ScRzG8efbKkPLdcPE6OKPja2QuiqjCxCjf4FJdz0lcbrN0KK7iX/BxdTDoaOG0VK6uVWHpumikx4O1vBxqDFRcgmed9TA+zWXkjzv+wHLIQEAAAAAAGBeuCz+STkIC0teqenM6pJblXRR0vKMbTWUdCjZnpmir8NP0bvgzrdTD3DtyetbZgsbkl2es4P3vcke9v3a1qkEuB2GiwcHpbZJ9+f5EmKmTn/YaykIRmlev5D2jRn/5xHs5K8Vrz+e6hlwctlxL7iF/qa549+Icj8DykFYMHNt9h7ztByEhdwDLHmlpqQr7D3m0rJ3rp7/PcDUYOvEO3L+AZxUYelE1Wl8CjrPzoku/O0LzqR4k+Ikf7R9d3Wmlr35fC+zbTL5HoBsEIAABAABCAACEAAEIAAIQAAQgAAgAAFAAAKAAAQAAQgAAhAABCAACEAAEIAAIAABQAACgAAEAAEIAAIQAAQgAAhAABCAACAAAUAAAoAA/7c0z4yLNcGz0SZ8xtqMcZ+ncAa4I47bhGVkR1MIMBowdQLTbu4BzBSxdOIp0M09wGhl5aWkfdYeW/9DHH98lXuAwXr12GQtBv9jfhvdS/OTJqk+hvb92paZOsz+69LTfvug1k3z0tTfA/rDXkuyTdZ3Gztfeo/St/tHa503DUmbkq7O2fL7zsxPe+RnFkCSKs92zy7GcUNmdSdV7ORnrIozNnjspEOTBk6Kvnted7BePeYKAAAAAAAAgEn9AI63ihVnDPNHAAAAAElFTkSuQmCC"},893:function(e,t,n){e.exports=n.p+"static/media/icon-medication-powder.ea8d7086.png"},894:function(e,t,n){e.exports=n.p+"static/media/icon-medication-syrup.a7ee612b.png"},895:function(e,t,n){e.exports=n.p+"static/media/icon-medication-gel.12878684.png"},896:function(e,t,n){e.exports=n.p+"static/media/icon-medication-pill.b0c168c9.png"},931:function(e,t,n){e.exports=n.p+"static/media/icon-wellness.8e4dfdb5.png"},932:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAC2UlEQVRo3u2Xv24TQRDGv9mzHdt3tmMHCiQiJNqYylBAwRMgurwBSoNooKG0y4gyosk78BRI0IQulihxEiRiXETIh2WMdygSoZx3cv98ZA/J293c7ml++30zuwesxmosNSjpAv5wu+LXnZ8A4LUHBADjwzssPbs/5lV6dDIRv9PfKvnwX4L5udcebKYFKCRdMHF5I/bcKloAvhrJH3SKPo/eAXiyrAIq6QJN1Iw9V6Elxcfl0dsskk8FwFTYWGauf7j5gIBnWdWASr6EW8vMZaJXaWovMwBFaKWdO+zf9AB6mmUXSmEhuhF7LoIFX9WVh2BUrAKA0Uzw+aBaSnWyPgeSA1D8NsoLNcDMd60DUAIFFII1QMAt6wBMSKCAUfAV+xYCxW+jREFY5qJ9AI5fA8Y5QJhkDVBILgCa4IsrwcWl7e8VYeEZRg2QzzlQoBeflXcXQt+sW8hrH+0C/Dra/tx1t456C4fgcQ6K+ByCmXpXi0S9xeQv2tIgFwAAULv3pSspQcTd83diD+5b/yML5LO9XZrVqtPLsWJhrUT7+zNx/kGn6JdHYwCloKIDunYFAAD1umfEnLF35W7d/zQD8DkXFgKAidauEZuRG97E+GNuABznt7HbDlQt1LOK3ucGgDTcOLEgoJMpQGEpAOV4rHnxthoKUH7zeDhTwTX8or5Ge3vT61dgrj0TSnnhW1ZoGLGzs4YVC82FZOeaQwGm9MtIduo4dgCI2RUUCLWQmikjWaXmdgBAwm5HKEBKN8zTW9lSQOhCFA6gQUaymsgOgIZpFykWBDSTpTlbUgDmbke1UWghWVsKgAW7RFiIhWQZWLcDIHccN6Ju1gUl7SjAggIMeBGVLyVrqwZIqgEv4gekIZwnlmoA5kEGCrcQC3Zha0Us28WL0C1PFkoDgPwAsNxx3P8GIJ2FUM+ThU6F8GnEmu9CeGjrKrFDwMml0DER7WS9ZjVW4x+OPysh2phhVbaOAAAAAElFTkSuQmCC"},933:function(e,t,n){e.exports=n.p+"static/media/icon-milk.02c27d2c.png"},934:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0UlEQVRo3u2YwQnCQBBF/wQL0GMwdmAFWoJ9iAUJbprJSTvwpBcFIVc7GC8iRBNBRbIJ753CJId5mRmYXQkAIBp8o50HuQdtu5JbUvnKNLs/zaP7uw25JV3vGgQQ+JFB49QHORVoswK2kjVV5fndv+PvOoIhRgABBBBAAAEEWOZqOBXlwmS55ONH8JBKks5FWV2s/hu/uGupY/pZBUwKleTbIzNT/k0LZRF1yoQhjhVrOvVc93ElOpzWnxZpIQQQ6OsqMVq/3s20CfdCCAAA9JIb9gROYBxbOFYAAAAASUVORK5CYII="},935:function(e,t,n){e.exports=n.p+"static/media/icon-diaper.236e3240.png"},936:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAABvklEQVRo3u2ZO0sDQRSFv1lFfGBg7SysLC20T62CIFb+D8EmhWUsxf+hpYUEtRBMZyCFQewCihZGQuIjMdmZa2MKQx6smSVZMqe9LHPPnHP37OyAg4NDrKHCPiCZnSW0OUaxAczbbki+azSKBUz5FXTwLnClIZVI8zAwAcnsLGFMHliIYjflu0Y9f40EzfZSWQmrs4c8the8UCtocxxV8wCNYqFT8wC+eBx1KnghDbcRpZ9N+bWHPGwOTiACz//pUQe9ygkbBEYOjsCwMTlKzcylw+eSFQJB4SzcoivbzkJWFbC5o3GagReEHErlEJPDm7qNm4WmUfggPuBDc2FoCvQb4i4W84EkkEQpkP99HY/KEGdR3vpYDvGoKJBEzIXLAZfELomjVkCbZZTaA7LxPA9MejMIv8kZRwsJd63ItJDEbohdErszMbwAN6Au0frSKTAELAK7ILtMeP86D3Qk8HnQ4V0JfGXPBup2Nrnthng8CCh4j2KxPn+fK9YICFxFQcBUSr3KGWsENKSAsm0CzeJ9txuYNyTYt0YgkeZBCasoToGqNQVqH9Tz1+jSc8tOVeAECdbU1vkTDg4O44cfoDWTjXIjQSwAAAAASUVORK5CYII="},937:function(e,t,n){e.exports=n.p+"static/media/icon-babies.a7fc62df.png"},938:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsSAAALEgHS3X78AAACTklEQVRo3u2Zz2sTQRzFPzO7KbSaUkOjUAwIFQsipDnlD6hEqQd/FEoPFSke9FSkXuJJ8NZDTHuu1EtCxYL2YH9Y2j/AWw+5LNaTEay/ohUvNrvroWlcY6KB3U1SMu+0OzM7M2/ee18WBhSaC+HHpKmFpYhmmWlskSg1bWBr9+5cv2y0PIHUwlJEM60tIFTR9UViRyfHR/Jerie9JqBZZhoICVi2zOJJiR0BVoGQhXjo9XqeEziwjcC+PXVj9N3k+Eje1OStUu8Fr5fT6xmUGJuIIGXaQiQEBA/aLw0P1/zm/cdPUSAPsLPzIdbX2wvQPZN5ZleOXV5Z+c0fvoPY1KWZXMvMG64zkBibiNhSq+bpfxLYK+79LBS+XisKoYV7ehYDut5Ra6yTgAMFYZnR9SeP37pTQMp0tc3/DwE90HE8HH7hwh3HbKmngFFXBEq2AWDmfpKzZ/rLfbPZ5574eD07V37OGdtMPZim3szIOjxW9rxz8wBHuzpdbz5YMce5gdPOitDtaxUaisdckQh2dTIUj/lfhWrhVN8Jbl692NRfCckhhyLQbOheTfTjfPyP9yMbr/4as2W8qfrt4EC/UqAhcHPSvhCotE2tvmp2OpQKqAyoDFTA6e16yqjKgMpAnXZqZAbaW4Fanm5kdWpvBfzwtFJAZUBlQCmgMqAy0FYKKAItT2D/zmofOWPb9w3ljNfO128ehFhsgn0FcN6cNAaCl64V0KWZBApNcMdnHe66JrCWmTeEZUZBLILYbcCx7yJ4qgsGV7OP8ii0OH4Bz96jqU9mE24AAAAASUVORK5CYII="},939:function(e,t,n){e.exports=n.p+"static/media/icon-morningreminder.9cb15f85.png"},940:function(e,t,n){e.exports=n.p+"static/media/icon-announcement.b546f363.png"},941:function(e,t,n){e.exports=n.p+"static/media/icon-attendance.96ff830b.png"},942:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAAeElEQVR4nO3bsQ3AMAwEMSX77+wsYeQKkRMIuPY1AwAAbPPMzKmP2OytD9hOgJgAMQFiAsQEiAkAAAAAAAAAAAAAAJf4EYtZR8cEiAkQEyAmQEyAmAAAAAAAAAAAAAAAcIkfsZh1dEyAmAAxAWICxASICQAAAPCzDwbFAyuExAG0AAAAAElFTkSuQmCC"},943:function(e,t,n){e.exports=n.p+"static/media/icon-plus-green.128442cf.png"},944:function(e,t,n){e.exports=n.p+"static/media/icon-plus-red.4fa4cf94.png"},949:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAACBklEQVRoge2Yyy4EQRSGvyEZKxazE3GJEFsmsRMLtzXhgWx4AIvBM7jMA1jyEojLIFbuFkRGWFThzJjqS1XXTEJ9SSWnp8+p8/9d09NdA4FAIPBXGQEugHNg2FeTNl8TA4tAL9APLPlq4tNAXsQdvpr4NNAUgoFWEwy0mmCg1fwLAwPAJnAJVIGPBuMFWEnRd1XXNJqrqnttoJ7iTswBT4ZG9eO5rnZZnFsWn+d0bpI5H4GZKIFRKzAAbAOdkRYVr8Bagjy0sDVdE0cXsAP0JZy7hk1+rsQpMEXt+00cphWIIw9MA2eifj1F/TeXYoIpi3pbA19Mi/qKKSnqK9Qt4gMLAa7si7jHlBRloF3Eb85y0iN7tpuS/sVzII5B4Bg4AYoJ8os6t0IGW80sDMwDQygje0SbKOqcQdRP44Jr8ywM7AJ3Oi6gBI41yBvT5wr6+A7YyqC/EflEjKMI3Ir8W6AsjssNzif5uqXR4Fw8Ctzw+3WgftwD4540OBfHmUgj3laDc7HJRFrxLhqci+tN2Ih31eBWjLpJj4BDkt2wVhpyMcVJ8nwSq+FPv0q8izjNPiArZM93U1KUgWsRTzjLSc+kiK9sJtjg5wY6Q+1Nm7ESeWCW2h1ZyWaiftSmOsnm2+d4wHJPDOqqt9LEA2pr6UQfagkrmP8XynJUda8SDlc+EAgEmsMnirAThvyxHLsAAAAASUVORK5CYII="}},[[575,1,2]]]);
//# sourceMappingURL=app.f3d99b1c.chunk.js.map