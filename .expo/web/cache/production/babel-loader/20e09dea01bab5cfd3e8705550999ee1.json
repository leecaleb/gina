{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import TouchableHighlight from\"react-native-web/dist/exports/TouchableHighlight\";import Image from\"react-native-web/dist/exports/Image\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TextInput from\"react-native-web/dist/exports/TextInput\";import KeyboardAvoidingView from\"react-native-web/dist/exports/KeyboardAvoidingView\";import Alert from\"react-native-web/dist/exports/Alert\";import{Card,Toast}from'native-base';import{connect}from'react-redux';import{bindActionCreators}from'redux';import{writeToAll,writeToOne,remindItemsToBringToAll,remindItemsToBringToOne,recordActivitiesForAll,recordActivitiesForOne,writeItemToBringToAll,writeItemToBringToOne,writeActivityForAll,writeActivityForOne,fetchClassMessageData,sendMessageOnSuccess}from\"../../redux/school/actions/index\";import Reloading from\"../reloading\";import{formatDate,fetchClassData as _fetchClassData}from\"../util\";var MessageForParents=function(_React$Component){_inherits(MessageForParents,_React$Component);var _super=_createSuper(MessageForParents);function MessageForParents(props){var _this;_classCallCheck(this,MessageForParents);_this=_super.call(this,props);_this.state={isLoading:true,to_all_message:'',items_to_bring:['母奶粉','尿布','水壺','衣物'],other_item:'其它',items_to_bring_bool:[0,0,0,0,0],activities_list:['嬰兒按摩','音樂律動','教具操作','繪本欣賞','認知圖片','體能活動','藝術創作','多元語言'],other_activity:'其它',activities_bool:[0,0,0,0,0,0,0,0,0],message_by_student_id:{},editingOtherItemToBring:false,editingOtherItemForStudent:'',editingOtherActivity:false,editingOtherActivityForOne:''};_this.recordActivitiesForAll=_this.recordActivitiesForAll.bind(_assertThisInitialized(_this));return _this;}_createClass(MessageForParents,[{key:\"componentDidMount\",value:function componentDidMount(){var student_id_for_update=this.props.message.student_id_for_update;var isConnected=this.props.class.isConnected;if(student_id_for_update.size>0||!isConnected){this.setState({isLoading:false});}else{this.fetchClassData();}if(!isConnected){Toast.show({text:'拍謝 網路連不到! 等一下再試試看',buttonText:'Okay',position:\"top\",type:\"warning\",duration:2000});}}},{key:\"fetchClassData\",value:function fetchClassData(){var date,start_date,end_date,messageData;return _regeneratorRuntime.async(function fetchClassData$(_context){while(1){switch(_context.prev=_context.next){case 0:date=new Date();start_date=formatDate(date);date.setDate(date.getDate()+1);end_date=formatDate(date);_context.next=6;return _regeneratorRuntime.awrap(_fetchClassData('message',this.props.class.class_id,start_date,end_date));case 6:messageData=_context.sent;this.props.fetchClassMessageData(messageData.data);this.setState({isLoading:false});case 9:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"writeToAll\",value:function writeToAll(text){var teacher_id=this.props.route.params.teacher_id;this.setState({to_all_message:text});this.props.writeToAll(text,teacher_id);}},{key:\"writeToOne\",value:function writeToOne(text,student_id){var teacher_id=this.props.route.params.teacher_id;this.props.writeToOne(text,student_id,teacher_id);}},{key:\"remindItemsToBringToOne\",value:function remindItemsToBringToOne(student_id,selected_index){var teacher_id=this.props.route.params.teacher_id;var message_by_student_id=this.props.message.message_by_student_id;var things_to_bring=_toConsumableArray(message_by_student_id[student_id].things_to_bring);var new_bool=things_to_bring[selected_index]?0:1;things_to_bring.splice(selected_index,1,new_bool);this.props.remindItemsToBringToOne(student_id,things_to_bring,teacher_id);}},{key:\"remindItemsToBringToAll\",value:function remindItemsToBringToAll(selected_index){var teacher_id=this.props.route.params.teacher_id;var items_to_bring_bool=this.state.items_to_bring_bool;var new_bool=items_to_bring_bool[selected_index]?0:1;items_to_bring_bool.splice(selected_index,1,new_bool);this.setState({items_to_bring_bool:items_to_bring_bool});this.props.remindItemsToBringToAll(items_to_bring_bool,teacher_id);}},{key:\"otherItemForAllEditorOnBlur\",value:function otherItemForAllEditorOnBlur(){var other_item=this.state.other_item;this.setState({editingOtherItemToBring:false,other_item:other_item===''?'其它':other_item});}},{key:\"writeItemToBringToAll\",value:function writeItemToBringToAll(item_to_bring){var teacher_id=this.props.route.params.teacher_id;this.setState({other_item:item_to_bring});this.props.writeItemToBringToAll(item_to_bring,teacher_id);}},{key:\"writeItemToBringToOne\",value:function writeItemToBringToOne(student_id,item_to_bring){var teacher_id=this.props.route.params.teacher_id;this.props.writeItemToBringToOne(student_id,item_to_bring,teacher_id);}},{key:\"editItemToBringToOneEditorOnBlur\",value:function editItemToBringToOneEditorOnBlur(student_id,other_item){this.setState({editingOtherItemForStudent:''});if(other_item===''){this.props.writeItemToBringToOne(student_id,'其它');}}},{key:\"recordActivitiesForOne\",value:function recordActivitiesForOne(student_id,selected_index){var teacher_id=this.props.route.params.teacher_id;var message_by_student_id=this.props.message.message_by_student_id;var activities=_toConsumableArray(message_by_student_id[student_id].activities);var new_bool=activities[selected_index]?0:1;activities.splice(selected_index,1,new_bool);this.props.recordActivitiesForOne(student_id,activities,teacher_id);}},{key:\"recordActivitiesForAll\",value:function recordActivitiesForAll(selected_index){var teacher_id=this.props.route.params.teacher_id;var activities_bool=this.state.activities_bool;var new_bool=activities_bool[selected_index]?0:1;activities_bool.splice(selected_index,1,new_bool);this.setState({activities_bool:activities_bool});this.props.recordActivitiesForAll(activities_bool,teacher_id);}},{key:\"writeActivityForAll\",value:function writeActivityForAll(other_activity){var teacher_id=this.props.route.params.teacher_id;this.setState({other_activity:other_activity});this.props.writeActivityForAll(other_activity,teacher_id);}},{key:\"otherActivityEditorOnBlur\",value:function otherActivityEditorOnBlur(){var other_activity=this.state.other_activity;this.setState({editingOtherActivity:false,other_activity:other_activity===''?'其它':other_activity});}},{key:\"writeActivityForOne\",value:function writeActivityForOne(student_id,other_activity){var teacher_id=this.props.route.params.teacher_id;this.props.writeActivityForOne(student_id,other_activity,teacher_id);}},{key:\"activityForOneEditorOnBlur\",value:function activityForOneEditorOnBlur(student_id,other_activity){this.setState({editingOtherActivityForOne:''});if(other_activity===''){this.props.writeActivityForOne(student_id,'其它');}}},{key:\"handleSend\",value:function handleSend(){var _this2=this;var message_by_student_id=this.props.message.message_by_student_id;var isConnected=this.props.class.isConnected;if(!isConnected){Toast.show({text:'拍謝 網路連不到! 等一下再試試看',buttonText:'Okay',position:\"top\",type:\"warning\",duration:2000});return;}var request_body={date:formatDate(new Date()),data:this.normalize(message_by_student_id)};fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/message',{method:'POST',headers:{Accept:'application/json','Content-Type':'application/json'},body:JSON.stringify(request_body)}).then(function(res){return res.json();}).then(function(resJson){var statusCode=resJson.statusCode,message=resJson.message,data=resJson.data;if(statusCode>200||message==='Internal server error'){alert('Error'+message);return;}_this2.props.sendMessageOnSuccess();_this2.props.navigation.goBack();}).catch(function(err){alert('Error'+err.message);});}},{key:\"normalize\",value:function normalize(data){var student_id_for_update=this.props.message.student_id_for_update;var normalized_data=[];student_id_for_update.forEach(function(student_id){normalized_data.push(_objectSpread(_objectSpread({},data[student_id]),{},{student_id:student_id}));});return normalized_data;}},{key:\"render\",value:function render(){var _this3=this;var student_id_for_update=this.props.message.student_id_for_update;if(this.state.isLoading){return React.createElement(Reloading,null);}var students=this.props.class.students;var message_by_student_id=this.props.message.message_by_student_id;var _this$state=this.state,items_to_bring=_this$state.items_to_bring,items_to_bring_bool=_this$state.items_to_bring_bool,activities_list=_this$state.activities_list,activities_bool=_this$state.activities_bool,editingOtherItemToBring=_this$state.editingOtherItemToBring,editingOtherItemForStudent=_this$state.editingOtherItemForStudent,editingOtherActivity=_this$state.editingOtherActivity,editingOtherActivityForOne=_this$state.editingOtherActivityForOne;var date=new Date();return React.createElement(KeyboardAvoidingView,{style:{flex:1},enabled:true},React.createElement(View,{style:{padding:10,flexDirection:'row',alignItems:'center',justifyContent:'space-between'}},React.createElement(Text,{style:{fontSize:40}},date.getFullYear()+'.'+(date.getMonth()+1)+'.'+date.getDate()),React.createElement(TouchableHighlight,{style:{backgroundColor:'#dcf3d0'},onPress:function onPress(){return _this3.handleSend();}},React.createElement(Text,{style:{fontSize:40,padding:5}},\"\\u9001\\u51FA\"))),React.createElement(ScrollView,{contentContainerStyle:{alignItems:'center',marginBottom:20}},React.createElement(View,{style:{width:'95%'}},React.createElement(Card,{style:{padding:10}},React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{flex:1,flexDirection:'row',justifyContent:'space-evenly',paddingVertical:10}},React.createElement(View,{style:{width:'29%',backgroundColor:'#fff1b5',borderRadius:10,marginRight:5}},React.createElement(Text,{style:{fontSize:35,alignSelf:'center'}},\"\\u5BB6\\u9577\\u6E96\\u5099\"),React.createElement(View,{style:{flex:1,flexDirection:'row',justifyContent:'space-evenly',flexWrap:'wrap'}},items_to_bring.map(function(item,index){return React.createElement(TouchableHighlight,{key:index,style:{backgroundColor:items_to_bring_bool[index]?'#f4d41f':'#fff7d6',borderRadius:3,padding:3,margin:5},onPress:function onPress(){return _this3.remindItemsToBringToAll(index);}},React.createElement(Text,{style:{fontSize:20}},item));}),React.createElement(TouchableHighlight,{style:{backgroundColor:items_to_bring_bool[4]?'#f4d41f':'#fff7d6',justifyContent:'center',borderRadius:3,padding:3,margin:5},underlayColor:\"#f4d41f\",onPress:function onPress(){return _this3.remindItemsToBringToAll(4);},onLongPress:function onLongPress(){return _this3.setState({editingOtherItemToBring:true});}},editingOtherItemToBring?React.createElement(View,{style:{flex:1}},React.createElement(TextInput,{autoFocus:true,selectTextOnFocus:true,value:this.state.other_item,style:{alignSelf:'center',fontSize:20,backgroundColor:items_to_bring_bool[4]?'#f4d41f':'#fff7d6'},onChangeText:function onChangeText(item_to_bring){return _this3.writeItemToBringToAll(item_to_bring);},onBlur:function onBlur(){return _this3.otherItemForAllEditorOnBlur();}})):React.createElement(Text,{style:{alignSelf:'center',fontSize:20}},this.state.other_item)))),React.createElement(View,{style:{width:'69%',backgroundColor:'#b5e9e9',borderRadius:10,marginLeft:5}},React.createElement(Text,{style:{fontSize:35,alignSelf:'center'}},\"\\u4ECA\\u65E5\\u6D3B\\u52D5\"),React.createElement(View,{style:{flexDirection:'row',justifyContent:'space-evenly',flexWrap:'wrap'}},activities_list.map(function(activity,index){return React.createElement(TouchableHighlight,{key:index,style:{backgroundColor:activities_bool[index]?'#368cbf':'#eaf8f8',borderRadius:3,padding:3,margin:5},onPress:function onPress(){return _this3.recordActivitiesForAll(index);}},React.createElement(Text,{style:{fontSize:20}},activity));}),React.createElement(TouchableHighlight,{style:{backgroundColor:activities_bool[8]?'#368cbf':'#eaf8f8',justifyContent:'center',borderRadius:3,padding:3,margin:5},underlayColor:\"#368cbf\",onPress:function onPress(){return _this3.recordActivitiesForAll(8);},onLongPress:function onLongPress(){return _this3.setState({editingOtherActivity:true});}},editingOtherActivity?React.createElement(View,{style:{flex:1}},React.createElement(TextInput,{autoFocus:true,selectTextOnFocus:true,value:this.state.other_activity,style:{alignSelf:'center',fontSize:20,backgroundColor:activities_bool[8]?'#368cbf':'#eaf8f8'},onChangeText:function onChangeText(other_activity){return _this3.writeActivityForAll(other_activity);},onBlur:function onBlur(){return _this3.otherActivityEditorOnBlur();}})):React.createElement(Text,{style:{alignSelf:'center',fontSize:20}},this.state.other_activity))))),React.createElement(TextInput,{value:this.state.to_all_message,style:{alignSelf:'center',width:'100%',borderColor:'gray',borderWidth:2,borderRadius:10,fontSize:25,padding:20},multiline:true,maxLength:100,onChangeText:function onChangeText(to_all_message){return _this3.writeToAll(to_all_message);}})))),Object.keys(students).map(function(student_id){var _message_by_student_i=message_by_student_id[student_id],text=_message_by_student_i.text,things_to_bring=_message_by_student_i.things_to_bring,activities=_message_by_student_i.activities,other_item=_message_by_student_i.other_item,other_activity=_message_by_student_i.other_activity;return React.createElement(View,{key:student_id,style:{width:'95%'}},React.createElement(Card,{style:{padding:10}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{flex:1,alignItems:'center',justifyContent:'center'}},React.createElement(Image,{source:students[student_id].profile_picture===''?require(\"../../assets/icon-thumbnail.png\"):{uri:students[student_id].profile_picture},style:{width:100,height:100,borderRadius:50}}),React.createElement(Text,{style:{fontSize:25}},students[student_id].name)),React.createElement(View,{style:{flex:4}},React.createElement(View,{style:{flex:1,flexDirection:'row',paddingBottom:10}},React.createElement(View,{style:{width:'29%',backgroundColor:'#fff1b5',borderRadius:10,marginRight:3}},React.createElement(Text,{style:{fontSize:28,alignSelf:'center'}},\"\\u5BB6\\u9577\\u6E96\\u5099\"),React.createElement(View,{style:{flex:1,flexDirection:'row',justifyContent:'space-evenly',flexWrap:'wrap'}},items_to_bring.map(function(item,index){return React.createElement(TouchableHighlight,{key:index,style:{backgroundColor:things_to_bring[index]?'#f4d41f':'#fff7d6',borderRadius:3,padding:4,margin:5},onPress:function onPress(){return _this3.remindItemsToBringToOne(student_id,index);}},React.createElement(Text,{style:{fontSize:20}},item));}),React.createElement(TouchableHighlight,{style:{backgroundColor:things_to_bring[4]?'#f4d41f':'#fff7d6',justifyContent:'center',borderRadius:3,padding:3,margin:5},underlayColor:\"#f4d41f\",onPress:function onPress(){return _this3.remindItemsToBringToOne(student_id,4);},onLongPress:function onLongPress(){return _this3.setState({editingOtherItemForStudent:student_id});}},editingOtherItemForStudent===student_id?React.createElement(View,{style:{flex:1}},React.createElement(TextInput,{autoFocus:true,selectTextOnFocus:true,value:other_item,style:{alignSelf:'center',fontSize:20,backgroundColor:things_to_bring[4]?'#f4d41f':'#fff7d6'},onChangeText:function onChangeText(item_to_bring){return _this3.writeItemToBringToOne(student_id,item_to_bring);},onBlur:function onBlur(){return _this3.editItemToBringToOneEditorOnBlur(student_id,other_item);}})):React.createElement(Text,{style:{alignSelf:'center',fontSize:20}},other_item)))),React.createElement(View,{style:{width:'70%',borderRadius:10,marginLeft:3,backgroundColor:'#b5e9e9'}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{flex:2}},React.createElement(Text,{style:{fontSize:28,alignSelf:'flex-end'}},\"\\u4ECA\\u65E5\\u6D3B\\u52D5\")),React.createElement(View,{style:{flex:1,justifyContent:'center'}},student_id_for_update.has(student_id)?React.createElement(Text,{style:{fontSize:15,alignSelf:'flex-end',paddingRight:10,color:'red'}},\"\\u672A\\u9001\\u51FA\"):null)),React.createElement(View,{style:{flex:1,flexDirection:'row',justifyContent:'space-between',flexWrap:'wrap'}},activities_list.map(function(activity,index){return React.createElement(TouchableHighlight,{key:index,style:{backgroundColor:activities[index]?'#368cbf':'#d6f2f2',borderRadius:3,padding:4,margin:5},onPress:function onPress(){return _this3.recordActivitiesForOne(student_id,index);}},React.createElement(Text,{style:{fontSize:20}},activity));}),React.createElement(TouchableHighlight,{style:{backgroundColor:activities[8]?'#368cbf':'#d6f2f2',justifyContent:'center',borderRadius:3,padding:3,margin:5},underlayColor:\"#368cbf\",onPress:function onPress(){return _this3.recordActivitiesForOne(student_id,8);},onLongPress:function onLongPress(){return _this3.setState({editingOtherActivityForOne:student_id});}},editingOtherActivityForOne===student_id?React.createElement(View,{style:{flex:1}},React.createElement(TextInput,{autoFocus:true,selectTextOnFocus:true,value:other_activity,style:{alignSelf:'center',fontSize:20,backgroundColor:activities[8]?'#368cbf':'#d6f2f2'},onChangeText:function onChangeText(activity){return _this3.writeActivityForOne(student_id,activity);},onBlur:function onBlur(){return _this3.activityForOneEditorOnBlur(student_id,other_activity);}})):React.createElement(Text,{style:{alignSelf:'center',fontSize:20}},other_activity))))),React.createElement(TextInput,{value:text,style:{borderColor:'gray',borderWidth:2,borderRadius:10,fontSize:25,padding:20},multiline:true,maxLength:100,onChangeText:function onChangeText(text){return _this3.writeToOne(text,student_id);}})))));})));}}]);return MessageForParents;}(React.Component);var styles=StyleSheet.create({cardContainer:{width:119,height:'100%',backgroundColor:'transparent'},thumbnailImage:{height:80,width:80,borderRadius:40}});var mapStateToProps=function mapStateToProps(state){return{class:state.classInfo,message:state.message};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return _objectSpread({},bindActionCreators({writeToAll:writeToAll,writeToOne:writeToOne,remindItemsToBringToAll:remindItemsToBringToAll,remindItemsToBringToOne:remindItemsToBringToOne,recordActivitiesForAll:recordActivitiesForAll,recordActivitiesForOne:recordActivitiesForOne,writeItemToBringToAll:writeItemToBringToAll,writeItemToBringToOne:writeItemToBringToOne,writeActivityForAll:writeActivityForAll,writeActivityForOne:writeActivityForOne,fetchClassMessageData:fetchClassMessageData,sendMessageOnSuccess:sendMessageOnSuccess},dispatch));};export default connect(mapStateToProps,mapDispatchToProps)(MessageForParents);","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/teacher/messageforparents.js"],"names":["React","Card","Toast","connect","bindActionCreators","writeToAll","writeToOne","remindItemsToBringToAll","remindItemsToBringToOne","recordActivitiesForAll","recordActivitiesForOne","writeItemToBringToAll","writeItemToBringToOne","writeActivityForAll","writeActivityForOne","fetchClassMessageData","sendMessageOnSuccess","Reloading","formatDate","fetchClassData","MessageForParents","props","state","isLoading","to_all_message","items_to_bring","other_item","items_to_bring_bool","activities_list","other_activity","activities_bool","message_by_student_id","editingOtherItemToBring","editingOtherItemForStudent","editingOtherActivity","editingOtherActivityForOne","bind","student_id_for_update","message","isConnected","class","size","setState","show","text","buttonText","position","type","duration","date","Date","start_date","setDate","getDate","end_date","class_id","messageData","data","teacher_id","route","params","student_id","selected_index","things_to_bring","new_bool","splice","item_to_bring","activities","request_body","normalize","fetch","method","headers","Accept","body","JSON","stringify","then","res","json","resJson","statusCode","alert","navigation","goBack","catch","err","normalized_data","forEach","push","students","flex","padding","flexDirection","alignItems","justifyContent","fontSize","getFullYear","getMonth","backgroundColor","handleSend","marginBottom","width","paddingVertical","borderRadius","marginRight","alignSelf","flexWrap","map","item","index","margin","otherItemForAllEditorOnBlur","marginLeft","activity","otherActivityEditorOnBlur","borderColor","borderWidth","Object","keys","profile_picture","require","uri","height","name","paddingBottom","editItemToBringToOneEditorOnBlur","has","paddingRight","color","activityForOneEditorOnBlur","Component","styles","StyleSheet","create","cardContainer","thumbnailImage","mapStateToProps","classInfo","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React from 'react'\nimport {\n  View,\n  Text,\n  ScrollView,\n  TouchableHighlight,\n  Image,\n  StyleSheet,\n  TextInput,\n  KeyboardAvoidingView,\n  Alert\n} from 'react-native'\nimport { Card, Toast } from 'native-base'\nimport { connect } from 'react-redux'\nimport { bindActionCreators } from 'redux'\nimport {\n  writeToAll,\n  writeToOne,\n  remindItemsToBringToAll,\n  remindItemsToBringToOne,\n  recordActivitiesForAll,\n  recordActivitiesForOne,\n  writeItemToBringToAll,\n  writeItemToBringToOne,\n  writeActivityForAll,\n  writeActivityForOne,\n  fetchClassMessageData,\n  sendMessageOnSuccess\n} from '../../redux/school/actions/index'\nimport Reloading from '../reloading'\nimport { formatDate, fetchClassData } from '../util'\n\nclass MessageForParents extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      isLoading: true,\n      to_all_message: '',\n      items_to_bring: ['母奶粉', '尿布', '水壺', '衣物'],\n      other_item: '其它',\n      items_to_bring_bool: [0, 0, 0, 0, 0],\n      activities_list: ['嬰兒按摩', '音樂律動', '教具操作', '繪本欣賞', '認知圖片', '體能活動', '藝術創作', '多元語言'],\n      other_activity: '其它',\n      activities_bool: [0, 0, 0, 0, 0, 0, 0, 0, 0],\n      message_by_student_id: {},\n      editingOtherItemToBring: false,\n      editingOtherItemForStudent: '',\n      editingOtherActivity: false,\n      editingOtherActivityForOne: ''\n    }\n    this.recordActivitiesForAll = this.recordActivitiesForAll.bind(this)\n  }\n\n  componentDidMount() {\n    const { student_id_for_update } = this.props.message\n    const { isConnected } = this.props.class\n    if (student_id_for_update.size > 0 || !isConnected) {\n      this.setState({\n        isLoading: false\n      })\n    } else {\n      this.fetchClassData()\n    }\n\n    if (!isConnected) {\n      Toast.show({\n          text: '拍謝 網路連不到! 等一下再試試看',\n          buttonText: 'Okay',\n          position: \"top\",\n          type: \"warning\",\n          duration: 2000\n      })\n  }\n  }\n\n  async fetchClassData() {\n    const date = new Date()\n    const start_date = formatDate(date)\n    date.setDate(date.getDate() + 1)\n    const end_date = formatDate(date)\n    const messageData = await fetchClassData('message', this.props.class.class_id, start_date, end_date)\n    this.props.fetchClassMessageData(messageData.data)\n    this.setState({\n        isLoading: false\n    })\n  }\n\n  writeToAll(text) {\n    const { teacher_id } = this.props.route.params\n    this.setState({ to_all_message: text })\n    this.props.writeToAll(text, teacher_id)\n  }\n\n  writeToOne(text, student_id) {\n    const { teacher_id } = this.props.route.params\n    this.props.writeToOne(text, student_id, teacher_id)\n  }\n\n  remindItemsToBringToOne(student_id, selected_index) {\n    const { teacher_id } = this.props.route.params\n    const { message_by_student_id } = this.props.message\n    const things_to_bring = [...message_by_student_id[student_id].things_to_bring]\n    const new_bool = things_to_bring[selected_index] ? 0 : 1\n    things_to_bring.splice(selected_index, 1, new_bool)\n    this.props.remindItemsToBringToOne(student_id, things_to_bring, teacher_id)\n  }\n\n  remindItemsToBringToAll(selected_index) {\n    const { teacher_id } = this.props.route.params\n    const { items_to_bring_bool } = this.state\n    const new_bool = items_to_bring_bool[selected_index] ? 0 : 1\n    items_to_bring_bool.splice(selected_index, 1, new_bool)\n    this.setState({\n      items_to_bring_bool\n    })\n    this.props.remindItemsToBringToAll(items_to_bring_bool, teacher_id)\n  }\n\n  otherItemForAllEditorOnBlur() {\n    const { other_item } = this.state\n    this.setState({\n      editingOtherItemToBring: false,\n      other_item: other_item === '' ? '其它' : other_item\n    })\n  }\n\n  writeItemToBringToAll(item_to_bring) {\n    const { teacher_id } = this.props.route.params\n    this.setState({\n      other_item: item_to_bring\n    })\n    this.props.writeItemToBringToAll(item_to_bring, teacher_id)\n  }\n\n  writeItemToBringToOne(student_id, item_to_bring) {\n    const { teacher_id } = this.props.route.params\n    this.props.writeItemToBringToOne(student_id, item_to_bring, teacher_id)\n  }\n\n  editItemToBringToOneEditorOnBlur(student_id, other_item) {\n    this.setState({ editingOtherItemForStudent: '' })\n    if (other_item === '') {\n      this.props.writeItemToBringToOne(student_id, '其它')\n    }\n  }\n\n  recordActivitiesForOne(student_id, selected_index) {\n    const { teacher_id } = this.props.route.params\n    const { message_by_student_id } = this.props.message\n    const activities = [...message_by_student_id[student_id].activities]\n    const new_bool = activities[selected_index] ? 0 : 1\n    activities.splice(selected_index, 1, new_bool)\n    this.props.recordActivitiesForOne(student_id, activities, teacher_id)\n  }\n\n  recordActivitiesForAll(selected_index) {\n    const { teacher_id } = this.props.route.params\n    const { activities_bool } = this.state\n    const new_bool = activities_bool[selected_index] ? 0 : 1\n    activities_bool.splice(selected_index, 1, new_bool)\n    this.setState({\n      activities_bool\n    })\n    this.props.recordActivitiesForAll(activities_bool, teacher_id)\n  }\n\n  writeActivityForAll(other_activity) {\n    const { teacher_id } = this.props.route.params\n    this.setState({\n      other_activity\n    })\n    this.props.writeActivityForAll(other_activity, teacher_id)\n  }\n\n  otherActivityEditorOnBlur() {\n    const { other_activity } = this.state\n    this.setState({\n      editingOtherActivity: false,\n      other_activity: other_activity === '' ? '其它' : other_activity\n    })\n  }\n\n  writeActivityForOne(student_id, other_activity) {\n    const { teacher_id } = this.props.route.params\n    this.props.writeActivityForOne(student_id, other_activity, teacher_id)\n  }\n  \n  activityForOneEditorOnBlur(student_id, other_activity) {\n    this.setState({ editingOtherActivityForOne: '' })\n    if (other_activity === '') {\n      this.props.writeActivityForOne(student_id, '其它')\n    }\n  }\n\n  handleSend() {\n    const { message_by_student_id } = this.props.message\n    const { isConnected } = this.props.class\n    if (!isConnected) {\n      Toast.show({\n          text: '拍謝 網路連不到! 等一下再試試看',\n          buttonText: 'Okay',\n          position: \"top\",\n          type: \"warning\",\n          duration: 2000\n      })\n      return\n    }\n\n    const request_body = {\n      date: formatDate(new Date()),\n      data: this.normalize(message_by_student_id)\n    }\n\n    fetch('https://iejnoswtqj.execute-api.us-east-1.amazonaws.com/dev/message', {\n      method: 'POST',\n      headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(request_body)\n    })\n      .then(res => res.json())\n      .then(resJson => {\n        const { statusCode, message, data } = resJson\n        if (statusCode > 200 || message === 'Internal server error') {\n          alert('Error' + message)\n          return\n        }\n        this.props.sendMessageOnSuccess()\n        this.props.navigation.goBack()\n      })\n      .catch(err => {\n        alert('Error' + err.message)\n      })\n  }\n\n  normalize(data) {\n    const { student_id_for_update } = this.props.message\n    var normalized_data = []\n    student_id_for_update.forEach(student_id => {\n      normalized_data.push({\n        ...data[student_id],\n        student_id,\n      })\n    })\n    return normalized_data\n  }\n\n  render() {\n    const { student_id_for_update } = this.props.message\n    if (this.state.isLoading) {\n      return (\n        <Reloading />\n      )\n    }\n    const { students } = this.props.class\n    const { message_by_student_id } = this.props.message\n    const {\n      items_to_bring,\n      items_to_bring_bool,\n      activities_list,\n      activities_bool,\n      editingOtherItemToBring,\n      editingOtherItemForStudent,\n      editingOtherActivity,\n      editingOtherActivityForOne\n    } = this.state\n    const date = new Date()\n    // console.log('message_by_student_id: ', message_by_student_id)\n    return (\n      <KeyboardAvoidingView\n        style={{\n          flex: 1\n        }}\n        // behavior='padding'\n        // keyboardVerticalOffset={100}\n        enabled\n      >       \n        <View\n          style={{\n            padding: 10,\n            flexDirection: 'row',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n          }}\n        >\n          <Text style={{ fontSize: 40 }}>{date.getFullYear() + '.' + (date.getMonth()+1) + '.' + date.getDate()}</Text>\n          <TouchableHighlight\n            style={{ backgroundColor: '#dcf3d0' }}\n            onPress={() => this.handleSend()}\n          >\n            <Text style={{ fontSize: 40, padding: 5 }}>送出</Text>\n          </TouchableHighlight>\n        </View> \n        <ScrollView\n          contentContainerStyle={{ alignItems: 'center', marginBottom: 20 }}\n        >\n          <View style={{ width: '95%' }}>\n            <Card style={{padding: 10}}>\n              <View style={{ flex: 1 }}>\n                <View style={{ flex: 1, flexDirection: 'row', justifyContent: 'space-evenly', paddingVertical: 10 }}>\n                  <View style={{\n                    width: '29%',\n                    backgroundColor: '#fff1b5',\n                    borderRadius: 10,\n                    marginRight: 5\n                  }}>\n                    <Text style={{ fontSize: 35, alignSelf: 'center' }}>家長準備</Text>\n                    <View\n                      style={{\n                        flex: 1,\n                        flexDirection: 'row',\n                        justifyContent: 'space-evenly',\n                        flexWrap: 'wrap'\n                      }}\n                    >\n                      {items_to_bring.map((item, index) => {\n                        return (\n                          <TouchableHighlight\n                            key={index}\n                            style={{\n                              backgroundColor: items_to_bring_bool[index] ? '#f4d41f' : '#fff7d6',\n                              borderRadius: 3,\n                              padding: 3,\n                              margin: 5\n                            }}\n                            onPress={() => this.remindItemsToBringToAll(index)}\n                          >\n                            <Text style={{fontSize: 20}}>{item}</Text>\n                          </TouchableHighlight>\n                        )\n                      })}\n                      <TouchableHighlight\n                            style={{\n                                backgroundColor: items_to_bring_bool[4] ? '#f4d41f' : '#fff7d6',\n                                justifyContent: 'center',\n                                borderRadius: 3,\n                                padding: 3,\n                                margin: 5\n                            }}\n                            underlayColor='#f4d41f'\n                            onPress={() => this.remindItemsToBringToAll(4)}\n                            onLongPress={() => this.setState({ editingOtherItemToBring: true })}\n                      >\n                        {editingOtherItemToBring ?\n                          <View style={{ flex: 1 }}>\n                            \n                            <TextInput\n                              autoFocus={true}\n                              selectTextOnFocus={true}\n                              value={this.state.other_item}\n                              style={{\n                                alignSelf: 'center',\n                                fontSize: 20,\n                                backgroundColor: items_to_bring_bool[4] ? '#f4d41f' : '#fff7d6'\n                              }}\n                              onChangeText={item_to_bring => this.writeItemToBringToAll(item_to_bring)}\n                              onBlur={() => this.otherItemForAllEditorOnBlur()}\n                            />\n\n                          </View>\n                          : <Text style={{ alignSelf: 'center', fontSize: 20 }}>{this.state.other_item}</Text>\n                        }\n                      </TouchableHighlight>\n                    </View>\n                  </View>\n                  <View\n                    style={{\n                      width: '69%',\n                      backgroundColor: '#b5e9e9',\n                      borderRadius: 10,\n                      marginLeft: 5\n                    }}\n                  >\n                    <Text style={{ fontSize: 35, alignSelf: 'center' }}>今日活動</Text>\n                    <View style={{\n                      flexDirection: 'row',\n                      justifyContent: 'space-evenly',\n                      flexWrap: 'wrap'\n                    }}>\n                      {activities_list.map((activity, index) => {\n                        return (\n                          <TouchableHighlight\n                            key={index}\n                            style={{\n                              backgroundColor: activities_bool[index] ? '#368cbf' : '#eaf8f8',\n                              // borderColor: '#d6f2f2',\n                              // borderWidth: 2,\n                              borderRadius: 3,\n                              padding: 3,\n                              margin: 5\n                              // width: '13%'\n                            }}\n                            onPress={() => this.recordActivitiesForAll(index)}\n                          >\n                            <Text style={{fontSize: 20}}>{activity}</Text>\n                          </TouchableHighlight>\n                        )\n                      })}\n\n                      <TouchableHighlight\n                            style={{\n                                backgroundColor: activities_bool[8] ? '#368cbf' : '#eaf8f8',\n                                justifyContent: 'center',\n                                borderRadius: 3,\n                                padding: 3,\n                                margin: 5\n                            }}\n                            underlayColor='#368cbf'\n                            onPress={() => this.recordActivitiesForAll(8)}\n                            onLongPress={() => this.setState({ editingOtherActivity: true })}\n                      >\n                        {editingOtherActivity ?\n                          <View style={{ flex: 1 }}>\n                            \n                            <TextInput\n                              autoFocus={true}\n                              selectTextOnFocus={true}\n                              value={this.state.other_activity}\n                              style={{\n                                alignSelf: 'center',\n                                fontSize: 20,\n                                backgroundColor: activities_bool[8] ? '#368cbf' : '#eaf8f8'\n                              }}\n                              onChangeText={other_activity => this.writeActivityForAll(other_activity)}\n                              onBlur={() => this.otherActivityEditorOnBlur()}\n                            />\n\n                          </View>\n                          : <Text style={{ alignSelf: 'center', fontSize: 20 }}>{this.state.other_activity}</Text>\n                        }\n                      </TouchableHighlight>\n                    </View>\n                  </View>\n                </View>\n                <TextInput\n                  value={this.state.to_all_message}\n                  style={{\n                    alignSelf: 'center',\n                    width: '100%',\n                    borderColor: 'gray',\n                    borderWidth: 2,\n                    borderRadius: 10,\n                    fontSize: 25,\n                    padding: 20\n                  }}\n                  multiline={true}\n                  maxLength={100}\n                  onChangeText={to_all_message => this.writeToAll(to_all_message)}\n                />\n              </View>\n            </Card>\n          </View>\n          {Object.keys(students).map(student_id => {\n            const {text, things_to_bring, activities, other_item, other_activity} = message_by_student_id[student_id]\n            return (\n              <View key={student_id} style={{ width: '95%' }}>\n                <Card style={{ padding: 10 }}>\n                  <View style={{ flex: 1, flexDirection: 'row'}}>\n                    <View style={{ flex: 1, alignItems: 'center', justifyContent: 'center' }}>\n                      <Image\n                        source={\n                          students[student_id].profile_picture === '' ?\n                            require('../../assets/icon-thumbnail.png')\n                            : {uri: students[student_id].profile_picture}\n                        }\n                        style={{ width: 100, height: 100, borderRadius: 50 }}\n                      />\n                      <Text style={{ fontSize: 25 }}>{students[student_id].name}</Text>\n                    </View>\n                    <View style={{ flex: 4 }}>\n                      <View style={{ flex: 1, flexDirection: 'row', paddingBottom: 10 }}>\n                        <View\n                          style={{\n                            width: '29%',\n                            backgroundColor: '#fff1b5',\n                            borderRadius: 10,\n                            marginRight: 3\n                          }}\n                        >\n                          <Text style={{ fontSize: 28, alignSelf: 'center' }}>家長準備</Text>\n                          <View\n                              style={{\n                              flex: 1,\n                              flexDirection: 'row',\n                              justifyContent: 'space-evenly',\n                              flexWrap: 'wrap',\n                            }}\n                          >\n                            {items_to_bring.map((item, index) => {\n                              return (\n                                <TouchableHighlight\n                                  key={index}\n                                  style={{\n                                    backgroundColor: things_to_bring[index] ? '#f4d41f' : '#fff7d6',\n                                    borderRadius: 3,\n                                    padding: 4,\n                                    margin: 5\n                                  }}\n                                  onPress={() => this.remindItemsToBringToOne(student_id, index)}\n                                >\n                                  <Text style={{fontSize: 20}}>{item}</Text>\n                                </TouchableHighlight>\n                              )\n                            })}\n\n                            <TouchableHighlight\n                                  style={{\n                                      backgroundColor: things_to_bring[4] ? '#f4d41f' : '#fff7d6',\n                                      justifyContent: 'center',\n                                      borderRadius: 3,\n                                      padding: 3,\n                                      margin: 5\n                                  }}\n                                  underlayColor='#f4d41f'\n                                  onPress={() => this.remindItemsToBringToOne(student_id, 4)}\n                                  onLongPress={() => this.setState({ editingOtherItemForStudent: student_id })}\n                            >\n                              {editingOtherItemForStudent === student_id ?\n                                <View style={{ flex: 1 }}>\n                                  \n                                  <TextInput\n                                    autoFocus={true}\n                                    selectTextOnFocus={true}\n                                    value={other_item}\n                                    style={{\n                                      alignSelf: 'center',\n                                      fontSize: 20,\n                                      backgroundColor: things_to_bring[4] ? '#f4d41f' : '#fff7d6',\n                                    }}\n                                    onChangeText={item_to_bring => this.writeItemToBringToOne(student_id, item_to_bring)}\n                                    onBlur={() => this.editItemToBringToOneEditorOnBlur(student_id, other_item)}\n                                  />\n\n                                </View>\n                                : <Text style={{ alignSelf: 'center', fontSize: 20 }}>{other_item}</Text>\n                              }\n                            </TouchableHighlight>\n                          </View>\n                        </View>\n                        <View style={{\n                          width: '70%',\n                          borderRadius: 10,\n                          marginLeft: 3,\n                          backgroundColor: '#b5e9e9'\n                        }}>\n                          <View style={{ flex:1, flexDirection: 'row' }}>\n                            <View style={{ flex: 2 }}>\n                              <Text style={{ fontSize: 28, alignSelf: 'flex-end' }}>今日活動</Text>\n                            </View>\n                            <View style={{ flex: 1, justifyContent: 'center' }}>\n                              {student_id_for_update.has(student_id) ? \n                                <Text \n                                  style={{ fontSize: 15, alignSelf: 'flex-end', paddingRight: 10, color: 'red' }}\n                                >\n                                    未送出\n                                </Text>\n                                : null}\n                            </View>\n                          </View>\n                          <View style={{\n                            flex: 1,\n                            flexDirection: 'row',\n                            justifyContent: 'space-between',\n                            flexWrap: 'wrap'\n                          }}>\n                            {activities_list.map((activity, index) => {\n                              return (\n                                <TouchableHighlight\n                                  key={index}\n                                  style={{\n                                    backgroundColor: activities[index] ? '#368cbf' : '#d6f2f2',\n                                    borderRadius: 3,\n                                    padding: 4,\n                                    margin: 5\n                                  }}\n                                  onPress={() => this.recordActivitiesForOne(student_id, index)}\n                                >\n                                  <Text style={{fontSize: 20}}>{activity}</Text>\n                                </TouchableHighlight>\n                              )\n                            })}\n\n                            <TouchableHighlight\n                                  style={{\n                                      backgroundColor: activities[8] ? '#368cbf' : '#d6f2f2',\n                                      justifyContent: 'center',\n                                      borderRadius: 3,\n                                      padding: 3,\n                                      margin: 5\n                                  }}\n                                  underlayColor='#368cbf'\n                                  onPress={() => this.recordActivitiesForOne(student_id, 8)}\n                                  onLongPress={() => this.setState({ editingOtherActivityForOne: student_id })}\n                            >\n                              {editingOtherActivityForOne === student_id ?\n                                <View style={{ flex: 1 }}>\n                                  \n                                  <TextInput\n                                    autoFocus={true}\n                                    selectTextOnFocus={true}\n                                    value={other_activity}\n                                    style={{\n                                      alignSelf: 'center',\n                                      fontSize: 20,\n                                      backgroundColor: activities[8] ? '#368cbf' : '#d6f2f2',\n                                    }}\n                                    onChangeText={activity => this.writeActivityForOne(student_id, activity)}\n                                    onBlur={() => this.activityForOneEditorOnBlur(student_id, other_activity)}\n                                  />\n\n                                </View>\n                                : <Text style={{ alignSelf: 'center', fontSize: 20 }}>{other_activity}</Text>\n                              }\n                            </TouchableHighlight>\n                          </View>\n                        </View>\n                      </View>\n                      <TextInput\n                        value={text}\n                        style={{ borderColor: 'gray', borderWidth: 2, borderRadius: 10, fontSize: 25, padding: 20 }}\n                        multiline={true}\n                        maxLength={100}\n                        onChangeText={text => this.writeToOne(text, student_id)}\n                      />\n                    </View>\n                  </View>\n                </Card>\n              </View>\n            )\n          })}\n        </ScrollView>\n      </KeyboardAvoidingView>\n    )\n  }\n}\n\nconst styles = StyleSheet.create({\n  cardContainer: {\n      width: 119,\n      height: '100%',\n      backgroundColor: 'transparent'\n  },\n  thumbnailImage: {\n      height: 80,\n      width: 80,\n      borderRadius: 40\n  }\n})\n\n\nconst mapStateToProps = state => {\n  return {\n    class: state.classInfo,\n    message: state.message\n  }\n}\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    ...bindActionCreators({\n      writeToAll,\n      writeToOne,\n      remindItemsToBringToAll,\n      remindItemsToBringToOne,\n      recordActivitiesForAll,\n      recordActivitiesForOne,\n      writeItemToBringToAll,\n      writeItemToBringToOne,\n      writeActivityForAll,\n      writeActivityForOne,\n      fetchClassMessageData,\n      sendMessageOnSuccess\n    }, dispatch)\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps) (MessageForParents)"]},"metadata":{},"sourceType":"module"}