{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}import React from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import Image from\"react-native-web/dist/exports/Image\";import TextInput from\"react-native-web/dist/exports/TextInput\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Alert from\"react-native-web/dist/exports/Alert\";import{Card,Body}from'native-base';import{formatDate,fetchData as _fetchData,post,beautifyTime,formatTime}from\"../util\";import Reloading from\"../reloading\";import TimeModal from\"./timemodal\";import{debounce}from'lodash';var MorningReminderCard=function(_React$Component){_inherits(MorningReminderCard,_React$Component);var _super=_createSuper(MorningReminderCard);function MorningReminderCard(props){var _this;_classCallCheck(this,MorningReminderCard);_this=_super.call(this,props);_this.state={isLoading:true,morning_reminder_id:null,text:'',reminder_read:false,isConnected:true,scrollHeight:'100%',milk_timestamp:new Date(),diaper_timestamp:new Date(),milk_amount:'',diaper_type:'小便',showDateTimeModal:false,showDateTimeModalType:'',includeMilkIntake:false,includeDiaper:false};_this.fetchData=_this.fetchData.bind(_assertThisInitialized(_this));_this.onSendMessageDelay=debounce(_this.sendMessage,1000).bind(_assertThisInitialized(_this));return _this;}_createClass(MorningReminderCard,[{key:\"componentDidMount\",value:function componentDidMount(){var date=this.props.date;this.fetchData(this.props.child_id,new Date(date.getTime()));}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(this.props.date!==prevProps.date){this.setState({isLoading:true,text:'',scrollHeight:'100%',includeMilkIntake:false,milk_timestamp:new Date(),milk_amount:'',includeDiaper:false,diaper_timestamp:new Date(),diaper_type:'小便'});this.fetchData(this.props.child_id,new Date(this.props.date.getTime()));}else if(this.props.child_id!==prevProps.child_id){this.setState({isLoading:true,text:'',scrollHeight:'100%',includeMilkIntake:false,milk_timestamp:new Date(),milk_amount:'',includeDiaper:false,diaper_timestamp:new Date(),diaper_type:'小便'});this.fetchData(this.props.child_id,new Date());}else if(this.props.isConnected!=prevProps.isConnected){this.setState({isConnected:this.props.isConnected});}}},{key:\"setScrollHeight\",value:function setScrollHeight(scrollHeight){this.setState({scrollHeight:scrollHeight});}},{key:\"fetchData\",value:function fetchData(child_id,date){var start_date,end_date,messageData;return _regeneratorRuntime.async(function fetchData$(_context){while(1){switch(_context.prev=_context.next){case 0:start_date=formatDate(date);date.setDate(date.getDate()+1);end_date=formatDate(date);_context.next=5;return _regeneratorRuntime.awrap(_fetchData('morningreminder',child_id,start_date,end_date));case 5:messageData=_context.sent;if(!(messageData.data===undefined||messageData.data[start_date]===undefined)){_context.next=9;break;}this.setState({isLoading:false,morning_reminder_id:null,text:'',reminder_read:false});return _context.abrupt(\"return\");case 9:this.setState({isLoading:false,morning_reminder_id:messageData.data[start_date].morning_reminder_id,text:messageData.data[start_date].text,reminder_read:messageData.data[start_date].reminder_read});case 10:case\"end\":return _context.stop();}}},null,this,null,Promise);}},{key:\"sendMessage\",value:function sendMessage(){var _this$props,class_id,date,parent_id,_this$state,text,morning_reminder_id,isConnected,includeMilkIntake,milk_timestamp,milk_amount,includeDiaper,diaper_timestamp,diaper_type,reminder,body,response,success,statusCode,message,data;return _regeneratorRuntime.async(function sendMessage$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this$props=this.props,class_id=_this$props.class_id,date=_this$props.date,parent_id=_this$props.parent_id;_this$state=this.state,text=_this$state.text,morning_reminder_id=_this$state.morning_reminder_id,isConnected=_this$state.isConnected,includeMilkIntake=_this$state.includeMilkIntake,milk_timestamp=_this$state.milk_timestamp,milk_amount=_this$state.milk_amount,includeDiaper=_this$state.includeDiaper,diaper_timestamp=_this$state.diaper_timestamp,diaper_type=_this$state.diaper_type;if(!(!this.editable()||text===''&&!includeMilkIntake&&!includeDiaper)){_context2.next=4;break;}return _context2.abrupt(\"return\");case 4:if(isConnected){_context2.next=7;break;}alert('網路連不到! 請稍後再試試看');return _context2.abrupt(\"return\");case 7:reminder=text;if(includeDiaper){reminder=\"\\u5982\\u5EC1: \"+beautifyTime(diaper_timestamp)+\" \"+diaper_type+\"\\n\"+reminder;}if(includeMilkIntake){reminder=\"\\u9935\\u5976: \"+beautifyTime(milk_timestamp)+\" \"+milk_amount+\" c.c.\\n\"+reminder;}body={morning_reminder_id:morning_reminder_id,student_id:this.props.child_id,parent_id:parent_id,timestamp:formatDate(date)+' '+formatTime(date),text:reminder};_context2.next=13;return _regeneratorRuntime.awrap(post(\"/morningreminder/class/\"+class_id,body));case 13:response=_context2.sent;success=response.success,statusCode=response.statusCode,message=response.message,data=response.data;if(success){_context2.next=18;break;}alert(\"Sorry \\u50B3\\u9001\\u8A0A\\u606F\\u6642\\u96FB\\u8166\\u51FA\\u72C0\\u6CC1\\u4E86\\uFF01\\u8ACB\\u622A\\u5716\\u548C\\u8207\\u5DE5\\u7A0B\\u5E2B\\u806F\\u7E6B\\n\\n\"+message);return _context2.abrupt(\"return\");case 18:alert(\"\\u8A0A\\u606F\\u50B3\\u9054\\u6210\\u529F\\uFF01\");this.setState({includeMilkIntake:false,milk_timestamp:new Date(),milk_amount:'',includeDiaper:false,diaper_timestamp:new Date(),diaper_type:'小便',morning_reminder_id:''});this.fetchData(this.props.child_id,new Date(this.props.date));case 21:case\"end\":return _context2.stop();}}},null,this,null,Promise);}},{key:\"editable\",value:function editable(){var date=this.props.date;var threshold=new Date();threshold.setHours(10,0,0);return date.toDateString()===new Date().toDateString()&&new Date()<threshold||date.toDateString()!==new Date().toDateString()&&date>new Date();}},{key:\"selectDatetimeConfirm\",value:function selectDatetimeConfirm(datetime){var showDateTimeModalType=this.state.showDateTimeModalType;if(showDateTimeModalType==='milkintake'){this.setState({milk_timestamp:datetime});}else if(showDateTimeModalType==='diaper'){this.setState({diaper_timestamp:datetime});}}},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,isLoading=_this$state2.isLoading,text=_this$state2.text,scrollHeight=_this$state2.scrollHeight,morning_reminder_id=_this$state2.morning_reminder_id,reminder_read=_this$state2.reminder_read,milk_timestamp=_this$state2.milk_timestamp,milk_amount=_this$state2.milk_amount,diaper_timestamp=_this$state2.diaper_timestamp,diaper_type=_this$state2.diaper_type,showDateTimeModal=_this$state2.showDateTimeModal,includeMilkIntake=_this$state2.includeMilkIntake,includeDiaper=_this$state2.includeDiaper;return React.createElement(Card,{style:{width:'93%'}},React.createElement(View,{style:{flex:1,flexDirection:'row'}},React.createElement(View,{style:{width:56,height:56,justifyContent:'center',alignItems:'center'}},React.createElement(Image,{source:require(\"../../assets/icon-morningreminder.png\"),style:{width:48,height:48}})),React.createElement(View,{style:{flex:1}},React.createElement(View,{style:{paddingTop:8,flexDirection:'row',justifyContent:'space-between',paddingRight:8}},React.createElement(Text,{style:{fontSize:20}},\"\\u611B\\u7684\\u53EE\\u5680\"),text!==''&&React.createElement(Text,{style:{fontSize:20}},reminder_read?'已讀':'未讀')),React.createElement(View,{style:{flex:1,paddingVertical:8,paddingRight:8}},React.createElement(View,{style:{flexDirection:'row',alignItems:'center',backgroundColor:includeMilkIntake?'#dcf3d0':'transparent'}},React.createElement(TouchableOpacity,{disabled:true,onClick:function onClick(){if(!_this2.editable())return;_this2.setState({includeMilkIntake:!includeMilkIntake});}},React.createElement(View,{style:{flexDirection:'row',justifyContent:'center',alignItems:'center'}},React.createElement(View,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:'center',alignItems:'center'}},React.createElement(View,{style:{width:16,height:16,borderRadius:8,backgroundColor:includeMilkIntake?'#00c07f':'white'}})),React.createElement(Text,{style:{fontSize:20,marginLeft:10,alignSelf:'center'}},\"\\u9935\\u5976: \"))),React.createElement(TouchableOpacity,{style:{justifyContent:'center',alignItems:'center',padding:10},onClick:function onClick(){if(!_this2.editable())return;_this2.setState({showDateTimeModalType:'milkintake',includeMilkIntake:true});_this2.props.showTimeModal();}},React.createElement(Text,{style:{fontSize:25}},\"\"+beautifyTime(milk_timestamp))),React.createElement(TextInput,{editable:this.editable(),style:{marginLeft:15,width:55,fontSize:25},keyboardType:\"number-pad\",placeholder:'_____',value:''+milk_amount,onChangeText:function onChangeText(milk_amount){return _this2.setState({milk_amount:milk_amount});},onFocus:function onFocus(){if(!_this2.editable())return;_this2.setState({includeMilkIntake:true});}}),React.createElement(Text,{style:{fontSize:20}},\"  c.c.\")),React.createElement(View,{style:{flexDirection:'row',alignItems:'center',marginTop:10,backgroundColor:includeDiaper?'#dcf3d0':'transparent'}},React.createElement(TouchableOpacity,{disabled:true,onClick:function onClick(){if(!_this2.editable())return;_this2.setState({includeDiaper:!includeDiaper});}},React.createElement(View,{style:{flexDirection:'row',justifyContent:'center',alignItems:'center'}},React.createElement(View,{style:{width:24,height:24,borderWidth:1,borderRadius:12,justifyContent:'center',alignItems:'center'}},React.createElement(View,{style:{width:16,height:16,borderRadius:8,backgroundColor:includeDiaper?'#00c07f':'white'}})),React.createElement(Text,{style:{fontSize:20,marginLeft:10,alignSelf:'center'}},\"\\u5982\\u5EC1: \"))),React.createElement(TouchableOpacity,{style:{justifyContent:'center',alignItems:'center',padding:5},onClick:function onClick(){if(!_this2.editable())return;_this2.setState({showDateTimeModalType:'diaper',includeDiaper:true});_this2.props.showTimeModal();}},React.createElement(Text,{style:{fontSize:25,padding:5}},\"\"+beautifyTime(diaper_timestamp))),React.createElement(TouchableOpacity,{style:{marginLeft:15,justifyContent:'center',alignItems:'center',padding:10},onClick:function onClick(){if(!_this2.editable())return;_this2.setState({diaper_type:diaper_type==='小便'?'大便':diaper_type==='大便'?'無排便':'小便',includeDiaper:true});}},React.createElement(Text,{style:{fontSize:20}},diaper_type))),React.createElement(TextInput,{key:morning_reminder_id,editable:this.editable(),style:{width:'100%',height:scrollHeight,backgroundColor:'#dcf3d0',fontSize:25,paddingTop:10,padding:10,marginTop:10},placeholder:this.editable()?'點擊我開始填寫...':isLoading?'下載中...':'已不能填寫',value:text,multiline:true,scrollEnabled:false,onChangeText:function onChangeText(text){return _this2.setState({text:text});},onChange:function onChange(e){return _this2.setScrollHeight(e.target.scrollHeight);},onLayout:function onLayout(event){var scrollHeight=event.nativeEvent.target.scrollHeight;_this2.setState({scrollHeight:scrollHeight});}}),React.createElement(TouchableOpacity,{disabled:!this.editable(),style:{backgroundColor:'#00c07f',padding:10,justifyContent:'center',alignItems:'center'},underlayColor:\"transparent\",onClick:this.onSendMessageDelay},React.createElement(Text,{style:{fontSize:25}},\"\\u9001\\u51FA\"))))));}}]);return MorningReminderCard;}(React.Component);export{MorningReminderCard as default};","map":{"version":3,"sources":["/home/caleb_lee/gina_web_app/components/parent/morningremindercard.js"],"names":["React","Card","Body","formatDate","fetchData","post","beautifyTime","formatTime","Reloading","TimeModal","debounce","MorningReminderCard","props","state","isLoading","morning_reminder_id","text","reminder_read","isConnected","scrollHeight","milk_timestamp","Date","diaper_timestamp","milk_amount","diaper_type","showDateTimeModal","showDateTimeModalType","includeMilkIntake","includeDiaper","bind","onSendMessageDelay","sendMessage","date","child_id","getTime","prevProps","setState","start_date","setDate","getDate","end_date","messageData","data","undefined","class_id","parent_id","editable","alert","reminder","body","student_id","timestamp","response","success","statusCode","message","threshold","setHours","toDateString","datetime","width","flex","flexDirection","height","justifyContent","alignItems","require","paddingTop","paddingRight","fontSize","paddingVertical","backgroundColor","borderWidth","borderRadius","marginLeft","alignSelf","padding","showTimeModal","marginTop","e","setScrollHeight","target","event","nativeEvent","Component"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { View, Text, Image, TextInput, TouchableOpacity, Alert } from 'react-native'\nimport { Card, Body } from 'native-base'\nimport { formatDate, fetchData, post, beautifyTime, formatTime } from '../util'\nimport Reloading from '../reloading'\nimport TimeModal from './timemodal'\nimport { debounce } from 'lodash'\n\nexport default class MorningReminderCard extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n        isLoading: true,\n        // present: false,\n        morning_reminder_id: null,\n        text: '',\n        reminder_read: false,\n        isConnected: true,\n        scrollHeight: '100%',\n        milk_timestamp: new Date(),\n        diaper_timestamp: new Date(),\n        milk_amount: '',\n        diaper_type: '小便',\n        showDateTimeModal: false,\n        showDateTimeModalType: '',\n        includeMilkIntake: false,\n        includeDiaper: false\n    }\n    this.fetchData = this.fetchData.bind(this)\n    this.onSendMessageDelay = debounce(this.sendMessage, 1000).bind(this)\n  }\n\n  componentDidMount() {\n    const { date } = this.props\n    this.fetchData(this.props.child_id, new Date(date.getTime()))\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.date !== prevProps.date) {\n      // console.log('this.props.date !== prevProps.date')\n      this.setState({ isLoading: true, text: '', scrollHeight: '100%', includeMilkIntake: false, milk_timestamp: new Date(), milk_amount: '', \n        includeDiaper: false, diaper_timestamp: new Date(), diaper_type: '小便' })\n      this.fetchData(this.props.child_id, new Date(this.props.date.getTime()));\n    } else if (this.props.child_id !== prevProps.child_id) {\n      this.setState({ isLoading: true, text: '', scrollHeight: '100%', includeMilkIntake: false, milk_timestamp: new Date(), milk_amount: '', \n        includeDiaper: false, diaper_timestamp: new Date(), diaper_type: '小便' })\n      this.fetchData(this.props.child_id, new Date());\n    // } else if (this.props.present !== prevProps.present) {\n    //     this.setState({ present: this.props.present })\n    } else if (this.props.isConnected != prevProps.isConnected) {\n      this.setState({\n        isConnected: this.props.isConnected\n      })\n    }\n  }\n\n  setScrollHeight(scrollHeight) {\n    // console.log('scrollHeight: ', scrollHeight)\n    this.setState({ scrollHeight })\n  }\n\n  async fetchData(child_id, date) {\n    const start_date = formatDate(date)\n    date.setDate(date.getDate() + 1)\n    const end_date = formatDate(date)\n    const messageData = await fetchData('morningreminder', child_id, start_date, end_date)\n    // console.log('messageData: ', messageData)\n    if (messageData.data === undefined || messageData.data[start_date] === undefined) {\n      this.setState({\n        isLoading: false,\n        morning_reminder_id: null,\n        text: '',\n        reminder_read: false\n      })\n      return\n    }\n    this.setState({\n        isLoading: false,\n        morning_reminder_id: messageData.data[start_date].morning_reminder_id,\n        text: messageData.data[start_date].text,\n        reminder_read: messageData.data[start_date].reminder_read\n    })\n  }\n\n  async sendMessage() {\n    const { class_id, date, parent_id } = this.props\n    const { text, morning_reminder_id, isConnected, \n      includeMilkIntake, milk_timestamp, milk_amount, includeDiaper, diaper_timestamp, diaper_type } = this.state\n    if (!this.editable() || (text === '' && !includeMilkIntake && !includeDiaper)) return\n    if (!isConnected) {\n      alert('網路連不到! 請稍後再試試看')\n      return\n    }\n\n    let reminder = text\n    if(includeDiaper) {\n      reminder = `如廁: ${beautifyTime(diaper_timestamp)} ${diaper_type}\\n` + reminder\n    }\n    if (includeMilkIntake) {\n      reminder = `餵奶: ${beautifyTime(milk_timestamp)} ${milk_amount} c.c.\\n` + reminder\n    }\n\n    const body = {\n        morning_reminder_id,\n        student_id: this.props.child_id,\n        parent_id,\n        timestamp: formatDate(date) + ' ' + formatTime(date),\n        text: reminder\n    }\n    const response = await post(`/morningreminder/class/${class_id}`, body)\n    const { success, statusCode, message, data } = response\n    if (!success) {\n      alert(`Sorry 傳送訊息時電腦出狀況了！請截圖和與工程師聯繫\\n\\n` + message)\n      return \n    }\n    alert(`訊息傳達成功！`)\n    this.setState({\n      includeMilkIntake: false,\n      milk_timestamp: new Date(),\n      milk_amount: '',\n      includeDiaper: false,\n      diaper_timestamp: new Date(),\n      diaper_type: '小便',\n      morning_reminder_id: ''\n    })\n\n    this.fetchData(this.props.child_id, new Date(this.props.date))\n  }\n\n  editable() {\n    const { date } = this.props\n    const threshold = new Date()\n    threshold.setHours(10, 0, 0)\n    return (date.toDateString() === (new Date).toDateString() && new Date() < threshold) || (date.toDateString() !== (new Date).toDateString() && date > (new Date()))\n    // return true\n  }\n\n  selectDatetimeConfirm(datetime) {\n    const { showDateTimeModalType } = this.state\n    if ( showDateTimeModalType === 'milkintake') {\n      this.setState({\n        milk_timestamp: datetime,\n        // showDateTimeModal: false\n      })\n    } else if (showDateTimeModalType === 'diaper') {\n      this.setState({\n        diaper_timestamp: datetime,\n        // showDateTimeModal: false\n      })\n    }\n  }\n\n  render() {\n    const { isLoading, text, scrollHeight, morning_reminder_id, reminder_read, \n      milk_timestamp, milk_amount, diaper_timestamp, diaper_type, showDateTimeModal, includeMilkIntake, includeDiaper } = this.state\n    // console.log('this.state: ', this.state)\n    return (\n      <Card style={{ width: '93%' }}>\n        {/* {showDateTimeModal &&\n          <TimeModal\n            start_date={new Date()}\n            datetime_type={'time'}\n            hideModal={() => this.setState({ showDateTimeModal: false })}\n            selectDatetimeConfirm={(datetime) => this.selectDatetimeConfirm(datetime)}\n            minDatetime={null}\n            maxDatetime={null}\n            minTime={null}\n            maxTime={null}\n          />\n        } */}\n        <View style={{ flex: 1, flexDirection: 'row' }}>\n          <View style={{ width: 56, height: 56, justifyContent: 'center', alignItems: 'center'}}>\n            <Image\n              source={require('../../assets/icon-morningreminder.png')}\n              style={{\n                  width: 48,\n                  height: 48\n              }}\n            />\n          </View>\n          <View style={{ flex: 1 }}>\n            <View style={{ paddingTop: 8, flexDirection: 'row', justifyContent: 'space-between', paddingRight: 8 }}>\n              <Text style={{ fontSize: 20 }}>愛的叮嚀</Text>\n              {text !== '' && <Text style={{ fontSize: 20 }}>{reminder_read ? '已讀' : '未讀'}</Text>}\n            </View>\n            <View style={{ flex: 1, paddingVertical: 8, paddingRight: 8 }}>\n                {/* milk */}\n                <View style={{ flexDirection: 'row', alignItems: 'center', backgroundColor: includeMilkIntake ? '#dcf3d0' : 'transparent' }}>\n                  <TouchableOpacity\n                    disabled={true}\n                    onClick={() => {\n                      if (!this.editable()) return\n                      this.setState({ includeMilkIntake: !includeMilkIntake })\n                    }}\n                  >\n                    <View style={{ flexDirection: 'row', justifyContent: 'center', alignItems: 'center' }}>\n                      <View\n                        style={{ width: 24, height: 24, borderWidth: 1, borderRadius: 12, justifyContent: 'center', alignItems: 'center' }}\n                      >\n                        <View \n                          style={{\n                            width: 16,\n                            height: 16,\n                            borderRadius: 8,\n                            backgroundColor: includeMilkIntake ? '#00c07f' : 'white'\n                          }}\n                        >\n                        </View>\n                      </View>\n                      <Text style={{ fontSize: 20, marginLeft: 10, alignSelf: 'center' }}>餵奶: </Text>\n                    </View>\n                  </TouchableOpacity>\n\n                  <TouchableOpacity\n                    style={{ justifyContent: 'center', alignItems: 'center', padding: 10 }}\n                    onClick={() => {\n                      if (!this.editable()) return\n                      this.setState({\n                        showDateTimeModalType: 'milkintake',\n                        // showDateTimeModal: true,\n                        includeMilkIntake: true\n                      })\n                      this.props.showTimeModal()\n                    }}\n                  >\n                    <Text style={{ fontSize: 25 }}>{`${beautifyTime(milk_timestamp)}`}</Text>\n                  </TouchableOpacity>\n                  <TextInput\n                    editable={this.editable()}\n                    style={{ marginLeft: 15, width: 55, fontSize: 25 }}\n                    keyboardType=\"number-pad\"\n                    placeholder={'_____'}\n                    value={''+milk_amount}\n                    onChangeText={(milk_amount) => this.setState({ milk_amount })}\n                    onFocus={() => {\n                      if (!this.editable()) return\n                      this.setState({ includeMilkIntake: true })\n                    }}\n                  />\n                  <Text style={{ fontSize: 20 }}>  c.c.</Text>\n                </View>\n\n                {/* diaper */}\n                <View \n                  style={{ \n                    flexDirection: 'row', alignItems: 'center', \n                    marginTop: 10, backgroundColor: includeDiaper ? '#dcf3d0' : 'transparent'\n                  }}\n                >\n                  <TouchableOpacity\n                    disabled={true}\n                    onClick={() => {\n                      if (!this.editable()) return\n                      this.setState({ includeDiaper: !includeDiaper })\n                    }}\n                  >\n                    <View style={{ flexDirection: 'row', justifyContent: 'center', alignItems: 'center' }}>\n                      <View\n                        style={{ width: 24, height: 24, borderWidth: 1, borderRadius: 12, justifyContent: 'center', alignItems: 'center' }}\n                      >\n                        <View \n                          style={{\n                            width: 16,\n                            height: 16,\n                            borderRadius: 8,\n                            backgroundColor: includeDiaper? '#00c07f' : 'white'\n                          }}\n                        >\n                        </View>\n                      </View>\n                      <Text style={{ fontSize: 20, marginLeft: 10, alignSelf: 'center' }}>如廁: </Text>\n                    </View>\n                  </TouchableOpacity>\n                  \n                  <TouchableOpacity\n                    style={{ justifyContent: 'center', alignItems: 'center', padding: 5 }}\n                    onClick={() => {\n                      if (!this.editable()) return\n                      this.setState({\n                        showDateTimeModalType: 'diaper',\n                        // showDateTimeModal: true,\n                        includeDiaper: true\n                      })\n                      this.props.showTimeModal()\n                    }}\n                  >\n                    <Text style={{ fontSize: 25, padding: 5 }}>{`${beautifyTime(diaper_timestamp)}`}</Text>\n                  </TouchableOpacity>\n\n                  <TouchableOpacity\n                    style={{ marginLeft: 15, justifyContent: 'center', alignItems: 'center', padding: 10 }}\n                    onClick={() => {\n                      if (!this.editable()) return\n                      this.setState({\n                        diaper_type: \n                          diaper_type === '小便' ? \n                            '大便'\n                            : diaper_type === '大便' ?\n                              '無排便'\n                              : '小便',\n                        includeDiaper: true\n                      })\n                    }}\n                  >\n                    <Text style={{ fontSize: 20 }}>{diaper_type}</Text>\n                  </TouchableOpacity>\n                </View>\n\n                {/* text */}\n                <TextInput\n                    key={morning_reminder_id}\n                    editable={this.editable()}\n                    style={{ width: '100%', height: scrollHeight, backgroundColor: '#dcf3d0', \n                      fontSize: 25, paddingTop: 10, padding: 10, marginTop: 10\n                    }}\n                    placeholder={\n                      this.editable() ? \n                        '點擊我開始填寫...' \n                        : isLoading ?\n                          '下載中...'\n                          :'已不能填寫'\n                    }\n                    value={text}\n                    multiline={true}\n                    scrollEnabled={false}\n                    // maxLength={200}\n                    onChangeText={(text) => this.setState({ text })}\n                    onChange={(e) => this.setScrollHeight(e.target.scrollHeight)}\n                    onLayout={(event) => {\n                      const { scrollHeight } = event.nativeEvent.target\n                      this.setState({\n                          scrollHeight\n                      })\n                    }}\n                />\n                <TouchableOpacity\n                    disabled={!this.editable()}\n                    style={{ backgroundColor: '#00c07f', padding: 10, justifyContent: 'center', alignItems: 'center' }}\n                    underlayColor=\"transparent\"\n                    onClick={this.onSendMessageDelay}\n                >\n                    <Text style={{ fontSize: 25}}>送出</Text>\n                </TouchableOpacity>\n            </View>\n          </View>\n        </View>\n      </Card>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}